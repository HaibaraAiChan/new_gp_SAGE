[05:32:06] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28897942 edges into 32 parts and get 9305165 edge cuts
main start at this time 1651555905.5925188
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026604175567626953
global_2_local spend time (sec) 0.03675341606140137
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004528999328613281
A = g.adjacency_matrix() spent  0.007870197296142578
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07907271385192871
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.305224895477295
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1653637886047363

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 1.210 seconds
Metis partitioning: 5.471 seconds
Split the graph: 0.541 seconds
Construct subgraphs: 0.042 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.280715465545654
2885
2789
2921
2864
2927
2758
2860
2859
2926
2890
2868
2927
2903
2897
2925
2877
2898
2861
2895
2888
2758
2770
2781
2791
2767
2764
2774
2777
2758
2867
2758
2758
total k batches seeds list generation spend  17.014108657836914
after graph partition
graph partition algorithm spend time 17.090879917144775
2885
2789
2921
2864
2927
2758
2860
2859
2926
2890
2868
2927
2903
2897
2925
2877
2898
2861
2895
2888
2758
2770
2781
2791
2767
2764
2774
2777
2758
2867
2758
2758
partition_len_list
[5721, 5126, 6125, 6050, 8117, 8422, 6856, 6831, 7389, 8286, 6666, 8838, 5161, 5111, 7130, 5543, 6371, 6636, 7941, 6580, 15856, 11972, 9467, 11980, 15189, 13120, 18975, 17509, 18024, 18401, 17281, 16829]
shared_neighbor_graph_partition_s0 selection method  spend 17.17945098876953
time for parepare:  0.017123937606811523
local_output_nid generation:  0.0006916522979736328
local_in_edges_tensor generation:  0.0009942054748535156
mini_batch_src_global generation:  0.00089263916015625
r_  generation:  0.005734682083129883
local_output_nid generation:  0.000698089599609375
local_in_edges_tensor generation:  0.0008819103240966797
mini_batch_src_global generation:  0.0008904933929443359
r_  generation:  0.005963325500488281
local_output_nid generation:  0.0007345676422119141
local_in_edges_tensor generation:  0.0008413791656494141
mini_batch_src_global generation:  0.0009899139404296875
r_  generation:  0.007045745849609375
local_output_nid generation:  0.0007445812225341797
local_in_edges_tensor generation:  0.0007157325744628906
mini_batch_src_global generation:  0.0007493495941162109
r_  generation:  0.006085872650146484
local_output_nid generation:  0.0007867813110351562
local_in_edges_tensor generation:  0.0007336139678955078
mini_batch_src_global generation:  0.0009248256683349609
r_  generation:  0.007966995239257812
local_output_nid generation:  0.0007462501525878906
local_in_edges_tensor generation:  0.0006685256958007812
mini_batch_src_global generation:  0.0007779598236083984
r_  generation:  0.0063817501068115234
local_output_nid generation:  0.0007703304290771484
local_in_edges_tensor generation:  0.0006926059722900391
mini_batch_src_global generation:  0.0008108615875244141
r_  generation:  0.007063388824462891
local_output_nid generation:  0.0007617473602294922
local_in_edges_tensor generation:  0.0006482601165771484
mini_batch_src_global generation:  0.0006849765777587891
r_  generation:  0.006197214126586914
local_output_nid generation:  0.0008037090301513672
local_in_edges_tensor generation:  0.0006783008575439453
mini_batch_src_global generation:  0.0008187294006347656
r_  generation:  0.007331371307373047
local_output_nid generation:  0.0008075237274169922
local_in_edges_tensor generation:  0.0006761550903320312
mini_batch_src_global generation:  0.0007786750793457031
r_  generation:  0.006739377975463867
local_output_nid generation:  0.0008122920989990234
local_in_edges_tensor generation:  0.0006430149078369141
mini_batch_src_global generation:  0.0007696151733398438
r_  generation:  0.0068433284759521484
local_output_nid generation:  0.0008165836334228516
local_in_edges_tensor generation:  0.0006659030914306641
mini_batch_src_global generation:  0.0008404254913330078
r_  generation:  0.00738978385925293
local_output_nid generation:  0.0008192062377929688
local_in_edges_tensor generation:  0.0006163120269775391
mini_batch_src_global generation:  0.0006122589111328125
r_  generation:  0.00510096549987793
local_output_nid generation:  0.0007991790771484375
local_in_edges_tensor generation:  0.0006148815155029297
mini_batch_src_global generation:  0.0005311965942382812
r_  generation:  0.0051310062408447266
local_output_nid generation:  0.0008056163787841797
local_in_edges_tensor generation:  0.0006394386291503906
mini_batch_src_global generation:  0.0007207393646240234
r_  generation:  0.006555795669555664
local_output_nid generation:  0.0007839202880859375
local_in_edges_tensor generation:  0.0006082057952880859
mini_batch_src_global generation:  0.0006310939788818359
r_  generation:  0.005714893341064453
local_output_nid generation:  0.0007653236389160156
local_in_edges_tensor generation:  0.0006020069122314453
mini_batch_src_global generation:  0.0005905628204345703
r_  generation:  0.005444765090942383
local_output_nid generation:  0.0007455348968505859
local_in_edges_tensor generation:  0.0005826950073242188
mini_batch_src_global generation:  0.0005669593811035156
r_  generation:  0.005469322204589844
local_output_nid generation:  0.0007960796356201172
local_in_edges_tensor generation:  0.0006544589996337891
mini_batch_src_global generation:  0.0006730556488037109
r_  generation:  0.005693912506103516
local_output_nid generation:  0.0007808208465576172
local_in_edges_tensor generation:  0.0006592273712158203
mini_batch_src_global generation:  0.00070953369140625
r_  generation:  0.006123781204223633
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.0006542205810546875
mini_batch_src_global generation:  0.0010569095611572266
r_  generation:  0.00901031494140625
local_output_nid generation:  0.000797271728515625
local_in_edges_tensor generation:  0.0006356239318847656
mini_batch_src_global generation:  0.0009312629699707031
r_  generation:  0.006851911544799805
local_output_nid generation:  0.0007960796356201172
local_in_edges_tensor generation:  0.0005998611450195312
mini_batch_src_global generation:  0.0006287097930908203
r_  generation:  0.005413055419921875
local_output_nid generation:  0.0007925033569335938
local_in_edges_tensor generation:  0.0006296634674072266
mini_batch_src_global generation:  0.0007338523864746094
r_  generation:  0.006789207458496094
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.0006344318389892578
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.007157087326049805
local_output_nid generation:  0.0007884502410888672
local_in_edges_tensor generation:  0.005921363830566406
mini_batch_src_global generation:  0.0009596347808837891
r_  generation:  0.0069522857666015625
local_output_nid generation:  0.0007905960083007812
local_in_edges_tensor generation:  0.0008101463317871094
mini_batch_src_global generation:  0.00121307373046875
r_  generation:  0.009034395217895508
local_output_nid generation:  0.0008218288421630859
local_in_edges_tensor generation:  0.0008242130279541016
mini_batch_src_global generation:  0.0012063980102539062
r_  generation:  0.008734464645385742
local_output_nid generation:  0.0008473396301269531
local_in_edges_tensor generation:  0.0008428096771240234
mini_batch_src_global generation:  0.001108407974243164
r_  generation:  0.011072397232055664
local_output_nid generation:  0.0009033679962158203
local_in_edges_tensor generation:  0.0008549690246582031
mini_batch_src_global generation:  0.0012218952178955078
r_  generation:  0.01217794418334961
local_output_nid generation:  0.00089263916015625
local_in_edges_tensor generation:  0.0007343292236328125
mini_batch_src_global generation:  0.00124359130859375
r_  generation:  0.008888006210327148
local_output_nid generation:  0.0009288787841796875
local_in_edges_tensor generation:  0.0007073879241943359
mini_batch_src_global generation:  0.0010733604431152344
r_  generation:  0.008775711059570312
----------------------check_connections_block total spend ----------------------------- 0.3893015384674072
generate_one_block  0.011757135391235352
generate_one_block  0.009515047073364258
generate_one_block  0.010456085205078125
generate_one_block  0.00890660285949707
generate_one_block  0.012294530868530273
generate_one_block  0.009978294372558594
generate_one_block  0.010442256927490234
generate_one_block  0.00897979736328125
generate_one_block  0.010488271713256836
generate_one_block  0.010621786117553711
generate_one_block  0.009841442108154297
generate_one_block  0.011018991470336914
generate_one_block  0.007050752639770508
generate_one_block  0.0071299076080322266
generate_one_block  0.00959324836730957
generate_one_block  0.00817251205444336
generate_one_block  0.007750988006591797
generate_one_block  0.007493019104003906
generate_one_block  0.008774280548095703
generate_one_block  0.008739233016967773
generate_one_block  0.014848470687866211
generate_one_block  0.010102987289428711
generate_one_block  0.008295774459838867
generate_one_block  0.010689496994018555
generate_one_block  0.011692047119140625
generate_one_block  0.010075569152832031
generate_one_block  0.014976978302001953
generate_one_block  0.013983488082885742
generate_one_block  0.015778779983520508
generate_one_block  0.019967317581176758
generate_one_block  0.01553034782409668
generate_one_block  0.0135040283203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023879528045654297
gen group dst list time:  0.009453296661376953
time for parepare:  0.021727323532104492
local_output_nid generation:  0.0011730194091796875
local_in_edges_tensor generation:  0.0047528743743896484
mini_batch_src_global generation:  0.0011813640594482422
r_  generation:  0.011739015579223633
local_output_nid generation:  0.0014140605926513672
local_in_edges_tensor generation:  0.0013070106506347656
mini_batch_src_global generation:  0.0014545917510986328
r_  generation:  0.009486198425292969
local_output_nid generation:  0.0017750263214111328
local_in_edges_tensor generation:  0.0014603137969970703
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.014378547668457031
local_output_nid generation:  0.001733541488647461
local_in_edges_tensor generation:  0.0014095306396484375
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.01296091079711914
local_output_nid generation:  0.0021827220916748047
local_in_edges_tensor generation:  0.001714468002319336
mini_batch_src_global generation:  0.0016450881958007812
r_  generation:  0.019308090209960938
local_output_nid generation:  0.0021784305572509766
local_in_edges_tensor generation:  0.001833200454711914
mini_batch_src_global generation:  0.0016713142395019531
r_  generation:  0.019527912139892578
local_output_nid generation:  0.0017862319946289062
local_in_edges_tensor generation:  0.0015015602111816406
mini_batch_src_global generation:  0.0013499259948730469
r_  generation:  0.015979528427124023
local_output_nid generation:  0.001847982406616211
local_in_edges_tensor generation:  0.0014443397521972656
mini_batch_src_global generation:  0.001219034194946289
r_  generation:  0.015903234481811523
local_output_nid generation:  0.002083301544189453
local_in_edges_tensor generation:  0.0016012191772460938
mini_batch_src_global generation:  0.0013325214385986328
r_  generation:  0.017086029052734375
local_output_nid generation:  0.002381563186645508
local_in_edges_tensor generation:  0.0018668174743652344
mini_batch_src_global generation:  0.0015361309051513672
r_  generation:  0.0187985897064209
local_output_nid generation:  0.0018723011016845703
local_in_edges_tensor generation:  0.0015842914581298828
mini_batch_src_global generation:  0.0013484954833984375
r_  generation:  0.015837669372558594
local_output_nid generation:  0.0023818016052246094
local_in_edges_tensor generation:  0.0018568038940429688
mini_batch_src_global generation:  0.0016977787017822266
r_  generation:  0.022503137588500977
local_output_nid generation:  0.0014696121215820312
local_in_edges_tensor generation:  0.001188039779663086
mini_batch_src_global generation:  0.0012621879577636719
r_  generation:  0.011891841888427734
local_output_nid generation:  0.0022115707397460938
local_in_edges_tensor generation:  0.0015420913696289062
mini_batch_src_global generation:  0.0012812614440917969
r_  generation:  0.008647441864013672
local_output_nid generation:  0.00196075439453125
local_in_edges_tensor generation:  0.0017192363739013672
mini_batch_src_global generation:  0.0012602806091308594
r_  generation:  0.015797853469848633
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0011811256408691406
mini_batch_src_global generation:  0.0013110637664794922
r_  generation:  0.010183334350585938
local_output_nid generation:  0.0017247200012207031
local_in_edges_tensor generation:  0.001329660415649414
mini_batch_src_global generation:  0.0010457038879394531
r_  generation:  0.013200998306274414
local_output_nid generation:  0.0017349720001220703
local_in_edges_tensor generation:  0.0015115737915039062
mini_batch_src_global generation:  0.0013897418975830078
r_  generation:  0.013738870620727539
local_output_nid generation:  0.0021355152130126953
local_in_edges_tensor generation:  0.0016672611236572266
mini_batch_src_global generation:  0.0013127326965332031
r_  generation:  0.017139434814453125
local_output_nid generation:  0.001707315444946289
local_in_edges_tensor generation:  0.0014543533325195312
mini_batch_src_global generation:  0.001238107681274414
r_  generation:  0.014014244079589844
local_output_nid generation:  0.0038988590240478516
local_in_edges_tensor generation:  0.005018949508666992
mini_batch_src_global generation:  0.004328250885009766
r_  generation:  0.04313921928405762
local_output_nid generation:  0.003374338150024414
local_in_edges_tensor generation:  0.0035948753356933594
mini_batch_src_global generation:  0.003655672073364258
r_  generation:  0.0322108268737793
local_output_nid generation:  0.0028564929962158203
local_in_edges_tensor generation:  0.0023040771484375
mini_batch_src_global generation:  0.0022220611572265625
r_  generation:  0.023832082748413086
local_output_nid generation:  0.0033516883850097656
local_in_edges_tensor generation:  0.0028302669525146484
mini_batch_src_global generation:  0.002844572067260742
r_  generation:  0.0311429500579834
local_output_nid generation:  0.004291057586669922
local_in_edges_tensor generation:  0.003949642181396484
mini_batch_src_global generation:  0.0039293766021728516
r_  generation:  0.04138946533203125
local_output_nid generation:  0.003902912139892578
local_in_edges_tensor generation:  0.0032854080200195312
mini_batch_src_global generation:  0.0037636756896972656
r_  generation:  0.035498857498168945
local_output_nid generation:  0.0053365230560302734
local_in_edges_tensor generation:  0.004919290542602539
mini_batch_src_global generation:  0.005925416946411133
r_  generation:  0.057842254638671875
local_output_nid generation:  0.004944324493408203
local_in_edges_tensor generation:  0.004653453826904297
mini_batch_src_global generation:  0.005680084228515625
r_  generation:  0.053734779357910156
local_output_nid generation:  0.005088090896606445
local_in_edges_tensor generation:  0.0044133663177490234
mini_batch_src_global generation:  0.005900859832763672
r_  generation:  0.0528416633605957
local_output_nid generation:  0.005047321319580078
local_in_edges_tensor generation:  0.0044689178466796875
mini_batch_src_global generation:  0.00601959228515625
r_  generation:  0.05444526672363281
local_output_nid generation:  0.004940509796142578
local_in_edges_tensor generation:  0.004357576370239258
mini_batch_src_global generation:  0.005644559860229492
r_  generation:  0.05259513854980469
local_output_nid generation:  0.004903078079223633
local_in_edges_tensor generation:  0.004464149475097656
mini_batch_src_global generation:  0.0052967071533203125
r_  generation:  0.049336910247802734
----------------------check_connections_block total spend ----------------------------- 1.2974424362182617
generate_one_block  0.015920162200927734
generate_one_block  0.014796257019042969
generate_one_block  0.019227981567382812
generate_one_block  0.017670631408691406
generate_one_block  0.026317834854125977
generate_one_block  0.026842594146728516
generate_one_block  0.021725893020629883
generate_one_block  0.020963668823242188
generate_one_block  0.02304673194885254
generate_one_block  0.025606155395507812
generate_one_block  0.021598100662231445
generate_one_block  0.037518978118896484
generate_one_block  0.012916088104248047
generate_one_block  0.012865781784057617
generate_one_block  0.01965808868408203
generate_one_block  0.015015840530395508
generate_one_block  0.01668262481689453
generate_one_block  0.018848657608032227
generate_one_block  0.024065732955932617
generate_one_block  0.018825531005859375
generate_one_block  0.06368589401245117
generate_one_block  0.04408526420593262
generate_one_block  0.031011104583740234
generate_one_block  0.042885541915893555
generate_one_block  0.05715775489807129
generate_one_block  0.04944491386413574
generate_one_block  0.07505655288696289
generate_one_block  0.06824231147766113
generate_one_block  0.07131719589233398
generate_one_block  0.07428503036499023
generate_one_block  0.0740044116973877
generate_one_block  0.08461403846740723
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.2974424362182617
block generation total time  1.1459033489227295
average batch blocks generation time:  0.0358094796538353
pseudo mini batch 0 input nodes size: 12447
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.0087127685546875  GigaBytes
Max Memory Allocated: 0.0087127685546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.008734703063964844  GigaBytes
Max Memory Allocated: 0.008734703063964844  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.008734703063964844  GigaBytes
Max Memory Allocated: 0.008734703063964844  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009128570556640625  GigaBytes
Max Memory Allocated: 0.009128570556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009128570556640625  GigaBytes
Max Memory Allocated: 0.009128570556640625  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009128570556640625  GigaBytes
Max Memory Allocated: 0.009128570556640625  GigaBytes

torch.Size([12447, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009128570556640625  GigaBytes
Max Memory Allocated: 0.009128570556640625  GigaBytes

m.shape torch.Size([730, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.02579975128173828  GigaBytes
Max Memory Allocated: 0.02591419219970703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.02579975128173828  GigaBytes
Max Memory Allocated: 0.02591419219970703  GigaBytes

 h.shape torch.Size([1, 730, 128]), torch.Size([1, 730, 128])
----------------------------------------3
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.026495933532714844  GigaBytes
Max Memory Allocated: 0.026495933532714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.03239774703979492  GigaBytes
Max Memory Allocated: 0.0327458381652832  GigaBytes

rst.shape  torch.Size([1, 730, 128])
m.shape torch.Size([664, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.03268289566040039  GigaBytes
Max Memory Allocated: 0.0327458381652832  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.03268289566040039  GigaBytes
Max Memory Allocated: 0.0327458381652832  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.03331613540649414  GigaBytes
Max Memory Allocated: 0.03331613540649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.04281473159790039  GigaBytes
Max Memory Allocated: 0.04344797134399414  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([596, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.0433506965637207  GigaBytes
Max Memory Allocated: 0.04344797134399414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.0433506965637207  GigaBytes
Max Memory Allocated: 0.04344797134399414  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.04391908645629883  GigaBytes
Max Memory Allocated: 0.04391908645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.05736255645751953  GigaBytes
Max Memory Allocated: 0.05821514129638672  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([486, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.058005332946777344  GigaBytes
Max Memory Allocated: 0.05821514129638672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.058005332946777344  GigaBytes
Max Memory Allocated: 0.05821514129638672  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.05846881866455078  GigaBytes
Max Memory Allocated: 0.05846881866455078  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.07190990447998047  GigaBytes
Max Memory Allocated: 0.07283687591552734  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([412, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.07266044616699219  GigaBytes
Max Memory Allocated: 0.07283687591552734  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.07266044616699219  GigaBytes
Max Memory Allocated: 0.07283687591552734  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.07305335998535156  GigaBytes
Max Memory Allocated: 0.07305335998535156  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08719825744628906  GigaBytes
Max Memory Allocated: 0.0881805419921875  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([336, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08796310424804688  GigaBytes
Max Memory Allocated: 0.0881805419921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08796310424804688  GigaBytes
Max Memory Allocated: 0.0881805419921875  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08828353881835938  GigaBytes
Max Memory Allocated: 0.08828353881835938  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.10206222534179688  GigaBytes
Max Memory Allocated: 0.10302352905273438  GigaBytes

rst.shape  torch.Size([1, 336, 128])
m.shape torch.Size([273, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.1028132438659668  GigaBytes
Max Memory Allocated: 0.10302352905273438  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.1028132438659668  GigaBytes
Max Memory Allocated: 0.10302352905273438  GigaBytes

 h.shape torch.Size([1, 273, 128]), torch.Size([1, 273, 128])
----------------------------------------3
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.1030735969543457  GigaBytes
Max Memory Allocated: 0.1030735969543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11609125137329102  GigaBytes
Max Memory Allocated: 0.11700248718261719  GigaBytes

rst.shape  torch.Size([1, 273, 128])
m.shape torch.Size([264, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11696815490722656  GigaBytes
Max Memory Allocated: 0.11700248718261719  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11696815490722656  GigaBytes
Max Memory Allocated: 0.11700248718261719  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11721992492675781  GigaBytes
Max Memory Allocated: 0.11721992492675781  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13157081604003906  GigaBytes
Max Memory Allocated: 0.13257789611816406  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([242, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13248348236083984  GigaBytes
Max Memory Allocated: 0.13257789611816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13248348236083984  GigaBytes
Max Memory Allocated: 0.13257789611816406  GigaBytes

 h.shape torch.Size([1, 242, 128]), torch.Size([1, 242, 128])
----------------------------------------3
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13271427154541016  GigaBytes
Max Memory Allocated: 0.13271427154541016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.14748477935791016  GigaBytes
Max Memory Allocated: 0.14852333068847656  GigaBytes

rst.shape  torch.Size([1, 242, 128])
m.shape torch.Size([1718, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.1559152603149414  GigaBytes
Max Memory Allocated: 0.15610790252685547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.1559152603149414  GigaBytes
Max Memory Allocated: 0.15610790252685547  GigaBytes

 h.shape torch.Size([1, 1718, 128]), torch.Size([1, 1718, 128])
----------------------------------------3
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.15755367279052734  GigaBytes
Max Memory Allocated: 0.15755367279052734  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2738809585571289  GigaBytes
Max Memory Allocated: 0.2820730209350586  GigaBytes

rst.shape  torch.Size([1, 1718, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.26066017150878906  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2661161422729492  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2715721130371094  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.26607322692871094  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

torch.Size([5721, 256])
first layer input nodes number: 12447
first layer output nodes number: 5721
edges number: 33247
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2716670036315918  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.27712297439575195  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2784872055053711  GigaBytes
Max Memory Allocated: 0.28394317626953125  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2784872055053711  GigaBytes
Max Memory Allocated: 0.28394317626953125  GigaBytes

m.shape torch.Size([542, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2988147735595703  GigaBytes
Max Memory Allocated: 0.29881715774536133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2988147735595703  GigaBytes
Max Memory Allocated: 0.29881715774536133  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2998485565185547  GigaBytes
Max Memory Allocated: 0.2998485565185547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.3081188201904297  GigaBytes
Max Memory Allocated: 0.3086357116699219  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([405, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.3083806037902832  GigaBytes
Max Memory Allocated: 0.3086357116699219  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.3083806037902832  GigaBytes
Max Memory Allocated: 0.3086357116699219  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.30915307998657227  GigaBytes
Max Memory Allocated: 0.30915307998657227  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.3218727111816406  GigaBytes
Max Memory Allocated: 0.3226451873779297  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([314, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.32239198684692383  GigaBytes
Max Memory Allocated: 0.3226451873779297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.32239198684692383  GigaBytes
Max Memory Allocated: 0.3226451873779297  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.32299089431762695  GigaBytes
Max Memory Allocated: 0.32299089431762695  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.33698177337646484  GigaBytes
Max Memory Allocated: 0.33788013458251953  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.3375973701477051  GigaBytes
Max Memory Allocated: 0.33788013458251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.3375973701477051  GigaBytes
Max Memory Allocated: 0.33788013458251953  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.33805131912231445  GigaBytes
Max Memory Allocated: 0.33805131912231445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.35121583938598633  GigaBytes
Max Memory Allocated: 0.3521237373352051  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.35207653045654297  GigaBytes
Max Memory Allocated: 0.3521237373352051  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.35207653045654297  GigaBytes
Max Memory Allocated: 0.3521237373352051  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.35246753692626953  GigaBytes
Max Memory Allocated: 0.35246753692626953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3665437698364258  GigaBytes
Max Memory Allocated: 0.36762332916259766  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3672652244567871  GigaBytes
Max Memory Allocated: 0.36762332916259766  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3672652244567871  GigaBytes
Max Memory Allocated: 0.36762332916259766  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3675684928894043  GigaBytes
Max Memory Allocated: 0.36762332916259766  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.38060903549194336  GigaBytes
Max Memory Allocated: 0.3815188407897949  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.38125133514404297  GigaBytes
Max Memory Allocated: 0.3815188407897949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.38125133514404297  GigaBytes
Max Memory Allocated: 0.3815188407897949  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.38147640228271484  GigaBytes
Max Memory Allocated: 0.3815188407897949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3927297592163086  GigaBytes
Max Memory Allocated: 0.39351749420166016  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3935399055480957  GigaBytes
Max Memory Allocated: 0.39354372024536133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3935399055480957  GigaBytes
Max Memory Allocated: 0.39354372024536133  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3937687873840332  GigaBytes
Max Memory Allocated: 0.3937687873840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.4068150520324707  GigaBytes
Max Memory Allocated: 0.4077305793762207  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.40758323669433594  GigaBytes
Max Memory Allocated: 0.4077305793762207  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.40758323669433594  GigaBytes
Max Memory Allocated: 0.4077305793762207  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.4077777862548828  GigaBytes
Max Memory Allocated: 0.4077777862548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.4202289581298828  GigaBytes
Max Memory Allocated: 0.42110443115234375  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.420804500579834  GigaBytes
Max Memory Allocated: 0.42110443115234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.420804500579834  GigaBytes
Max Memory Allocated: 0.42110443115234375  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.42093801498413086  GigaBytes
Max Memory Allocated: 0.42110443115234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.430417537689209  GigaBytes
Max Memory Allocated: 0.43108510971069336  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.4311652183532715  GigaBytes
Max Memory Allocated: 0.4311685562133789  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.4311652183532715  GigaBytes
Max Memory Allocated: 0.4311685562133789  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.43131208419799805  GigaBytes
Max Memory Allocated: 0.43131208419799805  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.4427676200866699  GigaBytes
Max Memory Allocated: 0.443575382232666  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.44345569610595703  GigaBytes
Max Memory Allocated: 0.443575382232666  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.44345569610595703  GigaBytes
Max Memory Allocated: 0.443575382232666  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.44358158111572266  GigaBytes
Max Memory Allocated: 0.44358158111572266  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.4542818069458008  GigaBytes
Max Memory Allocated: 0.45503711700439453  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.4548811912536621  GigaBytes
Max Memory Allocated: 0.45503711700439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.4548811912536621  GigaBytes
Max Memory Allocated: 0.45503711700439453  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.45498228073120117  GigaBytes
Max Memory Allocated: 0.45503711700439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.4642825126647949  GigaBytes
Max Memory Allocated: 0.46493959426879883  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.464810848236084  GigaBytes
Max Memory Allocated: 0.46493959426879883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.464810848236084  GigaBytes
Max Memory Allocated: 0.46493959426879883  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.4648928642272949  GigaBytes
Max Memory Allocated: 0.46493959426879883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.47301244735717773  GigaBytes
Max Memory Allocated: 0.4735865592956543  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.47356271743774414  GigaBytes
Max Memory Allocated: 0.4735865592956543  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.47356271743774414  GigaBytes
Max Memory Allocated: 0.4735865592956543  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.47364091873168945  GigaBytes
Max Memory Allocated: 0.47364091873168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.4819302558898926  GigaBytes
Max Memory Allocated: 0.4825167655944824  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.48221445083618164  GigaBytes
Max Memory Allocated: 0.4825167655944824  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.48221445083618164  GigaBytes
Max Memory Allocated: 0.4825167655944824  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.4822545051574707  GigaBytes
Max Memory Allocated: 0.4825167655944824  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.48678064346313477  GigaBytes
Max Memory Allocated: 0.48710107803344727  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.48725080490112305  GigaBytes
Max Memory Allocated: 0.48725271224975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.48725080490112305  GigaBytes
Max Memory Allocated: 0.48725271224975586  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.4873080253601074  GigaBytes
Max Memory Allocated: 0.4873080253601074  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.4941744804382324  GigaBytes
Max Memory Allocated: 0.4946608543395996  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.49456119537353516  GigaBytes
Max Memory Allocated: 0.4946608543395996  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.49456119537353516  GigaBytes
Max Memory Allocated: 0.4946608543395996  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.49460697174072266  GigaBytes
Max Memory Allocated: 0.4946608543395996  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.5004205703735352  GigaBytes
Max Memory Allocated: 0.5008325576782227  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.5008177757263184  GigaBytes
Max Memory Allocated: 0.5008325576782227  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.5008177757263184  GigaBytes
Max Memory Allocated: 0.5008325576782227  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.500861644744873  GigaBytes
Max Memory Allocated: 0.500861644744873  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5067400932312012  GigaBytes
Max Memory Allocated: 0.5071568489074707  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5070834159851074  GigaBytes
Max Memory Allocated: 0.5071568489074707  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5070834159851074  GigaBytes
Max Memory Allocated: 0.5071568489074707  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5071196556091309  GigaBytes
Max Memory Allocated: 0.5071568489074707  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5122294425964355  GigaBytes
Max Memory Allocated: 0.5125918388366699  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5125546455383301  GigaBytes
Max Memory Allocated: 0.5125918388366699  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5125546455383301  GigaBytes
Max Memory Allocated: 0.5125918388366699  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5125870704650879  GigaBytes
Max Memory Allocated: 0.5125918388366699  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.5173859596252441  GigaBytes
Max Memory Allocated: 0.5177264213562012  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.5177717208862305  GigaBytes
Max Memory Allocated: 0.5177736282348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.5177717208862305  GigaBytes
Max Memory Allocated: 0.5177736282348633  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.5178079605102539  GigaBytes
Max Memory Allocated: 0.5178079605102539  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.5234251022338867  GigaBytes
Max Memory Allocated: 0.5238237380981445  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.523716926574707  GigaBytes
Max Memory Allocated: 0.5238237380981445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.523716926574707  GigaBytes
Max Memory Allocated: 0.5238237380981445  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.5237436294555664  GigaBytes
Max Memory Allocated: 0.5238237380981445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5280694961547852  GigaBytes
Max Memory Allocated: 0.528376579284668  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5283560752868652  GigaBytes
Max Memory Allocated: 0.528376579284668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5283560752868652  GigaBytes
Max Memory Allocated: 0.528376579284668  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5283808708190918  GigaBytes
Max Memory Allocated: 0.5283808708190918  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5325713157653809  GigaBytes
Max Memory Allocated: 0.5328688621520996  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([152, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5362114906311035  GigaBytes
Max Memory Allocated: 0.5362257957458496  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5362114906311035  GigaBytes
Max Memory Allocated: 0.5362257957458496  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.536501407623291  GigaBytes
Max Memory Allocated: 0.536501407623291  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.587526798248291  GigaBytes
Max Memory Allocated: 0.5911507606506348  GigaBytes

rst.shape  torch.Size([1, 152, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5705275535583496  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5709576606750488  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.571387767791748  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.5709357261657715  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([2885, 40])
input nodes number: 5721
output nodes number: 2885
edges number: 19478
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.5714306831359863  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.5714316368103027  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.013129234313964844  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

pseudo mini batch 1 input nodes size: 10001
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011940956115722656  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011940956115722656  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.01670980453491211  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.016730785369873047  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.010773658752441406  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011153221130371094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011153221130371094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011153221130371094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([10001, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011153221130371094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

m.shape torch.Size([572, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.026267051696777344  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.026267051696777344  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.02681255340576172  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.03117656707763672  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([613, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.03148841857910156  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.03148841857910156  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.032073020935058594  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.04100942611694336  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([552, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.04150676727294922  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.04150676727294922  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.04203319549560547  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.053786277770996094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([448, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.05437755584716797  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.05437755584716797  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.05480480194091797  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.06719493865966797  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([355, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.06782770156860352  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.06782770156860352  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.06816625595092773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.08035421371459961  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([303, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.08105182647705078  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.08105182647705078  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 303, 128]), torch.Size([1, 303, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.08134078979492188  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.0937662124633789  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 303, 128])
m.shape torch.Size([265, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.09450626373291016  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.09450626373291016  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.09475898742675781  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.10739517211914062  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 265, 128])
m.shape torch.Size([216, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1080927848815918  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1080927848815918  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 216, 128]), torch.Size([1, 216, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.10829877853393555  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1200404167175293  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 216, 128])
m.shape torch.Size([209, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1208343505859375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1208343505859375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 209, 128]), torch.Size([1, 209, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1210336685180664  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1337900161743164  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 209, 128])
m.shape torch.Size([1593, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.14128637313842773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.14128637313842773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 1593, 128]), torch.Size([1, 1593, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1428055763244629  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.250669002532959  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 1593, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.23809099197387695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2429795265197754  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.24786806106567383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.24294090270996094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([5126, 256])
first layer input nodes number: 10001
first layer output nodes number: 5126
edges number: 30233
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.24794483184814453  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.25283336639404297  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2541341781616211  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2541341781616211  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

m.shape torch.Size([406, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.2743644714355469  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.2743644714355469  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.27513885498046875  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.28354358673095703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([387, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.28390073776245117  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.28390073776245117  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.2846388816833496  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.29638099670410156  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([317, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.29692602157592773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.29692602157592773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.2975306510925293  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.31110715866088867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([281, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.31188535690307617  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.31188535690307617  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3124213218688965  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.32831907272338867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.32894039154052734  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.32894039154052734  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.32929325103759766  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3419961929321289  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.34270238876342773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.34270238876342773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.34299421310424805  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3555426597595215  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.35628509521484375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.35628509521484375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.356536865234375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3691253662109375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3697991371154785  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3697991371154785  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.369997501373291  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3813042640686035  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.38213109970092773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.38213109970092773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.38233518600463867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.39539670944213867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3959965705871582  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3959965705871582  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3961358070373535  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4060215950012207  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.40654420852661133  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.40654420852661133  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.40665102005004883  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.41498231887817383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4156327247619629  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4156327247619629  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.41574907302856445  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.42563867568969727  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4261178970336914  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4261178970336914  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.42619991302490234  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4337453842163086  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4342966079711914  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4342966079711914  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.43438053131103516  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4426889419555664  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.44313716888427734  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.44313716888427734  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.44320201873779297  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4500761032104492  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45053577423095703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45053577423095703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45059680938720703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45749378204345703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45800256729125977  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45800256729125977  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4580655097961426  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4656186103820801  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.46617555618286133  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.46617555618286133  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.46624040603637695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.47447633743286133  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.47484588623046875  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.47484588623046875  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4748878479003906  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4805107116699219  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.48077821731567383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.48077821731567383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.480806827545166  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.48484086990356445  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.48539209365844727  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.48539209365844727  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.485445499420166  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.493349552154541  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4936823844909668  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4936823844909668  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4937148094177246  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.49874067306518555  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.49921083450317383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.49921083450317383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4992527961730957  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5060505867004395  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5063529014587402  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5063529014587402  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5063796043395996  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.510892391204834  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([189, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5154204368591309  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5154204368591309  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5157809257507324  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5792269706726074  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 189, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5626468658447266  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5630626678466797  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5634784698486328  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5630416870117188  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([2789, 40])
input nodes number: 5126
output nodes number: 2789
edges number: 20512
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.563086986541748  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5630874633789062  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.011894702911376953  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

pseudo mini batch 2 input nodes size: 13198
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.010759353637695312  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.010759353637695312  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.017052650451660156  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.0170745849609375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.01228475570678711  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.012783527374267578  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.012783527374267578  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.012783527374267578  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([13198, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.012783527374267578  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

m.shape torch.Size([346, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.03386735916137695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.03386735916137695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.034197330474853516  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.036837100982666016  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([446, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.03709745407104492  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.03709745407104492  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.03752279281616211  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.04390287399291992  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([450, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.04433393478393555  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.04433393478393555  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.04476308822631836  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.054204463958740234  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([472, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.05489015579223633  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.05489015579223633  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.05534029006958008  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.06839418411254883  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([434, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.06928777694702148  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.06928777694702148  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.0697016716003418  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.08460187911987305  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([432, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.08563089370727539  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.08563089370727539  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.08604288101196289  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.10375833511352539  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([358, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.10485029220581055  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.10485029220581055  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.10519170761108398  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12226247787475586  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([328, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12334299087524414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12334299087524414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12365579605102539  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.14148569107055664  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([248, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.1423935890197754  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.1423935890197754  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 248, 128]), torch.Size([1, 248, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.14263010025024414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.15776681900024414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 248, 128])
m.shape torch.Size([2611, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.17009878158569336  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.17009878158569336  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 2611, 128]), torch.Size([1, 2611, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.17258882522583008  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.35558366775512695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 2611, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.33591747283935547  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.34175872802734375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.34759998321533203  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.34171295166015625  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([6125, 256])
first layer input nodes number: 13198
first layer output nodes number: 6125
edges number: 42710
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.3477005958557129  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.35354185104370117  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.3552122116088867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.3552122116088867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

m.shape torch.Size([270, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.37921762466430664  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.37921762466430664  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.379732608795166  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3844928741455078  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([294, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.38480091094970703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.38480091094970703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3853616714477539  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3943028450012207  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([277, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3948211669921875  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3948211669921875  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.39534950256347656  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.40765953063964844  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4083566665649414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4083566665649414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.40883350372314453  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.42266178131103516  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([234, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.42354822158813477  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.42354822158813477  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4239945411682129  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4400620460510254  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([231, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.44117116928100586  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.44117116928100586  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.44161176681518555  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4605574607849121  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([176, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.46152162551879883  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.46152162551879883  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.46185731887817383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.47864198684692383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.479550838470459  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.479550838470459  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.47981786727905273  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4950385093688965  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([113, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.495882511138916  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.495882511138916  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.49609804153442383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5098919868469238  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([121, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5109472274780273  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5109472274780273  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5111780166625977  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5275640487670898  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5286436080932617  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5286436080932617  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5288591384887695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5456705093383789  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.546381950378418  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.546381950378418  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5465173721313477  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5580282211303711  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5587854385375977  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5587854385375977  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5589113235473633  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5704927444458008  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5713315010070801  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5713315010070801  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5714592933654785  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5841107368469238  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5846095085144043  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5846095085144043  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.584683895111084  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5925688743591309  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5931930541992188  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5931930541992188  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5932750701904297  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6025428771972656  GigaBytes
Max Memory Allocated: 0.6031990051269531  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6033844947814941  GigaBytes
Max Memory Allocated: 0.6033883094787598  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6033844947814941  GigaBytes
Max Memory Allocated: 0.6033883094787598  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.603487491607666  GigaBytes
Max Memory Allocated: 0.603487491607666  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.615847110748291  GigaBytes
Max Memory Allocated: 0.616722583770752  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6163668632507324  GigaBytes
Max Memory Allocated: 0.616722583770752  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6163668632507324  GigaBytes
Max Memory Allocated: 0.616722583770752  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6164298057556152  GigaBytes
Max Memory Allocated: 0.616722583770752  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6244235038757324  GigaBytes
Max Memory Allocated: 0.6249899864196777  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6248307228088379  GigaBytes
Max Memory Allocated: 0.6249899864196777  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6248307228088379  GigaBytes
Max Memory Allocated: 0.6249899864196777  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6248764991760254  GigaBytes
Max Memory Allocated: 0.6249899864196777  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6310105323791504  GigaBytes
Max Memory Allocated: 0.6314454078674316  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6316800117492676  GigaBytes
Max Memory Allocated: 0.6316828727722168  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6316800117492676  GigaBytes
Max Memory Allocated: 0.6316828727722168  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6317486763000488  GigaBytes
Max Memory Allocated: 0.6317486763000488  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6414303779602051  GigaBytes
Max Memory Allocated: 0.6421170234680176  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6419410705566406  GigaBytes
Max Memory Allocated: 0.6421170234680176  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6419410705566406  GigaBytes
Max Memory Allocated: 0.6421170234680176  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6419925689697266  GigaBytes
Max Memory Allocated: 0.6421170234680176  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6496143341064453  GigaBytes
Max Memory Allocated: 0.6501550674438477  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6500115394592285  GigaBytes
Max Memory Allocated: 0.6501550674438477  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6500115394592285  GigaBytes
Max Memory Allocated: 0.6501550674438477  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6500496864318848  GigaBytes
Max Memory Allocated: 0.6501550674438477  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6559624671936035  GigaBytes
Max Memory Allocated: 0.6563820838928223  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6562972068786621  GigaBytes
Max Memory Allocated: 0.6563820838928223  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6562972068786621  GigaBytes
Max Memory Allocated: 0.6563820838928223  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6563277244567871  GigaBytes
Max Memory Allocated: 0.6563820838928223  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6612715721130371  GigaBytes
Max Memory Allocated: 0.6616225242614746  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6616950035095215  GigaBytes
Max Memory Allocated: 0.6616969108581543  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6616950035095215  GigaBytes
Max Memory Allocated: 0.6616969108581543  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6617312431335449  GigaBytes
Max Memory Allocated: 0.6617312431335449  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.6678557395935059  GigaBytes
Max Memory Allocated: 0.6682906150817871  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([187, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.6723313331604004  GigaBytes
Max Memory Allocated: 0.6723489761352539  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.6723313331604004  GigaBytes
Max Memory Allocated: 0.6723489761352539  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.6726880073547363  GigaBytes
Max Memory Allocated: 0.6726880073547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7354626655578613  GigaBytes
Max Memory Allocated: 0.7399210929870605  GigaBytes

rst.shape  torch.Size([1, 187, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7145595550537109  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7149949073791504  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7154302597045898  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.714972972869873  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([2921, 40])
input nodes number: 6125
output nodes number: 2921
edges number: 24182
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7150602340698242  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7150607109069824  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.013751029968261719  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

pseudo mini batch 3 input nodes size: 13614
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.012304306030273438  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.012304306030273438  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.01879596710205078  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.018817424774169922  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.012502193450927734  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.01292562484741211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.01292562484741211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.01292562484741211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([13614, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.01292562484741211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

m.shape torch.Size([601, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.03129720687866211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.03129720687866211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.031870365142822266  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.036455631256103516  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([665, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.036803245544433594  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.036803245544433594  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.03743743896484375  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.046950340270996094  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([626, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.047528743743896484  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.047528743743896484  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.0481257438659668  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.06205606460571289  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([548, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.06280279159545898  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.06280279159545898  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.06332540512084961  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.07905340194702148  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([434, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.07982683181762695  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.07982683181762695  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.08024072647094727  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.09514093399047852  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([359, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.09596109390258789  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.09596109390258789  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.09630346298217773  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.11102533340454102  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([343, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1119990348815918  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1119990348815918  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 343, 128]), torch.Size([1, 343, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.11232614517211914  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.12868165969848633  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 343, 128])
m.shape torch.Size([274, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1295633316040039  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1295633316040039  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.12982463836669922  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.14471912384033203  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([218, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1455240249633789  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1455240249633789  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.14573192596435547  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.15903759002685547  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 218, 128])
m.shape torch.Size([1982, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.16838455200195312  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.16838455200195312  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 1982, 128]), torch.Size([1, 1982, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1702747344970703  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3082542419433594  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 1982, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.2924962043762207  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.2982659339904785  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.30403566360473633  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.2982206344604492  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([6050, 256])
first layer input nodes number: 13614
first layer output nodes number: 6050
edges number: 36700
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3041391372680664  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3101778030395508  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.311556339263916  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.311556339263916  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

m.shape torch.Size([433, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.33178281784057617  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.33178281784057617  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.332608699798584  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3392157554626465  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([412, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.33959484100341797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.33959484100341797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3403806686401367  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3523998260498047  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([350, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.35324811935424805  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.35324811935424805  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3539156913757324  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.36860227584838867  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([262, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3696002960205078  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3696002960205078  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3701000213623047  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3849658966064453  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.38567256927490234  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.38567256927490234  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.38605213165283203  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3997163772583008  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.40044355392456055  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.40044355392456055  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.40074682235717773  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4137873649597168  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.41451072692871094  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.41451072692871094  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.41475868225097656  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4271564483642578  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4278244972229004  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4278244972229004  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4280209541320801  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.43921899795532227  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.43983888626098633  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.43983888626098633  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.43999719619750977  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.45012903213500977  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4508380889892578  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4508380889892578  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.45099449157714844  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4620990753173828  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4628138542175293  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4628138542175293  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.46295690536499023  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.47411489486694336  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4747586250305176  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4747586250305176  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.47487688064575195  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.48492860794067383  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.48554420471191406  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.48554420471191406  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.48564720153808594  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.49512290954589844  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.495758056640625  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.495758056640625  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.49585533142089844  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5054855346679688  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.50604248046875  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.50604248046875  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5061225891113281  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5146141052246094  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5152816772460938  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5152816772460938  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5153694152832031  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5252838134765625  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5256977081298828  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5256977081298828  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5257511138916016  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5321598052978516  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5328254699707031  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5328254699707031  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5329017639160156  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5425910949707031  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5429916381835938  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5429916381835938  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5430374145507812  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5491714477539062  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5497255325317383  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5497255325317383  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5497827529907227  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5578508377075195  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5582060813903809  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5582060813903809  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5582423210144043  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.563605785369873  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5638837814331055  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5638837814331055  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5639104843139648  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.568049430847168  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5683460235595703  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5683460235595703  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5683727264404297  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5726985931396484  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5730776786804199  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5730776786804199  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5731101036071777  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.578589916229248  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([135, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.581817626953125  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.581817626953125  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5820751190185547  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6273937225341797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 135, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6105127334594727  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6109395027160645  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6113662719726562  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6109180450439453  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([2864, 40])
input nodes number: 6050
output nodes number: 2864
edges number: 20020
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6109762191772461  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6109766960144043  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.013760566711425781  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

pseudo mini batch 4 input nodes size: 15996
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.012493610382080078  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.012493610382080078  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.020121097564697266  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.02014303207397461  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.013629913330078125  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.014285087585449219  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.014285087585449219  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.014285087585449219  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([15996, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.014285087585449219  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

m.shape torch.Size([441, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.04355335235595703  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.04355335235595703  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.04397392272949219  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.04733848571777344  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([529, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.047632694244384766  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.047632694244384766  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.04813718795776367  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.05607175827026367  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([542, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.0565948486328125  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.0565948486328125  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.05711174011230469  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.06879711151123047  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([501, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.06949424743652344  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.06949424743652344  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.06997203826904297  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.08382797241210938  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([501, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.08478355407714844  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.08478355407714844  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.08526134490966797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.1024618148803711  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([452, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.1035161018371582  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.1035161018371582  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.10394716262817383  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.1224827766418457  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([440, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.12373590469360352  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.12373590469360352  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.12415552139282227  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.14513635635375977  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 440, 128])
m.shape torch.Size([414, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.14650583267211914  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.14650583267211914  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.14690065383911133  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.16940546035766602  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([346, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.17069292068481445  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.17069292068481445  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.17102289199829102  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.19214105606079102  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([3951, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.21150732040405273  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.21150732040405273  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 3951, 128]), torch.Size([1, 3951, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.21527528762817383  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.49048566818237305  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 3951, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.4633169174194336  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.4716825485229492  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.47942352294921875  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.47099733352661133  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([8117, 256])
first layer input nodes number: 15996
first layer output nodes number: 8117
edges number: 59362
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.47891998291015625  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.4868755340576172  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.48982763290405273  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.48982763290405273  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

m.shape torch.Size([282, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5176115036010742  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5176115036010742  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5181493759155273  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5228428840637207  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([294, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.523139476776123  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.523139476776123  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5237002372741699  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5324440002441406  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([256, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5329017639160156  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5329017639160156  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5333900451660156  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5441322326660156  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([179, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5445766448974609  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5445766448974609  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5449180603027344  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5548191070556641  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([176, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5554943084716797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5554943084716797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5558300018310547  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5679149627685547  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5685892105102539  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5685892105102539  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5688676834106445  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5808420181274414  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([152, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5817608833312988  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5817608833312988  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5820508003234863  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5965466499328613  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5975050926208496  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5975050926208496  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5977663993835449  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6126608848571777  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6134819984436035  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6134819984436035  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6136918067932129  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6271195411682129  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([104, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6280145645141602  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6280145645141602  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6282129287719727  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6422967910766602  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6433396339416504  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6433396339416504  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6435456275939941  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6596131324768066  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([85, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6604905128479004  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6604905128479004  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6606526374816895  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6744332313537598  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6753020286560059  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6753020286560059  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6754469871520996  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6887831687927246  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6898007392883301  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6898007392883301  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6899552345275879  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7052502632141113  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.706153392791748  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.706153392791748  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7062830924987793  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7200312614440918  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7209815979003906  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7209815979003906  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7211074829101562  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7353324890136719  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.736152172088623  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.736152172088623  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7362551689147949  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7486147880554199  GigaBytes
Max Memory Allocated: 0.7494902610778809  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7492380142211914  GigaBytes
Max Memory Allocated: 0.7494902610778809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7492380142211914  GigaBytes
Max Memory Allocated: 0.7494902610778809  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7493124008178711  GigaBytes
Max Memory Allocated: 0.7494902610778809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7587594985961914  GigaBytes
Max Memory Allocated: 0.7594289779663086  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.759270191192627  GigaBytes
Max Memory Allocated: 0.7594289779663086  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.759270191192627  GigaBytes
Max Memory Allocated: 0.7594289779663086  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7593274116516113  GigaBytes
Max Memory Allocated: 0.7594289779663086  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7669949531555176  GigaBytes
Max Memory Allocated: 0.7675385475158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7677931785583496  GigaBytes
Max Memory Allocated: 0.767796516418457  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7677931785583496  GigaBytes
Max Memory Allocated: 0.767796516418457  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7678751945495605  GigaBytes
Max Memory Allocated: 0.7678751945495605  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7794394493103027  GigaBytes
Max Memory Allocated: 0.7802596092224121  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7801456451416016  GigaBytes
Max Memory Allocated: 0.7802596092224121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7801456451416016  GigaBytes
Max Memory Allocated: 0.7802596092224121  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7802162170410156  GigaBytes
Max Memory Allocated: 0.7802596092224121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7906608581542969  GigaBytes
Max Memory Allocated: 0.7914018630981445  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.791111946105957  GigaBytes
Max Memory Allocated: 0.7914018630981445  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.791111946105957  GigaBytes
Max Memory Allocated: 0.7914018630981445  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7911558151245117  GigaBytes
Max Memory Allocated: 0.7914018630981445  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7979555130004883  GigaBytes
Max Memory Allocated: 0.7984380722045898  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7984423637390137  GigaBytes
Max Memory Allocated: 0.7984447479248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7984423637390137  GigaBytes
Max Memory Allocated: 0.7984447479248047  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7984862327575684  GigaBytes
Max Memory Allocated: 0.7984862327575684  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8055930137634277  GigaBytes
Max Memory Allocated: 0.8060975074768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8061943054199219  GigaBytes
Max Memory Allocated: 0.8061971664428711  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8061943054199219  GigaBytes
Max Memory Allocated: 0.8061971664428711  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8062458038330078  GigaBytes
Max Memory Allocated: 0.8062458038330078  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8149490356445312  GigaBytes
Max Memory Allocated: 0.8155670166015625  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([331, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8229408264160156  GigaBytes
Max Memory Allocated: 0.8229718208312988  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8229408264160156  GigaBytes
Max Memory Allocated: 0.8229718208312988  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8235721588134766  GigaBytes
Max Memory Allocated: 0.8235721588134766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.9371700286865234  GigaBytes
Max Memory Allocated: 0.9450616836547852  GigaBytes

rst.shape  torch.Size([1, 331, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.9124007225036621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.912837028503418  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.9132733345031738  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.9128150939941406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2927, 40])
input nodes number: 8117
output nodes number: 2927
edges number: 28491
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.9129071235656738  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.912907600402832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01549673080444336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 5 input nodes size: 20476
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.013639450073242188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.013639450073242188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.023403167724609375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.023424148559570312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01577472686767578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016364097595214844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016364097595214844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016364097595214844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([20476, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016364097595214844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([682, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04477834701538086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04477834701538086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 682, 128]), torch.Size([1, 682, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04542875289916992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05063199996948242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 682, 128])
m.shape torch.Size([723, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05099630355834961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05099630355834961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05168581008911133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06202840805053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([635, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0625920295715332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0625920295715332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06319761276245117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07652044296264648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([613, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07738685607910156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07738685607910156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0779714584350586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09570121765136719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([544, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09670591354370117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09670591354370117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09722471237182617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11620283126831055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([489, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11734247207641602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11734247207641602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11780881881713867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1378617286682129  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([427, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1390538215637207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1390538215637207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13946104049682617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1598219871520996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([379, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16106414794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16106414794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16142559051513672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18202781677246094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([352, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18335771560668945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18335771560668945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18369340896606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.20517778396606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([3578, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.22207117080688477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.22207117080688477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 3578, 128]), torch.Size([1, 3578, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.22624731063842773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4738640785217285  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 3578, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4479045867919922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4559364318847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46396827697753906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4558734893798828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([8422, 256])
first layer input nodes number: 20476
first layer output nodes number: 8422
edges number: 57108
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4641227722167969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4721546173095703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47416257858276367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47416257858276367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([433, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4957256317138672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4957256317138672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.496551513671875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5041041374206543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([364, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5043911933898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5043911933898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5050854682922363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5154995918273926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([296, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5160059928894043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5160059928894043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5165705680847168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5297989845275879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5303740501403809  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5303740501403809  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.530799388885498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5431342124938965  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5438394546508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5438394546508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5442037582397461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5573186874389648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([145, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5579729080200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5579729080200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5582494735717773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5701417922973633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5708718299865723  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5708718299865723  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5711178779602051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5834202766418457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5840511322021484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5840511322021484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5842380523681641  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5948925018310547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5955862998962402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5955862998962402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5957598686218262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6068682670593262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6075024604797363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6075024604797363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6076455116271973  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6178021430969238  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6183547973632812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6183547973632812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6184673309326172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6272449493408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6277308464050293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6277308464050293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6278204917907715  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6354403495788574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.635920524597168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.635920524597168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6360006332397461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6433706283569336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6438016891479492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6438016891479492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6438684463500977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.650477409362793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6508913040161133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6508913040161133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6509504318237305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6572179794311523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6577115058898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6577115058898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6577763557434082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6651043891906738  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6657257080078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6657257080078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.665802001953125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.674957275390625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6754035949707031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6754035949707031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6754570007324219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6822395324707031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6828155517578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6828155517578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6828784942626953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6913127899169922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6918196678161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6918196678161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6918730735778809  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6994032859802246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6997804641723633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6997804641723633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6998186111450195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7054643630981445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7056994438171387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7056994438171387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7057223320007324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7092700004577637  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7097892761230469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7097892761230469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7098350524902344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7172508239746094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7175512313842773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7175512313842773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7175779342651367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7220907211303711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([266, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7284688949584961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7284688949584961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7289762496948242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8231115341186523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 266, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8045568466186523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8049678802490234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8053789138793945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8049468994140625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2758, 40])
input nodes number: 8422
output nodes number: 2758
edges number: 21873
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8050055503845215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8050060272216797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017464160919189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 6 input nodes size: 15241
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.015749454498291016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.015749454498291016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.023563861846923828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.02358531951904297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.013800621032714844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014326095581054688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014326095581054688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014326095581054688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([15241, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014326095581054688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([558, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03716897964477539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03716897964477539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03770112991333008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04236125946044922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([577, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04264545440673828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04264545440673828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04319572448730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05144977569580078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([568, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0519871711730957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0519871711730957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05252885818481445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06444597244262695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([481, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06509256362915039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06509256362915039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0655512809753418  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07885408401489258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([482, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0797739028930664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0797739028930664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08023357391357422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09678173065185547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([390, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09766769409179688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09766769409179688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09803962707519531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11403274536132812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([362, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11505508422851562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11505508422851562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11540031433105469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1326618194580078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 362, 128])
m.shape torch.Size([337, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1337747573852539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1337747573852539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1340961456298828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.15241527557373047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([255, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1533489227294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1533489227294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.15359210968017578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16915607452392578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([2846, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18260526657104492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18260526657104492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2846, 128]), torch.Size([1, 2846, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1853194236755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3833460807800293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2846, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.36315345764160156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3696918487548828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.37623023986816406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3696403503417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6856, 256])
first layer input nodes number: 15241
first layer output nodes number: 6856
edges number: 46075
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3763461112976074  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.38288450241088867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.384519100189209  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.384519100189209  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([379, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4086289405822754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4086289405822754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40935182571411133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4156174659729004  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([302, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.41583681106567383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.41583681106567383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4164128303527832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.42531490325927734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4258403778076172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4258403778076172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4263782501220703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43821144104003906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4388270378112793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4388270378112793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43926572799682617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45198774337768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4528083801269531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4528083801269531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45320892333984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46762847900390625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.468350887298584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.468350887298584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.468656063079834  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.481778621673584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.482480525970459  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.482480525970459  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48272275924682617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49483442306518555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49561309814453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49561309814453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4958362579345703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5085563659667969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5092406272888184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5092406272888184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5094161033630371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5206465721130371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([109, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5216069221496582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5216069221496582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5218148231506348  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5365757942199707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5373177528381348  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5373177528381348  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5374703407287598  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5493721961975098  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5500802993774414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5500802993774414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5502099990844727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5612344741821289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5619821548461914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5619821548461914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5621061325073242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.573512077331543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5740828514099121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5740828514099121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5741724967956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5830473899841309  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([61, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5838823318481445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5838823318481445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5839986801147461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5963315963745117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5969810485839844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5969810485839844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5970687866210938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6069831848144531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6076092720031738  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6076092720031738  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6076874732971191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6170716285705566  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6175861358642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6175861358642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6176471710205078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6253986358642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6259160041809082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6259160041809082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6259732246398926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6336407661437988  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6342272758483887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6342272758483887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6342883110046387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6428942680358887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6435904502868652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6435904502868652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6436591148376465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6538214683532715  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6541681289672852  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6541681289672852  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6542024612426758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6595239639282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6598606109619141  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6598606109619141  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6598911285400391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6648349761962891  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6652812957763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6652812957763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6653194427490234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6717662811279297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([260, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6779947280883789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6779947280883789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6784906387329102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7689619064331055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 260, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.747931957244873  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7483582496643066  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7487845420837402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7483367919921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2860, 40])
input nodes number: 6856
output nodes number: 2860
edges number: 24335
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7484250068664551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7484254837036133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.015349864959716797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 7 input nodes size: 14675
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.013815879821777344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.013815879821777344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.020813465118408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.020834922790527344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01299905776977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01348257064819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01348257064819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01348257064819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([14675, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01348257064819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([608, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03585052490234375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03585052490234375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03643035888671875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04106903076171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([622, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04137229919433594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04137229919433594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.041965484619140625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05086326599121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([601, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05142641067504883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05142641067504883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.051999568939208984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06463241577148438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([544, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0653834342956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0653834342956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0659022331237793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08182096481323242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([463, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08266544342041016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08266544342041016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08310699462890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09900283813476562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([429, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10000944137573242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10000944137573242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1004185676574707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1180109977722168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([357, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11899805068969727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11899805068969727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1193385124206543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13636159896850586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([316, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13739681243896484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13739681243896484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13769817352294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1548757553100586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([262, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.15584945678710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.15584945678710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1560993194580078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1720905303955078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([2629, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18450164794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18450164794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2629, 128]), torch.Size([1, 2629, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18700885772705078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.37035274505615234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2629, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3507370948791504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3572516441345215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3637661933898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.35720062255859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6831, 256])
first layer input nodes number: 14675
first layer output nodes number: 6831
edges number: 44395
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3638777732849121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3703923225402832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3720211982727051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3720211982727051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([459, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3922743797302246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3922743797302246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.39314985275268555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40015363693237305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40042734146118164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40042734146118164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40113306045532227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.41257524490356445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([307, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.41310787200927734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.41310787200927734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4136934280395508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4274559020996094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([275, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4282207489013672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4282207489013672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4287452697753906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4442625045776367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44500017166137695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44500017166137695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44539690017700195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45967912673950195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([186, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4605536460876465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4605536460876465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4609084129333496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.476163387298584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47686767578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47686767578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47711753845214844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4896106719970703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4903855323791504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4903855323791504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49060869216918945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.503328800201416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5041604042053223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5041604042053223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5043683052062988  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5176739692687988  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5183777809143066  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5183777809143066  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5185379981994629  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5299134254455566  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5304465293884277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5304465293884277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5305571556091309  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5391860008239746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5398116111755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5398116111755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.539924144744873  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5494894981384277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5500454902648926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5500454902648926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5501389503479004  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5587372779846191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5593233108520508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5593233108520508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.559412956237793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5682878494262695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5687479972839355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5687479972839355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.568814754486084  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5758910179138184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.575965404510498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.575965404510498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5759787559509277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5774874687194824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5780038833618164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5780038833618164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5780649185180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5853891372680664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.585756778717041  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.585756778717041  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5858006477355957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.591372013092041  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5916972160339355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5916972160339355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.591733455657959  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5965895652770996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5970139503479004  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5970139503479004  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5970578193664551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.603243350982666  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.603705883026123  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.603705883026123  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6037516593933105  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6105265617370605  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.61077880859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.61077880859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6108036041259766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6146469116210938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6149663925170898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6149663925170898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.614995002746582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6196298599243164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6198697090148926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6198697090148926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6198906898498535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.623436450958252  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([198, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6281838417053223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6281838417053223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6285614967346191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6950287818908691  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 198, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6779613494873047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6783876419067383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6788139343261719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6783661842346191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2859, 40])
input nodes number: 6831
output nodes number: 2859
edges number: 20456
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.678438663482666  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6784391403198242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014414310455322266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 8 input nodes size: 17336
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01299905776977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01299905776977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.021265506744384766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.02128744125366211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01426839828491211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014816761016845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014816761016845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014816761016845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([17336, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014816761016845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([531, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.039193153381347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.039193153381347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.039699554443359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.044039249420166016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([642, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04439830780029297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04439830780029297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04501056671142578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.054604530334472656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([648, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.055225372314453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.055225372314453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.055843353271484375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07030248641967773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([591, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0711207389831543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0711207389831543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07168436050415039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08865499496459961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([503, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08957242965698242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08957242965698242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09005212783813477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10732126235961914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([438, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10833454132080078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10833454132080078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10875225067138672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12671375274658203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([409, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1278700828552246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1278700828552246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12826013565063477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14776277542114258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([408, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1491241455078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1491241455078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14951324462890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17169189453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([359, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17303800582885742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17303800582885742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17338037490844727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.19529199600219727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([2860, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.20875835418701172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.20875835418701172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2860, 128]), torch.Size([1, 2860, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.2114858627319336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40968751907348633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2860, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3877906799316406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3948373794555664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4018840789794922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.39478206634521484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([7389, 256])
first layer input nodes number: 17336
first layer output nodes number: 7389
edges number: 49224
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40201520919799805  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40906190872192383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4117722511291504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4117722511291504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([353, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43585777282714844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43585777282714844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43653106689453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4429755210876465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([332, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44327735900878906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44327735900878906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4439105987548828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4537811279296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45435571670532227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45435571670532227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45494508743286133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4679112434387207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46858930587768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46858930587768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4690718650817871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4830660820007324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48387765884399414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48387765884399414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4842953681945801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49933290481567383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49997758865356445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49997758865356445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5002598762512207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5123982429504395  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5130915641784668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5130915641784668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5133280754089355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.525153636932373  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([150, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.526188850402832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.526188850402832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5264749526977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5427827835083008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([115, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5436544418334961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5436544418334961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5438737869262695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5579118728637695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5587248802185059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5587248802185059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5589079856872559  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5719084739685059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5725679397583008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5725679397583008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5727033615112305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5832662582397461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5840640068054199  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5840640068054199  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5842070579528809  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5963664054870605  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5971198081970215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5971198081970215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5972456932067871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6088271141052246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6095447540283203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6095447540283203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6096553802490234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6206073760986328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6212730407714844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6212730407714844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.621368408203125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6314773559570312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6321220397949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6321220397949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6322078704833984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.64190673828125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6424684524536133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6424684524536133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6425390243530273  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6510076522827148  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6516470909118652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6516470909118652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6517214775085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6611685752868652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6617889404296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6617889404296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6618576049804688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6710586547851562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6715435981750488  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6715435981750488  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6715950965881348  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.678856372833252  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6793556213378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6793556213378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6794052124023438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6867446899414062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6872062683105469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6872062683105469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6872501373291016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6940498352050781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6945366859436035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6945366859436035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6945805549621582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7016873359680176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7020578384399414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7020578384399414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7020902633666992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7075700759887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([234, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7131767272949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7131767272949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.713623046875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.79217529296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 234, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7712326049804688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7716689109802246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7721052169799805  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7716469764709473  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2926, 40])
input nodes number: 7389
output nodes number: 2926
edges number: 24217
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7717342376708984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7717347145080566  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0158843994140625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 9 input nodes size: 20385
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014278411865234375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014278411865234375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.023998737335205078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.024020671844482422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.015732288360595703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016306400299072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016306400299072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016306400299072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([20385, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016306400299072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([692, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04327249526977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04327249526977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.043932437896728516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.049320220947265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 692, 128])
m.shape torch.Size([800, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04975318908691406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04975318908691406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05051612854003906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06196022033691406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([666, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0625314712524414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0625314712524414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06316661834716797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07713985443115234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([635, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.078033447265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.078033447265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07863903045654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09687232971191406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([560, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09790468215942383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09790468215942383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09843873977661133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11826562881469727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([532, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11952066421508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11952066421508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12002801895141602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14206886291503906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([424, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14323043823242188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14323043823242188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14363479614257812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16385269165039062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([426, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16527557373046875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16527557373046875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1656818389892578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18883895874023438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([359, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.19017648696899414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.19017648696899414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.19051885604858398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.21243047714233398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([3192, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.2274799346923828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.2274799346923828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 3192, 128]), torch.Size([1, 3192, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.23126840591430664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4474015235900879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 3192, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4237546920776367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4316568374633789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4395589828491211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4315948486328125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([8286, 256])
first layer input nodes number: 20385
first layer output nodes number: 8286
edges number: 54349
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4397130012512207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4476151466369629  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44959068298339844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44959068298339844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([430, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4718785285949707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4718785285949707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4726986885070801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4799013137817383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([377, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48021602630615234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48021602630615234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48093509674072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4924163818359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4928760528564453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4928760528564453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49341773986816406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5069828033447266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5076041221618652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5076041221618652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5080466270446777  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5208792686462402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.521571159362793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.521571159362793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5219335556030273  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5349798202514648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5360732078552246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5360732078552246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5364012718200684  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5505080223083496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5511112213134766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5511112213134766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5513286590576172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5622005462646484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5633664131164551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5633664131164551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5636258125305176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5784115791320801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5791730880737305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5791730880737305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5793695449829102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5919427871704102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([98, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5927867889404297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5927867889404297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5929737091064453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6062450408935547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([84, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6070399284362793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6070399284362793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6072001457214355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.619697093963623  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.620297908782959  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.620297908782959  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6204104423522949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6299757957458496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6306319236755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6306319236755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6307406425476074  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6407427787780762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6412134170532227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6412134170532227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6412878036499023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6486520767211914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6493358612060547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6493358612060547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6494312286376953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6595401763916016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6600461006164551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6600461006164551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6601147651672363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6678738594055176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6685261726379395  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6685261726379395  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6686062812805176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6782193183898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.678715705871582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.678715705871582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6787748336791992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.686284065246582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6867661476135254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6867661476135254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6868195533752441  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6939759254455566  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.694526195526123  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.694526195526123  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6945834159851074  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7026515007019043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7030673027038574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7030673027038574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7031092643737793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7093195915222168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7097640037536621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7097640037536621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.709805965423584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7163100242614746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7167315483093262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7167315483093262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7167696952819824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7229495048522949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.723299503326416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.723299503326416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.723330020904541  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.728487491607666  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([218, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.733710765838623  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.733710765838623  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7341265678405762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8073077201843262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 218, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7882051467895508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7886362075805664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.789067268371582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7886142730712891  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2890, 40])
input nodes number: 8286
output nodes number: 2890
edges number: 22628
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7886929512023926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7886934280395508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01741504669189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 10 input nodes size: 17450
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01572704315185547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01572704315185547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0240478515625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.02406930923461914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014327049255371094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014840126037597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014840126037597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014840126037597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([17450, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014840126037597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([505, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0374298095703125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0374298095703125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.037911415100097656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.041764259338378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([548, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04204607009887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04204607009887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04256868362426758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05149269104003906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([571, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0520482063293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0520482063293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05259275436401367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.064666748046875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([461, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06527376174926758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06527376174926758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06571340560913086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07846307754516602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([430, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0792684555053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0792684555053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07967853546142578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09444141387939453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([340, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09520912170410156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09520912170410156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09553337097167969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10947608947753906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([310, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11034870147705078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11034870147705078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 310, 128]), torch.Size([1, 310, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11064434051513672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1254262924194336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 310, 128])
m.shape torch.Size([320, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12649917602539062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12649917602539062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12680435180664062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14419937133789062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([270, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14520549774169922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14520549774169922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 270, 128]), torch.Size([1, 270, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1454629898071289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1619424819946289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 270, 128])
m.shape torch.Size([2911, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17569446563720703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17569446563720703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2911, 128]), torch.Size([1, 2911, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17847061157226562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3770132064819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2911, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.35646677017211914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3628239631652832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.36918115615844727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3627738952636719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6666, 256])
first layer input nodes number: 17450
first layer output nodes number: 6666
edges number: 45618
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.36931324005126953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3761301040649414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3772597312927246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3772597312927246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([380, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3999762535095215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3999762535095215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40070104598999023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4066905975341797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([360, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40702056884765625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40702056884765625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40770721435546875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4189939498901367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4194984436035156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4194984436035156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4200592041015625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4325981140136719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43327903747558594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43327903747558594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43375587463378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4475841522216797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4483213424682617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4483213424682617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44870853424072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4626474380493164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([140, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46326160430908203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46326160430908203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4635286331176758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47501087188720703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47580623626708984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47580623626708984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47606945037841797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4892301559448242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4900212287902832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4900212287902832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4902501106262207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5032963752746582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5041337013244629  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5041337013244629  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5043435096740723  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5177712440490723  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5185990333557129  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5185990333557129  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5187840461730957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5319199562072754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5326099395751953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5326099395751953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5327510833740234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5437602996826172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5445089340209961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5445089340209961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5446443557739258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5561552047729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5568747520446777  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5568747520446777  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5569949150085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5680499076843262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5687437057495117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5687437057495117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5688505172729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5794248580932617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5801067352294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5801067352294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5802040100097656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.59051513671875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5908355712890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5908355712890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.59088134765625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5960540771484375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5965542793273926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5965542793273926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5966153144836426  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6039395332336426  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6044454574584961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6044454574584961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6045045852661133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6120138168334961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6123862266540527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6123862266540527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6124281883239746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6180510520935059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6184916496276855  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6184916496276855  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.618537425994873  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6249918937683105  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6254134178161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6254134178161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.625455379486084  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6316657066345215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6322579383850098  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6322579383850098  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6323132514953613  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6408867835998535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6411247253417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6411247253417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6411476135253906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6448554992675781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6452593803405762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6452593803405762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6452937126159668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6510958671569824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([247, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6570138931274414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6570138931274414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6574850082397461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7404012680053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 247, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7207760810852051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7212038040161133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7216315269470215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7211823463439941  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2868, 40])
input nodes number: 6666
output nodes number: 2868
edges number: 23124
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7212505340576172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7212510108947754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01583576202392578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 11 input nodes size: 23529
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014323711395263672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014323711395263672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.025543212890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.025565147399902344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017222881317138672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017880916595458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017880916595458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017880916595458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([23529, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017880916595458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([578, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.048937320709228516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.048937320709228516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04948854446411133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.054070472717285156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([625, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.054390907287597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.054390907287597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05498695373535156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06450510025024414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([608, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06507682800292969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06507682800292969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06565666198730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07841300964355469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([598, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07926368713378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07926368713378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.079833984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09732818603515625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([574, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09841156005859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09841156005859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09895896911621094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.11889934539794922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([486, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12001609802246094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12001609802246094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12047958374023438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1404094696044922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([472, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1417531967163086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1417531967163086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14220333099365234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16471004486083984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([433, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1661367416381836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1661367416381836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1665496826171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19008731842041016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([375, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19149017333984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19149017333984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1918478012084961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2147359848022461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([4089, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.23408842086791992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.23408842086791992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 4089, 128]), torch.Size([1, 4089, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2386341094970703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5158743858337402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 4089, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48795652389526367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4963850975036621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5048136711120605  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4963188171386719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([8838, 256])
first layer input nodes number: 23529
first layer output nodes number: 8838
edges number: 62863
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5049910545349121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5134196281433105  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5155267715454102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5155267715454102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([385, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.540372371673584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.540372371673584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5411067008972168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.547541618347168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([329, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5478072166442871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5478072166442871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5484347343444824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5584807395935059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([276, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5589628219604492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5589628219604492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5594892501831055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5722179412841797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5728082656860352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5728082656860352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5732316970825195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5855112075805664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5862369537353516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5862369537353516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.58660888671875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5999984741210938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6007928848266602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6007928848266602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6011171340942383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6150598526000977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6158533096313477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6158533096313477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.616124153137207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6296663284301758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.630584716796875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.630584716796875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6308460235595703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6457405090332031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6464056968688965  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6464056968688965  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6465811729431152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6578116416931152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6586465835571289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6586465835571289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6588296890258789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6718301773071289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6724262237548828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6724262237548828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6725502014160156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.682220458984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6830582618713379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6830582618713379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6832070350646973  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6958527565002441  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6964783668518066  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6964783668518066  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6965851783752441  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7064118385314941  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7072601318359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7072601318359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7073879241943359  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7200393676757812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7207541465759277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7207541465759277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7208571434020996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7317748069763184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7325229644775391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7325229644775391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7326221466064453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7438297271728516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7443685531616211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7443685531616211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7444372177124023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7526769638061523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7531790733337402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7531790733337402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7532382011413574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7607474327087402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.761265754699707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.761265754699707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7613229751586914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7689905166625977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7695198059082031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7695198059082031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7695751190185547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.777374267578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7778310775756836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7778310775756836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7778768539428711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7846517562866211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7850518226623535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7850518226623535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7850899696350098  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7910027503967285  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7913599014282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7913599014282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7913923263549805  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7966451644897461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7970442771911621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7970442771911621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7970786094665527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8028807640075684  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([306, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8102164268493652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8102164268493652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8108000755310059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.9138998985290527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 306, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8921680450439453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8926043510437012  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.893040657043457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8925824165344238  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2927, 40])
input nodes number: 8838
output nodes number: 2927
edges number: 25328
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8926792144775391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8926796913146973  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.019144058227539062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 12 input nodes size: 8819
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.017231464385986328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.017231464385986328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.021436691284179688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02145862579345703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01021718978881836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010518550872802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010518550872802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010518550872802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([8819, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010518550872802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([772, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.023201942443847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.023201942443847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02393817901611328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.030508995056152344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([797, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.030900955200195312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.030900955200195312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.031661033630371094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04316091537475586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([693, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.043772220611572266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.043772220611572266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0444331169128418  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05935335159301758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([518, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06001091003417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06001091003417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.060504913330078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07490921020507812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([479, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07580423355102539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07580423355102539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07626104354858398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09270620346069336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([349, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0934762954711914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0934762954711914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09380912780761719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10812091827392578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 349, 128])
m.shape torch.Size([292, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10892915725708008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10892915725708008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1092076301574707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12313127517700195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 292, 128])
m.shape torch.Size([231, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12387323379516602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12387323379516602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12409353256225586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13665056228637695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([185, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13733434677124023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13733434677124023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1375107765197754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1488022804260254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([845, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15274333953857422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15274333953857422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1535491943359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21142339706420898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 845, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20240306854248047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20732498168945312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21224689483642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20728635787963867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([5161, 256])
first layer input nodes number: 8819
first layer output nodes number: 5161
edges number: 25013
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21231460571289062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21723651885986328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21931982040405273  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21931982040405273  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([530, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.23472118377685547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.23472118377685547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 530, 256]), torch.Size([1, 530, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2357320785522461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2449803352355957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 530, 256])
m.shape torch.Size([468, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2453746795654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2453746795654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.24626731872558594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2596569061279297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([392, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26053667068481445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26053667068481445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26128435134887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.27773332595825195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([272, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2787189483642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2787189483642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2792377471923828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2947101593017578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([269, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2957439422607422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2957439422607422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.29625701904296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3154172897338867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([185, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31622791290283203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31622791290283203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31658077239990234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3317537307739258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33257341384887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33257341384887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3328557014465332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3469700813293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3477439880371094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3477439880371094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34797096252441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36090850830078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36154794692993164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36154794692993164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36171388626098633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37233400344848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37288570404052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37288570404052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37301158905029297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38194942474365234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3824577331542969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3824577331542969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38256072998046875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.390594482421875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39130449295043945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39130449295043945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3914303779602051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4021306037902832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40250539779663086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40250539779663086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4025721549987793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40871381759643555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40920543670654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40920543670654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40927982330322266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4166440963745117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4170970916748047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4170970916748047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4171619415283203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42403602600097656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42437267303466797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42437267303466797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42441844940185547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42959117889404297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4299278259277344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4299278259277344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42996978759765625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43500518798828125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4351921081542969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4351921081542969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4352149963378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4381217956542969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43823862075805664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43823862075805664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43825197219848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44004106521606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44013071060180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44013071060180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4401402473449707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4414849281311035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4417428970336914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4417428970336914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44176769256591797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4454374313354492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44555234909057617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44555234909057617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44556379318237305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44733762741088867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4474649429321289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4474649429321289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4474763870239258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44933032989501953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4495091438293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4495091438293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4495244026184082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4521031379699707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([36, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4529609680175781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4529609680175781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4530296325683594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4651145935058594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45409631729125977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4545292854309082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45496225357055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45450735092163086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2903, 40])
input nodes number: 5161
output nodes number: 2903
edges number: 15355
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45456457138061523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45456504821777344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011146068572998047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 13 input nodes size: 9935
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010213851928710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010213851928710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014951229095458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014973163604736328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010746002197265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011057853698730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011057853698730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011057853698730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([9935, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011057853698730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([691, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.024618148803710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.024618148803710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.025277137756347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.030549049377441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([759, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03094339370727539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03094339370727539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 759, 128]), torch.Size([1, 759, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.031667232513427734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04252481460571289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 759, 128])
m.shape torch.Size([633, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04306840896606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04306840896606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04367208480834961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05780744552612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([565, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05858325958251953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05858325958251953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05912208557128906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0754404067993164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([417, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07616519927978516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07616519927978516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07656288146972656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09087944030761719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 417, 128])
m.shape torch.Size([356, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09169912338256836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09169912338256836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 356, 128]), torch.Size([1, 356, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09203863143920898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10663747787475586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 356, 128])
m.shape torch.Size([297, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10745906829833984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10745906829833984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1077423095703125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12190437316894531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([232, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12264776229858398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12264776229858398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 232, 128]), torch.Size([1, 232, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12286901473999023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13548040390014648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 232, 128])
m.shape torch.Size([197, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1362152099609375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1362152099609375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13640308380126953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14842700958251953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([964, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15292978286743164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15292978286743164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 964, 128]), torch.Size([1, 964, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15384912490844727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.22002077102661133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 964, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20905637741088867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21393060684204102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21880483627319336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21389245986938477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([5111, 256])
first layer input nodes number: 9935
first layer output nodes number: 5111
edges number: 25937
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21888113021850586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2237553596496582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2249741554260254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2249741554260254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([500, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.24076271057128906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.24076271057128906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2417163848876953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2500028610229492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([481, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.25045108795166016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.25045108795166016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.25136852264404297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26575708389282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([368, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2664299011230469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2664299011230469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2671318054199219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.28350257873535156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([322, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2843899726867676  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2843899726867676  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2850041389465332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3032193183898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([230, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3040652275085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3040652275085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3045039176940918  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3202967643737793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([182, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.321230411529541  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.321230411529541  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3215775489807129  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3365044593811035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.337557315826416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.337557315826416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3378415107727051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3520512580871582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35277843475341797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35277843475341797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3529939651489258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3652791976928711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36601924896240234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36601924896240234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36620616912841797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37816905975341797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37872934341430664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37872934341430664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3788590431213379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38806772232055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38875389099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38875389099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3888893127441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39945220947265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39983463287353516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39983463287353516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39990901947021484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4062318801879883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40673208236694336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40673208236694336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4068140983581543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41435956954956055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4148435592651367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4148435592651367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4149179458618164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42228221893310547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42272090911865234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42272090911865234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42278385162353516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4294557571411133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42987060546875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42987060546875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42992591857910156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4361763000488281  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([9, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4362959861755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4362959861755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4363131523132324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4383730888366699  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4387626647949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4387626647949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43880653381347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4443778991699219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44455718994140625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44455718994140625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4445781707763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4473896026611328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4475717544555664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4475717544555664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44759082794189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45028018951416016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4504728317260742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4504728317260742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45049190521240234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45331478118896484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.453432559967041  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.453432559967041  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4534440040588379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4552178382873535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4553670883178711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4553670883178711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4553804397583008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45754337310791016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4576754570007324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4576754570007324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4576869010925293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45962095260620117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([50, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4608168601989746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4608168601989746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46091222763061523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47769689559936523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46527719497680664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46570920944213867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4661412239074707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46568727493286133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2897, 40])
input nodes number: 5111
output nodes number: 2897
edges number: 15791
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4657464027404785  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4657468795776367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011708736419677734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 14 input nodes size: 16035
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010745048522949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010745048522949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.018391132354736328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.018413066864013672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013653755187988281  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014154434204101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014154434204101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014154434204101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([16035, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014154434204101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([656, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.036615848541259766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.036615848541259766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.037241458892822266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0428929328918457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([684, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04323244094848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04323244094848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0438847541809082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.054599761962890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([611, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.055147647857666016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.055147647857666016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.055730342864990234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0686650276184082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([576, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0694723129272461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0694723129272461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0700216293334961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0859518051147461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([562, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08701705932617188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08701705932617188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08755302429199219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10770130157470703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([489, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10883235931396484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10883235931396484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1092987060546875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12935161590576172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([407, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1304769515991211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1304769515991211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13086509704589844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15027236938476562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([358, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1514439582824707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1514439582824707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15178537368774414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.17124605178833008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([316, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.17243146896362305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.17243146896362305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.17273283004760742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19201993942260742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([2471, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20365190505981445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20365190505981445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2471, 128]), torch.Size([1, 2471, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2060084342956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37998390197753906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2471, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36052703857421875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36750221252441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3743019104003906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36727333068847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([7130, 256])
first layer input nodes number: 16035
first layer output nodes number: 7130
edges number: 45172
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37424802780151367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.381223201751709  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3827476501464844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3827476501464844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([461, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40496826171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40496826171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40584754943847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41353797912597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4138193130493164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4138193130493164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4145345687866211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42553281784057617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([301, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4260435104370117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4260435104370117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4266176223754883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43935298919677734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43994665145874023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43994665145874023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4403834342956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4530501365661621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([222, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45389890670776367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45389890670776367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45432233810424805  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46956586837768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47028303146362305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47028303146362305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47059011459350586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4837946891784668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([145, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.484616756439209  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.484616756439209  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4848933219909668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4987215995788574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49947547912597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49947547912597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4996967315673828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5123081207275391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5130801200866699  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5130801200866699  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5132746696472168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5257258415222168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([104, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266437530517578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266437530517578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5268421173095703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5409259796142578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([87, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5417466163635254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5417466163635254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5419125556945801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5548558235168457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5555343627929688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5555343627929688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5556602478027344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5663604736328125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5668973922729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5668973922729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5669889450073242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5754117965698242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5759449005126953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5759449005126953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5760269165039062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5841464996337891  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5846681594848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5846681594848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.584742546081543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5926275253295898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5932211875915527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5932211875915527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.593299388885498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6021361351013184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6025710105895996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6025710105895996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6026263236999512  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6092638969421387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6096172332763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6096172332763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6096591949462891  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6149883270263672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6155886650085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6155886650085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6156535148620605  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6243433952331543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6249456405639648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6249456405639648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6250085830688477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6338834762573242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6342358589172363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6342358589172363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6342720985412598  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6396355628967285  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6399984359741211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6399984359741211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6400327682495117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6453542709350586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6456689834594727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6456689834594727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6456975936889648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6503324508666992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6505722999572754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6505722999572754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6505932807922363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6541390419006348  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([204, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6590304374694824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6590304374694824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6594195365905762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7279009819030762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 204, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7089376449584961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.709373950958252  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7098102569580078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7093520164489746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2925, 40])
input nodes number: 7130
output nodes number: 2925
edges number: 21922
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7094316482543945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7094321250915527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.015136241912841797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 15 input nodes size: 10948
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01365804672241211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01365804672241211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.018878459930419922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.018899917602539062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01123189926147461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01160287857055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01160287857055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01160287857055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([10948, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01160287857055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([624, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02731037139892578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02731037139892578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02790546417236328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03290271759033203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([654, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03322887420654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03322887420654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033852577209472656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04320812225341797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([626, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.043791770935058594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.043791770935058594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.044388771057128906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05838298797607422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([553, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.059139251708984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.059139251708984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05966663360595703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07586479187011719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([446, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07666444778442383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07666444778442383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07708978652954102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09240198135375977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([378, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09327077865600586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09327077865600586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09363126754760742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10913228988647461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([331, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.11005687713623047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.11005687713623047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.11037254333496094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12615585327148438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([264, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12700510025024414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12700510025024414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1272568702697754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14160776138305664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([243, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14252471923828125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14252471923828125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14275646209716797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15758800506591797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([1424, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1642622947692871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1642622947692871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 1424, 128]), torch.Size([1, 1424, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1656203269958496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26507043838500977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 1424, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.25196313858032227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2572493553161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26253557205200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.25720787048339844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([5543, 256])
first layer input nodes number: 10948
first layer output nodes number: 5543
edges number: 31376
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2626194953918457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26790571212768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2692275047302246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2692275047302246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([421, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2872953414916992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2872953414916992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2880983352661133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.29505062103271484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([414, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.29544496536254883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.29544496536254883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2962346076965332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3086276054382324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([349, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.30927038192749023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.30927038192749023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3099360466003418  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32458066940307617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([275, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32543325424194336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32543325424194336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3259577751159668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34215450286865234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3429450988769531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3429450988769531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34336280822753906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3584003448486328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3592066764831543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3592066764831543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3595423698425293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3739771842956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([168, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3749399185180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3749399185180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3752603530883789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3912820816040039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39208316802978516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39208316802978516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3923215866088867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4059114456176758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([122, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4068479537963867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4068479537963867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40708065032958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42197322845458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4227027893066406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4227027893066406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4228706359863281  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4347877502441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4354548454284668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4354548454284668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4355902671813965  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4461531639099121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44684696197509766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44684696197509766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4469728469848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4576730728149414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45843505859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45843505859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4585609436035156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4701423645019531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47061777114868164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47061777114868164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47069406509399414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47824716567993164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47885799407958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47885799407958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4789438247680664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48804187774658203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4884910583496094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4884910583496094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4885520935058594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4954490661621094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49579477310180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49579477310180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49583864212036133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5011029243469238  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.501427173614502  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.501427173614502  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5014653205871582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.506309986114502  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5066928863525391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5066928863525391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5067348480224609  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5123577117919922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5126638412475586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5126638412475586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5126962661743164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.517268180847168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5174541473388672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5174541473388672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5174732208251953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5202960968017578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5205192565917969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5205192565917969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5205402374267578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5237922668457031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.523958683013916  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.523958683013916  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5239739418029785  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5264458656311035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5265998840332031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5265998840332031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266132354736328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.52886962890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([82, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5308337211608887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5308337211608887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5309901237487793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5585169792175293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 82, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5437097549438477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5441389083862305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5445680618286133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5441174507141113  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2877, 40])
input nodes number: 5543
output nodes number: 2877
edges number: 18242
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5441732406616211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5441737174987793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.012342453002929688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 16 input nodes size: 16182
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011224746704101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011224746704101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01894092559814453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.018962860107421875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013720989227294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014122486114501953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014122486114501953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014122486114501953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([16182, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014122486114501953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([704, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.032552242279052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.032552242279052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 704, 128]), torch.Size([1, 704, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033223628997802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.038594722747802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 704, 128])
m.shape torch.Size([803, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03902482986450195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03902482986450195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03979063034057617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05174589157104492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([681, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0523371696472168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0523371696472168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05298662185668945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06727457046508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([568, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06814193725585938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06814193725585938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06868362426757812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08483695983886719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([490, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08573436737060547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08573436737060547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08620166778564453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10302448272705078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([413, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1039724349975586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1039724349975586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10436630249023438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12130260467529297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([365, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12232398986816406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12232398986816406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12267208099365234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1400766372680664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 365, 128])
m.shape torch.Size([310, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14108514785766602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14108514785766602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 310, 128]), torch.Size([1, 310, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14138078689575195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1582322120666504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 310, 128])
m.shape torch.Size([255, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1591787338256836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1591787338256836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1594219207763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1749858856201172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([1782, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18336153030395508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18336153030395508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 1782, 128]), torch.Size([1, 1782, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18506097793579102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.30655908584594727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 1782, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.291046142578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2980647087097168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.304140567779541  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2970743179321289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6371, 256])
first layer input nodes number: 16182
first layer output nodes number: 6371
edges number: 36703
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.30332040786743164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31033897399902344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3110165596008301  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3110165596008301  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([499, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32799530029296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32799530029296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 499, 256]), torch.Size([1, 499, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3289470672607422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33846092224121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 499, 256])
m.shape torch.Size([472, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33889245986938477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33889245986938477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33979272842407227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.354769229888916  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([376, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35556507110595703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35556507110595703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35628223419189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37250518798828125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([256, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37313079833984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37313079833984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37361907958984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38777923583984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([217, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.388824462890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.388824462890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3892383575439453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40413856506347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40491199493408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40491199493408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40523624420166016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41917896270751953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4199790954589844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4199790954589844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42025184631347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43388938903808594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([131, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43476057052612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43476057052612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4350104331970215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4492526054382324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4499931335449219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4499931335449219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4501838684082031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4623908996582031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([94, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4631991386413574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4631991386413574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4633784294128418  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4761080741882324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4766530990600586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4766530990600586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47676753997802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48569393157958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.486236572265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.486236572265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48633575439453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4947662353515625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49527931213378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49527931213378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4953651428222656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5032615661621094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5036091804504395  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5036091804504395  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.503664493560791  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5091404914855957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5095458030700684  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5095458030700684  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5096030235290527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5156683921813965  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5161013603210449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5161013603210449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5161585807800293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5226244926452637  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5230536460876465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5230536460876465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5231070518493652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5295157432556152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5298352241516113  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5298352241516113  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5298733711242676  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5347180366516113  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5350279808044434  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5350279808044434  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.535062313079834  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5396628379821777  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5398960113525391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5398960113525391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5399208068847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5434169769287109  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5436267852783203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5436267852783203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5436477661132812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5467529296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5468697547912598  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5468697547912598  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5468811988830566  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5486550331115723  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5487160682678223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5487160682678223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5487217903137207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5496487617492676  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.549830436706543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.549830436706543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5498456954956055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.552424430847168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([87, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5545072555541992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5545072555541992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5546731948852539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5838785171508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 87, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5702428817749023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5706748962402344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5711069107055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.570652961730957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2898, 40])
input nodes number: 6371
output nodes number: 2898
edges number: 17031
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5707254409790039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5707259178161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014951229095458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 17 input nodes size: 16478
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01372385025024414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01372385025024414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.021581172943115234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.021602630615234375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013864517211914062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014266014099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014266014099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014266014099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([16478, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014266014099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([763, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033278465270996094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033278465270996094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03400611877441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03982734680175781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([820, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04024553298950195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04024553298950195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04102754592895508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0534205436706543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([727, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05445051193237305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05445051193237305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 727, 128]), torch.Size([1, 727, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05514383316040039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07039690017700195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 727, 128])
m.shape torch.Size([610, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0712137222290039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0712137222290039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07179546356201172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0886983871459961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([542, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08969974517822266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08969974517822266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09021663665771484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10909652709960938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([390, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1099538803100586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1099538803100586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.11032581329345703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12631893157958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([352, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12730789184570312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12730789184570312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12764358520507812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14442825317382812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([309, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14543914794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14543914794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14573383331298828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16253089904785156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 309, 128])
m.shape torch.Size([260, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1634993553161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1634993553161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16374731063842773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.17961645126342773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([1863, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18837594985961914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18837594985961914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 1863, 128]), torch.Size([1, 1863, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19015264511108398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3162980079650879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 1863, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.30070924758911133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3070378303527832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3133664131164551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3069882392883301  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6636, 256])
first layer input nodes number: 16478
first layer output nodes number: 6636
edges number: 37980
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3134913444519043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32036542892456055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32158422470092773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32158422470092773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([556, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33750391006469727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33750391006469727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.338564395904541  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3472018241882324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([475, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34758472442626953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34758472442626953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34849071502685547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36274051666259766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([356, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3633389472961426  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3633389472961426  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36401796340942383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3806614875793457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([303, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3814868927001953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3814868927001953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3820648193359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3993949890136719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([215, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40016889572143555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40016889572143555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40057897567749023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.415341854095459  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4160194396972656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4160194396972656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41631126403808594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4288597106933594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42960214614868164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42960214614868164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4298539161682129  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4424424171447754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44304704666137695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44304704666137695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44322824478149414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45355653762817383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45424461364746094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45424461364746094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45441627502441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46540260314941406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.466066837310791  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.466066837310791  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4662156105041504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.476778507232666  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4774446487426758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4774446487426758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47757816314697266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4879922866821289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48840999603271484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48840999603271484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48849010467529297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4952993392944336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4957594871520996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4957594871520996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4958357810974121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5028548240661621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5033283233642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5033283233642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5034008026123047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5105762481689453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5109729766845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5109729766845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5110301971435547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5170955657958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5173745155334473  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5173745155334473  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5174126625061035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5217232704162598  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5220150947570801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5220150947570801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5220513343811035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.526400089263916  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266590118408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266590118408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266895294189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5305652618408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5307145118713379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5307145118713379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5307316780090332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5330319404602051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5332927703857422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5332927703857422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5333194732666016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5370845794677734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5373339653015137  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5373339653015137  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5373587608337402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5410284996032715  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5411219596862793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5411219596862793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5411314964294434  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.542609691619873  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.542759895324707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.542759895324707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5427732467651367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5449361801147461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5451374053955078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5451374053955078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5451545715332031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5480556488037109  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([76, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5498733520507812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5498733520507812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.550018310546875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.575531005859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 76, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5632610321044922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.563687801361084  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5641145706176758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5636663436889648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2861, 40])
input nodes number: 6636
output nodes number: 2861
edges number: 15871
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5637321472167969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5637326240539551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01508474349975586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 18 input nodes size: 20223
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013859272003173828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013859272003173828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.023580074310302734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.023602008819580078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.015723228454589844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01622295379638672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01622295379638672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01622295379638672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([20223, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01622295379638672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([825, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04071760177612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04071760177612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0415043830871582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04779863357543945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([810, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04817771911621094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04817771911621094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0489501953125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.060584068298339844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([813, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.061360836029052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.061360836029052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.062136173248291016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0791935920715332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([640, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0801396369934082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0801396369934082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 640, 128]), torch.Size([1, 640, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0807499885559082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0984501838684082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 640, 128])
m.shape torch.Size([632, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09992647171020508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09992647171020508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10052919387817383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12222719192504883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([489, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12337541580200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12337541580200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12384176254272461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14389467239379883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([420, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1450634002685547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1450634002685547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1454639434814453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16549110412597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([383, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16675186157226562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16675186157226562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16711711883544922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18793678283691406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 383, 128])
m.shape torch.Size([306, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18906736373901367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18906736373901367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18935918807983398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20803594589233398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 306, 128])
m.shape torch.Size([2623, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2203974723815918  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2203974723815918  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2623, 128]), torch.Size([1, 2623, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.22324514389038086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40624141693115234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2623, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38515329360961914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39272642135620117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4002995491027832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3926668167114258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([7941, 256])
first layer input nodes number: 20223
first layer output nodes number: 7941
edges number: 48526
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4004521369934082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40802526473999023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41064453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41064453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([523, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4289517402648926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4289517402648926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4299492835998535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4383244514465332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([416, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4386253356933594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4386253356933594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4394187927246094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.452667236328125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([350, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4536271095275879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4536271095275879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45429468154907227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4693751335144043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([248, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46999502182006836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46999502182006836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47046804428100586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48418569564819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([252, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48516035079956055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48516035079956055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4856410026550293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5029444694519043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5036730766296387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5036730766296387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5039935111999512  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5177721977233887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5184869766235352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5184869766235352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5187349319458008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.531132698059082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5319623947143555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5319623947143555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5321989059448242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.545680046081543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5464615821838379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5464615821838379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5466599464416504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5593552589416504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.559852123260498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.559852123260498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5599703788757324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.568366527557373  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5688571929931641  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5688571929931641  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5689563751220703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5766925811767578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5772085189819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5772085189819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5773019790649414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5852460861206055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5858869552612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5858869552612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5859918594360352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5956430435180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5961289405822754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5961289405822754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5962052345275879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6037583351135254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6041531562805176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6041531562805176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.604210376739502  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6102757453918457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6106777191162109  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6106777191162109  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6107311248779297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6167659759521484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.617213249206543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.617213249206543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6172685623168945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.623906135559082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6241903305053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6241903305053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6242246627807617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6285848617553711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6289148330688477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6289148330688477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6289510726928711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6338071823120117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6341352462768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6341352462768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6341695785522461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6390104293823242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6391348838806152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6391348838806152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6391482353210449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6411242485046387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.641413688659668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.641413688659668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6414403915405273  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6455793380737305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6458091735839844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6458091735839844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6458301544189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6492290496826172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6494956016540527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6494956016540527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6495184898376465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6533865928649902  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([136, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6566433906555176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6566433906555176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6569027900695801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7025570869445801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 136, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6875762939453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6880078315734863  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6884393692016602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.687985897064209  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2895, 40])
input nodes number: 7941
output nodes number: 2895
edges number: 18390
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6880722045898438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.688072681427002  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.017227649688720703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 19 input nodes size: 14487
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.015727996826171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.015727996826171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02358531951904297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.023607254028320312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013864517211914062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014303207397460938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014303207397460938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014303207397460938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([14487, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014303207397460938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([715, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03472089767456055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03472089767456055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 715, 128]), torch.Size([1, 715, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.035402774810791016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.040857791900634766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 715, 128])
m.shape torch.Size([725, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04120826721191406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04120826721191406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 725, 128]), torch.Size([1, 725, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.041899681091308594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.052369117736816406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 725, 128])
m.shape torch.Size([648, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.052950382232666016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.052950382232666016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.053568363189697266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06716394424438477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([602, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06800317764282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06800317764282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06857728958129883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08522653579711914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([515, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0861673355102539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0861673355102539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08665847778320312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10451745986938477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([441, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10553359985351562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10553359985351562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10595417022705078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1240386962890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([373, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12507343292236328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12507343292236328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1254291534423828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14321517944335938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([344, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1443495750427246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1443495750427246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 344, 128]), torch.Size([1, 344, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14467763900756836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1633772850036621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 344, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16434621810913086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16434621810913086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1645979881286621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1807112693786621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([1953, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18989801406860352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18989801406860352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 1953, 128]), torch.Size([1, 1953, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19176054000854492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32852983474731445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 1953, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31107330322265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31746673583984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3237419128417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31729936599731445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6580, 256])
first layer input nodes number: 14487
first layer output nodes number: 6580
edges number: 39007
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3237338066101074  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3301272392272949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33228349685668945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33228349685668945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([461, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3525376319885254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3525376319885254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35341691970825195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36045122146606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([389, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3607597351074219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3607597351074219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36150169372558594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3726310729980469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([327, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3732032775878906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3732032775878906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3738269805908203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38782501220703125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3887209892272949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3887209892272949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38921499252319336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4042043685913086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40495729446411133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40495729446411133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40535402297973633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41963624954223633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42038965225219727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42038965225219727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42070436477661133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.434237003326416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([159, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4351496696472168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4351496696472168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.435452938079834  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45061635971069336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4513721466064453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4513721466064453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4515972137451172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46442604064941406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4652566909790039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4652566909790039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46546459197998047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47877025604248047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4795413017272949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4795413017272949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47971487045288086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4920382499694824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4926600456237793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4926600456237793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49278783798217773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5027556419372559  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5034646987915039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5034646987915039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5035924911499023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5144548416137695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5150408744812012  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5150408744812012  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5151400566101074  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5242648124694824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5248479843139648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5248479843139648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.524937629699707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5338125228881836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5342869758605957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5342869758605957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.534355640411377  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5416340827941895  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5421228408813477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5421228408813477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5421876907348633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5495157241821289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5499410629272461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5499410629272461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5499944686889648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5564031600952148  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5569648742675781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5569648742675781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5570297241210938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5652656555175781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5656900405883789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5656900405883789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5657377243041992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5721273422241211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5725264549255371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5725264549255371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.572568416595459  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5784850120544434  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5787062644958496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5787062644958496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5787291526794434  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5821166038513184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5824437141418457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5824437141418457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5824742317199707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5872044563293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5874991416931152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5874991416931152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5875258445739746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5918517112731934  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5921845436096191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5921845436096191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5922131538391113  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.597048282623291  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([133, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6002297401428223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6002297401428223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6004834175109863  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6451306343078613  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 133, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6281499862670898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6285805702209473  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6290111541748047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6285586357116699  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2888, 40])
input nodes number: 6580
output nodes number: 2888
edges number: 19807
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6286287307739258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.628629207611084  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.015177726745605469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 20 input nodes size: 40723
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013863563537597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013863563537597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033394813537597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033415794372558594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.025536537170410156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.026769638061523438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.026769638061523438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.026769638061523438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([40723, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.026769638061523438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([578, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.0930943489074707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.0930943489074707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.09364557266235352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.09805536270141602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([600, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.09835195541381836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.09835195541381836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.09892416000366211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.10750722885131836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([552, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.10801076889038086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.10801076889038086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.10853719711303711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.12015295028686523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([553, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.12094449996948242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.12094449996948242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.12147188186645508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.1367659568786621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([521, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.13774442672729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.13774442672729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.13824129104614258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.15661239624023438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([495, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.15778017044067383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.15778017044067383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.15825223922729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.17855119705200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([510, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.18001747131347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.18001747131347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.18050384521484375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.20482254028320312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([489, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.20644474029541016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.20644474029541016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.2069110870361328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.23349285125732422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([521, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.23549556732177734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.23549556732177734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.235992431640625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.2688288688659668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([11037, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.32131481170654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.32131481170654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11037, 128]), torch.Size([1, 11037, 128])
----------------------------------------3
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.33190250396728516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0891857147216797  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

rst.shape  torch.Size([1, 11037, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0267276763916016  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.041849136352539  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0569705963134766  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0417308807373047  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

torch.Size([15856, 256])
first layer input nodes number: 40723
first layer output nodes number: 15856
edges number: 133762
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0572762489318848  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0723977088928223  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0768074989318848  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0768074989318848  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

m.shape torch.Size([360, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1075677871704102  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1075677871704102  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1082544326782227  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1137475967407227  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([274, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1139311790466309  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1139311790466309  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1144537925720215  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1237921714782715  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([229, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1241912841796875  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1241912841796875  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1246280670166016  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.134237289428711  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([162, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1346421241760254  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1346421241760254  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.134951114654541  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1439118385314941  GigaBytes
Max Memory Allocated: 1.1445298194885254  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([138, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1444206237792969  GigaBytes
Max Memory Allocated: 1.1445298194885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1444206237792969  GigaBytes
Max Memory Allocated: 1.1445298194885254  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.144683837890625  GigaBytes
Max Memory Allocated: 1.144683837890625  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1541595458984375  GigaBytes
Max Memory Allocated: 1.1548175811767578  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([107, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1546454429626465  GigaBytes
Max Memory Allocated: 1.1548175811767578  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1546454429626465  GigaBytes
Max Memory Allocated: 1.1548175811767578  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1548495292663574  GigaBytes
Max Memory Allocated: 1.1548495292663574  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1636252403259277  GigaBytes
Max Memory Allocated: 1.1642374992370605  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([94, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1641559600830078  GigaBytes
Max Memory Allocated: 1.1642374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1641559600830078  GigaBytes
Max Memory Allocated: 1.1642374992370605  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1643352508544922  GigaBytes
Max Memory Allocated: 1.1643352508544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.173299789428711  GigaBytes
Max Memory Allocated: 1.1739273071289062  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([68, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1737332344055176  GigaBytes
Max Memory Allocated: 1.1739273071289062  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1737332344055176  GigaBytes
Max Memory Allocated: 1.1739273071289062  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1738629341125488  GigaBytes
Max Memory Allocated: 1.1739273071289062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.18125581741333  GigaBytes
Max Memory Allocated: 1.181774616241455  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([69, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1817879676818848  GigaBytes
Max Memory Allocated: 1.1817903518676758  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1817879676818848  GigaBytes
Max Memory Allocated: 1.1817903518676758  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1819195747375488  GigaBytes
Max Memory Allocated: 1.1819195747375488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1903424263000488  GigaBytes
Max Memory Allocated: 1.190934658050537  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1909112930297852  GigaBytes
Max Memory Allocated: 1.190934658050537  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1909112930297852  GigaBytes
Max Memory Allocated: 1.190934658050537  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1910371780395508  GigaBytes
Max Memory Allocated: 1.1910371780395508  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1999750137329102  GigaBytes
Max Memory Allocated: 1.2006044387817383  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2005677223205566  GigaBytes
Max Memory Allocated: 1.2006044387817383  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2005677223205566  GigaBytes
Max Memory Allocated: 1.2006044387817383  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.200685977935791  GigaBytes
Max Memory Allocated: 1.200685977935791  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2099099159240723  GigaBytes
Max Memory Allocated: 1.2105603218078613  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2104277610778809  GigaBytes
Max Memory Allocated: 1.2105603218078613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2104277610778809  GigaBytes
Max Memory Allocated: 1.2105603218078613  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2105231285095215  GigaBytes
Max Memory Allocated: 1.2105603218078613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2186293601989746  GigaBytes
Max Memory Allocated: 1.2192015647888184  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2191314697265625  GigaBytes
Max Memory Allocated: 1.2192015647888184  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2191314697265625  GigaBytes
Max Memory Allocated: 1.2192015647888184  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2192153930664062  GigaBytes
Max Memory Allocated: 1.2192153930664062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2269363403320312  GigaBytes
Max Memory Allocated: 1.2274818420410156  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2274999618530273  GigaBytes
Max Memory Allocated: 1.2275023460388184  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2274999618530273  GigaBytes
Max Memory Allocated: 1.2275023460388184  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.227585792541504  GigaBytes
Max Memory Allocated: 1.227585792541504  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2360830307006836  GigaBytes
Max Memory Allocated: 1.2366838455200195  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.236602783203125  GigaBytes
Max Memory Allocated: 1.2366838455200195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.236602783203125  GigaBytes
Max Memory Allocated: 1.2366838455200195  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2366771697998047  GigaBytes
Max Memory Allocated: 1.2366838455200195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2445621490478516  GigaBytes
Max Memory Allocated: 1.2451200485229492  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2450942993164062  GigaBytes
Max Memory Allocated: 1.2451200485229492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2450942993164062  GigaBytes
Max Memory Allocated: 1.2451200485229492  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2451648712158203  GigaBytes
Max Memory Allocated: 1.2451648712158203  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2531394958496094  GigaBytes
Max Memory Allocated: 1.2537040710449219  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2535619735717773  GigaBytes
Max Memory Allocated: 1.2537040710449219  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2535619735717773  GigaBytes
Max Memory Allocated: 1.2537040710449219  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.253615379333496  GigaBytes
Max Memory Allocated: 1.2537040710449219  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.260024070739746  GigaBytes
Max Memory Allocated: 1.2604780197143555  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2605857849121094  GigaBytes
Max Memory Allocated: 1.2605881690979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2605857849121094  GigaBytes
Max Memory Allocated: 1.2605881690979004  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.260650634765625  GigaBytes
Max Memory Allocated: 1.260650634765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2688865661621094  GigaBytes
Max Memory Allocated: 1.26947021484375  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2694387435913086  GigaBytes
Max Memory Allocated: 1.26947021484375  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2694387435913086  GigaBytes
Max Memory Allocated: 1.26947021484375  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2694997787475586  GigaBytes
Max Memory Allocated: 1.2694997787475586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2776784896850586  GigaBytes
Max Memory Allocated: 1.2782583236694336  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2783207893371582  GigaBytes
Max Memory Allocated: 1.2783236503601074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2783207893371582  GigaBytes
Max Memory Allocated: 1.2783236503601074  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2783875465393066  GigaBytes
Max Memory Allocated: 1.2783875465393066  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2878003120422363  GigaBytes
Max Memory Allocated: 1.2884678840637207  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2883119583129883  GigaBytes
Max Memory Allocated: 1.2884678840637207  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2883119583129883  GigaBytes
Max Memory Allocated: 1.2884678840637207  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2883634567260742  GigaBytes
Max Memory Allocated: 1.2884678840637207  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.295985221862793  GigaBytes
Max Memory Allocated: 1.2965259552001953  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2963190078735352  GigaBytes
Max Memory Allocated: 1.2965259552001953  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2963190078735352  GigaBytes
Max Memory Allocated: 1.2965259552001953  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.296351432800293  GigaBytes
Max Memory Allocated: 1.2965259552001953  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.301377296447754  GigaBytes
Max Memory Allocated: 1.3017339706420898  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.301781177520752  GigaBytes
Max Memory Allocated: 1.3017830848693848  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.301781177520752  GigaBytes
Max Memory Allocated: 1.3017830848693848  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3018174171447754  GigaBytes
Max Memory Allocated: 1.3018174171447754  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3076882362365723  GigaBytes
Max Memory Allocated: 1.3081049919128418  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3083162307739258  GigaBytes
Max Memory Allocated: 1.308319091796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3083162307739258  GigaBytes
Max Memory Allocated: 1.308319091796875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3083696365356445  GigaBytes
Max Memory Allocated: 1.3083696365356445  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3173952102661133  GigaBytes
Max Memory Allocated: 1.3180360794067383  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([694, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3340444564819336  GigaBytes
Max Memory Allocated: 1.3341093063354492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3340444564819336  GigaBytes
Max Memory Allocated: 1.3341093063354492  GigaBytes

 h.shape torch.Size([1, 694, 256]), torch.Size([1, 694, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3353681564331055  GigaBytes
Max Memory Allocated: 1.3353681564331055  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.5696425437927246  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 694, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.5414848327636719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.541895866394043  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.542306900024414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.541874885559082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2758, 40])
input nodes number: 15856
output nodes number: 2758
edges number: 31515
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.541994571685791  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.5419950485229492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.028908729553222656  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 21 input nodes size: 35233
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.025516986846923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.025516986846923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.04309511184692383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.043116092681884766  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.023563861846923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.024398326873779297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.024398326873779297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.024398326873779297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([35233, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.024398326873779297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([733, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0690603256225586  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0690603256225586  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.06975936889648438  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07535171508789062  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([805, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07576990127563477  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07576990127563477  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0765376091003418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08880233764648438  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([691, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08940696716308594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08940696716308594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09006595611572266  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10456371307373047  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([623, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1063089370727539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1063089370727539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.106903076171875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.12413311004638672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([572, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1251997947692871  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1251997947692871  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.12574529647827148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.14601850509643555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([508, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.14719915390014648  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.14719915390014648  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.14768362045288086  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16851568222045898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([457, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1697988510131836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1697988510131836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17023468017578125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19202613830566406  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([458, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19355535507202148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19355535507202148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19399213790893555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2188887596130371  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([364, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2203836441040039  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2203836441040039  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22073078155517578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24294757843017578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([6761, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2750129699707031  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2750129699707031  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 6761, 128]), torch.Size([1, 6761, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2814607620239258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7415084838867188  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 6761, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7022461891174316  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7136635780334473  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7250809669494629  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7135739326477051  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([11972, 256])
first layer input nodes number: 35233
first layer output nodes number: 11972
edges number: 90565
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7253456115722656  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7367630004882812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7396173477172852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7396173477172852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([465, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7606468200683594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7606468200683594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7615337371826172  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7688627243041992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([407, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7692017555236816  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7692017555236816  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7699780464172363  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7818264961242676  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7823123931884766  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7823123931884766  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7828903198242188  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7973155975341797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7978878021240234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7978878021240234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7983150482177734  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8107051849365234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8114290237426758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8114290237426758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8118009567260742  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.825190544128418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8258066177368164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8258066177368164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8260717391967773  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8374719619750977  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([109, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8380727767944336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8380727767944336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8382806777954102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8486757278442383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8492717742919922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8492717742919922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8494453430175781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8593387603759766  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8598752021789551  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8598752021789551  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8600125312805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8688015937805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8694734573364258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8694734573364258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8696203231811523  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8800477981567383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8807148933410645  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8807148933410645  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8808484077453613  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8912625312805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.891761302947998  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.891761302947998  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8918547630310059  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8997988700866699  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.900177001953125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.900177001953125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9002418518066406  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9062080383300781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9066600799560547  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9066600799560547  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9067287445068359  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9135265350341797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9140834808349609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9140834808349609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9141616821289062  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9224510192871094  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9227657318115234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9227657318115234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9228096008300781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9277667999267578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9282188415527344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9282188415527344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9282741546630859  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9349117279052734  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9353342056274414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9353342056274414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9353837966918945  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9416818618774414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9420042037963867  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9420042037963867  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9420404434204102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9468965530395508  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9470901489257812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9470901489257812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9471111297607422  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9500694274902344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.950261116027832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.950261116027832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9502801895141602  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9531030654907227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9533262252807617  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9533262252807617  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9533472061157227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.956599235534668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9567217826843262  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9567217826843262  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.956733226776123  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9585871696472168  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9589047431945801  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9589047431945801  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9589314460754395  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9634442329406738  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([309, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9710884094238281  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9710884094238281  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9716777801513672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0795707702636719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 309, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0615472793579102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.061960220336914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.062373161315918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0619392395019531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2770, 40])
input nodes number: 11972
output nodes number: 2770
edges number: 21282
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.062051773071289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0620522499084473  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.025957107543945312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 22 input nodes size: 27980
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02356576919555664  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02356576919555664  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.03690767288208008  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.036928653717041016  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.019329547882080078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.019928455352783203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.019928455352783203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.019928455352783203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([27980, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.019928455352783203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([835, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.05241060256958008  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.05241060256958008  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 835, 128]), torch.Size([1, 835, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0532069206237793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.05957746505737305  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 835, 128])
m.shape torch.Size([883, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.060021400451660156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.060021400451660156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.060863494873046875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07349491119384766  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([788, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07448530197143555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07448530197143555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07523679733276367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09176969528198242  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([651, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09285497665405273  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09285497665405273  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0934758186340332  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11232137680053711  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([565, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1133580207824707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1133580207824707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11389684677124023  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1337442398071289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([487, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13486814498901367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13486814498901367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13533258438110352  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1553034782409668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([403, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1564164161682129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1564164161682129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 403, 128]), torch.Size([1, 403, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1568007469177246  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17601728439331055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 403, 128])
m.shape torch.Size([418, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17741966247558594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17741966247558594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17781829833984375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.20054054260253906  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([348, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.20183467864990234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.20183467864990234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.20216655731201172  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22340679168701172  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([4089, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24277210235595703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24277210235595703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 4089, 128]), torch.Size([1, 4089, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2466716766357422  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5239086151123047  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 4089, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.49500608444213867  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5040345191955566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5130629539489746  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5039639472961426  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([9467, 256])
first layer input nodes number: 27980
first layer output nodes number: 9467
edges number: 63503
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5132737159729004  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5223021507263184  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5254378318786621  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5254378318786621  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([565, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.542205810546875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.542205810546875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5432834625244141  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5519046783447266  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([466, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5522618293762207  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5522618293762207  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5531506538391113  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5672383308410645  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([336, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5677628517150879  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5677628517150879  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5684037208557129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5832595825195312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([256, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.58392333984375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.58392333984375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.58441162109375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.59857177734375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5996079444885254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5996079444885254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.600008487701416  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6144280433654785  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6150298118591309  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6150298118591309  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6152949333190918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6266951560974121  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([108, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6272892951965332  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6272892951965332  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.627495288848877  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6377949714660645  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6385302543640137  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6385302543640137  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6387381553649902  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6505885124206543  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6511077880859375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6511077880859375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6512451171875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6600341796875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6606097221374512  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6606097221374512  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6607375144958496  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6698107719421387  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([45, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6702227592468262  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6702227592468262  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6703085899353027  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6770033836364746  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6774449348449707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6774449348449707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6775250434875488  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6843342781066895  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6846942901611328  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6846942901611328  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6847553253173828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6903705596923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6908516883850098  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6908516883850098  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6909241676330566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6980996131896973  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([24, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6984095573425293  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6984095573425293  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6984553337097168  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7033076286315918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7035617828369141  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7035617828369141  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7035961151123047  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7074756622314453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7077364921569824  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7077364921569824  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7077689170837402  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7116599082946777  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7119555473327637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7119555473327637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7119898796081543  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7163500785827637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7166070938110352  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7166070938110352  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7166357040405273  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7204694747924805  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7207822799682617  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7207822799682617  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7208147048950195  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7253866195678711  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7256731986999512  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7256731986999512  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7257018089294434  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7299361228942871  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7301335334777832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7301335334777832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7301526069641113  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7331089973449707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7333207130432129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7333207130432129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.733339786529541  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7364296913146973  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7366046905517578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7366046905517578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7366199493408203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7391986846923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([144, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7426514625549316  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7426514625549316  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7429261207580566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7912659645080566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 144, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.777733325958252  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7781481742858887  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7785630226135254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7781271934509277  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2781, 40])
input nodes number: 9467
output nodes number: 2781
edges number: 16749
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7782206535339355  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7782211303710938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021106243133544922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 23 input nodes size: 31624
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.01933145523071289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.01933145523071289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.034410953521728516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.03443193435668945  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021069049835205078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021929264068603516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021929264068603516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021929264068603516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([31624, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021929264068603516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([676, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0674285888671875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0674285888671875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.06807327270507812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07323074340820312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([742, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07361602783203125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07361602783203125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 742, 128]), torch.Size([1, 742, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07432365417480469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08539819717407227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 742, 128])
m.shape torch.Size([581, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0858755111694336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0858755111694336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08642959594726562  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09872055053710938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([593, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09957456588745117  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09957456588745117  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10014009475708008  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11654043197631836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([564, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11760234832763672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11760234832763672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11814022064208984  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1380910873413086  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([531, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1393413543701172  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1393413543701172  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1398477554321289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16207599639892578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([488, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1634516716003418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1634516716003418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16391706466674805  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18718671798706055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([479, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1887812614440918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1887812614440918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1892380714416504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.21527624130249023  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([442, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.21694469451904297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.21694469451904297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.21736621856689453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24434375762939453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([6884, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2769584655761719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2769584655761719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 6884, 128]), torch.Size([1, 6884, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2835235595703125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7498588562011719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 6884, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7080245018005371  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.719449520111084  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7308745384216309  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7193598747253418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([11980, 256])
first layer input nodes number: 31624
first layer output nodes number: 11980
edges number: 92347
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7311124801635742  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7425374984741211  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7456560134887695  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7456560134887695  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([441, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7683024406433105  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7683024406433105  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7691435813903809  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7777915000915527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([390, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7781209945678711  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7781209945678711  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.778864860534668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7903814315795898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([238, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7906961441040039  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7906961441040039  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7911500930786133  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8011369705200195  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([197, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8016676902770996  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8016676902770996  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8020434379577637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8129401206970215  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8136415481567383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8136415481567383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8139944076538086  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8266973495483398  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8274726867675781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8274726867675781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8277873992919922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8413200378417969  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8420510292053223  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8420510292053223  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8423027992248535  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.854891300201416  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8555960655212402  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8555960655212402  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.855802059173584  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8675436973571777  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8681674003601074  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8681674003601074  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8683276176452637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8785815238952637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8792800903320312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8792800903320312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8794345855712891  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8904037475585938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8911089897155762  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8911089897155762  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8912501335144043  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.902259349822998  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9028811454772949  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9028811454772949  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9029955863952637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9127230644226074  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9131908416748047  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9131908416748047  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9132709503173828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9206409454345703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9210453033447266  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9210453033447266  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9211082458496094  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9273395538330078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9277839660644531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9277839660644531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9278469085693359  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9345188140869141  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9349641799926758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9349641799926758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.935023307800293  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9417047500610352  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9421982765197754  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9421982765197754  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9422593116760254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9495835304260254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9500894546508789  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9500894546508789  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9501485824584961  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9576578140258789  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9581947326660156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9581947326660156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9582538604736328  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9661769866943359  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.966609001159668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.966609001159668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9666547775268555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.973109245300293  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9734702110290527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9734702110290527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9735064506530762  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9788699150085449  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9792747497558594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9792747497558594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9793128967285156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9852256774902344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9854722023010254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9854722023010254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9854950904846191  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9892029762268066  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9896531105041504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9896531105041504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9896912574768066  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9961380958557129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([308, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0035200119018555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0035200119018555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0041074752807617  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1189050674438477  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 308, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0992746353149414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0996909141540527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.100107192993164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0996699333190918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2791, 40])
input nodes number: 11980
output nodes number: 2791
edges number: 22991
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0997819900512695  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0997824668884277  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.023499011993408203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 24 input nodes size: 45204
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021070480346679688  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021070480346679688  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.04262542724609375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.04264640808105469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.027545928955078125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02862834930419922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02862834930419922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02862834930419922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([45204, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02862834930419922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([717, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08846807479858398  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08846807479858398  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08915185928344727  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09513711929321289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([762, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09552192687988281  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09552192687988281  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 762, 128]), torch.Size([1, 762, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09624862670898438  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10794258117675781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 762, 128])
m.shape torch.Size([741, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10863924026489258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10863924026489258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 741, 128]), torch.Size([1, 741, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10934591293334961  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1257038116455078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 741, 128])
m.shape torch.Size([664, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1266169548034668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1266169548034668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.12725019454956055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.14585447311401367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([627, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1470327377319336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1470327377319336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1476306915283203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16925477981567383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([564, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17056941986083984  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17056941986083984  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17110729217529297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19494152069091797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([552, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19651508331298828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19651508331298828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19704151153564453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22416019439697266  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([499, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2258005142211914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2258005142211914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22627639770507812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2534017562866211  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([453, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2551078796386719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2551078796386719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 453, 128]), torch.Size([1, 453, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2555398941040039  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2831888198852539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 453, 128])
m.shape torch.Size([9610, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3287968635559082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3287968635559082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 9610, 128]), torch.Size([1, 9610, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.33796167373657227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9886631965637207  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 9610, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.933016300201416  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9475016593933105  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9619870185852051  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9473881721496582  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([15189, 256])
first layer input nodes number: 45204
first layer output nodes number: 15189
edges number: 121672
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9623260498046875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.976811408996582  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9805426597595215  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9805426597595215  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([436, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0036630630493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0036630630493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0044946670532227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0118122100830078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([386, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.012138843536377  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.012138843536377  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0128750801086426  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.024376392364502  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([280, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0248160362243652  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0248160362243652  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0253500938415527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0383009910583496  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([208, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0388336181640625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0388336181640625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0392303466796875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0507354736328125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([151, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0512628555297852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0512628555297852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0515508651733398  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0619192123413086  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.062577247619629  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.062577247619629  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0628423690795898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0742425918579102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.074951171875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.074951171875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0751895904541016  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0871105194091797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.087721824645996  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.087721824645996  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0879030227661133  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.098231315612793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.098867416381836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.098867416381836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0990276336669922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1092815399169922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1098265647888184  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1098265647888184  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1099505424499512  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1187529563903809  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1193785667419434  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1193785667419434  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1195025444030762  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1291728019714355  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1297106742858887  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1297106742858887  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.129809856414795  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1382403373718262  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1387405395507812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1387405395507812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.138824462890625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.14654541015625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1470017433166504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1470017433166504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1470723152160645  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1540589332580566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1544709205627441  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1544709205627441  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1545300483703613  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1607975959777832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.161168098449707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.161168098449707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1612176895141602  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1668214797973633  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1672053337097168  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1672053337097168  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.167253017425537  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1729750633239746  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1734356880187988  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1734356880187988  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1734890937805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1802716255187988  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1807928085327148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1807928085327148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1808500289916992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1885175704956055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.189065933227539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.189065933227539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1891231536865234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1971912384033203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1975059509277344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1975059509277344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1975383758544922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2023372650146484  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2026596069335938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2026596069335938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2026901245117188  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2074203491210938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.207913875579834  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.207913875579834  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2079577445983887  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.215064525604248  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2154812812805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2154812812805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.215517520904541  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.221642017364502  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([355, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.230642318725586  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.230642318725586  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2313194274902344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.360520362854004  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 355, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3403472900390625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3407597541809082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.341172218322754  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3407387733459473  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2767, 40])
input nodes number: 15189
output nodes number: 2767
edges number: 23488
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.340869426727295  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3408699035644531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.030591487884521484  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 25 input nodes size: 42855
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0275421142578125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0275421142578125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.04797697067260742  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.04799795150756836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02642202377319336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02731943130493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02731943130493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02731943130493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([42855, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02731943130493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([718, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0763697624206543  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0763697624206543  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 718, 128]), torch.Size([1, 718, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07705450057983398  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08253240585327148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 718, 128])
m.shape torch.Size([851, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08300161361694336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08300161361694336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08381319046020508  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09598684310913086  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([824, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09675979614257812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09675979614257812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09754562377929688  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11520767211914062  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([674, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11610031127929688  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11610031127929688  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11674308776855469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13548660278320312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([621, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13664579391479492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13664579391479492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1372380256652832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.15855836868286133  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([579, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.15991878509521484  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.15991878509521484  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16047096252441406  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18517541885375977  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([562, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18677520751953125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18677520751953125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18731117248535156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2143869400024414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([502, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.216033935546875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.216033935546875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.21651268005371094  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24380111694335938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([456, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24551868438720703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24551868438720703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24595355987548828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2737855911254883  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([7333, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3085346221923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3085346221923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 7333, 128]), torch.Size([1, 7333, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.31552791595458984  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8135652542114258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 7333, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7680988311767578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7806110382080078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7931232452392578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7805132865905762  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([13120, 256])
first layer input nodes number: 42855
first layer output nodes number: 13120
edges number: 99551
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7934446334838867  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8059568405151367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8090848922729492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8090848922729492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([438, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8295722007751465  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8295722007751465  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8304076194763184  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8378720283508301  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([412, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8382463455200195  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8382463455200195  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8390321731567383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8536777496337891  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8541440963745117  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8541440963745117  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8547124862670898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8738055229187012  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8744134902954102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8744134902954102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8748559951782227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8876886367797852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8883471488952637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8883471488952637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8886961936950684  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9012618064880371  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9019985198974609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9019985198974609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9022998809814453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9152584075927734  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9160366058349609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9160366058349609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9162998199462891  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9294605255126953  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9301981925964355  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9301981925964355  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9304137229919434  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9426989555358887  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9432315826416016  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9432315826416016  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9433727264404297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9524059295654297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([57, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.952883243560791  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.952883243560791  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9529919624328613  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9607110023498535  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9612278938293457  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9612278938293457  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9613308906555176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9693646430969238  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9700632095336914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9700632095336914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9701871871948242  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9807252883911133  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9811758995056152  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9811758995056152  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9812541007995605  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9884486198425293  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9887866973876953  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9887866973876953  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9888401031494141  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9941272735595703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9946198463439941  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9946198463439941  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9946885108947754  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.001966953277588  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.002394199371338  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.002394199371338  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0024514198303223  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0089173316955566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.009199619293213  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.009199619293213  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0092358589172363  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0135846138000488  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0141029357910156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0141029357910156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0141620635986328  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0216712951660156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.022153377532959  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.022153377532959  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0222067832946777  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0293631553649902  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.029740333557129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.029740333557129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.029780387878418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0354280471801758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.035771369934082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.035771369934082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0358057022094727  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0408868789672852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0411872863769531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0411872863769531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0412158966064453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0456504821777344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0459461212158203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0459461212158203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0459728240966797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0502986907958984  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0505623817443848  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0505623817443848  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0505852699279785  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0544533729553223  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([249, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0604252815246582  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0604252815246582  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0609002113342285  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1444878578186035  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 249, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1271882057189941  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1276001930236816  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1280121803283691  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1275792121887207  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2764, 40])
input nodes number: 13120
output nodes number: 2764
edges number: 20748
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.127697467803955  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1276979446411133  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.029016494750976562  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 26 input nodes size: 51251
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.026421546936035156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.026421546936035156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.050859928131103516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.05088090896606445  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.030425071716308594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.031864166259765625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.031864166259765625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.031864166259765625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([51251, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.031864166259765625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([595, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11219644546508789  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11219644546508789  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11276388168334961  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11793899536132812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([674, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11829805374145508  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11829805374145508  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11894083023071289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.12858247756958008  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([613, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.12913799285888672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.12913799285888672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.12972259521484375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.1431293487548828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([586, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.14395475387573242  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.14395475387573242  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.14451360702514648  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.1607203483581543  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([635, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.1619548797607422  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.1619548797607422  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.16256046295166016  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.18436145782470703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([593, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.18575525283813477  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.18575525283813477  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.18632078170776367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.21175765991210938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([593, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.2134542465209961  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.2134542465209961  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.214019775390625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.24288225173950195  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([593, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.24486160278320312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.24486160278320312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.24542713165283203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.2779655456542969  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([612, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.28030920028686523  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.28030920028686523  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.28089284896850586  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.3190760612487793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([13481, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.383237361907959  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.383237361907959  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 13481, 128]), torch.Size([1, 13481, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.39609384536743164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3108763694763184  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 13481, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2347636222839355  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2528595924377441  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2709555625915527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2527179718017578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([18975, 256])
first layer input nodes number: 51251
first layer output nodes number: 18975
edges number: 162072
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2713394165039062  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2894353866577148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.293959617614746  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.293959617614746  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([327, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.324143409729004  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.324143409729004  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3247671127319336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3300666809082031  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([287, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3303065299987793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3303065299987793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3308539390563965  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.342085361480713  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([209, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.342414379119873  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.342414379119873  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3428130149841309  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3515830039978027  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([153, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3519721031188965  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3519721031188965  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3522639274597168  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3607268333435059  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([164, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3613691329956055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3613691329956055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3616819381713867  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3729429244995117  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([112, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3734326362609863  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3734326362609863  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3736462593078613  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3828320503234863  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3833646774291992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3833646774291992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3835458755493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3926057815551758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([80, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3931303024291992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3931303024291992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3932828903198242  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4019804000854492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.402587890625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.402587890625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4027385711669922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4123821258544922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([58, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4128646850585938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4128646850585938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4129753112792969  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4208297729492188  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4215784072875977  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4215784072875977  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4217233657836914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.433030128479004  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4336614608764648  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4336614608764648  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4337778091430664  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4436674118041992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4444341659545898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4444341659545898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4445600509643555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.456141471862793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4567513465881348  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4567513465881348  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4568467140197754  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4662880897521973  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.46696138381958  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.46696138381958  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4670567512512207  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.477165699005127  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4779486656188965  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4779486656188965  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4780516624450684  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4896903038024902  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4902434349060059  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4902434349060059  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.49031400680542  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4987826347351074  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.499612808227539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.499612808227539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4997081756591797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.511819839477539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5123748779296875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5123748779296875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5124378204345703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5208721160888672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5215134620666504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5215134620666504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5215802192687988  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5309929847717285  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5317673683166504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5317673683166504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.531843662261963  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.543135166168213  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5437736511230469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5437736511230469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5438346862792969  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5532951354980469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5537734031677246  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5537734031677246  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5538172721862793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5609240531921387  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5614328384399414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5614328384399414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.561476707458496  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5688905715942383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([580, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5828051567077637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5828051567077637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.583911418914795  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.778613567352295  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 580, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7511200904846191  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7515335083007812  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7519469261169434  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7515125274658203  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([2774, 40])
input nodes number: 18975
output nodes number: 2774
edges number: 30949
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7516765594482422  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7516770362854004  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.034374237060546875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

pseudo mini batch 27 input nodes size: 48279
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030426502227783203  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030426502227783203  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.0538640022277832  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.05388498306274414  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.029425621032714844  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030744552612304688  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030744552612304688  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030744552612304688  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([48279, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030744552612304688  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

m.shape torch.Size([619, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10322952270507812  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10322952270507812  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1038198471069336  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10854244232177734  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([693, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10890817642211914  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10890817642211914  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10956907272338867  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11967182159423828  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([647, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12026691436767578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12026691436767578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 647, 128]), torch.Size([1, 647, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12088394165039062  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1344585418701172  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 647, 128])
m.shape torch.Size([566, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13522958755493164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13522958755493164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13576936721801758  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.15177011489868164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([580, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.15288305282592773  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.15288305282592773  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.15343618392944336  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.17409086227416992  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([566, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.17543363571166992  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.17543363571166992  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.17597341537475586  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1995558738708496  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([545, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.20110511779785156  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.20110511779785156  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.20162487030029297  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2282118797302246  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([516, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2299203872680664  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2299203872680664  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.23041248321533203  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.26016902923583984  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([520, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.26215457916259766  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.26215457916259766  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2626504898071289  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2948732376098633  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([12257, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.3530712127685547  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.3530712127685547  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 12257, 128]), torch.Size([1, 12257, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.36492300033569336  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1952099800109863  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 12257, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1267890930175781  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1434869766235352  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1601848602294922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1433563232421875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([17509, 256])
first layer input nodes number: 48279
first layer output nodes number: 17509
edges number: 147699
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1605467796325684  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1772446632385254  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1814193725585938  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1814193725585938  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

m.shape torch.Size([360, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2099652290344238  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2099652290344238  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2106518745422363  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.217517375946045  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([301, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2177529335021973  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2177529335021973  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2183270454406738  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2312145233154297  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([229, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2315878868103027  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2315878868103027  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2320246696472168  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2416338920593262  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([165, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2420501708984375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2420501708984375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2423648834228516  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2514915466308594  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([163, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.25211763381958  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.25211763381958  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2524285316467285  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2636208534240723  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2642555236816406  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2642555236816406  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.264516830444336  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2757530212402344  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.276214599609375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.276214599609375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2763824462890625  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2847747802734375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2854290008544922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2854290008544922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2856121063232422  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2960491180419922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.29671049118042  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.29671049118042  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2968764305114746  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3074965476989746  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3081440925598145  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3081440925598145  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3082890510559082  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3185811042785645  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3191008567810059  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3191008567810059  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3192076683044434  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3275389671325684  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.328223705291748  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.328223705291748  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.328345775604248  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.338721752166748  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3392481803894043  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3392481803894043  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3393378257751465  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3475852012634277  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3482403755187988  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3482403755187988  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.348339557647705  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3581585884094238  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3586859703063965  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3586859703063965  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.358762264251709  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.366849422454834  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3673958778381348  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3673958778381348  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3674683570861816  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3756585121154785  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3762760162353516  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3762760162353516  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.376352310180664  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.385507583618164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3859367370605469  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3859367370605469  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3859882354736328  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3925285339355469  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3929228782653809  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3929228782653809  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3929667472839355  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3988451957702637  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3993425369262695  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3993425369262695  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3993940353393555  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4066553115844727  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4072351455688477  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4072351455688477  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.407292366027832  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4157609939575195  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4162187576293945  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4162187576293945  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4162626266479492  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4230623245239258  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4235930442810059  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4235930442810059  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4236407279968262  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4313654899597168  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.431826114654541  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.431826114654541  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.43186616897583  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4386353492736816  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([562, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.452406883239746  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.452406883239746  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4534788131713867  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6451210975646973  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 562, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6193046569824219  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6197185516357422  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6201324462890625  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6196975708007812  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([2777, 40])
input nodes number: 17509
output nodes number: 2777
edges number: 29212
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.619849681854248  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6198501586914062  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.0330657958984375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

pseudo mini batch 28 input nodes size: 44305
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.029426097869873047  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.029426097869873047  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.05091047286987305  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.050931453704833984  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.027472972869873047  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028896808624267578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028896808624267578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028896808624267578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([44305, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028896808624267578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

m.shape torch.Size([531, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10579156875610352  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10579156875610352  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10629796981811523  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1106414794921875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([558, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11092042922973633  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11092042922973633  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11145257949829102  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11943483352661133  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([515, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11990547180175781  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11990547180175781  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12039661407470703  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13120174407958984  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([524, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13195562362670898  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13195562362670898  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13245534896850586  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.14730024337768555  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([479, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1481924057006836  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1481924057006836  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1486492156982422  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16509437561035156  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([495, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16628217697143555  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16628217697143555  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16675424575805664  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.18705320358276367  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([512, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.18852615356445312  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.18852615356445312  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.18901443481445312  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21342849731445312  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([494, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21506881713867188  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21506881713867188  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21553993225097656  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.24239349365234375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([494, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.24454355239868164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.24454355239868164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.24501466751098633  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.27516603469848633  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([13422, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.339383602142334  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.339383602142334  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 13422, 128]), torch.Size([1, 13422, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.35218381881713867  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2636466026306152  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 13422, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1903738975524902  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2075629234313965  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2247519493103027  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2074284553527832  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([18024, 256])
first layer input nodes number: 44305
first layer output nodes number: 18024
edges number: 156855
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2250843048095703  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2422733306884766  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2465705871582031  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2465705871582031  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

m.shape torch.Size([305, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2798099517822266  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2798099517822266  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2803916931152344  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.286184310913086  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([253, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2863798141479492  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2863798141479492  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2868623733520508  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2941007614135742  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([186, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.294395923614502  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.294395923614502  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.294750690460205  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3025555610656738  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([159, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3029894828796387  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3029894828796387  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3032927513122559  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3120875358581543  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([113, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.312479019165039  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.312479019165039  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3126945495605469  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3204536437988281  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([105, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3209514617919922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3209514617919922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3211517333984375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.329763412475586  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3302555084228516  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3302555084228516  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.330423355102539  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.338815689086914  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([75, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.339308738708496  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.339308738708496  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.339451789855957  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3476057052612305  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.348278522491455  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.348278522491455  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.348442554473877  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.358940601348877  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3595027923583984  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3595027923583984  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3596305847167969  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.368703842163086  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3693485260009766  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3693485260009766  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.369476318359375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3794441223144531  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.380049228668213  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.380049228668213  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.380159854888916  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3895630836486816  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.390244960784912  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.390244960784912  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.390357494354248  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4007105827331543  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.401179313659668  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.401179313659668  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4012537002563477  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4086179733276367  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4090137481689453  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4090137481689453  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4090709686279297  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4151363372802734  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.415738582611084  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.415738582611084  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4158167839050293  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4246535301208496  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4252357482910156  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4252357482910156  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4253082275390625  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4340057373046875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.434661865234375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.434661865234375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4347381591796875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.444427490234375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4449920654296875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4449920654296875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4450550079345703  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4534893035888672  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4540538787841797  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4540538787841797  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4541130065917969  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4624500274658203  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4631071090698242  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4631071090698242  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4631719589233398  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4727697372436523  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4732451438903809  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4732451438903809  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4732909202575684  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4803862571716309  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.480982780456543  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.480982780456543  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4810361862182617  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4896879196166992  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4904227256774902  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4904227256774902  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.490485668182373  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5011229515075684  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([766, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5194973945617676  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5194973945617676  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 766, 256]), torch.Size([1, 766, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.520958423614502  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7788739204406738  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 766, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7481346130371094  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7485456466674805  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7489566802978516  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7485246658325195  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

torch.Size([2758, 40])
input nodes number: 18024
output nodes number: 2758
edges number: 34153
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7486772537231445  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7486777305603027  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.031337738037109375  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

pseudo mini batch 29 input nodes size: 43021
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.04895448684692383  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.04897594451904297  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.02747058868408203  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028966903686523438  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028966903686523438  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028966903686523438  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

torch.Size([43021, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028966903686523438  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

m.shape torch.Size([482, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10922384262084961  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10922384262084961  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10968351364135742  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11336088180541992  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([456, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11356592178344727  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11356592178344727  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11400079727172852  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12052392959594727  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([451, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12095165252685547  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12095165252685547  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12138175964355469  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1308441162109375  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([500, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13158273696899414  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13158273696899414  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13205957412719727  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1458878517150879  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([538, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.14693212509155273  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.14693212509155273  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1474452018737793  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16681909561157227  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([494, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16797590255737305  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16797590255737305  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16844701766967773  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1887049674987793  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([490, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.19010496139526367  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.19010496139526367  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.19057226181030273  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21393728256225586  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([484, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21554994583129883  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21554994583129883  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21601152420043945  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.24232149124145508  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([481, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2441549301147461  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2441549301147461  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2446136474609375  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2739715576171875  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([14025, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7635498046875 GB
    Memory Allocated: 0.3406186103820801  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7635498046875 GB
    Memory Allocated: 0.3406186103820801  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 14025, 128]), torch.Size([1, 14025, 128])
----------------------------------------3
 Nvidia-smi: 3.7635498046875 GB
    Memory Allocated: 0.35399389266967773  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3184685707092285  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 14025, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2420806884765625  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.259629249572754  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2771778106689453  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2594919204711914  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

torch.Size([18401, 256])
first layer input nodes number: 43021
first layer output nodes number: 18401
edges number: 162282
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2775006294250488  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2950491905212402  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.299548625946045  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.299548625946045  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

m.shape torch.Size([264, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3369231224060059  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3369231224060059  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3374266624450684  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3438820838928223  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([199, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3440132141113281  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3440132141113281  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3443927764892578  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3500862121582031  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([151, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.350332260131836  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.350332260131836  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3506202697753906  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3569564819335938  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([144, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3573660850524902  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3573660850524902  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3576407432556152  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3656058311462402  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([140, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3661413192749023  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3661413192749023  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.366408348083496  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.376021385192871  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([106, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3764991760253906  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3764991760253906  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3767013549804688  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3853950500488281  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([90, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.385899543762207  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.385899543762207  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3860712051391602  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3946542739868164  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([63, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3950529098510742  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3950529098510742  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3951730728149414  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.402022361755371  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([67, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4025421142578125  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4025421142578125  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.402669906616211  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.410848617553711  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4115824699401855  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4115824699401855  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.411740779876709  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.422980785369873  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4236946105957031  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4236946105957031  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.423837661743164  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4349956512451172  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4357895851135254  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4357895851135254  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4359326362609863  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.448091983795166  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4489326477050781  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4489326477050781  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4490718841552734  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4618816375732422  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4624581336975098  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4624581336975098  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4625496864318848  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4716134071350098  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4723320007324219  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4723320007324219  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.472433090209961  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4831485748291016  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4838056564331055  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4838056564331055  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4838933944702148  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4938077926635742  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4945158958435059  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4945158958435059  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4946036338806152  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5051321983337402  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5060930252075195  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5060930252075195  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5062036514282227  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5202531814575195  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5211658477783203  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5211658477783203  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5212669372558594  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5348129272460938  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5356082916259766  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5356082916259766  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5356922149658203  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.547525405883789  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5494747161865234  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5494747161865234  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5495738983154297  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5642528533935547  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.564964771270752  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.564964771270752  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5650334358215332  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.575676441192627  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.576460361480713  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.576460361480713  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.576530933380127  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.587963581085205  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.588620662689209  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.588620662689209  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5886778831481934  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5983481407165527  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([834, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.618359088897705  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.618359088897705  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.6199498176574707  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.9030184745788574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 834, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.8686585426330566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.8690857887268066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.8695130348205566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.8690643310546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2867, 40])
input nodes number: 18401
output nodes number: 2867
edges number: 38489
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.869239330291748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.8692398071289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03153181076049805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 30 input nodes size: 46428
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.027486801147460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.027486801147460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.049625396728515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04964637756347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028140544891357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.029444217681884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.029444217681884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.029444217681884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([46428, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.029444217681884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([627, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10104084014892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10104084014892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1016387939453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10652542114257812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([655, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10685110092163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10685110092163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10747575759887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11684560775756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([636, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11744308471679688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11744308471679688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11804962158203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1313934326171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([577, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13226842880249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13226842880249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13281869888305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14963674545288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([574, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15073013305664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15073013305664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1512775421142578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17157840728759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([526, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17280960083007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17280960083007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1733112335205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19511985778808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([534, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19665145874023438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19665145874023438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1971607208251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22319507598876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([534, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2249774932861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2249774932861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22548675537109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.25487327575683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([496, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2567472457885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2567472457885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2572202682495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2874937057495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([12122, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3450593948364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3450593948364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12122, 128]), torch.Size([1, 12122, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.35749053955078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1801815032958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12122, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1118836402893066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.128364086151123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1448445320129395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.12823486328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17281, 256])
first layer input nodes number: 46428
first layer output nodes number: 17281
edges number: 145873
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1451926231384277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1616730690002441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.165895938873291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.165895938873291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([391, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1943011283874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1943011283874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1950469017028809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.202843189239502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([290, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2030282020568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2030282020568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2035813331604004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2127165794372559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([236, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.213120937347412  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.213120937347412  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2135710716247559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2234740257263184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([173, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2239141464233398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2239141464233398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2242441177368164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2338132858276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([150, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2343692779541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2343692779541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2346553802490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.244955062866211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([127, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.24554443359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.24554443359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2457866668701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2562026977539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.256721019744873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.256721019744873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2569022178649902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2659621238708496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([83, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.266510009765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.266510009765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2666683197021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2756919860839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2762703895568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2762703895568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2764153480529785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2856926918029785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2862257957458496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2862257957458496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2863459587097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.294877529144287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2953357696533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2953357696533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2954292297363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3027191162109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3033990859985352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3033990859985352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3035192489624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3137331008911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.314298152923584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.314298152923584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3143935203552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.323167324066162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3236579895019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3236579895019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3237342834472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3312873840332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3317971229553223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3317971229553223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3318696022033691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.339552402496338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3400545120239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3400545120239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3401212692260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3476648330688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.348219871520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.348219871520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3482885360717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3565282821655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3569960594177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3569960594177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3570513725280762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3640761375427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3646697998046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3646697998046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3647346496582031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3734245300292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3741226196289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3741226196289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3741950988769531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3844146728515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3849034309387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3849034309387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3849530220031738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3922924995422363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.392669677734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.392669677734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3927059173583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3983230590820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3986587524414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3986587524414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3986892700195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4036331176757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4041485786437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4041485786437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4041924476623535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4116063117980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([578, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4254727363586426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4254727363586426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4265751838684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.6232447624206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 578, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5975637435913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5979747772216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5983858108520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5979537963867188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 17281
output nodes number: 2758
edges number: 29035
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5980877876281738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.598088264465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03171396255493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 31 input nodes size: 45091
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028124332427978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028124332427978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.049625396728515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04964637756347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.027486801147460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028757095336914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028757095336914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028757095336914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([45091, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028757095336914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([646, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09911584854125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09911584854125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0997319221496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10536479949951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([649, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10567569732666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10567569732666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 649, 128]), torch.Size([1, 649, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10629463195800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11557865142822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 649, 128])
m.shape torch.Size([583, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1161031723022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1161031723022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11665916442871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1288909912109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([597, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12975168228149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12975168228149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13032102584838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14683198928833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([562, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14793968200683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14793968200683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14847564697265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1677703857421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([507, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16895294189453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16895294189453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16943645477294922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19022750854492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([508, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1919875144958496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1919875144958496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19247198104858398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21669530868530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([470, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2182459831237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2182459831237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21869421005249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24424314498901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([512, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2462162971496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2462162971496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2467045783996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2779545783996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([11795, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3339533805847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3339533805847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11795, 128]), torch.Size([1, 11795, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3452019691467285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1457324028015137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11795, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.0794525146484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.0955018997192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.111551284790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.0953764915466309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16829, 256])
first layer input nodes number: 45091
first layer output nodes number: 16829
edges number: 141807
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.111889362335205  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1279387474060059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1322312355041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1322312355041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([373, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1601872444152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1601872444152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1608986854553223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1665902137756348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([325, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1668596267700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1668596267700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1674795150756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.177314281463623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([201, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.177584171295166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.177584171295166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1779675483703613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1864018440246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([188, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1869330406188965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1869330406188965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1872916221618652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.197690486907959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1983909606933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1983909606933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.198740005493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2113056182861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([105, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2117366790771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2117366790771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2119369506835938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2205486297607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([96, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2210946083068848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2210946083068848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2212777137756348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2304329872131348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([71, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2308874130249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2308874130249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.231022834777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2387418746948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.239427089691162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.239427089691162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2395930290222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2502131462097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2509279251098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2509279251098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2510862350463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2623262405395508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2628602981567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2628602981567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2629709243774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2715997695922852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2721099853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2721099853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2722034454345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2801475524902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2807259559631348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2807259559631348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2808213233947754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.289595127105713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2900590896606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2900590896606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2901315689086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.297307014465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2978620529174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2978620529174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2979402542114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.306229591369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3068366050720215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3068366050720215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3069167137145996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3159689903259277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3165335655212402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3165335655212402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3166041374206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3250727653503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3254876136779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3254876136779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3255372047424316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3318352699279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3325228691101074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3325228691101074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.332597255706787  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3425650596618652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3430280685424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3430280685424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3430776596069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3500699996948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.350691318511963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.350691318511963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.350752353668213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.359785556793213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3601994514465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3601994514465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3602395057678223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.366447925567627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3668479919433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3668479919433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3668842315673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3727550506591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes
[05:32:35] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28960368 edges into 32 parts and get 9152996 edge cuts

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3730602264404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3730602264404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.373086929321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3775997161865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([554, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3908982276916504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3908982276916504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3919548988342285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5970125198364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 554, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5717830657958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5721940994262695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5726051330566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5721731185913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 16829
output nodes number: 2758
edges number: 28586
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.572319507598877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5723199844360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.030985355377197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03653573989868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03653573989868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009694963693618774 |0.012682989239692688 |0.13109706342220306 |8.807331323623657e-05 |0.07569184899330139 |0.006258726119995117 |
----------------------------------------------------------pseudo_mini_loss sum 5.332906723022461
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1128952
Number of first layer input nodes during this epoch:  809449
Number of first layer output nodes during this epoch:  319503
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03653526306152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.023106813430786133
global_2_local spend time (sec) 0.047321319580078125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004422664642333984
A = g.adjacency_matrix() spent  0.009093284606933594
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0848076343536377
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3212809562683105
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1668179035186768

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 1.288 seconds
Metis partitioning: 5.682 seconds
Split the graph: 0.648 seconds
Construct subgraphs: 0.080 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.71251916885376
2788
2877
2865
2919
2820
2859
2927
2802
2921
2910
2888
2868
2909
2913
2924
2902
2772
2832
2780
2919
2833
2777
2762
2825
2844
2758
2794
2828
2758
2759
2850
2758
total k batches seeds list generation spend  17.563045024871826
after graph partition
graph partition algorithm spend time 17.651773691177368
2788
2877
2865
2919
2820
2859
2927
2802
2921
2910
2888
2868
2909
2913
2924
2902
2772
2832
2780
2919
2833
2777
2762
2825
2844
2758
2794
2828
2758
2759
2850
2758
partition_len_list
[5548, 5255, 5799, 6357, 6825, 6978, 7235, 8998, 5372, 5826, 7511, 6163, 8428, 6600, 7934, 5875, 6115, 8725, 9309, 7963, 7336, 10851, 10805, 12193, 18502, 15982, 15417, 17498, 16824, 18533, 16436, 17936]
shared_neighbor_graph_partition_s0 selection method  spend 17.757283926010132
time for parepare:  0.01899266242980957
local_output_nid generation:  0.0008018016815185547
local_in_edges_tensor generation:  0.0009129047393798828
mini_batch_src_global generation:  0.0010323524475097656
r_  generation:  0.006594657897949219
local_output_nid generation:  0.0008258819580078125
local_in_edges_tensor generation:  0.0007560253143310547
mini_batch_src_global generation:  0.0007266998291015625
r_  generation:  0.0050389766693115234
local_output_nid generation:  0.0008194446563720703
local_in_edges_tensor generation:  0.0007259845733642578
mini_batch_src_global generation:  0.0009124279022216797
r_  generation:  0.007367610931396484
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0007293224334716797
mini_batch_src_global generation:  0.0008900165557861328
r_  generation:  0.007522106170654297
local_output_nid generation:  0.0008571147918701172
local_in_edges_tensor generation:  0.0006949901580810547
mini_batch_src_global generation:  0.0008122920989990234
r_  generation:  0.0067026615142822266
local_output_nid generation:  0.0009012222290039062
local_in_edges_tensor generation:  0.0006814002990722656
mini_batch_src_global generation:  0.0008192062377929688
r_  generation:  0.007251739501953125
local_output_nid generation:  0.0009083747863769531
local_in_edges_tensor generation:  0.0007150173187255859
mini_batch_src_global generation:  0.0008366107940673828
r_  generation:  0.0077702999114990234
local_output_nid generation:  0.000881195068359375
local_in_edges_tensor generation:  0.0006577968597412109
mini_batch_src_global generation:  0.0007612705230712891
r_  generation:  0.006426572799682617
local_output_nid generation:  0.0009136199951171875
local_in_edges_tensor generation:  0.0006632804870605469
mini_batch_src_global generation:  0.0006082057952880859
r_  generation:  0.005145072937011719
local_output_nid generation:  0.00090789794921875
local_in_edges_tensor generation:  0.0006551742553710938
mini_batch_src_global generation:  0.0006237030029296875
r_  generation:  0.005371809005737305
local_output_nid generation:  0.0009071826934814453
local_in_edges_tensor generation:  0.0006785392761230469
mini_batch_src_global generation:  0.0007431507110595703
r_  generation:  0.006298542022705078
local_output_nid generation:  0.0009236335754394531
local_in_edges_tensor generation:  0.0006763935089111328
mini_batch_src_global generation:  0.0007650852203369141
r_  generation:  0.006752729415893555
local_output_nid generation:  0.0009076595306396484
local_in_edges_tensor generation:  0.0006873607635498047
mini_batch_src_global generation:  0.0008604526519775391
r_  generation:  0.007018566131591797
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0006589889526367188
mini_batch_src_global generation:  0.0008721351623535156
r_  generation:  0.007481098175048828
local_output_nid generation:  0.0009253025054931641
local_in_edges_tensor generation:  0.0006697177886962891
mini_batch_src_global generation:  0.0008656978607177734
r_  generation:  0.007278919219970703
local_output_nid generation:  0.0009102821350097656
local_in_edges_tensor generation:  0.0006363391876220703
mini_batch_src_global generation:  0.0007085800170898438
r_  generation:  0.006456613540649414
local_output_nid generation:  0.0008616447448730469
local_in_edges_tensor generation:  0.00063323974609375
mini_batch_src_global generation:  0.0006072521209716797
r_  generation:  0.007115602493286133
local_output_nid generation:  0.0009336471557617188
local_in_edges_tensor generation:  0.0006334781646728516
mini_batch_src_global generation:  0.0007436275482177734
r_  generation:  0.006337642669677734
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0006198883056640625
mini_batch_src_global generation:  0.0006823539733886719
r_  generation:  0.005700111389160156
local_output_nid generation:  0.0009429454803466797
local_in_edges_tensor generation:  0.0006608963012695312
mini_batch_src_global generation:  0.0006701946258544922
r_  generation:  0.0059282779693603516
local_output_nid generation:  0.000904083251953125
local_in_edges_tensor generation:  0.0006234645843505859
mini_batch_src_global generation:  0.0006284713745117188
r_  generation:  0.005594491958618164
local_output_nid generation:  0.0008428096771240234
local_in_edges_tensor generation:  0.0005946159362792969
mini_batch_src_global generation:  0.0006952285766601562
r_  generation:  0.005465507507324219
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.00061798095703125
mini_batch_src_global generation:  0.0006613731384277344
r_  generation:  0.005541563034057617
local_output_nid generation:  0.0008513927459716797
local_in_edges_tensor generation:  0.0006399154663085938
mini_batch_src_global generation:  0.0008866786956787109
r_  generation:  0.007536888122558594
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0007119178771972656
mini_batch_src_global generation:  0.001247406005859375
r_  generation:  0.009394645690917969
local_output_nid generation:  0.0009369850158691406
local_in_edges_tensor generation:  0.0007245540618896484
mini_batch_src_global generation:  0.0013763904571533203
r_  generation:  0.012958049774169922
local_output_nid generation:  0.0010454654693603516
local_in_edges_tensor generation:  0.0007300376892089844
mini_batch_src_global generation:  0.0010831356048583984
r_  generation:  0.008363723754882812
local_output_nid generation:  0.0010297298431396484
local_in_edges_tensor generation:  0.0007338523864746094
mini_batch_src_global generation:  0.0010695457458496094
r_  generation:  0.009211301803588867
local_output_nid generation:  0.0009472370147705078
local_in_edges_tensor generation:  0.0006797313690185547
mini_batch_src_global generation:  0.00107574462890625
r_  generation:  0.008860588073730469
local_output_nid generation:  0.0009944438934326172
local_in_edges_tensor generation:  0.0007812976837158203
mini_batch_src_global generation:  0.001314401626586914
r_  generation:  0.01329803466796875
local_output_nid generation:  0.001043558120727539
local_in_edges_tensor generation:  0.0007677078247070312
mini_batch_src_global generation:  0.0013613700866699219
r_  generation:  0.014494180679321289
local_output_nid generation:  0.0009684562683105469
local_in_edges_tensor generation:  0.0007193088531494141
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.009296178817749023
----------------------check_connections_block total spend ----------------------------- 0.411637544631958
generate_one_block  0.016854047775268555
generate_one_block  0.008979082107543945
generate_one_block  0.011144876480102539
generate_one_block  0.011245489120483398
generate_one_block  0.010216951370239258
generate_one_block  0.010855436325073242
generate_one_block  0.011394977569580078
generate_one_block  0.010445117950439453
generate_one_block  0.007396697998046875
generate_one_block  0.007924556732177734
generate_one_block  0.009813070297241211
generate_one_block  0.009691715240478516
generate_one_block  0.01080632209777832
generate_one_block  0.010768413543701172
generate_one_block  0.010933876037597656
generate_one_block  0.008788585662841797
generate_one_block  0.01268458366394043
generate_one_block  0.009914398193359375
generate_one_block  0.009207487106323242
generate_one_block  0.008815288543701172
generate_one_block  0.008493661880493164
generate_one_block  0.009216547012329102
generate_one_block  0.008957147598266602
generate_one_block  0.011483192443847656
generate_one_block  0.01620197296142578
generate_one_block  0.0158388614654541
generate_one_block  0.015833616256713867
generate_one_block  0.01619124412536621
generate_one_block  0.014067888259887695
generate_one_block  0.016072988510131836
generate_one_block  0.021708965301513672
generate_one_block  0.018183469772338867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0366513729095459
gen group dst list time:  0.009487390518188477
time for parepare:  0.02226734161376953
local_output_nid generation:  0.0013566017150878906
local_in_edges_tensor generation:  0.009047746658325195
mini_batch_src_global generation:  0.0012929439544677734
r_  generation:  0.01253819465637207
local_output_nid generation:  0.0015277862548828125
local_in_edges_tensor generation:  0.0014257431030273438
mini_batch_src_global generation:  0.0012793540954589844
r_  generation:  0.008618831634521484
local_output_nid generation:  0.0017740726470947266
local_in_edges_tensor generation:  0.0014655590057373047
mini_batch_src_global generation:  0.0010478496551513672
r_  generation:  0.025768280029296875
local_output_nid generation:  0.0033957958221435547
local_in_edges_tensor generation:  0.0022013187408447266
mini_batch_src_global generation:  0.0017750263214111328
r_  generation:  0.01513814926147461
local_output_nid generation:  0.003114461898803711
local_in_edges_tensor generation:  0.0019109249114990234
mini_batch_src_global generation:  0.0013041496276855469
r_  generation:  0.016129255294799805
local_output_nid generation:  0.00943899154663086
local_in_edges_tensor generation:  0.0019867420196533203
mini_batch_src_global generation:  0.0017383098602294922
r_  generation:  0.016496896743774414
local_output_nid generation:  0.0038475990295410156
local_in_edges_tensor generation:  0.002156972885131836
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.01723647117614746
local_output_nid generation:  0.0036377906799316406
local_in_edges_tensor generation:  0.002454042434692383
mini_batch_src_global generation:  0.0016889572143554688
r_  generation:  0.020453691482543945
local_output_nid generation:  0.002209901809692383
local_in_edges_tensor generation:  0.001373291015625
mini_batch_src_global generation:  0.001306772232055664
r_  generation:  0.009186267852783203
local_output_nid generation:  0.0022399425506591797
local_in_edges_tensor generation:  0.0014002323150634766
mini_batch_src_global generation:  0.0011239051818847656
r_  generation:  0.009856939315795898
local_output_nid generation:  0.002971649169921875
local_in_edges_tensor generation:  0.0019173622131347656
mini_batch_src_global generation:  0.0014619827270507812
r_  generation:  0.016581296920776367
local_output_nid generation:  0.0026569366455078125
local_in_edges_tensor generation:  0.0016071796417236328
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.013436317443847656
local_output_nid generation:  0.003217935562133789
local_in_edges_tensor generation:  0.002327442169189453
mini_batch_src_global generation:  0.0042209625244140625
r_  generation:  0.0195004940032959
local_output_nid generation:  0.003895282745361328
local_in_edges_tensor generation:  0.002225160598754883
mini_batch_src_global generation:  0.015868186950683594
r_  generation:  0.017867326736450195
local_output_nid generation:  0.0035958290100097656
local_in_edges_tensor generation:  0.002256155014038086
mini_batch_src_global generation:  0.0014851093292236328
r_  generation:  0.03493809700012207
local_output_nid generation:  0.0030364990234375
local_in_edges_tensor generation:  0.0025277137756347656
mini_batch_src_global generation:  0.0018885135650634766
r_  generation:  0.013322591781616211
local_output_nid generation:  0.0026602745056152344
local_in_edges_tensor generation:  0.0016722679138183594
mini_batch_src_global generation:  0.0009458065032958984
r_  generation:  0.012585163116455078
local_output_nid generation:  0.0033643245697021484
local_in_edges_tensor generation:  0.0021898746490478516
mini_batch_src_global generation:  0.0016393661499023438
r_  generation:  0.03928089141845703
local_output_nid generation:  0.004236936569213867
local_in_edges_tensor generation:  0.0032351016998291016
mini_batch_src_global generation:  0.002819061279296875
r_  generation:  0.023022174835205078
local_output_nid generation:  0.0031478404998779297
local_in_edges_tensor generation:  0.0021467208862304688
mini_batch_src_global generation:  0.0015978813171386719
r_  generation:  0.030887126922607422
local_output_nid generation:  0.003500223159790039
local_in_edges_tensor generation:  0.0025701522827148438
mini_batch_src_global generation:  0.0021963119506835938
r_  generation:  0.016252994537353516
local_output_nid generation:  0.004233360290527344
local_in_edges_tensor generation:  0.002933979034423828
mini_batch_src_global generation:  0.0022094249725341797
r_  generation:  0.027136802673339844
local_output_nid generation:  0.0040667057037353516
local_in_edges_tensor generation:  0.0036780834197998047
mini_batch_src_global generation:  0.004470109939575195
r_  generation:  0.03051161766052246
local_output_nid generation:  0.005558967590332031
local_in_edges_tensor generation:  0.003936767578125
mini_batch_src_global generation:  0.003165721893310547
r_  generation:  0.03495478630065918
local_output_nid generation:  0.009608030319213867
local_in_edges_tensor generation:  0.007874488830566406
mini_batch_src_global generation:  0.01101827621459961
r_  generation:  0.0583798885345459
local_output_nid generation:  0.005963325500488281
local_in_edges_tensor generation:  0.0043621063232421875
mini_batch_src_global generation:  0.0066301822662353516
r_  generation:  0.04893302917480469
local_output_nid generation:  0.005948781967163086
local_in_edges_tensor generation:  0.0042879581451416016
mini_batch_src_global generation:  0.02603626251220703
r_  generation:  0.04602527618408203
local_output_nid generation:  0.006209135055541992
local_in_edges_tensor generation:  0.005190849304199219
mini_batch_src_global generation:  0.006829738616943359
r_  generation:  0.05972647666931152
local_output_nid generation:  0.006375789642333984
local_in_edges_tensor generation:  0.0077056884765625
mini_batch_src_global generation:  0.006804943084716797
r_  generation:  0.05100107192993164
local_output_nid generation:  0.008043766021728516
local_in_edges_tensor generation:  0.005928754806518555
mini_batch_src_global generation:  0.00859379768371582
r_  generation:  0.0566256046295166
local_output_nid generation:  0.005911111831665039
local_in_edges_tensor generation:  0.0052967071533203125
mini_batch_src_global generation:  0.005806446075439453
r_  generation:  0.0493772029876709
local_output_nid generation:  0.0065004825592041016
local_in_edges_tensor generation:  0.005538463592529297
mini_batch_src_global generation:  0.006305217742919922
r_  generation:  0.05552363395690918
----------------------check_connections_block total spend ----------------------------- 1.539468765258789
generate_one_block  0.03616738319396973
generate_one_block  0.03262615203857422
generate_one_block  0.018894433975219727
generate_one_block  0.022693872451782227
generate_one_block  0.021838903427124023
generate_one_block  0.024809598922729492
generate_one_block  0.024260282516479492
generate_one_block  0.02912116050720215
generate_one_block  0.013362407684326172
generate_one_block  0.014221906661987305
generate_one_block  0.023064374923706055
generate_one_block  0.018488168716430664
generate_one_block  0.02804708480834961
generate_one_block  0.021703481674194336
generate_one_block  0.024469852447509766
generate_one_block  0.0244143009185791
generate_one_block  0.0190584659576416
generate_one_block  0.027798175811767578
generate_one_block  0.02985072135925293
generate_one_block  0.0235135555267334
generate_one_block  0.02093219757080078
generate_one_block  0.03970217704772949
generate_one_block  0.03854537010192871
generate_one_block  0.04539990425109863
generate_one_block  0.07523322105407715
generate_one_block  0.06306219100952148
generate_one_block  0.05869603157043457
generate_one_block  0.06867861747741699
generate_one_block  0.06834912300109863
generate_one_block  0.07904052734375
generate_one_block  0.06856226921081543
generate_one_block  0.07613086700439453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03653526306152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

connection checking time:  1.539468765258789
block generation total time  1.180736780166626
average batch blocks generation time:  0.03689802438020706
block dataloader generation time/epoch 21.542696237564087
pseudo mini batch 0 input nodes size: 11462
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.033036231994628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.033036231994628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.038501739501953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03852272033691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017000675201416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017437458038330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017437458038330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017437458038330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([11462, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017437458038330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([489, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03517961502075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03517961502075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03564596176147461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03937673568725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([543, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.039661407470703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.039661407470703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04017925262451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.048378944396972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([505, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.048842430114746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.048842430114746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04932403564453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05991935729980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([462, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.060559749603271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.060559749603271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06100034713745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07377767562866211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([354, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0744013786315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0744013786315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 354, 128]), torch.Size([1, 354, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07473897933959961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08689260482788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 354, 128])
m.shape torch.Size([323, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08764791488647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08764791488647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08795595169067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10120153427124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([298, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10204219818115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10204219818115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 298, 128]), torch.Size([1, 298, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1023263931274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11653614044189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 298, 128])
m.shape torch.Size([260, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1173858642578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1173858642578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11763381958007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13176727294921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([242, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13268184661865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13268184661865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 242, 128]), torch.Size([1, 242, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13291263580322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14768314361572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 242, 128])
m.shape torch.Size([2072, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15744781494140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15744781494140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2072, 128]), torch.Size([1, 2072, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.159423828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3050394058227539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2072, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.28879880905151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.29408979415893555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2993807792663574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2940483093261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5548, 256])
first layer input nodes number: 11462
first layer output nodes number: 5548
edges number: 35710
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2994685173034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.30475950241088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.30608224868774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.30608224868774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([354, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3284735679626465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3284735679626465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3291487693786621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3349137306213379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([352, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3352527618408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3352527618408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3359241485595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3459949493408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.34648990631103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.34648990631103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.34703922271728516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3601188659667969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([248, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3607978820800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3607978820800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3612709045410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3749885559082031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3756222724914551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3756222724914551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.37596750259399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3883957862854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.38908863067626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.38908863067626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3893747329711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40167713165283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40245580673217773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40245580673217773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40271711349487305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.41578245162963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.41648244857788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.41648244857788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4166884422302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.42843008041381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4292788505554199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4292788505554199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4294886589050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4429163932800293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44353246688842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44353246688842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44367551803588867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.45383214950561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4543952941894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4543952941894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4545097351074219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4634361267089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([91, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4644622802734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4644622802734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46463584899902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4793891906738281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.47999000549316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.47999000549316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48009490966796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48974609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.49036645889282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.49036645889282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4904618263244629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.49990320205688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5004324913024902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5004324913024902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5005087852478027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5085959434509277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5091114044189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5091114044189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5091800689697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5169391632080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5175585746765137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5175585746765137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5176348686218262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5267901420593262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5274615287780762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5274615287780762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5275397300720215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5374712944030762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5380167961120605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5380167961120605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5380778312683105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5462565422058105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.546572208404541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.546572208404541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5466065406799316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5514473915100098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5520763397216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5520763397216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5521373748779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5611705780029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5615420341491699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5615420341491699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5615782737731934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5671954154968262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5676860809326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5676860809326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5677299499511719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5748367309570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5751609802246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5751609802246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5751895904541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5800247192382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([233, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5856094360351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5856094360351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5860538482666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6642704010009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 233, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6448793411254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6452951431274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6457109451293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6452741622924805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2788, 40])
input nodes number: 5548
output nodes number: 2788
edges number: 22815
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6453413963317871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6453423500061035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.018292903900146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 1 input nodes size: 10816
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017006397247314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017006397247314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.022163867950439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.022185325622558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.016698837280273438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017004966735839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017004966735839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017004966735839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([10816, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017004966735839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([865, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.030106067657470703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.030106067657470703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03093099594116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03804636001586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([813, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03840923309326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03840923309326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0391845703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05156707763671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([646, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.052103519439697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.052103519439697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0527195930480957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06671524047851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([526, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06741046905517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06741046905517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06791210174560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08255863189697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([432, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08333778381347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08333778381347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08374977111816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09858131408691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([336, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09933662414550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09933662414550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09965705871582031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11343574523925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 336, 128])
m.shape torch.Size([238, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11406993865966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11406993865966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11429691314697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12564563751220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 238, 128])
m.shape torch.Size([206, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12631797790527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12631797790527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 206, 128]), torch.Size([1, 206, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12651443481445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1377124786376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 206, 128])
m.shape torch.Size([176, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13836956024169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13836956024169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13853740692138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14927959442138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([1017, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15404510498046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15404510498046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1017, 128]), torch.Size([1, 1017, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1550149917602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22414398193359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1017, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21376800537109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2187795639038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22379112243652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21873998641967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5255, 256])
first layer input nodes number: 10816
first layer output nodes number: 5255
edges number: 25777
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22387361526489258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22888517379760742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.23013830184936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.23013830184936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([639, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24548959732055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24548959732055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 639, 256]), torch.Size([1, 639, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24670839309692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2565269470214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 639, 256])
m.shape torch.Size([496, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.25687122344970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.25687122344970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.25781726837158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2726898193359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([360, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.27347803115844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.27347803115844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.27416467666625977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2897148132324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2904648780822754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2904648780822754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.29097795486450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3058609962463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3066573143005371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3066573143005371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.30707502365112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3221125602722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.32292699813842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.32292699813842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.32326459884643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3377814292907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([102, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3382992744445801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3382992744445801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.33849382400512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3482213020324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([92, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3488316535949707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3488316535949707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.34900712966918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3590092658996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3596053123474121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3596053123474121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3597559928894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3693995475769043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3700742721557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3700742721557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3702230453491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3807859420776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3812088966369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3812088966369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3812985420227051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3882908821105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.38875389099121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.38875389099121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3888378143310547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.39597129821777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3963794708251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3963794708251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.39644813537597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40276527404785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([23, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40304088592529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40304088592529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40308475494384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4074277877807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40779542922973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40779542922973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40784692764282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.41330575942993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4136033058166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4136033058166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.41364336013793945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4181694984436035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4184603691101074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4184603691101074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.41849660873413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.42284536361694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4230523109436035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4230523109436035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4230771064758301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4262261390686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4264698028564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4264698028564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4264965057373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.43007469177246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.430234432220459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.430234432220459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4302515983581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.43267202377319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.43286561965942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.43286561965942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.43288469314575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.43570756912231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4358253479003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4358253479003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4358367919921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4376106262207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.43789243698120117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.43789243698120117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.43791723251342773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44193410873413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44208335876464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44208335876464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4420967102050781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4443531036376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([77, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4461970329284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4461970329284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44634389877319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.47219228744506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4602928161621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4607219696044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.461151123046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46070051193237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2877, 40])
input nodes number: 5255
output nodes number: 2877
edges number: 15198
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46077489852905273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46077537536621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.017670154571533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 2 input nodes size: 12631
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.016712188720703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.016712188720703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.023667335510253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.023688793182373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.018509864807128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.01900005340576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.01900005340576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.01900005340576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([12631, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.01900005340576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([325, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03921651840209961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03921651840209961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 325, 128]), torch.Size([1, 325, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03952646255493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04200601577758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 325, 128])
m.shape torch.Size([413, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.042244911193847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.042244911193847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04263877868652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.048546791076660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([415, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.048943519592285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.048943519592285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 415, 128]), torch.Size([1, 415, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04933929443359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05804634094238281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 415, 128])
m.shape torch.Size([411, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05863237380981445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05863237380981445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05902433395385742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07039117813110352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([399, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07114648818969727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07114648818969727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07152700424194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08522558212280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([398, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08617401123046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08617401123046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 398, 128]), torch.Size([1, 398, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08655357360839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.102874755859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 398, 128])
m.shape torch.Size([343, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10382986068725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10382986068725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 343, 128]), torch.Size([1, 343, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1041569709777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12051248550415039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 343, 128])
m.shape torch.Size([316, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12155437469482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12155437469482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1218557357788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13903331756591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([237, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13989973068237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13989973068237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14012575149536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15459108352661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 237, 128])
m.shape torch.Size([2542, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16659927368164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16659927368164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2542, 128]), torch.Size([1, 2542, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1690235137939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3424367904663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2542, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3242049217224121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.33059215545654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3361225128173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.32969188690185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5799, 256])
first layer input nodes number: 12631
first layer output nodes number: 5799
edges number: 40905
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.33536195755004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3417491912841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.34227514266967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.34227514266967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([264, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3664240837097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3664240837097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3669276237487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.371673583984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([294, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.37198734283447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.37198734283447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.37254810333251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3821687698364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([257, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3826298713684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3826298713684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.383120059967041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.39412689208984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([220, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3947277069091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3947277069091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.39514732360839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4073162078857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([217, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40814924240112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40814924240112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40856313705444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4234633445739746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([209, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.42446184158325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.42446184158325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.42486047744750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4420018196105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([173, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4429664611816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4429664611816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4432964324951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4597949981689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([144, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4607372283935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4607372283935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4610118865966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4766674041748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4774298667907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4774298667907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.477628231048584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.490323543548584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([120, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4913778305053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4913778305053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4916067123413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5078573226928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([111, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5089168548583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5089168548583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5091285705566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5256423950195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5263094902038574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5263094902038574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5264372825622559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.537299633026123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5381608009338379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5381608009338379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.538301944732666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5512871742248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([70, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5521588325500488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5521588325500488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5522923469543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5655102729797363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5660204887390137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5660204887390137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5660967826843262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5741839408874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5748686790466309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5748686790466309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.574958324432373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5850882530212402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5859584808349609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5859584808349609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5860652923583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5988826751708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5994348526000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5994348526000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5995016098022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6079797744750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6083850860595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6083850860595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6084308624267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6145648956298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6152534484863281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6152534484863281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6153240203857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.625274658203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6258854866027832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6258854866027832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6259465217590332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6349797248840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6354570388793945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6354570388793945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.635502815246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6425981521606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6429953575134277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6429953575134277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6430315971374512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.648902416229248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6494150161743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6494150161743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6494588851928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6568727493286133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([204, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6617527008056641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6617527008056641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6621417999267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7306232452392578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 204, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7097454071044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7101726531982422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.7105998992919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.710151195526123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2865, 40])
input nodes number: 5799
output nodes number: 2865
edges number: 24727
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.7102141380310059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.7102146148681641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.01993083953857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 3 input nodes size: 14339
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.018507957458496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.018507957458496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.025345325469970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.025367259979248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.018390655517578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.018901824951171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.018901824951171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.018901824951171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14339, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.018901824951171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([399, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.041146278381347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.041146278381347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.04152679443359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.0445709228515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([495, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.04485273361206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.04485273361206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.04532480239868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.05240583419799805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([528, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.05292510986328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.05292510986328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.05342864990234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.06450653076171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([492, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.06519317626953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.06519317626953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.06566238403320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.0792694091796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([426, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.08071184158325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.08071184158325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.08111810684204102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.09574365615844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([401, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.09668779373168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.09668779373168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 401, 128]), torch.Size([1, 401, 128])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.09707021713256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.11351442337036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 401, 128])
m.shape torch.Size([361, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.11452817916870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.11452817916870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.11487245559692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.13208627700805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([340, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.1332111358642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.1332111358642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.13353538513183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.15201759338378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([304, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.15316009521484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.15316009521484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.15345001220703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.17200469970703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([2611, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.1843099594116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.1843099594116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2611, 128]), torch.Size([1, 2611, 128])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.1876821517944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.3704667091369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2611, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.3506431579589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.3567056655883789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.36276817321777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.3566579818725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6357, 256])
first layer input nodes number: 14339
first layer output nodes number: 6357
edges number: 43570
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.36287736892700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.3689398765563965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.3704996109008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.3704996109008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([300, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.39484071731567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.39484071731567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.3954129219055176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4001612663269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([305, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.40046167373657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.40046167373657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4010434150695801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.40976953506469727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([279, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.41028356552124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.41028356552124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4108157157897949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4225955009460449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4232754707336426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4232754707336426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.42374467849731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.43735170364379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4380640983581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4380640983581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.43843984603881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4519667625427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([181, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4528226852416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4528226852416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4531679153442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.46801280975341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([152, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4688687324523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4688687324523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4691586494445801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4836544990539551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([142, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4846014976501465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.4846014976501465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.48487234115600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5003104209899902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([123, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5012392997741699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5012392997741699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5014739036560059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5164885520935059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([105, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5173807144165039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5173807144165039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5175809860229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5318002700805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([124, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5330114364624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5330114364624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5332479476928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5516958236694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([85, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5525579452514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5525579452514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5527200698852539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5665006637573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5673317909240723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5673317909240723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5674710273742676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5802807807922363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5810456275939941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5810456275939941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5811638832092285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5928711891174316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5935044288635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5935044288635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.5935959815979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6033005714416504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6039929389953613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6039929389953613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6040844917297363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6144299507141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6149888038635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6149888038635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6150593757629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.623528003692627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6240983009338379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6240983009338379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6241650581359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6326432228088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6331577301025391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6331577301025391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6332149505615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6408824920654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6416616439819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6416616439819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6417417526245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6530370712280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6534814834594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6534814834594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6535272598266602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6603021621704102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6609139442443848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6609139442443848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6609711647033691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6698403358459473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6702761650085449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6702761650085449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.670316219329834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6768050193786621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.677269458770752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.677269458770752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.677309513092041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6840786933898926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([209, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6890807151794434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6890807151794434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.8338623046875 GB
    Memory Allocated: 0.6894793510437012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7596392631530762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 209, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7384119033813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7388472557067871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7392826080322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7388253211975098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2919, 40])
input nodes number: 6357
output nodes number: 2919
edges number: 24893
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7389030456542969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7389035224914551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019890308380126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 4 input nodes size: 14599
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018398761749267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018398761749267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.025360107421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02538156509399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018522262573242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01902294158935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01902294158935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01902294158935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14599, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01902294158935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([578, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0413813591003418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0413813591003418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04193258285522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0468144416809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([621, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04713106155395508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04713106155395508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04772329330444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.057521820068359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([568, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05803823471069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05803823471069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05857992172241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07049703598022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([500, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07117986679077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07117986679077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07165670394897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08548498153686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([481, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08639335632324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08639335632324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0868520736694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10336589813232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([430, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10436677932739258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10436677932739258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10477685928344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12241029739379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([347, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12336349487304688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12336349487304688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12369441986083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14024066925048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([328, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1413264274597168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1413264274597168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14163923263549805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1594691276550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([271, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1604757308959961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1604757308959961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1607341766357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1772747039794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 271, 128])
m.shape torch.Size([2701, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19002485275268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19002485275268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2701, 128]), torch.Size([1, 2701, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1926717758178711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3772563934326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2701, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.358212947845459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36472177505493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37123537063598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36467552185058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6825, 256])
first layer input nodes number: 14599
first layer output nodes number: 6825
edges number: 45011
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37134647369384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3778553009033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3794827461242676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3794827461242676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([421, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40166282653808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40166282653808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4024658203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40975379943847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([379, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4100809097290039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4100809097290039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41080379486083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4216771125793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([268, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.422088623046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.422088623046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42259979248046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4341106414794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43477773666381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43477773666381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43523550033569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44851064682006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44924306869506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44924306869506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44962453842163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46335744857788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46410131454467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46410131454467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46441030502319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47769689559936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47838354110717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47838354110717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4786219596862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4905428886413574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49130821228027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49130821228027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4915275573730469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5040302276611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5047945976257324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5047945976257324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5049872398376465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5173163414001465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5180177688598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5180177688598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5181760787963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5294160842895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5300455093383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5300455093383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5301733016967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5401411056518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5408387184143066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5408387184143066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5409646034240723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5516648292541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5521769523620605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5521769523620605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5522646903991699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5603365898132324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5609655380249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5609655380249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.561060905456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5705022811889648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5711469650268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5711469650268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5712385177612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5809431076049805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5812511444091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5812511444091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5812950134277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5862522125244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5867695808410645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5867695808410645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5868325233459473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5943856239318848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5948214530944824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5948214530944824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5948729515075684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6014132499694824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.601844310760498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.601844310760498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6018919944763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6082816123962402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6088347434997559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6088347434997559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6088919639587402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6169600486755371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6174564361572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6174564361572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6175060272216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6248455047607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6251168251037598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6251168251037598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6251435279846191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6292824745178223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6296229362487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6296229362487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6296534538269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6345973014831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6347899436950684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6347899436950684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6348071098327637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6377081871032715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([246, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.643610954284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.643610954284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6440801620483398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7266607284545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 246, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7075591087341309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.707979679107666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7084002494812012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7079582214355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2820, 40])
input nodes number: 6825
output nodes number: 2820
edges number: 22074
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7080159187316895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7080163955688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01996898651123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 5 input nodes size: 15510
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01850748062133789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01850748062133789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02590322494506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0259246826171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018941879272460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019483566284179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019483566284179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019483566284179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15510, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019483566284179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([533, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04380226135253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04380226135253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044310569763183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.048377037048339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([542, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.048639774322509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.048639774322509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04915666580200195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.056910037994384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([552, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05744123458862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05744123458862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0579676628112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07032632827758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([483, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0709843635559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0709843635559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07144498825073242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08480310440063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([468, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08568859100341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08568859100341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0861349105834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1022024154663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([405, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10313796997070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10313796997070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 405, 128]), torch.Size([1, 405, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10352420806884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1201324462890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 405, 128])
m.shape torch.Size([355, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.121124267578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.121124267578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12146282196044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13839054107666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([356, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13957929611206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13957929611206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 356, 128]), torch.Size([1, 356, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13991880416870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1592707633972168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 356, 128])
m.shape torch.Size([266, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16024255752563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16024255752563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 266, 128]), torch.Size([1, 266, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16049623489379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17673158645629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 266, 128])
m.shape torch.Size([3018, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1909956932067871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1909956932067871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3018, 128]), torch.Size([1, 3018, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19387388229370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40727853775024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3018, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38514184951782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3917965888977051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3984513282775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39174413681030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6978, 256])
first layer input nodes number: 15510
first layer output nodes number: 6978
edges number: 47882
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39856910705566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4052238464355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4074859619140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4074859619140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([365, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4316830635070801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4316830635070801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43237924575805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4384913444519043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([302, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4387240409851074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4387240409851074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4393000602722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44872188568115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44927310943603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44927310943603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4498281478881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46268653869628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46326637268066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46326637268066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46369171142578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4760265350341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.476712703704834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.476712703704834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4770693778991699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48990964889526367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49065399169921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49065399169921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49095916748046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5040817260742188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5048441886901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5048441886901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.505103588104248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.518073558807373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5188436508178711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5188436508178711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5190668106079102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5317869186401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5325837135314941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5325837135314941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5327839851379395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5456013679504395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([106, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5465202331542969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5465202331542969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.546722412109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5610771179199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5618324279785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5618324279785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5619869232177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5740375518798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5747909545898438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5747909545898438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5749282836914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5866012573242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5872950553894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5872950553894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5874114036560059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5981154441833496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5987439155578613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5987439155578613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5988411903381348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6084713935852051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.609187126159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.609187126159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.609288215637207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6200037002563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6206297874450684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6206297874450684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6207137107849121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6301970481872559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6309232711791992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6309232711791992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6310129165649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6417703628540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6423487663269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6423487663269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6424174308776855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6511378288269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6516880989074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6516880989074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6517491340637207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6599278450012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6605124473571777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6605124473571777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6605734825134277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6691794395446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6698555946350098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6698555946350098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6699223518371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.679802417755127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.680171012878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.680171012878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6802072525024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6858243942260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6861381530761719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6861381530761719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6861667633056641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6908016204833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6912717819213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6912717819213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6913118362426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6980810165405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([268, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.704500675201416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.704500675201416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7050118446350098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7963528633117676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 268, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7752156257629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.775641918182373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7760682106018066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7756204605102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2859, 40])
input nodes number: 6978
output nodes number: 2859
edges number: 24680
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7757000923156738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.775700569152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020520687103271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 6 input nodes size: 14688
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018947601318359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018947601318359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.025951385498046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02597332000732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01855611801147461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019130229949951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019130229949951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019130229949951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14688, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019130229949951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([449, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044464111328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044464111328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044892311096191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.048317909240722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([529, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04860830307006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04860830307006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.049112796783447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.057547569274902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([537, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.058063507080078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.058063507080078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05857563018798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07013988494873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([483, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07080507278442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07080507278442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07126569747924805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08462381362915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([490, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08556175231933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08556175231933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.086029052734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10285186767578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([395, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10374832153320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10374832153320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1041250228881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12032318115234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([374, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1213831901550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1213831901550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12173986434936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1395735740661621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([344, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14070749282836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14070749282836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 344, 128]), torch.Size([1, 344, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1410355567932129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15973520278930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 344, 128])
m.shape torch.Size([287, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16080284118652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16080284118652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 287, 128]), torch.Size([1, 287, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16107654571533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17859363555908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 287, 128])
m.shape torch.Size([3347, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19441652297973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19441652297973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3347, 128]), torch.Size([1, 3347, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19798803329467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42967891693115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3347, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40693140029907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4138312339782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4207310676574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41377687454223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7235, 256])
first layer input nodes number: 14688
first layer output nodes number: 7235
edges number: 51293
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42084264755249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42774248123168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42946767807006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42946767807006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([313, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4546084403991699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4546084403991699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45520544052124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4609498977661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([321, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46126890182495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46126890182495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.461881160736084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47189855575561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([279, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4723973274230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4723973274230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4729294776916504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4853944778442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.486020565032959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.486020565032959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4864630699157715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.499295711517334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5000119209289551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5000119209289551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5003838539123535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5137734413146973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5145220756530762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5145220756530762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5148310661315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5281176567077637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([158, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5290265083312988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5290265083312988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5293278694152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.544395923614502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([134, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5452756881713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5452756881713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5455312728881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5600996017456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5608978271484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5608978271484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5611019134521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5741634368896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5750417709350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5750417709350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5752363204956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5890493392944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([101, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5900201797485352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5900201797485352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5902128219604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6052389144897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6059961318969727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6059961318969727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6061372756958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6181344985961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6189513206481934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6189513206481934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.619086742401123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6315455436706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6323528289794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6323528289794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.632476806640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6447505950927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6455540657043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6455540657043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6456685066223145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.657799243927002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6585726737976074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6585726737976074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6586756706237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6703143119812012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6710801124572754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6710801124572754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.671175479888916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.682619571685791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6831603050231934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6831603050231934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.683225154876709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6914610862731934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6918487548828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6918487548828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6918926239013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6977710723876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6984415054321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6984415054321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6985101699829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7081918716430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7087230682373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7087230682373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7087764739990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7166805267333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7170348167419434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7170348167419434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.717069149017334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7223906517028809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7228379249572754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7228379249572754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7228779792785645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7293667793273926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7299466133117676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7299466133117676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7299962043762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7383770942687988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([263, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7446718215942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7446718215942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.745173454284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8357791900634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 263, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8137264251708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8141627311706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8145990371704102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.814140796661377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2927, 40])
input nodes number: 7235
output nodes number: 2927
edges number: 25709
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8142271041870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8142275810241699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02021169662475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 7 input nodes size: 21972
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018566131591796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018566131591796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029043197631835938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029064178466796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02203845977783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02264690399169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02264690399169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02264690399169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([21972, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02264690399169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([742, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05309104919433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05309104919433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 742, 128]), torch.Size([1, 742, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.053798675537109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.059459686279296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 742, 128])
m.shape torch.Size([804, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05987262725830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05987262725830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.060639381408691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07214069366455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([752, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07307910919189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07307910919189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 752, 128]), torch.Size([1, 752, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07379627227783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08996295928955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 752, 128])
m.shape torch.Size([637, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0908193588256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0908193588256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09142684936523438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10904407501220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([566, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11104249954223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11104249954223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11158227920532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13101434707641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([500, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13217496871948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13217496871948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13265180587768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15315580368041992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([453, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15482473373413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15482473373413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 453, 128]), torch.Size([1, 453, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1552567481994629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17685747146606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 453, 128])
m.shape torch.Size([398, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1781597137451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1781597137451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 398, 128]), torch.Size([1, 398, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17853927612304688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20017433166503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 398, 128])
m.shape torch.Size([346, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20146942138671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20146942138671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2017993927001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2229175567626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([3800, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24087238311767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24087238311767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3800, 128]), torch.Size([1, 3800, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24449634552001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5017976760864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3800, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47629499435424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4848761558532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4934573173522949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48480892181396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([8998, 256])
first layer input nodes number: 21972
first layer output nodes number: 8998
edges number: 60453
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4936232566833496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.502204418182373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5045733451843262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5045733451843262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([473, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5253963470458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5253963470458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5262985229492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5335159301757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([386, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5338072776794434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5338072776794434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.534543514251709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5458731651306152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([332, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5464625358581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5464625358581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.547095775604248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5623183250427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([218, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5628399848937988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5628399848937988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.563255786895752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5753140449523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5760049819946289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5760049819946289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5763616561889648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5892019271850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5898137092590332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5898137092590332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5900750160217285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.601311206817627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6019678115844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6019678115844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6021909713745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6133489608764648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6139988899230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6139988899230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6141877174377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6249508857727051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6257219314575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6257219314575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6259126663208008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6381196975708008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6387648582458496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6387648582458496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6389117240905762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6493391990661621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6498475074768066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6498475074768066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6499524116516113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.658134937286377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6586594581604004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6586594581604004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.658754825592041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6668610572814941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6673383712768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6673383712768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6674184799194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6747884750366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6753139495849609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6753139495849609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6753940582275391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6833248138427734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6837177276611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6837177276611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6837749481201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6898403167724609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6903500556945801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6903500556945801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6904168128967285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.697960376739502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6984992027282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6984992027282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6985659599304199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7065768241882324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7070279121398926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7070279121398926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7070813179016113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7138638496398926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7143850326538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7143850326538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.714442253112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7221097946166992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7226581573486328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7226581573486328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7227153778076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7307834625244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7312393188476562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7312393188476562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7312850952148438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7380599975585938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7382912635803223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7382912635803223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.738314151763916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7418618202209473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7422704696655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7422704696655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7423067092895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7481775283813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.748436450958252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.748436450958252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7484593391418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7523274421691895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([232, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7578907012939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7578907012939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7583332061767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8362140655517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 232, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8185067176818848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8189244270324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8193421363830566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8189034461975098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2802, 40])
input nodes number: 8998
output nodes number: 2802
edges number: 21062
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8189730644226074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8189735412597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.023791790008544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 8 input nodes size: 9844
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02201986312866211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02201986312866211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.026713848114013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.026735782623291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016237735748291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016545772552490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016545772552490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016545772552490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([9844, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016545772552490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([809, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029891014099121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029891014099121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03066253662109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03769874572753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([858, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0381312370300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0381312370300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 858, 128]), torch.Size([1, 858, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03894948959350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05183887481689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 858, 128])
m.shape torch.Size([698, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.052428245544433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.052428245544433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 698, 128]), torch.Size([1, 698, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.053093910217285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0680084228515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 698, 128])
m.shape torch.Size([529, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06868457794189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06868457794189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06918907165527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08394145965576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([445, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08475017547607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08475017547607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.085174560546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10045242309570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([349, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10123872756958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10123872756958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10157155990600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11588335037231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 349, 128])
m.shape torch.Size([297, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11670827865600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11670827865600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11699151992797852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13115358352661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([235, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13190841674804688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13190841674804688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13213253021240234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14490699768066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 235, 128])
m.shape torch.Size([200, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14565324783325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14565324783325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 200, 128]), torch.Size([1, 200, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1458439826965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1580510139465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 200, 128])
m.shape torch.Size([952, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16249513626098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16249513626098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16340303421020508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22786378860473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 952, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2182602882385254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22338342666625977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22850656509399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2233433723449707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5372, 256])
first layer input nodes number: 9844
first layer output nodes number: 5372
edges number: 26333
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22858190536499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2337050437927246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2350783348083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2350783348083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([575, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2501492500305176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2501492500305176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.25124597549438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26125669479370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 575, 256])
m.shape torch.Size([503, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2616753578186035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2616753578186035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2626347541809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2770256996154785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([386, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27792835235595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27792835235595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27866458892822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.29582834243774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([299, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.29660987854003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.29660987854003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.29718017578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3144817352294922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([234, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3153214454650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3153214454650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.315767765045166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3318352699279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([174, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33261585235595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33261585235595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3329477310180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34721851348876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.348055362701416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.348055362701416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3483395576477051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3625493049621582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3633298873901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3633298873901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3635587692260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3766050338745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3771395683288574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3771395683288574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37728261947631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38643789291381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38713550567626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38713550567626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38728809356689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39812183380126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([46, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3985319137573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3985319137573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3986196517944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40546321868896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4058694839477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4058694839477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4059438705444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41226673126220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4125795364379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4125795364379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41263294219970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41754627227783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4179368019104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4179368019104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4179959297180176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42384958267211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42432498931884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42432498931884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4243917465209961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43146800994873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43169641494750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43169641494750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4317288398742676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4353928565979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43571996688842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43571996688842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4357600212097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4405665397644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44092750549316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44092750549316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44096946716308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44629859924316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4464421272277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4464421272277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4464592933654785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4487595558166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4488859176635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4488859176635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4488992691040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45078182220458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45093679428100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45093679428100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45095205307006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45321035385131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4533085823059082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4533085823059082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45331811904907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45479631423950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45490217208862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45490217208862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4549117088317871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45645666122436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45665979385375977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45665979385375977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4566769599914551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4595780372619629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([44, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46062707901000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46062707901000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4607110023498535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4754815101623535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46387338638305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4643087387084961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46474409103393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46428680419921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2921, 40])
input nodes number: 5372
output nodes number: 2921
edges number: 14969
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46436643600463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4643669128417969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017209529876708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 9 input nodes size: 10379
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01625537872314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01625537872314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.021204471588134766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02122640609741211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016510486602783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016860485076904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016860485076904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016860485076904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([10379, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016860485076904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([782, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03199005126953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03199005126953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03273582458496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03945112228393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([822, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03986215591430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03986215591430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04064607620239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05240488052368164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([722, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05304574966430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05304574966430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 722, 128]), torch.Size([1, 722, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05373430252075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06969451904296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 722, 128])
m.shape torch.Size([609, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0705118179321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0705118179321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07109260559082031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0883188247680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([509, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08924198150634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08924198150634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08972740173339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10720252990722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([399, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10810136795043945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10810136795043945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10848188400268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12484407424926758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([331, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12575864791870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12575864791870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12607431411743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14185762405395508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([282, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1427755355834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1427755355834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 282, 128]), torch.Size([1, 282, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14304447174072266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15837383270263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 282, 128])
m.shape torch.Size([235, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15924787521362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15924787521362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15947198867797852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17381525039672852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 235, 128])
m.shape torch.Size([1135, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17911529541015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17911529541015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18019771575927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.25719261169433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24500656127929688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2505626678466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2561187744140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.250518798828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5826, 256])
first layer input nodes number: 10379
first layer output nodes number: 5826
edges number: 30005
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2561984062194824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26175451278686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26336002349853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26336002349853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([509, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.28010988235473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.28010988235473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2810807228088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.28968381881713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([455, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2900733947753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2900733947753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2909412384033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3039588928222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([356, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30455827713012695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30455827713012695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3052372932434082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32074546813964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3214249610900879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3214249610900879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3219304084777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33658838272094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([245, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33751344680786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33751344680786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3379807472229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.35480356216430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([183, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.35562562942504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.35562562942504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3559746742248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3709836006164551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3717174530029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3717174530029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3719749450683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38484954833984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3856973648071289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3856973648071289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3859395980834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3997468948364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4005775451660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4005775451660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.400787353515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.414215087890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41485071182250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41485071182250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41499757766723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42542505264282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4261026382446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4261026382446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4262380599975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4368009567260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43744850158691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43744850158691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43756675720214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4476184844970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44815921783447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44815921783447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44825077056884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45667362213134766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4571661949157715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4571661949157715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.457242488861084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4647955894470215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46527671813964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46527671813964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4653453826904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4726238250732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4730663299560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4730663299560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4731254577636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47980690002441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48020219802856445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48020219802856445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4802517890930176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4862027168273926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4865241050720215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4865241050720215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48656225204467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4914069175720215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4916071891784668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4916071891784668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49163007736206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49469709396362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4948587417602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4948587417602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4948759078979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4972963333129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49748992919921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49748992919921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4975090026855469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5003318786621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5004916191101074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5004916191101074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5005068778991699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5028719902038574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5030412673950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5030412673950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.503056526184082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.505528450012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5057053565979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5057053565979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5057206153869629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5082993507385254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([59, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5097613334655762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5097613334655762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5098738670349121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5296797752380371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5163187980651855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5167527198791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5171866416931152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.516730785369873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2910, 40])
input nodes number: 5826
output nodes number: 2910
edges number: 16783
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5167951583862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5167956352233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017577171325683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 10 input nodes size: 18791
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016509056091308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016509056091308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.025469303131103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02549123764038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02052021026611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.021025657653808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.021025657653808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.021025657653808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([18791, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.021025657653808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([733, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04545450210571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04545450210571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04615354537963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05261850357055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([727, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.052962303161621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.052962303161621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 727, 128]), torch.Size([1, 727, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05365562438964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06483316421508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 727, 128])
m.shape torch.Size([696, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06548213958740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06548213958740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0661458969116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0807485580444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 696, 128])
m.shape torch.Size([583, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0815286636352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0815286636352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08208465576171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09820842742919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([533, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09920120239257812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09920120239257812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09970951080322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11878824234008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([468, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.119873046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.119873046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12031936645507812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1395111083984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([373, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1405329704284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1405329704284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14088869094848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1586747169494629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([378, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15993881225585938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15993881225585938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16029930114746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18084716796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([319, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1820359230041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1820359230041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18234014511108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20181035995483398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([2701, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2145376205444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2145376205444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2701, 128]), torch.Size([1, 2701, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21749114990234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40207576751708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2701, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38106775283813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3882308006286621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39539384841918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38817453384399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7511, 256])
first layer input nodes number: 18791
first layer output nodes number: 7511
edges number: 47596
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.395535945892334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40269899368286133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40448999404907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40448999404907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([493, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4247736930847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4247736930847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42571401596069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4335513114929199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([400, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4338502883911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4338502883911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4346132278442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4469575881958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([335, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4475421905517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4475421905517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44818115234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46329832077026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([247, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4639286994934082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4639286994934082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4643998146057129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47806215286254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47875452041625977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47875452041625977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4791226387023926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49237489700317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([184, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4932522773742676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4932522773742676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4936032295227051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5086941719055176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5093598365783691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5093598365783691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5095982551574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5215191841125488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5223383903503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5223383903503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5225710868835449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.535834789276123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5366096496582031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5366096496582031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5368061065673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5493793487548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5500020980834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5500020980834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.550145149230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5603017807006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.560981273651123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.560981273651123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5611166954040527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5716795921325684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5721426010131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5721426010131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.572230339050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5796880722045898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5801939964294434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5801939964294434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5802779197692871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5879988670349121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5884280204772949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5884280204772949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5884947776794434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5951037406921387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5956907272338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5956907272338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5957727432250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.604466438293457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6048407554626465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6048407554626465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6048922538757324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6107115745544434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6111927032470703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6111927032470703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6112518310546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.61834716796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6187505722045898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6187505722045898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6187982559204102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6248540878295898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6252140998840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6252140998840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6252541542053223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6306214332580566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6310439109802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6310439109802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6310877799987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6372733116149902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6375141143798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6375141143798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6375389099121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6412086486816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6415772438049316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6415772438049316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6416115760803223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6469330787658691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6473360061645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6473360061645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6473722457885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6532430648803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6535482406616211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6535482406616211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6535749435424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6580877304077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([181, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6624236106872559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6624236106872559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6627688407897949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7235293388366699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 181, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7065067291259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.706937313079834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7073678970336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7069153785705566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2888, 40])
input nodes number: 7511
output nodes number: 2888
edges number: 20158
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7069902420043945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7069907188415527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022020339965820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 11 input nodes size: 13211
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02051687240600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02051687240600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.026816368103027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.026837825775146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01785564422607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018301963806152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018301963806152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018301963806152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13211, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018301963806152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([583, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03721189498901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03721189498901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.037767887115478516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04252338409423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([655, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04287004470825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04287004470825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04349470138549805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05286455154418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([608, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.053421974182128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.053421974182128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.054001808166503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06679105758666992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([556, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06756162643432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06756162643432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06809186935424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08348417282104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([440, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08426809310913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08426809310913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08468770980834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09979391098022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 440, 128])
m.shape torch.Size([377, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1006627082824707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1006627082824707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10102224349975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11648225784301758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([319, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11736726760864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11736726760864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11767148971557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13288259506225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([313, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1339244842529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1339244842529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13422298431396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15123748779296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([277, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15227699279785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15227699279785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 277, 128]), torch.Size([1, 277, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1525411605834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1694478988647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 277, 128])
m.shape torch.Size([2035, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17901945114135742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17901945114135742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2035, 128]), torch.Size([1, 2035, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18096017837524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31949567794799805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2035, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30323123931884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3091087341308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3149862289428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30906248092651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6163, 256])
first layer input nodes number: 13211
first layer output nodes number: 6163
edges number: 37983
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31508684158325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3214435577392578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3224339485168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3224339485168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([396, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3445892333984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3445892333984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34534454345703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.35169267654418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([359, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3520054817199707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3520054817199707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3526902198791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3639397621154785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36447715759277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36447715759277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36505889892578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3778572082519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3786454200744629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3786454200744629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3791508674621582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3944230079650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([222, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39523744583129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39523744583129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3956608772277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4109044075012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4115924835205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4115924835205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41189002990722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4246845245361328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42539024353027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42539024353027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4256324768066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.437744140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([135, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4386610984802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4386610984802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4389185905456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4535956382751465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45428037643432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45428037643432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45445966720581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46593427658081055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4666905403137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4666905403137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4668583869934082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4787755012512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4795060157775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4795060157775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47965288162231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49110841751098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49175024032592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49175024032592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4918684959411621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.501920223236084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5026235580444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5026235580444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5027399063110352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5134439468383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5141124725341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5141124725341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5142154693603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5244121551513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5249519348144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5249519348144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5250301361083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5333194732666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5339264869689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5339264869689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5340065956115723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5430588722229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5435419082641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5435419082641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5436029434204102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5509271621704102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5514159202575684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5514159202575684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5514731407165527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5587401390075684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5592780113220215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5592780113220215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5593371391296387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5672602653503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5677886009216309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5677886009216309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5678439140319824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5756430625915527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5762615203857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5762615203857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5763225555419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5853557586669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5857062339782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5857062339782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5857405662536621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.591062068939209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5914649963378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5914649963378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5915012359619141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5973720550537109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5976772308349609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5976772308349609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5977039337158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6022167205810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([179, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6065044403076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6065044403076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6068458557128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6669349670410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 179, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.647942066192627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6483697891235352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6487975120544434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.648348331451416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2868, 40])
input nodes number: 6163
output nodes number: 2868
edges number: 21826
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6484131813049316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6484136581420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01917886734008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 12 input nodes size: 22379
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017852783203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017852783203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.028523921966552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.028545856475830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022224903106689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02283620834350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02283620834350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02283620834350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([22379, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02283620834350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([651, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05193901062011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05193901062011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.052559852600097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05762672424316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([626, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05791330337524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05791330337524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05851030349731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0677947998046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([600, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06835460662841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06835460662841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06892681121826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08151531219482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([603, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08237934112548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08237934112548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08295440673828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09996509552001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([520, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10091733932495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10091733932495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10141324996948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1194300651550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([463, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12050676345825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12050676345825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12094831466674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13993501663208008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([425, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14113283157348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14113283157348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14153814315795898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1618037223815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([373, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1630239486694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1630239486694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16337966918945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1836557388305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([334, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18491125106811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18491125106811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 334, 128]), torch.Size([1, 334, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18522977828979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20561552047729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 334, 128])
m.shape torch.Size([3833, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22373342514038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22373342514038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3833, 128]), torch.Size([1, 3833, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22738885879516602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4875946044921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3833, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46337080001831055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4714083671569824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4794459342956543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4713454246520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([8428, 256])
first layer input nodes number: 22379
first layer output nodes number: 8428
edges number: 58788
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4796147346496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4876523017883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48966169357299805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48966169357299805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([436, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5124650001525879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5124650001525879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5132966041564941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5200791358947754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([359, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5203537940979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5203537940979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5210385322570801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5326952934265137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.533200740814209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.533200740814209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5337615013122559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5472912788391113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([252, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5479798316955566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5479798316955566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5484604835510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5623993873596191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5631155967712402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5631155967712402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5634951591491699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5771594047546387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5779213905334473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5779213905334473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5782361030578613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.591768741607666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5925264358520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5925264358520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5927858352661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6057558059692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6065797805786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6065797805786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.606816291809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6202974319458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6209235191345215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6209235191345215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6210875511169434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6315855979919434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6323976516723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6323976516723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6325750350952148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6451692581176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6457571983337402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6457571983337402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6458792686462402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6554007530212402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6561355590820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6561355590820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6562671661376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6674537658691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6680879592895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6680879592895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6681947708129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6780214309692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6786680221557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6786680221557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.678767204284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6885862350463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.689185619354248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.689185619354248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6892714500427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6983695030212402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6989264488220215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6989264488220215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6990008354187012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7074065208435059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7077288627624512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7077288627624512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.707770824432373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.712806224822998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.713200569152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.713200569152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7132463455200195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.719059944152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.719566822052002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.719566822052002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7196221351623535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7270340919494629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.727391242980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.727391242980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7274293899536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7328081130981445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7331929206848145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7331929206848145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7332310676574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7388768196105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7393865585327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7393865585327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7394342422485352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7468252182006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7470006942749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7470006942749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7470178604125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7497987747192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7501826286315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7501826286315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7502150535583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7556948661804199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([274, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7622628211975098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7622628211975098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7627854347229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8589396476745605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 274, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8392958641052246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8397297859191895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8401637077331543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8397078514099121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2909, 40])
input nodes number: 8428
output nodes number: 2909
edges number: 23156
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8397989273071289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8397994041442871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.024014949798583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 13 input nodes size: 15906
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022231101989746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022231101989746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029815673828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029837608337402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019144535064697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019671916961669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019671916961669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019671916961669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15906, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019671916961669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([473, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04223203659057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04223203659057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04268312454223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04629182815551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([532, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.046573638916015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.046573638916015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04708099365234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0553741455078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([528, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05587577819824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05587577819824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05637931823730469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06834888458251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([468, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06898975372314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06898975372314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06943607330322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08237934112548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([434, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08319091796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08319091796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08360481262207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09850502014160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([334, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09925365447998047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09925365447998047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 334, 128]), torch.Size([1, 334, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09957218170166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11326885223388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 334, 128])
m.shape torch.Size([320, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11417770385742188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11417770385742188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11448287963867188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12974166870117188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([320, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13080978393554688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13080978393554688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13111495971679688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14850997924804688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([285, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1495804786682129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1495804786682129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 285, 128]), torch.Size([1, 285, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14985227584838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16724729537963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 285, 128])
m.shape torch.Size([2906, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1809682846069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1809682846069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2906, 128]), torch.Size([1, 2906, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18373966217041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3818235397338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2906, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36171483993530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.368009090423584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37430334091186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36795949935913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6600, 256])
first layer input nodes number: 15906
first layer output nodes number: 6600
edges number: 45592
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3744239807128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3813667297363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3822917938232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3822917938232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([324, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.406740665435791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.406740665435791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40735864639282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41266345977783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([323, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4129757881164551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4129757881164551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4135918617248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4232029914855957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4236879348754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4236879348754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4242124557495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4362220764160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4369325637817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4369325637817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43741512298583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45140933990478516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45216798782348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45216798782348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45256471633911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46684694290161133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46747922897338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46747922897338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46775388717651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47956418991088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([154, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48046302795410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48046302795410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4807567596435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49544334411621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4962272644042969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4962272644042969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4964580535888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.509613037109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([128, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5106048583984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5106048583984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5108489990234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5264739990234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([114, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5274477005004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5274477005004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5276651382446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5431032180786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5438508987426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5438508987426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5440053939819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.556056022644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5568785667419434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5568785667419434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5570273399353027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5696730613708496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5704984664916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5704984664916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5706357955932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5832700729370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5841836929321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5841836929321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5843229293823242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5981073379516602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5988597869873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5988597869873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.598968505859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6104927062988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6109304428100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6109304428100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6109914779663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6178884506225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6185116767883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6185116767883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6185879707336426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6277432441711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6283454895019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6283454895019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6284160614013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6373786926269531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6378369331359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6378369331359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6378884315490723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6447892189025879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6453213691711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6453213691711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6453766822814941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6531758308410645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6536531448364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6536531448364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6537008285522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6607580184936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6613473892211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6613473892211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.661402702331543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6699762344360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6702585220336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6702585220336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6702852249145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6746110916137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6750822067260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6750822067260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6751222610473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6818914413452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([254, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6879749298095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6879749298095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6884593963623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7737255096435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 254, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7523660659790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.752800464630127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.75323486328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7527785301208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2913, 40])
input nodes number: 6600
output nodes number: 2913
edges number: 24979
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7528505325317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7528510093688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020687103271484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 14 input nodes size: 18487
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01914501190185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01914501190185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02796030044555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.027982234954833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020375728607177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02095174789428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02095174789428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02095174789428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([18487, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02095174789428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([630, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04709959030151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04709959030151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04770040512084961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05250692367553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([674, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05284929275512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05284929275512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.053492069244384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06317281723022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([659, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06379413604736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06379413604736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.064422607421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07824897766113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([599, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07911300659179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07911300659179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07968425750732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09625053405761719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([594, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0973811149597168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0973811149597168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09794759750366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11834096908569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([461, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11937665939331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11937665939331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11981630325317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13872098922729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([447, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13999319076538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13999319076538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14041948318481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16173410415649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([410, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1630849838256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1630849838256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16347599029541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18576335906982422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([351, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1870741844177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1870741844177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1874089241027832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2088322639465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([3109, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22348976135253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22348976135253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3109, 128]), torch.Size([1, 3109, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2264547348022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4399547576904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3109, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4169497489929199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4245162010192871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4320826530456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4244570732116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7934, 256])
first layer input nodes number: 18487
first layer output nodes number: 7934
edges number: 52745
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4322223663330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.439788818359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44229555130004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44229555130004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([400, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4664301872253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4664301872253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4671931266784668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4732966423034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([343, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4735746383666992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4735746383666992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4742288589477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4840421676635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([299, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48457765579223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48457765579223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48514795303344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4977898597717285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([215, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49833154678344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49833154678344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49874162673950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5106339454650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.511385440826416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.511385440826416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5117650032043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5254292488098145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([128, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.525977611541748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.525977611541748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.526221752166748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.536719799041748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([151, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5376501083374023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5376501083374023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.537938117980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5523386001586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([135, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5532803535461426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5532803535461426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5535378456115723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5682148933410645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5689859390258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5689859390258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5691843032836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5818796157836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([100, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5827417373657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5827417373657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5829324722290039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5964746475219727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5972251892089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5972251892089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5973777770996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6092796325683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6100454330444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6100454330444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6101846694946289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6220197677612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6228752136230469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6228752136230469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.623016357421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6360015869140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6365504264831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6365504264831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6366381645202637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6453242301940918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6460447311401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6460447311401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6461458206176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6568613052368164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6575798988342285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6575798988342285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6576752662658691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6684517860412598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6690578460693359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6690578460693359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6691341400146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6782894134521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6788744926452637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6788744926452637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6789431571960449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6876635551452637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6882319450378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6882319450378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6882948875427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6967291831970215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6973514556884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6973514556884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6974163055419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7065601348876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7069315910339355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7069315910339355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7069697380065918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7126154899597168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.713040828704834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.713040828704834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.713080883026123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7192893028259277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7196455001831055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7196455001831055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7196779251098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7249307632446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7252607345581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7252607345581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7252893447875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7301244735717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([258, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7363095283508301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7363095283508301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7368016242980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8265438079833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 258, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8055734634399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8060092926025391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8064451217651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8059873580932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2924, 40])
input nodes number: 7934
output nodes number: 2924
edges number: 24354
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8060698509216309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8060703277587891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02205944061279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 15 input nodes size: 11183
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020377159118652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020377159118652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02570962905883789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.025731563568115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01689434051513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017292022705078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017292022705078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017292022705078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([11183, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017292022705078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([617, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0342249870300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0342249870300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03481340408325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0395207405090332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([662, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03985786437988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03985786437988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04048919677734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04995918273925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 662, 128])
m.shape torch.Size([635, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0505518913269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0505518913269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.051157474517822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06448030471801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([595, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06531238555908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06531238555908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06587982177734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0831747055053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([492, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08406400680541992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08406400680541992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0845332145690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1014246940612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([398, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10232877731323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10232877731323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 398, 128]), torch.Size([1, 398, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10270833969116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11902952194213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 398, 128])
m.shape torch.Size([357, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12003135681152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12003135681152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12037181854248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13739490509033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([302, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13837671279907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13837671279907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 302, 128]), torch.Size([1, 302, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13866472244262695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15508127212524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 302, 128])
m.shape torch.Size([270, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1560959815979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1560959815979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 270, 128]), torch.Size([1, 270, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15635347366333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17283296585083008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 270, 128])
m.shape torch.Size([1547, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18008089065551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18008089065551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1547, 128]), torch.Size([1, 1547, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18155622482299805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.28630495071411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1547, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.272092342376709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2776951789855957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2832980155944824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.277651309967041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5875, 256])
first layer input nodes number: 11183
first layer output nodes number: 5875
edges number: 33889
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2833833694458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2889862060546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2907872200012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2907872200012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([404, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30992650985717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30992650985717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.310697078704834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3177199363708496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([386, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31807708740234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31807708740234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3188133239746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3311028480529785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([325, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33167219161987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33167219161987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3322920799255371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34601879119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([277, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3467741012573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3467741012573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3473024368286133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3627901077270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([211, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3635520935058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3635520935058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3639545440673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37844276428222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([193, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37935495376586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37935495376586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37972307205200195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3955521583557129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([193, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39763593673706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39763593673706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39800405502319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.416409969329834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41717958450317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41717958450317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4174160957336426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43089723587036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([118, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43179988861083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43179988861083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4320249557495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4464292526245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4472494125366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4472494125366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4474344253540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4605703353881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([85, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4613766670227051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4613766670227051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46153879165649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.474184513092041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.474853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.474853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4749774932861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4855155944824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4861907958984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4861907958984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48630332946777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4966564178466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49736738204956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49736738204956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49747610092163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5082392692565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.508819580078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.508819580078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5089035034179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5177993774414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5183110237121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5183110237121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5183796882629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5261387825012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5264315605163574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5264315605163574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5264697074890137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5310473442077637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5313916206359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5313916206359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5314316749572754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5365185737609863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5370101928710938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5370101928710938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5370635986328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.544219970703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.544520378112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.544520378112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5445528030395508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5491247177124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5493507385253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5493507385253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5493736267089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5527610778808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5530672073364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5530672073364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.553095817565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.557530403137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.557826042175293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.557826042175293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5578527450561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5621786117553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5623960494995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5623960494995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5624151229858398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.565638542175293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([91, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5678157806396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5678157806396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5679893493652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5985374450683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 91, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.582667350769043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5830998420715332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5835323333740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5830779075622559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2902, 40])
input nodes number: 5875
output nodes number: 2902
edges number: 19372
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5831403732299805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5831408500671387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018079280853271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 16 input nodes size: 14782
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016891002655029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016891002655029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02393960952758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.023960590362548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018606185913085938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01897716522216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01897716522216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01897716522216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14782, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01897716522216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([736, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03611183166503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03611183166503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 736, 128]), torch.Size([1, 736, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03681373596191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04285717010498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 736, 128])
m.shape torch.Size([802, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04327106475830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04327106475830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044035911560058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05698585510253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([674, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.057567596435546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.057567596435546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05821037292480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07235145568847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([576, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07312870025634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07312870025634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07367801666259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0905466079711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([503, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09147119522094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09147119522094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09195089340209961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10922002792358398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([375, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11005306243896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11005306243896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11041069030761719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12578868865966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([307, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1266345977783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1266345977783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 307, 128]), torch.Size([1, 307, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12692737579345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14156627655029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 307, 128])
m.shape torch.Size([290, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14252614974975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14252614974975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 290, 128]), torch.Size([1, 290, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14280271530151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15856695175170898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 290, 128])
m.shape torch.Size([246, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1594843864440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1594843864440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 246, 128]), torch.Size([1, 246, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15971899032592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17473363876342773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 246, 128])
m.shape torch.Size([1606, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18227434158325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18227434158325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1606, 128]), torch.Size([1, 1606, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1838059425354004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.29254961013793945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1606, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27828502655029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2841167449951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2899484634399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2840709686279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6115, 256])
first layer input nodes number: 14782
first layer output nodes number: 6115
edges number: 34174
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.29006052017211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.29589223861694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2979283332824707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2979283332824707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([516, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3135080337524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3135080337524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31449222564697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3242802619934082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([464, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3246803283691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3246803283691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3255653381347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3388404846191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([346, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3395233154296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3395233154296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3401832580566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.35567378997802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3565030097961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3565030097961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3570084571838379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37244462966918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([245, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3733696937561035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3733696937561035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3738369941711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39065980911254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39132022857666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39132022857666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3916158676147461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4043283462524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4049544334411621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4049544334411621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40517377853393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4161410331726074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4168696403503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4168696403503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41707754135131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4289278984069824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4295682907104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4295682907104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4297323226928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4402303695678711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44090795516967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44090795516967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4410586357116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45175695419311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45223140716552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45223140716552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4523305892944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4600667953491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4605593681335449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4605593681335449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4606490135192871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46826887130737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4688115119934082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4688115119934082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4689011573791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47714853286743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47756147384643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47756147384643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47762632369995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48404645919799805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4843893051147461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4843893051147461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4844388961791992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48969554901123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49005556106567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49005556106567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49010324478149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49549150466918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([11, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4956474304199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4956474304199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4956684112548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4981861114501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49841785430908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49841785430908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4984445571899414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.501835823059082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5020236968994141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5020236968994141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.502044677734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5048561096191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5051918029785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5051918029785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5052261352539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5100669860839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5102314949035645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5102314949035645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5102486610412598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.512789249420166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5129289627075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5129289627075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5129423141479492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5150117874145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5151381492614746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5151381492614746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5151495933532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5170035362243652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5170903205871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5170903205871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5170979499816895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5183873176574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([81, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5203299522399902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5203299522399902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.520484447479248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.547675609588623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5354323387145996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5358457565307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5362591743469238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5358247756958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2772, 40])
input nodes number: 6115
output nodes number: 2772
edges number: 15561
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5358724594116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5358729362487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019724369049072266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 17 input nodes size: 23510
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018587112426757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018587112426757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02979755401611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029819011688232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02274942398071289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02332925796508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02332925796508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02332925796508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([23510, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02332925796508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([702, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.052080631256103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.052080631256103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0527501106262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05841255187988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([797, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.058837890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.058837890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05959796905517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0709991455078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([742, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0717015266418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0717015266418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 742, 128]), torch.Size([1, 742, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07240915298461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0882573127746582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 742, 128])
m.shape torch.Size([656, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08915472030639648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08915472030639648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08978033065795898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10792303085327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([574, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1089787483215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1089787483215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10952615737915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1300349235534668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([496, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1311802864074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1311802864074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1316533088684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1519932746887207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([464, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1533055305480957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1533055305480957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1537480354309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1758732795715332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([411, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17721986770629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17721986770629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1776118278503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19995355606079102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([369, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2013411521911621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2013411521911621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20169305801391602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22421503067016602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([3514, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24079513549804688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24079513549804688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3514, 128]), torch.Size([1, 3514, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24414634704589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4820823669433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3514, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45674705505371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46506786346435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.473388671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46500253677368164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([8725, 256])
first layer input nodes number: 23510
first layer output nodes number: 8725
edges number: 57989
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47356605529785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4818868637084961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4846620559692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4846620559692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([477, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5040969848632812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5040969848632812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 477, 256]), torch.Size([1, 477, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5050067901611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5135402679443359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 477, 256])
m.shape torch.Size([401, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5138564109802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5138564109802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5146212577819824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5261015892028809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([326, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5266594886779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5266594886779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5272812843322754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5412492752075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([256, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5419225692749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5419225692749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5424108505249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5565710067749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5574350357055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5574350357055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5578527450561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5728902816772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5735583305358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5735583305358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5738482475280762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5863146781921387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5870513916015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5870513916015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5873012542724609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5997943878173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6005229949951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6005229949951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6007347106933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6128025054931641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.613466739654541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.613466739654541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6136364936828613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6245007514953613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6250309944152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6250309944152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6251530647277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6338200569152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6344146728515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6344146728515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6345329284667969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6437568664550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6443901062011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6443901062011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6445045471191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6542320251464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6546998023986816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6546998023986816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6547799110412598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6621499061584473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6625809669494629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6625809669494629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6626477241516113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6692566871643066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6697134971618652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6697134971618652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6697783470153809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6766524314880371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6771278381347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6771278381347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6771907806396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6843032836914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6848931312561035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6848931312561035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6849656105041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6936631202697754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6941981315612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6941981315612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6942610740661621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7022547721862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7025885581970215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7025885581970215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7026267051696777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7077383995056152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7080464363098145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7080464363098145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7080788612365723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7126507759094238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7130184173583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7130184173583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7130546569824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7184181213378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7187175750732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7187175750732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7187461853027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7231807708740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7234539985656738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7234539985656738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7234787940979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7274956703186035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7277603149414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7277603149414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.727783203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7316513061523438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([173, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7357969284057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7357969284057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7361268997192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7942018508911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 173, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.779625415802002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7800474166870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7804694175720215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7800259590148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2832, 40])
input nodes number: 8725
output nodes number: 2832
edges number: 19611
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7801213264465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7801218032836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02446889877319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 18 input nodes size: 26656
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022758007049560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022758007049560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03546857833862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.035489559173583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.024257659912109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.024849891662597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.024849891662597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.024849891662597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([26656, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.024849891662597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([795, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.055384159088134766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.055384159088134766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.056142330169677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06259918212890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([877, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06305646896362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06305646896362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06389284133911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07660055160522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([744, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07724666595458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07724666595458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0779561996459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0937356948852539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([646, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09461307525634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09461307525634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0952291488647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1137704849243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([674, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11506938934326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11506938934326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11571216583251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13885211944580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([550, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1401042938232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1401042938232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14062881469726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1640462875366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([509, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1654829978942871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1654829978942871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1659684181213379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19023942947387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([420, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19159889221191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19159889221191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1919994354248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2148303985595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([363, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2161879539489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2161879539489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21653413772583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23868989944458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([3731, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.25630760192871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.25630760192871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3731, 128]), torch.Size([1, 3731, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.25986576080322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5134811401367188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3731, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4882025718688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49708032608032227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.505958080291748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4970107078552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([9309, 256])
first layer input nodes number: 26656
first layer output nodes number: 9309
edges number: 61535
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5061588287353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5150365829467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5172562599182129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5172562599182129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([486, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5350565910339355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5350565910339355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5359835624694824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5434203147888184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([426, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5437760353088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5437760353088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.544588565826416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5574688911437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([322, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5579915046691895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5579915046691895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5586056709289551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5748682022094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5754146575927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5754146575927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5758380889892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5881175994873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([225, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5889873504638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5889873504638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.58941650390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6048660278320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([194, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6057705879211426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6057705879211426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6061406135559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6220517158508301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6227483749389648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6227483749389648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6229982376098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6354913711547852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6361279487609863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6361279487609863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6363167762756348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6470799446105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6477036476135254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6477036476135254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6478619575500488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6579937934875488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6585683822631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6585683822631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6586980819702148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6679067611694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6684660911560059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6684660911560059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6685786247253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6773562431335449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6779112815856934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6779112815856934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6780123710632324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6866049766540527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6872043609619141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6872043609619141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6873035430908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6964282989501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6970114707946777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6970114707946777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6971011161804199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7059760093688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.706392765045166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.706392765045166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.706453800201416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.712923526763916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7133083343505859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7133083343505859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7133598327636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7191791534423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7194805145263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7194805145263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7195186614990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7240962982177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7243714332580566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7243714332580566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7244038581848145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7285218238830566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7288708686828613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7288708686828613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7289090156555176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7340207099914551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7343287467956543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7343287467956543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7343611717224121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7389330863952637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7391996383666992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7391996383666992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7392263412475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7431783676147461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7433342933654785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7433342933654785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.743349552154541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7457146644592285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7459502220153809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7459502220153809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7459712028503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7493700981140137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7495903968811035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7495903968811035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7496094703674316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7528328895568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([137, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7561154365539551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7561154365539551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7563767433166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8023667335510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 137, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7886643409729004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7890787124633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7894930839538574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.789057731628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2780, 40])
input nodes number: 9309
output nodes number: 2780
edges number: 17902
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7891407012939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7891411781311035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02600717544555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 19 input nodes size: 20288
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.024250030517578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.024250030517578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.033924102783203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03394603729248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02121448516845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02170848846435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02170848846435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02170848846435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([20288, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02170848846435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([811, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.046195030212402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.046195030212402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04696846008300781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05315589904785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([854, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.053583621978759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.053583621978759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0543980598449707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06694459915161133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([815, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0677032470703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0677032470703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0684804916381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08622407913208008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([692, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08715534210205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08715534210205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0878152847290039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10753726959228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 692, 128])
m.shape torch.Size([609, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10865926742553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10865926742553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10924005508422852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.130645751953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([529, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13186883926391602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13186883926391602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13237333297729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15477895736694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([446, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15601539611816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15601539611816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15644073486328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17770767211914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([382, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17895221710205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17895221710205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 382, 128]), torch.Size([1, 382, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17931652069091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20008182525634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 382, 128])
m.shape torch.Size([320, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20127296447753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20127296447753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20157814025878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22110939025878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([2505, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23290157318115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23290157318115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2505, 128]), torch.Size([1, 2505, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23534536361694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40831804275512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2505, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3873286247253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39546871185302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4030628204345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3948631286621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7963, 256])
first layer input nodes number: 20288
first layer output nodes number: 7963
edges number: 48059
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40266990661621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4108099937438965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41216278076171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41216278076171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([533, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43016481399536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43016481399536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4311814308166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4395880699157715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([419, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43988561630249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43988561630249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44068479537963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4540553092956543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([346, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4546537399291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4546537399291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45531368255615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4698324203491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([272, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.470888614654541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.470888614654541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.471407413482666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.486452579498291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([242, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48735618591308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48735618591308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48781776428222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5044345855712891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5052471160888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5052471160888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.505584716796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5201015472412109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5208077430725098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5208077430725098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5210556983947754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5334534645080566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5342369079589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5342369079589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5344619750976562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5472908020019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5480608940124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5480608940124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.548255443572998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.560706615447998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5613398551940918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5613398551940918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5614848136901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5717768669128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5722966194152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5722966194152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5724034309387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5807347297668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5812926292419434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5812926292419434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5813937187194824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5899863243103027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5906729698181152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5906729698181152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5907855033874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6011385917663574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.601661205291748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.601661205291748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.601743221282959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6098628044128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6102547645568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6102547645568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6103119850158691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6163773536682129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6166720390319824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6166720390319824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6167120933532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6212382316589355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6218228340148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6218228340148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6218934059143066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6303620338439941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6306729316711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6306729316711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6307110786437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6355557441711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6358656883239746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6358656883239746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6359000205993652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.640500545501709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6407718658447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6407718658447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6408004760742188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6448345184326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6449213027954102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6449213027954102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6449308395385742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6463422775268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6465702056884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6465702056884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6465911865234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6498432159423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6500096321105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6500096321105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6500248908996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6524968147277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6526970863342285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6526970863342285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6527142524719238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6556153297424316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([119, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6584663391113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6584663391113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6586933135986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6986408233642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 119, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6843171119689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6847524642944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.685187816619873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6847305297851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2919, 40])
input nodes number: 7963
output nodes number: 2919
edges number: 18061
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6848330497741699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6848335266113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022722244262695312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 20 input nodes size: 17029
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02123546600341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02123546600341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029355525970458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029376983642578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01968097686767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02012920379638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02012920379638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02012920379638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17029, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02012920379638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([806, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04152059555053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04152059555053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04228925704956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.048638343811035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([852, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04906654357910156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04906654357910156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 852, 128]), torch.Size([1, 852, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04987907409667969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06216621398925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 852, 128])
m.shape torch.Size([737, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06283760070800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06283760070800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 737, 128]), torch.Size([1, 737, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06354045867919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07900333404541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 737, 128])
m.shape torch.Size([662, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08032846450805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08032846450805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08095979690551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09926843643188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 662, 128])
m.shape torch.Size([636, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10046911239624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10046911239624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10107564926147461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12334775924682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([480, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12441778182983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12441778182983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12487554550170898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14455938339233398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([405, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14568233489990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14568233489990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 405, 128]), torch.Size([1, 405, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14606857299804688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16538047790527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 405, 128])
m.shape torch.Size([380, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16663694381713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16663694381713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16699934005737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18765592575073242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([288, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18871068954467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18871068954467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18898534774780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20656347274780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([2090, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21639204025268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21639204025268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2090, 128]), torch.Size([1, 2090, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21842479705810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36501312255859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2090, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34636831283569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3533644676208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36036062240600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.35330963134765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7336, 256])
first layer input nodes number: 17029
first layer output nodes number: 7336
edges number: 42796
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3604898452758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36748600006103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3700752258300781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3700752258300781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([545, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38722991943359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38722991943359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 545, 256]), torch.Size([1, 545, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38826942443847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39658546447753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 545, 256])
m.shape torch.Size([447, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3969249725341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3969249725341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3977775573730469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41098976135253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([319, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4114832878112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4114832878112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4120917320251465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4275527000427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42833518981933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42833518981933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42884063720703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4434986114501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([238, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44438982009887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44438982009887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44484376907348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46118593215942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4617609977722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4617609977722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46202611923217773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47342634201049805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47416210174560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47416210174560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4744081497192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4867105484008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48749494552612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48749494552612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4877200126647949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5005488395690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5012063980102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5012063980102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5013761520385742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5122404098510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5128765106201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5128765106201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5130195617675781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5231761932373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5236020088195801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5236020088195801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5236916542053223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5306839942932129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5313081741333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5313081741333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5314188003540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5408220291137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5412540435791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5412540435791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5413284301757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5481719970703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5485653877258301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5485653877258301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5486264228820801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5546689033508301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5550713539123535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5550713539123535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5551285743713379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5611939430236816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5615501403808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5615501403808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5615978240966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.566986083984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5672731399536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5672731399536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5673093795776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5716581344604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5720553398132324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5720553398132324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5721011161804199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5779147148132324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5782389640808105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5782389640808105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.578275203704834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5831313133239746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5835747718811035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5835747718811035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.583620548248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5900750160217285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5903148651123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5903148651123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5903396606445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5940093994140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5942931175231934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5942931175231934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5943198204040527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5984587669372559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5986666679382324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5986666679382324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5986857414245605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6017756462097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6019740104675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6019740104675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6019911766052246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6048922538757324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([106, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6074309349060059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6074309349060059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.607633113861084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.643216609954834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 106, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6293692588806152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6297917366027832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6302142143249512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6297702789306641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2833, 40])
input nodes number: 7336
output nodes number: 2833
edges number: 17169
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6298336982727051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6298341751098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.021018028259277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 21 input nodes size: 35376
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019668102264404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019668102264404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0372462272644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.037267208099365234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029125690460205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02981424331665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02981424331665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02981424331665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([35376, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02981424331665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([928, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0670466423034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0670466423034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 928, 128]), torch.Size([1, 928, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0679316520690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0750117301940918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 928, 128])
m.shape torch.Size([959, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07548379898071289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07548379898071289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07639837265014648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09074783325195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([785, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09141349792480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09141349792480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0921621322631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10863208770751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([670, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10953569412231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10953569412231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11017465591430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12870454788208008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([627, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12987995147705078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12987995147705078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1304779052734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15247774124145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([528, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15368938446044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15368938446044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15419292449951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1767745018005371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([479, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17812156677246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17812156677246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17857837677001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20141887664794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([410, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20275449752807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20275449752807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20314550399780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2254328727722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([350, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22673940658569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22673940658569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22707319259643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24843549728393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([5115, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2726588249206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2726588249206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 5115, 128]), torch.Size([1, 5115, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27805137634277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6252312660217285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 5115, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5914244651794434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6025605201721191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6136965751647949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6024794578552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([10851, 256])
first layer input nodes number: 35376
first layer output nodes number: 10851
edges number: 75117
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6131744384765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6243104934692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6261100769042969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6261100769042969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([585, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.643336296081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.643336296081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6444520950317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6539411544799805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([461, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6542696952819824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6542696952819824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.655148983001709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6683540344238281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([317, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6688284873962402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6688284873962402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6694331169128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6836757659912109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.684257984161377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.684257984161377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6846966743469238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6974186897277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([213, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6982927322387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6982927322387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6986989974975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7133245468139648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([132, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7138829231262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7138829231262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.714134693145752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7249608039855957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7256760597229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7256760597229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.725914478302002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7378354072570801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7385239601135254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7385239601135254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7387242317199707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7501397132873535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([69, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7506365776062012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7506365776062012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7507681846618652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7591910362243652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7596926689147949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7596926689147949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7598052024841309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7677950859069824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7683205604553223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7683205604553223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.768425464630127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7766079902648926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7770862579345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7770862579345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7771739959716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7846317291259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7850127220153809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7850127220153809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7850775718688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.791043758392334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7913613319396973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7913613319396973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7914109230041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7963204383850098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7965984344482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7965984344482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7966384887695312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8008842468261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8010950088500977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8010950088500977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8011236190795898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.804356575012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8045387268066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8045387268066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8045616149902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8073081970214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8075909614562988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8075909614562988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8076233863830566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8117413520812988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8122000694274902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8122000694274902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8122496604919434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8188948631286621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8191971778869629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8191971778869629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8192296028137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8238015174865723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8241486549377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8241486549377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8241829872131348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8292641639709473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8294162750244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8294162750244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8294315338134766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8317966461181641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8319220542907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8319220542907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8319334983825684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8337874412536621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8339896202087402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8339896202087402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8340067863464355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8369078636169434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([171, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.841008186340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.841008186340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.841334342956543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.898737907409668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 171, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8847408294677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8851547241210938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8855686187744141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8851337432861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2777, 40])
input nodes number: 10851
output nodes number: 2777
edges number: 17206
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8852272033691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8852276802062988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03116130828857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 22 input nodes size: 31391
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029117107391357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029117107391357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04408550262451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044106483459472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02650737762451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02720355987548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02720355987548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02720355987548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([31391, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02720355987548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([847, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06488275527954102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06488275527954102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06569051742553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07215261459350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([848, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07255744934082031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07255744934082031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07336616516113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08549690246582031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([783, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08642435073852539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08642435073852539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08717107772827148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10423660278320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([736, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10526704788208008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10526704788208008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 736, 128]), torch.Size([1, 736, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10596895217895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12651872634887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 736, 128])
m.shape torch.Size([603, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12760543823242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12760543823242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12818050384521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14909887313842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([511, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15027332305908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15027332305908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15076065063476562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17171573638916016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([470, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17304086685180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17304086685180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17348909378051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19590044021606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([400, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19720220565795898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19720220565795898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19758367538452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21932744979858398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([358, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2206730842590332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2206730842590332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22101449966430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24286508560180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([5249, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26772356033325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26772356033325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 5249, 128]), torch.Size([1, 5249, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27272939682006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6281437873840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 5249, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5942869186401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6045913696289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6148958206176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6045107841491699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([10805, 256])
first layer input nodes number: 31391
first layer output nodes number: 10805
edges number: 76119
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6160073280334473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6263117790222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6297636032104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6297636032104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([540, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6470050811767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6470050811767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6480350494384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6567769050598145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([443, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6571135520935059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6571135520935059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6579585075378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6720619201660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([335, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6726055145263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6726055145263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6732444763183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6905989646911621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([262, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6912870407104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6912870407104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6917867660522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.706298828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.707005500793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.707005500793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7073850631713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7210493087768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7217884063720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7217884063720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7220954895019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7353000640869141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7359271049499512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7359271049499512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7361483573913574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7472109794616699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([89, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7477850914001465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7477850914001465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7479548454284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7576308250427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7583246231079102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7583246231079102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7584962844848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7694826126098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([59, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7699642181396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7699642181396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7700767517089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7780666351318359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7785711288452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7785711288452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7786722183227539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7865571975708008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([37, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.786933422088623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.786933422088623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7870039939880371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7930026054382324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7933549880981445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7933549880981445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7934141159057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.798853874206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([20, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7990937232971191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7990937232971191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7991318702697754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8029084205627441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8032355308532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8032355308532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.803281307220459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.808133602142334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.808356761932373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.808356761932373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.808387279510498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.811835765838623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8121967315673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8121967315673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8122406005859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8175048828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8178291320800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8178291320800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8178672790527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8227119445800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8230037689208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8230037689208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8230361938476562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8273811340332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8275957107543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8275957107543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8276185989379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.830845832824707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8310971260070801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8310971260070801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8311219215393066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8347916603088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8350119590759277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8350119590759277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8350329399108887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.838284969329834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8384294509887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8384294509887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8384428024291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8406057357788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8408989906311035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8408989906311035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8409237861633301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8451142311096191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([171, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8492107391357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8492107391357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8495368957519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9069404602050781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 171, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8928704261779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.893282413482666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8936944007873535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8932614326477051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2762, 40])
input nodes number: 10805
output nodes number: 2762
edges number: 17267
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8933610916137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8933615684509277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.028534412384033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 23 input nodes size: 32422
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.026505470275878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.026505470275878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.041965484619140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.041986942291259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02699756622314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.027878761291503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.027878761291503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.027878761291503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([32422, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.027878761291503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([686, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07441329956054688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07441329956054688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 686, 128]), torch.Size([1, 686, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07506752014160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08111095428466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 686, 128])
m.shape torch.Size([691, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08144283294677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08144283294677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08210182189941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09198665618896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([589, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0924997329711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0924997329711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09306144714355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10541915893554688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([612, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10630559921264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10630559921264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10688924789428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12461233139038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([563, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12566280364990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12566280364990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12619972229003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14574384689331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([540, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1470203399658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1470203399658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1475353240966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16984939575195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([515, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1713109016418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1713109016418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17180204391479492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19709110260009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([508, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19878339767456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19878339767456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19926786422729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2268824577331543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([439, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22852420806884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22852420806884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22894287109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2557373046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([7050, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.28914499282836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.28914499282836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7050, 128]), torch.Size([1, 7050, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2964286804199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7737903594970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7050, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7309670448303223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7425951957702637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7542233467102051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7425041198730469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([12193, 256])
first layer input nodes number: 32422
first layer output nodes number: 12193
edges number: 94458
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7544670104980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7660951614379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7690024375915527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7690024375915527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([440, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7931656837463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7931656837463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7940049171447754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8024392127990723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([343, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8026790618896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8026790618896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8033332824707031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8133697509765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([262, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8137984275817871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8137984275817871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.814298152923584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8281874656677246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([211, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8287491798400879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8287491798400879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8291516304016113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.840822696685791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8415203094482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8415203094482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8418769836425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8547172546386719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8562703132629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8562703132629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8566060066223145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8710408210754395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8717074394226074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8717074394226074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8719439506530762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8837695121765137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8846125602722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8846125602722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8848509788513184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8984408378601074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([73, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8989534378051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8989534378051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8990926742553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9080038070678711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9087033271789551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9087033271789551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9088559150695801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9196896553039551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9204697608947754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9204697608947754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9206242561340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9326748847961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9332208633422852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9332208633422852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.933323860168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9420785903930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9425644874572754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9425644874572754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9426465034484863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9501919746398926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9506220817565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9506220817565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9506888389587402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9572978019714355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.957827091217041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.957827091217041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9579014778137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9657864570617676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9663643836975098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9663643836975098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9664406776428223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9750618934631348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9756612777709961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9756612777709961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9757356643676758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9846620559692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9851093292236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9851093292236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9851627349853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9919452667236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9924483299255371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9924483299255371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9925036430358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.999915599822998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0003304481506348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0003304481506348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0003743171691895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0065598487854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0070223808288574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0070223808288574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.007068157196045  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.013843059539795  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0142011642456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0142011642456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.014235496520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.019556999206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0197830200195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0197830200195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0198040008544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.023202896118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.023676872253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.023676872253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.023716926574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0304861068725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([319, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0385632514953613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0385632514953613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0391716957092285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1543960571289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 319, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1332769393920898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1336979866027832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1341190338134766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.133676528930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2825, 40])
input nodes number: 12193
output nodes number: 2825
edges number: 23695
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1337981224060059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.133798599243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029494285583496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 24 input nodes size: 49628
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02700662612915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02700662612915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05067110061645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05069255828857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03521108627319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036623477935791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036623477935791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036623477935791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([49628, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036623477935791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([568, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11405086517333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11405086517333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1145925521850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11960172653198242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([676, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11997556686401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11997556686401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1206202507019043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13030767440795898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([630, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13088655471801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13088655471801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13148736953735352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14470529556274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([581, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1460108757019043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1460108757019043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14656496047973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16263341903686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([620, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1638345718383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1638345718383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16442584991455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18573665618896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([579, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18709754943847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18709754943847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18764972686767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21184253692626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([540, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21336889266967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21336889266967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2138838768005371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23984098434448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([541, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24164724349975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24164724349975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24216318130493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27253103256225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([607, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27487802505493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27487802505493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27545690536499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3131980895996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([13160, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37566041946411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37566041946411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13160, 128]), torch.Size([1, 13160, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3882107734680176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2842259407043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13160, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2104334831237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2280783653259277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2457232475280762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2279400825500488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([18502, 256])
first layer input nodes number: 49628
first layer output nodes number: 18502
edges number: 157879
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2460951805114746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.263740062713623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2681736946105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2681736946105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([323, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2989840507507324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2989840507507324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2996001243591309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3063063621520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([308, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3065905570983887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3065905570983887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.307178020477295  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.317430019378662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([213, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3177504539489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3177504539489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3181567192077637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.327094554901123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([154, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3274836540222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3274836540222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.32777738571167  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3362956047058105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([151, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3368744850158691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3368744850158691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3371624946594238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3475308418273926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([124, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.34810209274292  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.34810209274292  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3483386039733887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.358508586883545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([106, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3591036796569824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3591036796569824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3593058586120605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3694148063659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3699674606323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3699674606323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3701295852661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3793706893920898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3799386024475098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3799386024475098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3800816535949707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3892369270324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3898191452026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3898191452026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.389948844909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3991575241088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3998966217041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3998966217041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4000415802001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4113483428955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4121065139770508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4121065139770508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4122438430786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4239168167114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4246478080749512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4246478080749512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4247698783874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4360003471374512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4366121292114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4366121292114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4367074966430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4461488723754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4468941688537598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4468941688537598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4469990730285645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4581189155578613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4587740898132324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4587740898132324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4588618278503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4687762260437012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4694676399230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4694676399230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4695534706115723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4798531532287598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4806408882141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4806408882141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4807324409484863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4923596382141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.493135929107666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.493135929107666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4932217597961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.504723072052002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5054683685302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5054683685302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5055465698242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5165729522705078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.517533779144287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.517533779144287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.517627239227295  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5314593315124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5318355560302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5318355560302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5318737030029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5377864837646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5383644104003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5383644104003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5384159088134766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5467586517333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5474019050598145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5474019050598145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.547457218170166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.55680513381958  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([570, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5704736709594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5704736709594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5715608596801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7656478881835938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 570, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7376065254211426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7380304336547852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7384543418884277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.738008975982666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2844, 40])
input nodes number: 18502
output nodes number: 2844
edges number: 31603
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7381715774536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7381720542907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03909158706665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 25 input nodes size: 40150
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03521394729614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03521394729614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05474519729614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.054766178131103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.031080245971679688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.032341957092285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.032341957092285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.032341957092285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([40150, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.032341957092285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([506, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09922075271606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09922075271606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09970331192016602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10356378555297852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([590, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10388517379760742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10388517379760742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10444784164428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11288785934448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([545, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11338615417480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11338615417480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1139059066772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12539005279541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([519, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12612009048461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12612009048461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12661504745483398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1417698860168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([489, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14268827438354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14268827438354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14315462112426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1599431037902832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([481, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1610860824584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1610860824584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1615447998046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18126964569091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([475, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18262577056884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18262577056884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18307876586914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20572853088378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([478, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20732545852661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20732545852661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20778131484985352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2337651252746582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([511, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23573017120361328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23573017120361328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23621749877929688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2674064636230469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([11388, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32146501541137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32146501541137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11388, 128]), torch.Size([1, 11388, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33232545852661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1072697639465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11388, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0437521934509277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0589938163757324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.074235439300537  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0588746070861816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15982, 256])
first layer input nodes number: 40150
first layer output nodes number: 15982
edges number: 136356
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0745368003845215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0897784233093262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0940680503845215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0940680503845215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([297, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.126060962677002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.126060962677002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1266274452209473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1329102516174316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([285, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1331748962402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1331748962402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.133718490600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1429972648620605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([211, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.143333911895752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.143333911895752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1437363624572754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.152590274810791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([153, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.152977466583252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.152977466583252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1532692909240723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1617321968078613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([132, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1622209548950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1622209548950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1624727249145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1715364456176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([110, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1720452308654785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1720452308654785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.172255039215088  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.181276798248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([87, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1817574501037598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1817574501037598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1819233894348145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1902203559875488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([80, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1907525062561035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1907525062561035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1909050941467285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1996026039123535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.200322151184082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.200322151184082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2004976272583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2117280960083008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.212294101715088  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.212294101715088  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2124238014221191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.221632480621338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.222276210784912  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.222276210784912  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2224040031433105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2323718070983887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2330002784729004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2330002784729004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2331147193908691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.242842197418213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.243272304534912  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.243272304534912  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2433466911315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.250190258026123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2507452964782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2507452964782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2508292198181152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2591376304626465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2596149444580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2596149444580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.259683609008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2669620513916016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2674198150634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2674198150634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2674808502197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2743778228759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2748050689697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2748050689697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2748584747314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2812671661376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2819151878356934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2819151878356934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.281989574432373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2914366722106934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2920751571655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2920751571655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2921457290649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3016023635864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3021249771118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3021249771118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.302180290222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3099794387817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3103556632995605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3103556632995605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3103938102722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3160395622253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3165702819824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3165702819824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.316619873046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3243064880371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3246798515319824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3246798515319824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.324714183807373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3302760124206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3309049606323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3309049606323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.330958366394043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3399839401245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([740, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3577384948730469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3577384948730469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 740, 256]), torch.Size([1, 740, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3591499328613281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.6079425811767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 740, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5787968635559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5792078971862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5796189308166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5791869163513184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 15982
output nodes number: 2758
edges number: 32860
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5793142318725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5793147087097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03452444076538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 26 input nodes size: 45355
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05269432067871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.052715301513671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03316307067871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03427314758300781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03427314758300781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03427314758300781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([45355, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03427314758300781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([672, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09533977508544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09533977508544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09598064422607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10163640975952148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 672, 128])
m.shape torch.Size([790, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10206937789916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10206937789916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10282278060913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11412382125854492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([704, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11489248275756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11489248275756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 704, 128]), torch.Size([1, 704, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11556386947631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13097906112670898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 704, 128])
m.shape torch.Size([639, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13186216354370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13186216354370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13247156143188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15014410018920898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([643, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15137243270874023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15137243270874023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15198564529418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17488956451416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([605, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1763138771057129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1763138771057129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17689085006713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2021193504333496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([534, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20361328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20361328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20412254333496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23049640655517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([554, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23235511779785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23235511779785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23288345336914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2638530731201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([465, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26558446884155273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26558446884155273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26602792739868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.29440927505493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([9811, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3409700393676758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3409700393676758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9811, 128]), torch.Size([1, 9811, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3503265380859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0260934829711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9811, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.969332218170166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9840350151062012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9987378120422363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9839200973510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15417, 256])
first layer input nodes number: 45355
first layer output nodes number: 15417
edges number: 124230
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.9990777969360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0137805938720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0174565315246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0174565315246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([388, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0416436195373535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0416436195373535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0423836708068848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0483918190002441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([389, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0487699508666992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0487699508666992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0495119094848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0606412887573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.061063289642334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.061063289642334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0615878105163574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0752668380737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([217, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0758390426635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0758390426635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0762529373168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0882558822631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([176, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0888948440551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0888948440551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.0892305374145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1013154983520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1020069122314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1020069122314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1022911071777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.114511489868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.115156650543213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.115156650543213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.115379810333252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.126537799835205  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1272568702697754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1272568702697754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1274628639221191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.139204502105713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1397504806518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1397504806518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1398935317993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1490488052368164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1495542526245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1495542526245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1496686935424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1577939987182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1582865715026855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1582865715026855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1583857536315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1661219596862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1666955947875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1666955947875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1667985916137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.175553321838379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1760516166687012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1760516166687012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.176135540008545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.18385648727417  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1843528747558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1843528747558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1844291687011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1919822692871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.192636489868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.192636489868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.192728042602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.202432632446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.202817440032959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.202817440032959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2028708457946777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2089056968688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2093205451965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2093205451965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2093720436096191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2155518531799316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2159414291381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2159414291381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.215987205505371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2218008041381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.222179889678955  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.222179889678955  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.222221851348877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2278447151184082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2282662391662598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2282662391662598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2283101081848145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2344956398010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.234938144683838  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.234938144683838  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2349820137023926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2414746284484863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2417912483215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2417912483215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2418217658996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2465519905090332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.246912956237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.246912956237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2469453811645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2521982192993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2524127960205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2524127960205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.252431869506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.255655288696289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([412, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.26554536819458  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.26554536819458  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2663311958312988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4081826210021973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 412, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3868770599365234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.387293815612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3877105712890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.387272834777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2794, 40])
input nodes number: 15417
output nodes number: 2794
edges number: 24646
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3874144554138184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3874149322509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036287784576416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 27 input nodes size: 45807
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.033168792724609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.033168792724609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05501127243041992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05503273010253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03338479995727539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.034711360931396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.034711360931396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.034711360931396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([45807, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.034711360931396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([627, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10676193237304688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10676193237304688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1073598861694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11254262924194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([690, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11290168762207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11290168762207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11355972290039062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12389898300170898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([697, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12456703186035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12456703186035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 697, 128]), torch.Size([1, 697, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12523174285888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13985538482666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 697, 128])
m.shape torch.Size([573, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14150714874267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14150714874267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14205360412597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15790081024169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([621, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15910816192626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15910816192626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1597003936767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18121862411499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([572, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18255901336669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18255901336669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1831045150756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2070627212524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([549, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20862245559692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20862245559692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20914602279663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23633766174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([562, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2382197380065918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2382197380065918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2387557029724121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26956701278686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([535, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2715950012207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2715950012207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27210521697998047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3053469657897949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([12072, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3626556396484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3626556396484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12072, 128]), torch.Size([1, 12072, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37416839599609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1929130554199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12072, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.125169277191162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1418566703796387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1585440635681152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.141726016998291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17498, 256])
first layer input nodes number: 45807
first layer output nodes number: 17498
edges number: 146801
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1588873863220215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.175574779510498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1798930168151855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1798930168151855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([345, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2103276252746582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2103276252746582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2109856605529785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.219088077545166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([298, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.219332218170166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.219332218170166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2199006080627441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2287259101867676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([249, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2291598320007324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2291598320007324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2296347618103027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2400832176208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([160, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2404608726501465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2404608726501465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2407660484313965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2496161460876465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([160, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2502326965332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2502326965332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2505378723144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2615242004394531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([118, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2620525360107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2620525360107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.262277603149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2719554901123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([97, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2724957466125488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2724957466125488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2726807594299316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2819314002990723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([76, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.282423496246338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.282423496246338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2825684547424316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2908310890197754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([71, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2913727760314941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2913727760314941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2915081977844238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3001751899719238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3008861541748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3008861541748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3010406494140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3120098114013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3126516342163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3126516342163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3127813339233398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3228979110717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3233866691589355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3233866691589355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3234782218933105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3312602043151855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3317770957946777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3317770957946777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3318629264831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.339759349822998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3404030799865723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3404030799865723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3405003547668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.350130558013916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3507452011108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3507452011108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3508329391479492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.360133171081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3608274459838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3608274459838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3609189987182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3712644577026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.371790885925293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.371790885925293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3718576431274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.379868507385254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3805274963378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3805274963378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3806037902832031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3902931213378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3907299041748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3907299041748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3907794952392578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3974246978759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.397900104522705  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.397900104522705  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3979496955871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4049420356750488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4055633544921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4055633544921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4056243896484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4146575927734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4152193069458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4152193069458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4152727127075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4235506057739258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4241433143615723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4241433143615723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.424196720123291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4328484535217285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.433375358581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.433375358581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4334211349487305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.441157341003418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([628, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4562244415283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4562244415283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 628, 256]), torch.Size([1, 628, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4574222564697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.6695003509521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 628, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.641782283782959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.6422038078308105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.642625331878662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.6421823501586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2828, 40])
input nodes number: 17498
output nodes number: 2828
edges number: 31190
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.6423392295837402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.6423397064208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03704118728637695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 28 input nodes size: 43982
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03338956832885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03338956832885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05487394332885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05489492416381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03303098678588867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03431367874145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03431367874145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03431367874145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([43982, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03431367874145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([592, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10465478897094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10465478897094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10521936416625977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10973596572875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([628, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11005258560180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11005258560180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 628, 128]), torch.Size([1, 628, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11065149307250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11963510513305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 628, 128])
m.shape torch.Size([556, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12013101577758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12013101577758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12066125869750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13296747207641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([567, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13378381729125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13378381729125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1343245506286621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15000581741333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([550, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1510467529296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1510467529296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15157127380371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1704540252685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([519, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1716766357421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1716766357421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17217159271240234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1937856674194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([554, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1953873634338379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1953873634338379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19591569900512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22363042831420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([451, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22508668899536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22508668899536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22551679611206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.250032901763916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([482, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.25188636779785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.25188636779785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2523460388183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2817649841308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([11925, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3383979797363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3383979797363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11925, 128]), torch.Size([1, 11925, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34977054595947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1601653099060059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11925, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.093820571899414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1098651885986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1259098052978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1097397804260254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16824, 256])
first layer input nodes number: 43982
first layer output nodes number: 16824
edges number: 142722
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1262397766113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1422843933105469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1468830108642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1468830108642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([354, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1754112243652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1754112243652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.17608642578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1829476356506348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([302, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1831908226013184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1831908226013184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1837668418884277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1929121017456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([218, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1932530403137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1932530403137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1936688423156738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2028164863586426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([171, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2032661437988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2032661437988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.203592300415039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2130508422851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([152, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.213618278503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.213618278503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2139081954956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2243452072143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([113, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2248520851135254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2248520851135254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2250676155090332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2343354225158691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2350287437438965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2350287437438965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2352557182312012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2466044425964355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([83, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2471294403076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2471294403076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2472877502441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2563114166259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2570371627807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2570371627807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2572145462036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2685670852661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2692761421203613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2692761421203613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2694344520568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2806744575500488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2811875343322754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2811875343322754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.281294345855713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.289625644683838  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2903451919555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2903451919555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2904729843139648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.301335334777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3018465042114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3018465042114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3019342422485352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3100061416625977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3103928565979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3103928565979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3104538917541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3164963722229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.316941738128662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.316941738128662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.317004680633545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.323676586151123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3244295120239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3244295120239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3245267868041992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3355188369750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3359932899475098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3359932899475098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3360543251037598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3433785438537598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3439884185791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3439884185791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3440589904785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3530216217041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3536438941955566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3536438941955566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.353712558746338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3629136085510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3633794784545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3633794784545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.363429069519043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3704214096069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3709216117858887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3709216117858887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3709712028503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3783106803894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.378772258758545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.378772258758545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3788161277770996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3856158256530762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3861689567565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3861689567565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.386218547821045  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3942523002624512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3945508003234863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3945508003234863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3945775032043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.39909029006958  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([565, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4126529693603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4126529693603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4137306213378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.6124086380004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 565, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.586583137512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5869941711425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5874052047729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5869731903076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 16824
output nodes number: 2758
edges number: 29200
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.587109088897705  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5871095657348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03654050827026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 29 input nodes size: 44598
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0545048713684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05452585220336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03447771072387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03447771072387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03447771072387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([44598, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03447771072387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([522, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11376714706420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11376714706420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11426496505737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11824750900268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([559, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11853170394897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11853170394897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1190648078918457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1270613670349121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([571, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12761163711547852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12761163711547852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12815618515014648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14070653915405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([494, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14137649536132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14137649536132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1418476104736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15550994873046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([527, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15653085708618164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15653085708618164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15703344345092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1751265525817871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([463, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17619991302490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17619991302490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17664146423339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19562816619873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([476, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19699621200561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19699621200561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1974501609802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22014760971069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([510, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22186613082885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22186613082885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2223525047302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2500758171081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([494, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2519526481628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2519526481628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2524237632751465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2825751304626465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([13917, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34870100021362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34870100021362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13917, 128]), torch.Size([1, 13917, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36197328567504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3242850303649902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13917, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2489967346191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2666711807250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2843456268310547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2665328979492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([18533, 256])
first layer input nodes number: 44598
first layer output nodes number: 18533
edges number: 161770
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.284679889678955  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.302354335784912  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3070597648620605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3070597648620605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([308, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3398380279541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3398380279541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3404254913330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3471708297729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([256, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3473691940307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3473691940307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3478574752807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3551816940307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([224, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.355583667755127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.355583667755127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.356010913848877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.365410327911377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([159, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3658080101013184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3658080101013184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3661112785339355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.374906063079834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([129, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3753747940063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3753747940063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3756208419799805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3844785690307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([103, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3849496841430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3849496841430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.385146141052246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3935937881469727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([72, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3939800262451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3939800262451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3941173553466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4009838104248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([61, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4013843536376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4013843536376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4015007019042969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.408132553100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4087319374084473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4087319374084473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.408876895904541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.418154239654541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4187545776367188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4187545776367188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4188880920410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4283676147460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4289355278015137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4289355278015137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4290499687194824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.437976360321045  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4386343955993652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4386343955993652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4387526512145996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4488043785095215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.449470043182373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.449470043182373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4495806694030762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4597582817077637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4601740837097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4601740837097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4602408409118652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4668498039245605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4672203063964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4672203063964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4672737121582031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4729347229003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4734926223754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4734926223754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4735651016235352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.481755256652832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4822750091552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4822750091552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.482339859008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.490121841430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4908337593078613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4908337593078613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4909157752990723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5013318061828613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5019850730895996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5019850730895996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5020575523376465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5117697715759277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5123295783996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5123295783996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5123887062072754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5207257270812988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5213828086853027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5213828086853027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5214476585388184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5310454368591309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5316686630249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5316686630249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5317277908325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5408926010131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.541548728942871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.541548728942871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5416078567504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5511865615844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5517802238464355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5517802238464355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5518317222595215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.560534954071045  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([751, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.578554630279541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.578554630279541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 751, 256]), torch.Size([1, 751, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.5799870491027832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.837641716003418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 751, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.807499885559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.8079113960266113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.8083229064941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.8078904151916504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2759, 40])
input nodes number: 18533
output nodes number: 2759
edges number: 33669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.8080501556396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.8080506324768066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03696584701538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 30 input nodes size: 38228
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05124950408935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05127096176147461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029765605926513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.031127452850341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.031127452850341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.031127452850341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([38228, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.031127452850341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([423, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1021890640258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1021890640258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10259246826171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1058197021484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([416, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10601472854614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10601472854614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10641145706176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11236238479614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([448, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11280488967895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11280488967895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11323213577270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12263154983520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([442, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1232609748840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1232609748840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12368249893188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13590669631958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([415, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13699865341186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13699865341186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 415, 128]), torch.Size([1, 415, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13739442825317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1516423225402832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 415, 128])
m.shape torch.Size([423, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15265464782714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15265464782714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15305805206298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17040443420410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([437, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.171661376953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.171661376953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 437, 128]), torch.Size([1, 437, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17207813262939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1929159164428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 437, 128])
m.shape torch.Size([428, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19434022903442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19434022903442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1947484016418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21801424026489258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([465, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21980571746826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21980571746826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22024917602539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24863052368164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([12539, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.308199405670166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.308199405670166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12539, 128]), torch.Size([1, 12539, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.320157527923584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1691842079162598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12539, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1015706062316895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1172451972961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1329197883605957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1171226501464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16436, 256])
first layer input nodes number: 38228
first layer output nodes number: 16436
edges number: 145038
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.133206844329834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.148881435394287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1535439491271973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1535439491271973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([271, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1900978088378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1900978088378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1906147003173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1961913108825684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([205, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1963272094726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1963272094726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1967182159423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2025833129882812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([176, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2028956413269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2028956413269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2032313346862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2106165885925293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([161, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2110681533813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2110681533813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2113752365112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.220280647277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([114, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.220674991607666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.220674991607666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2208924293518066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2287201881408691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([94, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2291536331176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2291536331176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2293329238891602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2370424270629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([86, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2375316619873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2375316619873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2376956939697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2458972930908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([81, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2464385032653809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2464385032653809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2465929985046387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.255399227142334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2560834884643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2560834884643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.256251335144043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.266993522644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2675728797912598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2675728797912598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2677044868469238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2770485877990723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.27769136428833  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.27769136428833  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2778191566467285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2877869606018066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.288449764251709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.288449764251709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2885699272155762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.298783779144287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2994112968444824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2994112968444824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.299516201019287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3091673851013184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3099761009216309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3099761009216309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3100981712341309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3221831321716309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.322929859161377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.322929859161377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3230366706848145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3343586921691895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3349361419677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3349361419677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3350143432617188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.343851089477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3446946144104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3446946144104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3447976112365723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3571572303771973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.35797119140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.35797119140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3580665588378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.37017822265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3708248138427734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3708248138427734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3708972930908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3806095123291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([56, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3821759223937988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3821759223937988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3822827339172363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3973431587219238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3982186317443848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3982186317443848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3983063697814941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4112915992736816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4118609428405762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4118609428405762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4119162559509277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.42048978805542  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4211254119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4211254119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.421182632446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4304523468017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4313697814941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4313697814941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.431447982788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4446640014648438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([815, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.464308261871338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.464308261871338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 815, 256]), torch.Size([1, 815, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.46586275100708  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7540459632873535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 815, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7200279235839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7204527854919434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7208776473999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7204313278198242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2850, 40])
input nodes number: 16436
output nodes number: 2850
edges number: 37632
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7205886840820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7205891609191895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03346872329711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 31 input nodes size: 48103
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02977895736694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02977895736694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05321645736694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0532374382019043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.034987449645996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036355018615722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036355018615722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036355018615722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([48103, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036355018615722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([589, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11145973205566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11145973205566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11202144622802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1165151596069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([631, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1168360710144043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1168360710144043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 631, 128]), torch.Size([1, 631, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11743783950805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12701034545898438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 631, 128])
m.shape torch.Size([582, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12754201889038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12754201889038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1280970573425293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14030790328979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([605, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1416001319885254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1416001319885254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14217710494995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15890932083129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([597, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16004419326782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16004419326782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1606135368347168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18195438385009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([534, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1831974983215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1831974983215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18370676040649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2058701515197754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([522, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20735788345336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.20735788345336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2078557014465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23328924179077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([511, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23498964309692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23498964309692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23547697067260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26325464248657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([495, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2651352882385254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2651352882385254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2656073570251465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2958197593688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([12870, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3569526672363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3569526672363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12870, 128]), torch.Size([1, 12870, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36922645568847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2412309646606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12870, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1702995300292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1874046325683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2045097351074219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.1872706413269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17936, 256])
first layer input nodes number: 48103
first layer output nodes number: 17936
edges number: 153103
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2048702239990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.221975326538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.226724624633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.226724624633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([354, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2562379837036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2562379837036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.256913185119629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2625741958618164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([296, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2628059387207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2628059387207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2633705139160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2730827331542969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([209, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2734031677246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2734031677246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2738018035888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.282571792602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([193, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2831149101257324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2831149101257324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2834830284118652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2941584587097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([146, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2946763038635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.2946763038635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.294954776763916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3049798011779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([106, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3054518699645996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3054518699645996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3056540489196777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.314347743988037  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([90, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.314852237701416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.314852237701416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3150238990783691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3236069679260254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([65, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.324021339416504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.324021339416504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3241453170776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.331212043762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.331824779510498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.331824779510498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3319735527038574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3414950370788574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3420934677124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3420934677124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3422269821166992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3517065048217773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3523907661437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3523907661437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3525261878967285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3630890846252441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3637137413024902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3637137413024902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.363828182220459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3735556602478027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.374223232269287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.374223232269287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3743338584899902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3845114707946777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3850617408752441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3850617408752441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3851475715637207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3936448097229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3943371772766113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3943371772766113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.3944344520568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4047455787658691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4053583145141602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4053583145141602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.405440330505371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.414708137512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4151086807250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4151086807250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4151601791381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.421339988708496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4218335151672363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4218335151672363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4218907356262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4291577339172363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4297504425048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4297504425048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4298152923583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4385051727294922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4390497207641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4390497207641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4391069412231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4471750259399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4475703239440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4475703239440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4476103782653809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.453538417816162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4537301063537598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4537301063537598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.453749179840088  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4567055702209473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4570941925048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4570941925048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4571285247802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4626903533935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4632039070129395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4632039070129395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4632477760314941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4706616401672363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([630, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4857778549194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4857778549194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 630, 256]), torch.Size([1, 630, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.4869794845581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.7098803520202637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 630, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.6830153465270996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.6834263801574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.6838374137878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.6834053993225098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 17936
output nodes number: 2758
edges number: 30223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.683546543121338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 1.683547019958496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0387272834777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0387272834777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0387272834777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007861793041229248 |0.0017456263303756714 |0.11509741097688675 |8.589774370193481e-05 |0.07621331512928009 |0.00476384162902832 |
----------------------------------------------------------pseudo_mini_loss sum 4.913638591766357
Total (block generation + training)time/epoch 28.15216040611267
Training time/epoch 6.609169960021973
Training time without block to device /epoch 6.553309917449951
Training time without total dataloading part /epoch 6.129455804824829
load block tensor time/epoch 0.25157737731933594
block to device time/epoch 0.055860042572021484
input features size transfer per epoch 4.291534423828125e-06[05:33:03] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28962740 edges into 32 parts and get 9185437 edge cuts

blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1110631
Number of first layer input nodes during this epoch:  793502
Number of first layer output nodes during this epoch:  317129
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.038726806640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.019991397857666016
global_2_local spend time (sec) 0.05482745170593262
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004274845123291016
A = g.adjacency_matrix() spent  0.012436151504516602
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.11368608474731445
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3824784755706787
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1494770050048828

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 1.364 seconds
Metis partitioning: 5.957 seconds
Split the graph: 0.660 seconds
Construct subgraphs: 0.100 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.096150398254395
2882
2871
2852
2900
2884
2865
2885
2927
2918
2779
2890
2918
2927
2831
2792
2882
2921
2918
2870
2837
2759
2795
2758
2758
2758
2758
2758
2914
2789
2773
2775
2797
total k batches seeds list generation spend  18.18766975402832
after graph partition
graph partition algorithm spend time 18.280472993850708
2882
2871
2852
2900
2884
2865
2885
2927
2918
2779
2890
2918
2927
2831
2792
2882
2921
2918
2870
2837
2759
2795
2758
2758
2758
2758
2758
2914
2789
2773
2775
2797
partition_len_list
[6469, 6438, 5073, 5782, 7464, 6336, 6966, 8651, 6690, 5954, 6891, 6213, 7836, 7246, 7272, 5248, 7903, 6542, 8305, 6198, 15475, 10356, 9613, 12487, 15914, 16142, 19917, 17655, 18329, 17354, 13862, 14365]
shared_neighbor_graph_partition_s0 selection method  spend 18.395944118499756
time for parepare:  0.018073558807373047
local_output_nid generation:  0.0008254051208496094
local_in_edges_tensor generation:  0.0009534358978271484
mini_batch_src_global generation:  0.0009133815765380859
r_  generation:  0.0060460567474365234
local_output_nid generation:  0.0008070468902587891
local_in_edges_tensor generation:  0.0008385181427001953
mini_batch_src_global generation:  0.0009911060333251953
r_  generation:  0.00693058967590332
local_output_nid generation:  0.0008323192596435547
local_in_edges_tensor generation:  0.0007486343383789062
mini_batch_src_global generation:  0.0005967617034912109
r_  generation:  0.005171298980712891
local_output_nid generation:  0.0008420944213867188
local_in_edges_tensor generation:  0.002048492431640625
mini_batch_src_global generation:  0.0006678104400634766
r_  generation:  0.005930900573730469
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.0008132457733154297
r_  generation:  0.006932258605957031
local_output_nid generation:  0.0008425712585449219
local_in_edges_tensor generation:  0.0006771087646484375
mini_batch_src_global generation:  0.0006430149078369141
r_  generation:  0.005601167678833008
local_output_nid generation:  0.0008535385131835938
local_in_edges_tensor generation:  0.0007200241088867188
mini_batch_src_global generation:  0.0007855892181396484
r_  generation:  0.007350921630859375
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0007405281066894531
mini_batch_src_global generation:  0.0008265972137451172
r_  generation:  0.0069391727447509766
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.000720977783203125
mini_batch_src_global generation:  0.0009467601776123047
r_  generation:  0.008254528045654297
local_output_nid generation:  0.0008292198181152344
local_in_edges_tensor generation:  0.0006852149963378906
mini_batch_src_global generation:  0.0007452964782714844
r_  generation:  0.0062177181243896484
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.0007548332214355469
mini_batch_src_global generation:  0.0007565021514892578
r_  generation:  0.007085323333740234
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0006732940673828125
mini_batch_src_global generation:  0.0007967948913574219
r_  generation:  0.007334232330322266
local_output_nid generation:  0.0009069442749023438
local_in_edges_tensor generation:  0.0007128715515136719
mini_batch_src_global generation:  0.0008702278137207031
r_  generation:  0.010625839233398438
local_output_nid generation:  0.0009729862213134766
local_in_edges_tensor generation:  0.0007143020629882812
mini_batch_src_global generation:  0.0007927417755126953
r_  generation:  0.007116556167602539
local_output_nid generation:  0.0008845329284667969
local_in_edges_tensor generation:  0.0007040500640869141
mini_batch_src_global generation:  0.0007069110870361328
r_  generation:  0.006388664245605469
local_output_nid generation:  0.0009191036224365234
local_in_edges_tensor generation:  0.0006928443908691406
mini_batch_src_global generation:  0.0005841255187988281
r_  generation:  0.005026817321777344
local_output_nid generation:  0.0009205341339111328
local_in_edges_tensor generation:  0.0006639957427978516
mini_batch_src_global generation:  0.0006382465362548828
r_  generation:  0.006071805953979492
local_output_nid generation:  0.0009248256683349609
local_in_edges_tensor generation:  0.0006830692291259766
mini_batch_src_global generation:  0.0007140636444091797
r_  generation:  0.0065915584564208984
local_output_nid generation:  0.0009140968322753906
local_in_edges_tensor generation:  0.0007252693176269531
mini_batch_src_global generation:  0.0008206367492675781
r_  generation:  0.006295680999755859
local_output_nid generation:  0.0009076595306396484
local_in_edges_tensor generation:  0.0006718635559082031
mini_batch_src_global generation:  0.0006029605865478516
r_  generation:  0.005365610122680664
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.0007023811340332031
mini_batch_src_global generation:  0.0010612010955810547
r_  generation:  0.010448932647705078
local_output_nid generation:  0.0009374618530273438
local_in_edges_tensor generation:  0.0006806850433349609
mini_batch_src_global generation:  0.0008749961853027344
r_  generation:  0.0060613155364990234
local_output_nid generation:  0.0008971691131591797
local_in_edges_tensor generation:  0.00072479248046875
mini_batch_src_global generation:  0.0034856796264648438
r_  generation:  0.005452156066894531
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0017061233520507812
mini_batch_src_global generation:  0.0010232925415039062
r_  generation:  0.00735163688659668
local_output_nid generation:  0.0009405612945556641
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.009751558303833008
local_output_nid generation:  0.0009584426879882812
local_in_edges_tensor generation:  0.0008478164672851562
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.008611440658569336
local_output_nid generation:  0.0009539127349853516
local_in_edges_tensor generation:  0.0008258819580078125
mini_batch_src_global generation:  0.0011022090911865234
r_  generation:  0.010901927947998047
local_output_nid generation:  0.0010497570037841797
local_in_edges_tensor generation:  0.001276254653930664
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.012286901473999023
local_output_nid generation:  0.0010030269622802734
local_in_edges_tensor generation:  0.0008563995361328125
mini_batch_src_global generation:  0.0012843608856201172
r_  generation:  0.009338617324829102
local_output_nid generation:  0.001054525375366211
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0010900497436523438
r_  generation:  0.009128093719482422
local_output_nid generation:  0.0011980533599853516
local_in_edges_tensor generation:  0.0007243156433105469
mini_batch_src_global generation:  0.0009019374847412109
r_  generation:  0.00764155387878418
local_output_nid generation:  0.0011491775512695312
local_in_edges_tensor generation:  0.0007781982421875
mini_batch_src_global generation:  0.00102996826171875
r_  generation:  0.008218050003051758
----------------------check_connections_block total spend ----------------------------- 0.4180426597595215
generate_one_block  0.017292022705078125
generate_one_block  0.012292146682739258
generate_one_block  0.008339405059814453
generate_one_block  0.009325027465820312
generate_one_block  0.011948108673095703
generate_one_block  0.010896444320678711
generate_one_block  0.011471748352050781
generate_one_block  0.011263608932495117
generate_one_block  0.012955188751220703
generate_one_block  0.009007692337036133
generate_one_block  0.010320186614990234
generate_one_block  0.010639429092407227
generate_one_block  0.012494802474975586
generate_one_block  0.010354280471801758
generate_one_block  0.010686635971069336
generate_one_block  0.0073337554931640625
generate_one_block  0.015506982803344727
generate_one_block  0.009548187255859375
generate_one_block  0.009385347366333008
generate_one_block  0.007592439651489258
generate_one_block  0.016474485397338867
generate_one_block  0.009373188018798828
generate_one_block  0.00948953628540039
generate_one_block  0.011780738830566406
generate_one_block  0.018320560455322266
generate_one_block  0.014087677001953125
generate_one_block  0.016101598739624023
generate_one_block  0.019306659698486328
generate_one_block  0.015962839126586914
generate_one_block  0.014104843139648438
generate_one_block  0.01080632209777832
generate_one_block  0.012059688568115234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03957390785217285
gen group dst list time:  0.009615659713745117
time for parepare:  0.024648189544677734
local_output_nid generation:  0.0016856193542480469
local_in_edges_tensor generation:  0.011073112487792969
mini_batch_src_global generation:  0.0013577938079833984
r_  generation:  0.01421499252319336
local_output_nid generation:  0.0020475387573242188
local_in_edges_tensor generation:  0.0017254352569580078
mini_batch_src_global generation:  0.0015993118286132812
r_  generation:  0.014232635498046875
local_output_nid generation:  0.0016086101531982422
local_in_edges_tensor generation:  0.0012083053588867188
mini_batch_src_global generation:  0.0009894371032714844
r_  generation:  0.00867152214050293
local_output_nid generation:  0.0017783641815185547
local_in_edges_tensor generation:  0.0013124942779541016
mini_batch_src_global generation:  0.001035451889038086
r_  generation:  0.010486364364624023
local_output_nid generation:  0.002166271209716797
local_in_edges_tensor generation:  0.001664876937866211
mini_batch_src_global generation:  0.0015609264373779297
r_  generation:  0.017925500869750977
local_output_nid generation:  0.0018534660339355469
local_in_edges_tensor generation:  0.0014264583587646484
mini_batch_src_global generation:  0.0011017322540283203
r_  generation:  0.013319015502929688
local_output_nid generation:  0.002134084701538086
local_in_edges_tensor generation:  0.0016541481018066406
mini_batch_src_global generation:  0.0013496875762939453
r_  generation:  0.02900838851928711
local_output_nid generation:  0.004416942596435547
local_in_edges_tensor generation:  0.0033974647521972656
mini_batch_src_global generation:  0.002183198928833008
r_  generation:  0.021102190017700195
local_output_nid generation:  0.0034132003784179688
local_in_edges_tensor generation:  0.0027382373809814453
mini_batch_src_global generation:  0.003831624984741211
r_  generation:  0.019251346588134766
local_output_nid generation:  0.0021257400512695312
local_in_edges_tensor generation:  0.0015361309051513672
mini_batch_src_global generation:  0.0013151168823242188
r_  generation:  0.01339864730834961
local_output_nid generation:  0.0023593902587890625
local_in_edges_tensor generation:  0.001653432846069336
mini_batch_src_global generation:  0.0012974739074707031
r_  generation:  0.016120195388793945
local_output_nid generation:  0.001959085464477539
local_in_edges_tensor generation:  0.001390695571899414
mini_batch_src_global generation:  0.0012404918670654297
r_  generation:  0.016433000564575195
local_output_nid generation:  0.002387523651123047
local_in_edges_tensor generation:  0.0021812915802001953
mini_batch_src_global generation:  0.0019402503967285156
r_  generation:  0.02108454704284668
local_output_nid generation:  0.002042055130004883
local_in_edges_tensor generation:  0.0018808841705322266
mini_batch_src_global generation:  0.0014884471893310547
r_  generation:  0.016834497451782227
local_output_nid generation:  0.002042055130004883
local_in_edges_tensor generation:  0.00164794921875
mini_batch_src_global generation:  0.0014047622680664062
r_  generation:  0.01683187484741211
local_output_nid generation:  0.0016357898712158203
local_in_edges_tensor generation:  0.0011887550354003906
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.009081602096557617
local_output_nid generation:  0.002424001693725586
local_in_edges_tensor generation:  0.001790761947631836
mini_batch_src_global generation:  0.0012404918670654297
r_  generation:  0.01749420166015625
local_output_nid generation:  0.0019404888153076172
local_in_edges_tensor generation:  0.0015926361083984375
mini_batch_src_global generation:  0.0012540817260742188
r_  generation:  0.0141448974609375
local_output_nid generation:  0.002523183822631836
local_in_edges_tensor generation:  0.0020117759704589844
mini_batch_src_global generation:  0.0014190673828125
r_  generation:  0.018887042999267578
local_output_nid generation:  0.0018754005432128906
local_in_edges_tensor generation:  0.0014193058013916016
mini_batch_src_global generation:  0.0012359619140625
r_  generation:  0.012934446334838867
local_output_nid generation:  0.004346132278442383
local_in_edges_tensor generation:  0.004691600799560547
mini_batch_src_global generation:  0.0042307376861572266
r_  generation:  0.04277777671813965
local_output_nid generation:  0.0031807422637939453
local_in_edges_tensor generation:  0.0025246143341064453
mini_batch_src_global generation:  0.003036022186279297
r_  generation:  0.02704906463623047
local_output_nid generation:  0.0030341148376464844
local_in_edges_tensor generation:  0.0028662681579589844
mini_batch_src_global generation:  0.0020966529846191406
r_  generation:  0.024322986602783203
local_output_nid generation:  0.0036308765411376953
local_in_edges_tensor generation:  0.0035219192504882812
mini_batch_src_global generation:  0.0030364990234375
r_  generation:  0.033444881439208984
local_output_nid generation:  0.00456690788269043
local_in_edges_tensor generation:  0.004178762435913086
mini_batch_src_global generation:  0.004984617233276367
r_  generation:  0.04568314552307129
local_output_nid generation:  0.00472569465637207
local_in_edges_tensor generation:  0.004754543304443359
mini_batch_src_global generation:  0.004877328872680664
r_  generation:  0.04970550537109375
local_output_nid generation:  0.00560307502746582
local_in_edges_tensor generation:  0.007374763488769531
mini_batch_src_global generation:  0.00712275505065918
r_  generation:  0.06068134307861328
local_output_nid generation:  0.005141735076904297
local_in_edges_tensor generation:  0.005531787872314453
mini_batch_src_global generation:  0.006115436553955078
r_  generation:  0.052704811096191406
local_output_nid generation:  0.005313396453857422
local_in_edges_tensor generation:  0.004583120346069336
mini_batch_src_global generation:  0.005948305130004883
r_  generation:  0.05464959144592285
local_output_nid generation:  0.005070924758911133
local_in_edges_tensor generation:  0.004260540008544922
mini_batch_src_global generation:  0.007782936096191406
r_  generation:  0.07123422622680664
local_output_nid generation:  0.004956960678100586
local_in_edges_tensor generation:  0.0040056705474853516
mini_batch_src_global generation:  0.004738330841064453
r_  generation:  0.0388336181640625
local_output_nid generation:  0.00449371337890625
local_in_edges_tensor generation:  0.0035715103149414062
mini_batch_src_global generation:  0.004014730453491211
r_  generation:  0.04051375389099121
----------------------check_connections_block total spend ----------------------------- 1.3810298442840576
generate_one_block  0.018778324127197266
generate_one_block  0.028136730194091797
generate_one_block  0.013486862182617188
generate_one_block  0.01496124267578125
generate_one_block  0.021863460540771484
generate_one_block  0.0175473690032959
generate_one_block  0.023174762725830078
generate_one_block  0.028618574142456055
generate_one_block  0.021172761917114258
generate_one_block  0.01784682273864746
generate_one_block  0.02141571044921875
generate_one_block  0.030945539474487305
generate_one_block  0.03266429901123047
generate_one_block  0.022826433181762695
generate_one_block  0.022537708282470703
generate_one_block  0.024132966995239258
generate_one_block  0.03400421142578125
generate_one_block  0.01885390281677246
generate_one_block  0.02575969696044922
generate_one_block  0.017883777618408203
generate_one_block  0.06252503395080566
generate_one_block  0.03699469566345215
generate_one_block  0.03243660926818848
generate_one_block  0.04569530487060547
generate_one_block  0.06250953674316406
generate_one_block  0.06587672233581543
generate_one_block  0.08229207992553711
generate_one_block  0.07315301895141602
generate_one_block  0.07349681854248047
generate_one_block  0.06896090507507324
generate_one_block  0.0521087646484375
generate_one_block  0.054167747497558594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.038726806640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

connection checking time:  1.3810298442840576
block generation total time  1.1668283939361572
average batch blocks generation time:  0.03646338731050491
block dataloader generation time/epoch 21.77035129070282
pseudo mini batch 0 input nodes size: 15023
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0349726676940918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0349726676940918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.042136192321777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04215812683105469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01869964599609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019127845764160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019127845764160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019127845764160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15023, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019127845764160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([751, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03829765319824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03829765319824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 751, 128]), torch.Size([1, 751, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03901386260986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04474353790283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 751, 128])
m.shape torch.Size([763, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04511308670043945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04511308670043945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04584074020385742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.057051658630371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([654, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05762338638305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05762338638305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05824708938598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07197713851928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([513, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07264375686645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07264375686645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07313299179077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08809137344360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([462, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08894824981689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08894824981689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08938884735107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10525035858154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([423, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10624027252197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10624027252197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1066436767578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12399005889892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([347, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12494659423828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12494659423828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12527751922607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14182376861572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([272, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14269590377807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14269590377807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 272, 128]), torch.Size([1, 272, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14295530319213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15774106979370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 272, 128])
m.shape torch.Size([258, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15871858596801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15871858596801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1589646339416504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1747117042541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 258, 128])
m.shape torch.Size([2026, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1842494010925293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1842494010925293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2026, 128]), torch.Size([1, 2026, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18618154525756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32441282272338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2026, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3082456588745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31441497802734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3205842971801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31436634063720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6469, 256])
first layer input nodes number: 15023
first layer output nodes number: 6469
edges number: 38326
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32069826126098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32686758041381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3290095329284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3290095329284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([497, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34787940979003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34787940979003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3488273620605469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3564109802246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([424, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3567523956298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3567523956298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3575611114501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3706388473510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([334, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3711977005004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3711977005004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37183475494384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38628196716308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([247, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3869132995605469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3869132995605469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38738441467285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4010467529296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.402008056640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.402008056640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4024009704589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4165458679199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([190, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41744518280029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41744518280029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41780757904052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43339061737060547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4341716766357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4341716766357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4344444274902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44808197021484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44876861572265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44876861572265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4489727020263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4606056213378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.461334228515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.461334228515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.461517333984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.473236083984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4739809036254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4739809036254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47414684295654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4859285354614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4865541458129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4865541458129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4866819381713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49664974212646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4971628189086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4971628189086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49725818634033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5053644180297852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5058794021606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5058794021606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5059652328491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5138616561889648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5142092704772949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5142092704772949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5142645835876465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5197405815124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5203619003295898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5203619003295898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5204477310180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.529545783996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([16, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5297489166259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5297489166259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5297794342041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5332279205322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5337519645690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5337519645690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5338149070739746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5413680076599121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5418386459350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5418386459350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5418939590454102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5489187240600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5492749214172363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5492749214172363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5493149757385254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5546822547912598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.554931640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.554931640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5549583435058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5587234497070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5590534210205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5590534210205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5590858459472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5638847351074219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5642070770263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5642070770263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5642375946044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5689678192138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5693507194519043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5693507194519043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5693850517272949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5749468803405762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5752530097961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5752530097961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.575279712677002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5797924995422363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([137, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.583071231842041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.583071231842041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5833325386047363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6293225288391113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 137, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6137452125549316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6141748428344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6146044731140137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6141529083251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2882, 40])
input nodes number: 6469
output nodes number: 2882
edges number: 19001
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6142420768737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6142430305480957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020008563995361328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 1 input nodes size: 14305
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018719196319580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018719196319580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02554035186767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.025561809539794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01837635040283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018843650817871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018843650817871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018843650817871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14305, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018843650817871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([582, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03920316696166992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03920316696166992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03975820541381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044461727142333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([624, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044779300689697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044779300689697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.045374393463134766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05432319641113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([615, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05490541458129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05490541458129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05549192428588867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06839513778686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([571, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06919097900390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06919097900390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06973552703857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08578872680664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([459, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08661079406738281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08661079406738281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08704853057861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10280704498291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([396, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10372114181518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10372114181518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 396, 128]), torch.Size([1, 396, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10409879684448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12033796310424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 396, 128])
m.shape torch.Size([349, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12131404876708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12131404876708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12164688110351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1382884979248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 349, 128])
m.shape torch.Size([354, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13947248458862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13947248458862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 354, 128]), torch.Size([1, 354, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13981008529663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15905332565307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 354, 128])
m.shape torch.Size([283, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16009902954101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16009902954101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1603689193725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1776418685913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 283, 128])
m.shape torch.Size([2205, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18802118301391602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18802118301391602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2205, 128]), torch.Size([1, 2205, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1901240348815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34503984451293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2205, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32739925384521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3338766098022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34001636505126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33349084854125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6438, 256])
first layer input nodes number: 14305
first layer output nodes number: 6438
edges number: 40502
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33978748321533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3462648391723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34746217727661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34746217727661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([393, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3696174621582031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3696174621582031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37036705017089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3764352798461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([351, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37673521041870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37673521041870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37740468978881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38840818405151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38893890380859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38893890380859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3895111083984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40221309661865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4030470848083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4030470848083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40354108810424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41829824447631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41908931732177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41908931732177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41950130462646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43433284759521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4350614547729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4350614547729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43537044525146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4486570358276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44936370849609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44936370849609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44960784912109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46181488037109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([149, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46283864974975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46283864974975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4631228446960449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4793219566345215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48000192642211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48000192642211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48018312454223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49177980422973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4926023483276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4926023483276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4927835464477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5056486129760742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.506340503692627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.506340503692627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5064816474914551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5174908638000488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5181703567504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5181703567504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5182943344116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5288324356079102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5295076370239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5295076370239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5296201705932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.539973258972168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5406436920166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5406436920166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5407466888427734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5509433746337891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5515265464782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5515265464782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5516104698181152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5605063438415527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5610795021057129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5610795021057129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5611557960510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5697770118713379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5702619552612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5702619552612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5703229904174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5776472091674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5781188011169434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5781188011169434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5781741142272949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5851988792419434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.585719108581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.585719108581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5857763290405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5934438705444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5938959121704102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5938959121704102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5939435958862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6006669998168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6011881828308105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6011881828308105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6012396812438965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6088614463806152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6093010902404785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6093010902404785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6093430519104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.615847110748291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6162023544311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6162023544311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6162347793579102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6214876174926758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6218404769897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6218404769897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6218709945678711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6270284652709961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([189, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6315546035766602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6315546035766602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6319150924682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6953611373901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 189, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6763606071472168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6767888069152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6772170066833496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6767673492431641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2871, 40])
input nodes number: 6438
output nodes number: 2871
edges number: 22080
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6768355369567871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6768360137939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01975870132446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 2 input nodes size: 9457
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018374919891357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018374919891357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022884368896484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022905826568603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016063213348388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016372203826904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016372203826904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016372203826904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([9457, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016372203826904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([745, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03018474578857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03018474578857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 745, 128]), torch.Size([1, 745, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.030895233154296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036579132080078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 745, 128])
m.shape torch.Size([782, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036969661712646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.036969661712646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03771543502807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.048902034759521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([617, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.049411773681640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.049411773681640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05000019073486328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06338024139404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([526, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06408929824829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06408929824829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0645909309387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07913827896118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([408, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07986021041870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07986021041870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08024930953979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09425687789916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([325, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09499216079711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09499216079711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 325, 128]), torch.Size([1, 325, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09530210494995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10862970352172852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 325, 128])
m.shape torch.Size([269, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10937261581420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10937261581420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10962915420532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12245607376098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([217, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12315559387207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12315559387207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12336254119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13515853881835938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 217, 128])
m.shape torch.Size([188, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13586187362670898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13586187362670898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 188, 128]), torch.Size([1, 188, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13604116439819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14751577377319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 188, 128])
m.shape torch.Size([996, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1521754264831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1521754264831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 996, 128]), torch.Size([1, 996, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15312528610229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2216334342956543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 996, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21040630340576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21524429321289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22008228302001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21520614624023438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5073, 256])
first layer input nodes number: 9457
first layer output nodes number: 5073
edges number: 25525
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2201547622680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2249927520751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22647666931152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.22647666931152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([548, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24231529235839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.24231529235839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2433605194091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.25205087661743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([486, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.25246286392211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.25246286392211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.253389835357666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26781702041625977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([341, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26833677291870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26833677291870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.26898717880249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.28377819061279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([280, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2853412628173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2853412628173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2858753204345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3013629913330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([223, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3021678924560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3021678924560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3025932312011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3179054260253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31865596771240234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31865596771240234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31897449493408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3326711654663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3333868980407715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3333868980407715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3336348533630371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34603261947631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34677791595458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34677791595458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34699344635009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.35927867889404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3599238395690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3599238395690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3600897789001465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3707098960876465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3713674545288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3713674545288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37151432037353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3819417953491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38240766525268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38240766525268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.382504940032959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3900923728942871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39052820205688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39052820205688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3906083106994629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3974175453186035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3979148864746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3979148864746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3979969024658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40554237365722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40598583221435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40598583221435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4060544967651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41285228729248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41336584091186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41336584091186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4134383201599121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42112112045288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42143869400024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42143869400024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42148256301879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4264397621154785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42684268951416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42684268951416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4268922805786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4328432083129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43325138092041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43325138092041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43329906463623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43935489654541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4394955635070801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4394955635070801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4395127296447754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44181299209594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44205474853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44205474853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4420795440673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4455757141113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4457855224609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4457855224609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44580650329589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4489116668701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4490494728088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4490494728088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4490628242492676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45113229751586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45130252838134766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45130252838134766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45131778717041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45378971099853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45398998260498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45398998260498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4540071487426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4569082260131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([59, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45831775665283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45831775665283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45843029022216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47823619842529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4657602310180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4661855697631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4666109085083008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46616411209106445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2852, 40])
input nodes number: 5073
output nodes number: 2852
edges number: 15796
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4662208557128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46622133255004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017014026641845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 3 input nodes size: 11016
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016060352325439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016060352325439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.021313190460205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.021335124969482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016804218292236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017186641693115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017186641693115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017186641693115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([11016, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.017186641693115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([621, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03340291976928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03340291976928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03399515151977539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03925514221191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([701, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0396275520324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0396275520324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 701, 128]), torch.Size([1, 701, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.040296077728271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05082225799560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 701, 128])
m.shape torch.Size([661, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.051433563232421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.051433563232421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.052063941955566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06595468521118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([592, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06676864624023438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06676864624023438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06733322143554688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.084381103515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([494, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08527660369873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08527660369873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08574771881103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1027078628540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([408, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10363960266113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10363960266113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10402870178222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12075996398925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([362, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12177371978759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12177371978759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12211894989013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13938045501708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 362, 128])
m.shape torch.Size([295, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1403331756591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1403331756591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 295, 128]), torch.Size([1, 295, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14061450958251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15665054321289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 295, 128])
m.shape torch.Size([253, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15759563446044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15759563446044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1578369140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17327880859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([1395, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1798100471496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1798100471496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1395, 128]), torch.Size([1, 1395, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18114042282104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2792210578918457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1395, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2657437324523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2712578773498535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27677202224731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.27121448516845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5782, 256])
first layer input nodes number: 11016
first layer output nodes number: 5782
edges number: 32413
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2768564224243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.28237056732177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2837491035461426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2837491035461426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([398, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3023347854614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3023347854614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30309391021728516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3092489242553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([396, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3096308708190918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3096308708190918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31038618087768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3217158317565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([334, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32230138778686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32230138778686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3229384422302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3371748924255371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33791065216064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33791065216064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3384237289428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3538527488708496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([234, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3547210693359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3547210693359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3551673889160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3712348937988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([194, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3721308708190918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3721308708190918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3725008964538574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3884119987487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([183, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38945865631103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38945865631103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38980770111083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4072599411010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([130, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40808534622192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40808534622192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40833330154418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4224667549133301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([127, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42344141006469727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42344141006469727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42368364334106445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43918657302856445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43992090225219727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43992090225219727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4400906562805176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45214319229125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45283031463623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45283031463623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4529695510864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46382999420166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([82, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4647064208984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4647064208984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4648628234863281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47815704345703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47882890701293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47882890701293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4789433479309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4894719123840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49007415771484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49007415771484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49016761779785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.499420166015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5000224113464355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5000224113464355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5001082420349121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5092062950134277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5097784996032715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5097784996032715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.509854793548584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5184760093688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5188794136047363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5188794136047363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5189309120178223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5251107215881348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5254483222961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5254483222961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5254883766174316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5305752754211426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5308475494384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5308475494384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5308780670166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5349674224853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5352025032043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5352025032043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5352272987365723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5387234687805176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5389533042907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5389533042907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5389761924743652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5423636436462402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5426907539367676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5426907539367676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5427212715148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5474514961242676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.547635555267334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.547635555267334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5476527214050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5504336357116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5506329536437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5506329536437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5506501197814941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.553551197052002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([74, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5553207397460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5553207397460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5554618835449219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5803031921386719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5649905204772949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5654230117797852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5658555030822754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5654010772705078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2900, 40])
input nodes number: 5782
output nodes number: 2900
edges number: 18802
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5654735565185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5654740333557129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01796245574951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 4 input nodes size: 17263
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016811370849609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.016811370849609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.025043010711669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.025064945220947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019790172576904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020331859588623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020331859588623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020331859588623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17263, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020331859588623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([614, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04484987258911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04484987258911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.045435428619384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05037975311279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([627, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05068492889404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05068492889404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05128288269042969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06025218963623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([634, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06086015701293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06086015701293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.061464786529541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07526302337646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([570, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07604789733886719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07604789733886719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07659149169921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09289360046386719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([547, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09392595291137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09392595291137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09444761276245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11354255676269531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([437, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1145319938659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1145319938659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 437, 128]), torch.Size([1, 437, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11494874954223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13286924362182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 437, 128])
m.shape torch.Size([391, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13396596908569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13396596908569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 391, 128]), torch.Size([1, 391, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1343388557434082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1529831886291504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 391, 128])
m.shape torch.Size([409, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1543569564819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1543569564819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15474700927734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17698001861572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([335, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17822265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17822265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1785421371459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1989889144897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([2900, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21265745162963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21265745162963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2900, 128]), torch.Size([1, 2900, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2154231071472168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41433000564575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2900, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3927898406982422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39990806579589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4070262908935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39985227584838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7464, 256])
first layer input nodes number: 17263
first layer output nodes number: 7464
edges number: 49431
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40715694427490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4142751693725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41605472564697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41605472564697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4388284683227539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4388284683227539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4396333694458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4464120864868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([346, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44667482376098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44667482376098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44733476638793945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45750856399536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([290, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45801496505737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45801496505737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45856809616088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47166013717651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4722757339477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4722757339477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4727182388305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4855508804321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4863004684448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4863004684448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48668575286865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5005559921264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5011534690856934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5011534690856934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5014147758483887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5126509666442871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5134692192077637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5134692192077637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5137381553649902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5271849632263184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([146, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5281734466552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5281734466552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5284519195556641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5443248748779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5449209213256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5449209213256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5450830459594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5554590225219727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5562911033630371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5562911033630371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5564723014831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5693373680114746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.570061206817627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.570061206817627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5702080726623535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5816636085510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.582420825958252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.582420825958252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5825581550598145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.594231128692627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5948872566223145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5948872566223145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5949978828430176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6051754951477051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6057796478271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6057796478271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6058731079101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6151256561279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6157999038696289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6157999038696289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6158952713012695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6260042190551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6266794204711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6266794204711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6267690658569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6368989944458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6373281478881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6373281478881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6373834609985352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6440210342407227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6445298194885254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6445298194885254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6445889472961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6520981788635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6527261734008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6527261734008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6527948379516602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6619958877563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6626152992248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6626152992248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6626801490783691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6718239784240723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6721954345703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6721954345703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6722335815429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6778793334960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6781778335571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6781778335571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6782064437866211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6826410293579102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6829586029052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6829586029052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6829872131347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6876220703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6879310607910156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6879310607910156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.687957763671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6924705505371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([241, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6982483863830566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6982483863830566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6987080574035645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7796101570129395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 241, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7599902153015137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7604203224182129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7608504295349121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7603983879089355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2884, 40])
input nodes number: 7464
output nodes number: 2884
edges number: 23138
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7604737281799316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7604742050170898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.021373271942138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 5 input nodes size: 13973
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01978778839111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01978778839111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.026450634002685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.026472091674804688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018218517303466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018613338470458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018613338470458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018613338470458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13973, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018613338470458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([760, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03706502914428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03706502914428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 760, 128]), torch.Size([1, 760, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.03778982162475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04387617111206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 760, 128])
m.shape torch.Size([774, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04425191879272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04425191879272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04499006271362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05691242218017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([700, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.057544708251953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.057544708251953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 700, 128]), torch.Size([1, 700, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0582122802734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07289886474609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 700, 128])
m.shape torch.Size([605, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07371902465820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07371902465820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0742959976196289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09144973754882812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([490, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09232950210571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09232950210571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09279680252075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1096196174621582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([414, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11057043075561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11057043075561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11096525192260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12794256210327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([341, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12888336181640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12888336181640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12920856475830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14546871185302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([300, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14645051956176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14645051956176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 300, 128]), torch.Size([1, 300, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14673662185668945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16304445266723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 300, 128])
m.shape torch.Size([260, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1640172004699707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1640172004699707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16426515579223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18013429641723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([1692, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1880784034729004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1880784034729004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1692, 128]), torch.Size([1, 1692, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18969202041625977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3050975799560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1692, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2896080017089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.2956504821777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3016929626464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.29560327529907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6336, 256])
first layer input nodes number: 13973
first layer output nodes number: 6336
edges number: 35809
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30179929733276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30784177780151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30962324142456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30962324142456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([506, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3266453742980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3266453742980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32761049270629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33533143997192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([437, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33568906784057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33568906784057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.33652257919311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3502192497253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([361, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.35090160369873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.35090160369873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3515901565551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36696720123291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([281, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3679523468017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3679523468017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3684883117675781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3840312957763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([222, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3848304748535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3848304748535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38525390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4004974365234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40129518508911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40129518508911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4016289710998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4159817695617676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4167165756225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4167165756225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41697216033935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4297513961791992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4304542541503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4304542541503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4306602478027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4424018859863281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44318151473999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44318151473999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4433760643005371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4558272361755371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4564800262451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4564800262451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45662879943847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4671916961669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4677729606628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4677729606628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46789121627807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4771151542663574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47762155532836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47762155532836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47771501541137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.485659122467041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4863123893737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4863123893737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4864192008972168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4962458610534668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49675798416137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49675798416137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4968380928039551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5047688484191895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5052046775817871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5052046775817871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5052676200866699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.511939525604248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5122156143188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5122156143188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5122537612915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5165643692016602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5168232917785645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5168232917785645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5168557167053223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5207467079162598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.520972728729248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.520972728729248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5209994316101074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.524390697479248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5246882438659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5246882438659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5247206687927246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5290656089782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5294146537780762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5294146537780762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5294508934020996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5345606803894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.534825325012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.534825325012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5348520278930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5388040542602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5390233993530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5390233993530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5390443801879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5422964096069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5425515174865723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5425515174865723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.542574405670166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5462822914123535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5464553833007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5464553833007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5464706420898438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5490493774414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([87, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5511322021484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5511322021484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5512981414794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5805034637451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5667986869812012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5672259330749512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5676531791687012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.567204475402832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2865, 40])
input nodes number: 6336
output nodes number: 2865
edges number: 17071
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5672702789306641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5672707557678223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01941204071044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 6 input nodes size: 18020
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018215656280517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018215656280517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02680826187133789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.026830196380615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020145893096923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02069711685180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02069711685180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02069711685180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([18020, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02069711685180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([468, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044991493225097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044991493225097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04543781280517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04900836944580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([518, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.049279212951660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.049279212951660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.049773216247558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.057183265686035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([533, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.057698726654052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.057698726654052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.058207035064697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0693974494934082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([484, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07006645202636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07006645202636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07052803039550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08391380310058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([452, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08476066589355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08476066589355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08519172668457031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10070991516113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([362, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10153007507324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10153007507324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10187530517578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11672019958496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 362, 128])
m.shape torch.Size([341, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11768579483032227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11768579483032227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1180109977722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13427114486694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([356, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1354665756225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1354665756225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 356, 128]), torch.Size([1, 356, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13580608367919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15515804290771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 356, 128])
m.shape torch.Size([270, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15614700317382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15614700317382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 270, 128]), torch.Size([1, 270, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1564044952392578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1728839874267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 270, 128])
m.shape torch.Size([3182, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1879281997680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1879281997680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3182, 128]), torch.Size([1, 3182, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1909627914428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4064955711364746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3182, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38472414016723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39136743545532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3980107307434082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3913154602050781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6966, 256])
first layer input nodes number: 18020
first layer output nodes number: 6966
edges number: 48956
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3981471061706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40479040145874023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4064512252807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4064512252807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([329, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4308762550354004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4308762550354004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4315037727355957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43672990798950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([327, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4370450973510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4370450973510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4376688003540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4474821090698242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44796037673950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44796037673950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4484829902648926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46121978759765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46192359924316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46192359924316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46240234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4762859344482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4770030975341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4770030975341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4773826599121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4910469055175781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4917163848876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4917163848876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4920005798339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5042209625244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5050749778747559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5050749778747559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5053572654724121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5194716453552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([135, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5203685760498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5203685760498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5206260681152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5353031158447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5360655784606934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5360655784606934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.536262035369873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.548835277557373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([108, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5502786636352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5502786636352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5504846572875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5651102066040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5657792091369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5657792091369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5659184455871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5767788887023926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5776090621948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5776090621948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5777578353881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5904035568237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5911917686462402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5911917686462402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5913233757019043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.603431224822998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6041326522827148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6041326522827148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6042413711547852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6150045394897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([58, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6157865524291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6157865524291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6158971786499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6276235580444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6280450820922852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6280450820922852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6281042098999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6347856521606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6353774070739746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6353774070739746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6354498863220215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6441473960876465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6447343826293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6447343826293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6448030471801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6535234451293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6539640426635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6539640426635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6540136337280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6606588363647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6611533164978027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6611533164978027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6612048149108887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6684660911560059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6689248085021973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6689248085021973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6689705848693848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6757454872131348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6763148307800293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6763148307800293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.676368236541748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6846461296081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6849513053894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6849513053894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6849799156188965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6896147727966309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.689969539642334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.689969539642334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.690000057220459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.695157527923584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([286, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7020144462585449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7020144462585449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7025599479675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8009562492370605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 286, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7795672416687012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7799973487854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7804274559020996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.779975414276123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2885, 40])
input nodes number: 6966
output nodes number: 2885
edges number: 24948
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7800521850585938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.780052661895752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.021760940551757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 7 input nodes size: 23052
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020148754119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020148754119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.031140804290771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.031162738800048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022548198699951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.023167133331298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.023167133331298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.023167133331298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([23052, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.023167133331298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([626, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.053540706634521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.053540706634521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0541377067565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0589137077331543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([688, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05927133560180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05927133560180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 688, 128]), torch.Size([1, 688, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05992746353149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06976938247680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 688, 128])
m.shape torch.Size([636, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07035112380981445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07035112380981445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07095766067504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08430147171020508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([579, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08510255813598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08510255813598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08565473556518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10218286514282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([561, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10324430465698242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10324430465698242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10377931594848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12373542785644531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([507, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12491846084594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12491846084594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12540197372436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1461930274963379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([456, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14747333526611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14747333526611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14790821075439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16965198516845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([398, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17095279693603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17095279693603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 398, 128]), torch.Size([1, 398, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17133235931396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19296741485595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 398, 128])
m.shape torch.Size([342, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1942453384399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1942453384399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19457149505615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.21544551849365234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([3858, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23367881774902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23367881774902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3858, 128]), torch.Size([1, 3858, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.23735809326171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49858665466308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3858, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47278547286987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4810357093811035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.489285945892334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4809708595275879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([8651, 256])
first layer input nodes number: 23052
first layer output nodes number: 8651
edges number: 60107
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4894599914550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4977102279663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5006847381591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5006847381591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([407, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5231218338012695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5231218338012695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5238981246948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.530247688293457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5305824279785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5305824279785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5312995910644531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5426559448242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5431628227233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5431628227233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5437350273132324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5565629005432129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5571613311767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5571613311767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5576000213623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5703220367431641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5711312294006348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5711312294006348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5715317726135254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5859513282775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([184, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.586850643157959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.586850643157959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5872015953063965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.602292537689209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([154, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6031579971313477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6031579971313477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6034517288208008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.618138313293457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([129, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6191344261169434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6191344261169434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6193804740905762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6334052085876465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6341476440429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6341476440429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.63433837890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.64654541015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6472673416137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6472673416137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6474294662475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.658940315246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([84, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6597476005554199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6597476005554199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6599078178405762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6724047660827637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6731324195861816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6731324195861816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6732659339904785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6846146583557129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.685185432434082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.685185432434082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6852827072143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6942319869995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6949100494384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6949100494384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6950130462646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7052097320556641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.70574951171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.70574951171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7058277130126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7141170501708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.714754581451416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.714754581451416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7148385047912598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7243218421936035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.724982738494873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.724982738494873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.725064754486084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7349066734313965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7351946830749512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7351946830749512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7352309226989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7398333549499512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7402172088623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7402172088623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7402591705322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7458820343017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7463035583496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7463035583496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7463474273681641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.752532958984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7528343200683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7528343200683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7528648376464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7573814392089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.757789134979248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.757789134979248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7578272819519043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.763740062713623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7639865875244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7639865875244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7640094757080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7677173614501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7681903839111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7681903839111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7682304382324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7749996185302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([232, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7805542945861816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7805542945861816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7809967994689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8588776588439941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 232, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.839627742767334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8400640487670898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8405003547668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8400421142578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2927, 40])
input nodes number: 8651
output nodes number: 2927
edges number: 22802
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8401350975036621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8401355743408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.024362564086914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 8 input nodes size: 14238
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022554397583007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.022554397583007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.029343605041503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02936553955078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01835155487060547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018907546997070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018907546997070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018907546997070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14238, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018907546997070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([459, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0415654182434082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0415654182434082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04200315475463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04550504684448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([558, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.045818328857421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.045818328857421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04635047912597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05555152893066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([545, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05606508255004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05606508255004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.056584835052490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06851720809936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([512, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06923389434814453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06923389434814453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06972217559814453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08388233184814453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([406, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08460617065429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08460617065429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08499336242675781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09893226623535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([392, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09986019134521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09986019134521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 392, 128]), torch.Size([1, 392, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1002340316772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11630916595458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 392, 128])
m.shape torch.Size([364, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11733722686767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11733722686767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11768436431884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1350412368774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([312, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13605785369873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13605785369873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 312, 128]), torch.Size([1, 312, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13635540008544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15331554412841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 312, 128])
m.shape torch.Size([302, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1544628143310547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1544628143310547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 302, 128]), torch.Size([1, 302, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15475082397460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17318344116210938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 302, 128])
m.shape torch.Size([2840, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18658161163330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18658161163330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2840, 128]), torch.Size([1, 2840, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18929004669189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3873109817504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2840, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3671746253967285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37355470657348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37993478775024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.373504638671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6690, 256])
first layer input nodes number: 14238
first layer output nodes number: 6690
edges number: 45802
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38004302978515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3868141174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3880181312561035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3880181312561035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([292, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4160275459289551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4160275459289551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41658449172973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42223453521728516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([309, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4225502014160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4225502014160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4231395721435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4327726364135742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([267, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43324804306030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43324804306030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43375730514526367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4453005790710449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44590330123901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44590330123901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44632863998413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4586634635925293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([171, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4592728614807129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4592728614807129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45959901809692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4713406562805176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([145, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4720139503479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4720139503479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4722905158996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48418283462524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48491954803466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48491954803466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4851675033569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49756526947021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4983024597167969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4983024597167969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4985160827636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5106925964355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([124, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5116586685180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5116586685180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5118951797485352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5270318984985352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5277309417724609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5277309417724609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.52789306640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5394039154052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5400209426879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5400209426879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5401468276977539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5499658584594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([86, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5508952140808105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5508952140808105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5510592460632324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5650019645690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5657696723937988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5657696723937988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5658993721008301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5778317451477051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5785341262817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5785341262817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5786428451538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5894060134887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5900440216064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5900440216064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5901355743408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5998401641845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6005172729492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6005172729492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6006069183349609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6107368469238281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.611541748046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.611541748046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6116409301757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6235427856445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6243586540222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6243586540222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6244540214538574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6365656852722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6372852325439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6372852325439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6373653411865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6480998992919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6485981941223145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6485981941223145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6486515998840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.656181812286377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.65704345703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.65704345703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6571273803710938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6695480346679688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6699924468994141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6699924468994141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6700363159179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6768360137939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.677609920501709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.677609920501709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6776785850524902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6888022422790527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6892523765563965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6892523765563965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6892924308776855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6960616111755371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([392, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7054610252380371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7054610252380371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7062087059020996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8382582664489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 392, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8132081031799316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8136429786682129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8140778541564941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8136210441589355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2918, 40])
input nodes number: 6690
output nodes number: 2918
edges number: 28716
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8136916160583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.8136920928955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019966602325439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 9 input nodes size: 13569
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01835012435913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01835012435913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.024820327758789062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.02484130859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018030166625976562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01845836639404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01845836639404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01845836639404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13569, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01845836639404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([557, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.037137508392333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.037137508392333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.037668704986572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04248237609863281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([617, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04280519485473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04280519485473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.043393611907958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05221986770629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([558, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05272388458251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05272388458251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05325603485107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06564569473266602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([499, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06633138656616211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06633138656616211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06680727005004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08060789108276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([381, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08127832412719727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08127832412719727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08164167404174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09472227096557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([358, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0955648422241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0955648422241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09590625762939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11058712005615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([329, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11151456832885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11151456832885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11182832717895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1275162696838379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([284, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12844276428222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12844276428222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12871360778808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1441516876220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 284, 128])
m.shape torch.Size([250, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14508914947509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14508914947509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14532756805419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16058635711669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 250, 128])
m.shape torch.Size([2121, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17058086395263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17058086395263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2121, 128]), torch.Size([1, 2121, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17260360717773438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31927013397216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2121, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30307674407958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30875492095947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31443309783935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.30871009826660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5954, 256])
first layer input nodes number: 13569
first layer output nodes number: 5954
edges number: 37549
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.31453657150268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32108497619628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32173633575439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.32173633575439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([406, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3419308662414551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3419308662414551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34270524978637695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34937429428100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([388, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3497333526611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3497333526611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.35047340393066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3621335029602051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([308, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3626518249511719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3626518249511719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3632392883300781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37648868560791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([252, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3771638870239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3771638870239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37764453887939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3915834426879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([186, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39223718643188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39223718643188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3925919532775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4053635597229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([173, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40618419647216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40618419647216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40651416778564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4207029342651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42141294479370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42141294479370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4216609001159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43405866622924805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4348268508911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4348268508911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.43504810333251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4476594924926758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44832754135131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44832754135131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4484992027282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4594855308532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4601879119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4601879119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4603443145751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4714488983154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([99, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47241783142089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47241783142089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4726066589355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.487335205078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([81, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4881753921508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4881753921508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4883298873901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5014619827270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5021219253540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5021219253540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5022344589233398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5125875473022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.513096809387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.513096809387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5131769180297852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5211076736450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5216155052185059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5216155052185059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5216879844665527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5293707847595215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5296883583068848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5296883583068848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5297322273254395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5346894264221191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5351090431213379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5351090431213379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5351605415344238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5413403511047363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5416955947875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5416955947875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5417375564575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5470666885375977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5475025177001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5475025177001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5475502014160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5539398193359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5543584823608398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5543584823608398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5544023513793945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5605878829956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5609092712402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5609092712402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5609416961669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5657405853271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5660839080810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5660839080810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5661163330078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5711421966552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5713691711425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5713691711425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5713901519775391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5747890472412109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5750327110290527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5750327110290527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5750536918640137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5785994529724121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([153, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5822653770446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5822653770446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.582557201385498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.633918285369873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 153, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6168484687805176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6172628402709961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6176772117614746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6172418594360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2779, 40])
input nodes number: 5954
output nodes number: 2779
edges number: 19767
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6172871589660645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6172876358032227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019281387329101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 10 input nodes size: 16050
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018009662628173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018009662628173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.025662899017333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.025684833526611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019193649291992188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019708633422851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019708633422851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019708633422851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16050, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019708633422851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([527, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.042415618896484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.042415618896484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04291820526123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04752302169799805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([607, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.047850608825683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.047850608825683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04842948913574219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.057112693786621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([598, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0576786994934082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0576786994934082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.05824899673461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07149410247802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([531, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07229089736938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07229089736938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07279729843139648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08783388137817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([478, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08872032165527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08872032165527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.08917617797851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10558700561523438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([409, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10652923583984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.10652923583984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1069192886352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12369155883789062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([388, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12479162216186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12479162216186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.12516164779663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1436629295349121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([323, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14471006393432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14471006393432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1450181007385254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16257619857788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([284, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16364097595214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16364097595214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1639118194580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1812458038330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 284, 128])
m.shape torch.Size([2746, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19420433044433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.19420433044433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2746, 128]), torch.Size([1, 2746, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1968231201171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38275718688964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2746, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3627481460571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3693199157714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37589168548583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36926841735839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6891, 256])
first layer input nodes number: 16050
first layer output nodes number: 6891
edges number: 45819
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.37601327896118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3825850486755371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3842282295227051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3842282295227051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([342, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40705299377441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40705299377441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40770530700683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41307783126831055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([336, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41339778900146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41339778900146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41403865814208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4245905876159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([304, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42514705657958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42514705657958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42572689056396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4388437271118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4395265579223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4395265579223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.44000911712646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45400333404541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([214, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4549698829650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4549698829650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.45537805557250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47007226943969727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47080278396606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.47080278396606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4711117744445801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48439836502075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4851994514465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4851994514465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4854702949523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.49901247024536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4998154640197754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4998154640197754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5000481605529785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5133118629455566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([111, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5141558647155762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5141558647155762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5143675804138184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5279173851013184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5287919044494629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5287919044494629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5289864540100098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5427994728088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([94, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5439519882202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5439519882202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5441312789916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5581159591674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5588221549987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5588221549987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5589537620544434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5701403617858887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5709242820739746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5709242820739746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5710539817810059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5829863548278809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5837154388427734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5837154388427734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5838279724121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5949687957763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5955758094787598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5955758094787598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5956635475158691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6049637794494629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.605781078338623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.605781078338623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6058878898620605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.617957592010498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.618476390838623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.618476390838623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6185431480407715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.626554012298584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6271438598632812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6271438598632812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6272125244140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6359329223632812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6364102363586426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6364102363586426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6364636421203613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6436200141906738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6441702842712402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6441702842712402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6442275047302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6522955894470215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6529736518859863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6529736518859863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6530404090881348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6629204750061035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6633315086364746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6633315086364746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6633715629577637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6695799827575684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6698474884033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6698474884033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6698722839355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.67388916015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6744303703308105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6744303703308105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.674476146697998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6822123527526855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([188, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6873307228088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6873307228088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6876893043518066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7507996559143066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 188, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7311091423034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7315402030944824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.731971263885498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7315182685852051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2890, 40])
input nodes number: 6891
output nodes number: 2890
edges number: 23274
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7316083908081055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.7316088676452637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.020720958709716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 11 input nodes size: 13134
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019210338592529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.019210338592529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0256805419921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.025702476501464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.018027305603027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01853179931640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01853179931640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01853179931640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13134, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.01853179931640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([365, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04075193405151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04075193405151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04110002517700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0438847541809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 365, 128])
m.shape torch.Size([463, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044152259826660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.044152259826660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.04459381103515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.051217079162597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([479, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0516815185546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.0516815185546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.052138328552246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.062188148498535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([453, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06282377243041992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06282377243041992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 453, 128]), torch.Size([1, 453, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06325578689575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07578420639038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 453, 128])
m.shape torch.Size([430, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07659339904785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07659339904785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.07700347900390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.091766357421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([452, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09285449981689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09285449981689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.09328556060791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11182117462158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([358, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11280059814453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11280059814453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.11314201354980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13021278381347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([329, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13129711151123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13129711151123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.13161087036132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.14949512481689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([267, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1504840850830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.1504840850830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.15073871612548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.16703510284423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 267, 128])
m.shape torch.Size([2617, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17938661575317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.17938661575317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2617, 128]), torch.Size([1, 2617, 128])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.18188238143920898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3649749755859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2617, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.34461498260498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3505401611328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.35646533966064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3504934310913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6213, 256])
first layer input nodes number: 13134
first layer output nodes number: 6213
edges number: 43113
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3565654754638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3624906539916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36408472061157227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.36408472061157227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([271, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3880939483642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3880939483642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.38861083984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3929600715637207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([292, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3932633399963379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.3932633399963379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.39382028579711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4026370048522949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([277, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40315723419189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.40315723419189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4036855697631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41559314727783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41624021530151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41624021530151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.41669225692749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.42980146408081055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([230, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4306807518005371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4306807518005371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.431119441986084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4469122886657715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([226, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4479966163635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4479966163635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.448427677154541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4669632911682129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([169, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46788501739501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46788501739501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.46820735931396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48432445526123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([134, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4851984977722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.4851984977722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.48545408248901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5000224113464355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([114, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5008811950683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5008811950683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5010986328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5150146484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([122, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5160789489746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5160789489746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5163116455078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5328330993652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5339646339416504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5339646339416504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5341897010803223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5517449378967285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5524053573608398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5524053573608398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5525331497192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5633955001831055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5642566680908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5642566680908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5643978118896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5773830413818359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([69, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5782413482666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5782413482666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5783729553222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5914020538330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5918698310852051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5918698310852051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5919404029846191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.5994210243225098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.600062370300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.600062370300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6001462936401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6096296310424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6104702949523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6104702949523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6105732917785645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6229329109191895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6235561370849609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6235561370849609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6236305236816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6330776214599609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6335153579711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6335153579711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6335649490356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6402101516723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6409544944763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6409544944763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6410307884216309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6517882347106934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.652315616607666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.652315616607666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6523690223693848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6602730751037598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6607117652893066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6607117652893066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6607537269592285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6672577857971191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6675906181335449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6675906181335449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6676211357116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6725649833679199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.673011302947998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.673011302947998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6730494499206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6794962882995605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([192, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6840906143188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6840906143188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.6844568252563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7489099502563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 192, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.727999210357666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7284340858459473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7288689613342285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7284121513366699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2918, 40])
input nodes number: 6213
output nodes number: 2918
edges number: 24564
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7284846305847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.728485107421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01949453353881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 12 input nodes size: 15688
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01803112030029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01803112030029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.025511741638183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.025533676147460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01904153823852539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01967000961303711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01967000961303711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01967000961303711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15688, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01967000961303711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([445, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.047951698303222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.047951698303222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04837608337402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05177116394042969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([515, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.052050113677978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.052050113677978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.052541255950927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.060577392578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([547, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06111431121826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06111431121826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06163597106933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07338380813598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([500, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07407665252685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07407665252685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0745534896850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08838176727294922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([500, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08933544158935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08933544158935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0898122787475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1069784164428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([413, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10792160034179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10792160034179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10831546783447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12525177001953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([407, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12641334533691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12641334533691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1268014907836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1462087631225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([388, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14749479293823242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14749479293823242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14786481857299805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16895627975463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([335, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17020893096923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17020893096923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17052841186523438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19097518920898438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([3786, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.20886850357055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.20886850357055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3786, 128]), torch.Size([1, 3786, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2124791145324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46883249282836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3786, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.443265438079834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.45073843002319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.45821142196655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4506797790527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7836, 256])
first layer input nodes number: 15688
first layer output nodes number: 7836
edges number: 56922
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4583306312561035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4658036231994629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46767187118530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46767187118530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([305, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4943547248840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4943547248840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.494936466217041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5000777244567871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([284, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5003328323364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5003328323364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5008745193481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5111799240112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([272, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5116934776306152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5116934776306152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5122122764587402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5262694358825684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([213, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5268292427062988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5268292427062988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5272355079650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5390172004699707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.539703369140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.539703369140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5400562286376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5527591705322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5534482002258301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5534482002258301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.553734302520752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5660367012023926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5673742294311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5673742294311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5676603317260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.581965446472168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([138, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5828838348388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5828838348388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5831470489501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5981502532958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([117, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5990309715270996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5990309715270996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5992541313171387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6135363578796387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([108, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6144628524780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6144628524780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6146688461303711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6292943954467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([98, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6306977272033691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6306977272033691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6308846473693848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6454644203186035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.646270751953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.646270751953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6464195251464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6590652465820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6598782539367676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6598782539367676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6600136756896973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6724724769592285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6733870506286621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6733870506286621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6735262870788574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6873106956481934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6881351470947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6881351470947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6882534027099609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7007884979248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7016677856445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7016677856445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7017841339111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7149314880371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7156906127929688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7156906127929688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7157859802246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7272300720214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.727787971496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.727787971496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7278547286987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.736332893371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7367563247680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7367563247680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7368040084838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7431936264038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7439389228820801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7439389228820801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7440152168273926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7547726631164551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7553400993347168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7553400993347168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7553973197937012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7638659477233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7642393112182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7642393112182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7642755508422852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.769892692565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7704052925109863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7704052925109863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7704510688781738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7778668403625488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7784209251403809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7784209251403809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7784686088562012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.786527156829834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([314, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7940483093261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7940483093261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.794647216796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9016666412353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 314, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8780279159545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8784642219543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8789005279541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8784422874450684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2927, 40])
input nodes number: 7836
output nodes number: 2927
edges number: 27323
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8785243034362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8785247802734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.020830631256103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 13 input nodes size: 15067
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01904296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01904296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.026227474212646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.026248931884765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.018746376037597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01927661895751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01927661895751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01927661895751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15067, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01927661895751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([572, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04362630844116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04362630844116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.044171810150146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.048535823822021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([610, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04884481430053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04884481430053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04942655563354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.058292388916015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([599, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.058858394622802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.058858394622802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05942964553833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07199716567993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([530, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0727224349975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0727224349975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0732278823852539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08803653717041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([522, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08902835845947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08902835845947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08952617645263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10775184631347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([445, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10877609252929688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10877609252929688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10920047760009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12744903564453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([414, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12861871719360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12861871719360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1290135383605957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14875459671020508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([338, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14984655380249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14984655380249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15016889572143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16854238510131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([297, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16965579986572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16965579986572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1699390411376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1880664825439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([2919, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2018437385559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2018437385559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2919, 128]), torch.Size([1, 2919, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.20462751388549805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.40351343154907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2919, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.38195228576660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.38886260986328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.39577293395996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3888082504272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7246, 256])
first layer input nodes number: 15067
first layer output nodes number: 7246
edges number: 48454
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3958873748779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4027976989746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4045252799987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4045252799987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([390, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4267401695251465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4267401695251465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.42748403549194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4340801239013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([335, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43435239791870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43435239791870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43499135971069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4461660385131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4466714859008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4466714859008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4472169876098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4594736099243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4601316452026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4601316452026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46059322357177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47397899627685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47475767135620117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47475767135620117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4751582145690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4895777702331543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49093055725097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49093055725097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4912586212158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5053653717041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5061635971069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5061635971069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5064363479614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5200738906860352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5208835601806641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5208835601806641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5211181640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5344905853271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([115, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5353684425354004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5353684425354004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5355877876281738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5496258735656738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5503525733947754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5503525733947754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5505185127258301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5623002052307129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5629153251647949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5629153251647949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5630412101745605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5728602409362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5734896659851074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5734896659851074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5736041069030762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5833315849304199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5838994979858398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5838994979858398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5839948654174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.592768669128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5934209823608398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5934209823608398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5935201644897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6033391952514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6039242744445801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6039242744445801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6040081977844238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6129040718078613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.613123893737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.613123893737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6131563186645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6168203353881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6174578666687012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6174578666687012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6175341606140137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6266894340515137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6270842552185059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6270842552185059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6271319389343262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6331877708435059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6336207389831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6336207389831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6336684226989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6400580406188965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6406302452087402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6406302452087402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6406893730163574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6490263938903809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6495018005371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6495018005371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6495494842529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6566066741943359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6569004058837891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6569004058837891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6569290161132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6613636016845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6617474555969238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6617474555969238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6617817878723145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6673436164855957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6677188873291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6677188873291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6677513122558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6732311248779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([243, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.679053783416748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.679053783416748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6795172691345215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7610907554626465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 243, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7419419288635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7423639297485352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7427859306335449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.742342472076416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2831, 40])
input nodes number: 7246
output nodes number: 2831
edges number: 22591
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7424039840698242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7424044609069824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.020269393920898438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 14 input nodes size: 17191
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.018732070922851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.018732070922851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.026929378509521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.026950359344482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.019744396209716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.020258426666259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.020258426666259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.020258426666259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17191, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.020258426666259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([638, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.044638633728027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.044638633728027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04524707794189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05011463165283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([623, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05040454864501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05040454864501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.050998687744140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05991077423095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([602, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06047487258911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06047487258911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06104898452758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07371711730957031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([546, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07447147369384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07447147369384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07499217987060547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09062480926513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([515, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09159231185913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09159231185913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09208345413208008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10997295379638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([414, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11091184616088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11091184616088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11130666732788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12828397750854492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([395, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12940502166748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12940502166748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12978172302246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14861679077148438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([342, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1497330665588379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1497330665588379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15005922317504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16865015029907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([267, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1696329116821289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1696329116821289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16988754272460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.18618392944335938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 267, 128])
m.shape torch.Size([2930, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2000279426574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2000279426574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2930, 128]), torch.Size([1, 2930, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.20282220840454102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4020838737487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2930, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.38057374954223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3875088691711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.39444398880004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3874545097351074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7272, 256])
first layer input nodes number: 17191
first layer output nodes number: 7272
edges number: 48137
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3945741653442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.40150928497314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4032430648803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4032430648803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([464, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4237246513366699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4237246513366699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4246096611022949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4320406913757324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43230390548706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43230390548706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43300390243530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4442276954650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([311, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4447746276855469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4447746276855469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44536781311035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46005725860595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([221, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46061038970947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46061038970947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4610319137573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47325611114501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4740018844604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4740018844604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4743814468383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48804569244384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48874425888061523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48874425888061523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48903799057006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5016684532165527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5024433135986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5024433135986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5027046203613281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5157699584960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5164313316345215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5164313316345215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5166277885437012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5278258323669434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5284457206726074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5284457206726074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5286040306091309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5387358665466309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5394163131713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5394163131713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5395669937133789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5502653121948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5509514808654785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5509514808654785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.551088809967041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.561800479888916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5623779296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5623779296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5624847412109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.571563720703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5720601081848145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5720601081848145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5721440315246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5798649787902832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5803346633911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5803346633911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5804071426391602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5875825881958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5882387161254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5882387161254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5883302688598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5980348587036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5985274314880371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5985274314880371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5985941886901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.606137752532959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6066927909851074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6066927909851074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6067614555358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6150012016296387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6154170036315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6154170036315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6154665946960449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6217646598815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6221785545349121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6221785545349121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6222243309020996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6283583641052246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6288547515869141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6288547515869141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.62890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6361675262451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6365456581115723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6365456581115723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6365838050842285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6422295570373535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6425280570983887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6425280570983887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6425566673278809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6469912528991699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6472644805908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6472644805908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6472892761230469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.65130615234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6515707969665527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6515707969665527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6515936851501465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6554617881774902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([208, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6604485511779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6604485511779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6608452796936035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7306694984436035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 208, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7133054733276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.713721752166748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7141380310058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7137007713317871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2792, 40])
input nodes number: 7272
output nodes number: 2792
edges number: 20715
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7137703895568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.713770866394043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.021244049072265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 15 input nodes size: 11257
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01973867416381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01973867416381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.025106430053710938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02512836456298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.016910076141357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.017216205596923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.017216205596923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.017216205596923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([11257, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.017216205596923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([867, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.030385971069335938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.030385971069335938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.031212806701660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.037827491760253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([812, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03818845748901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03818845748901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03896284103393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05124044418334961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([640, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05176877975463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05176877975463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 640, 128]), torch.Size([1, 640, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05237913131713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06661128997802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 640, 128])
m.shape torch.Size([518, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06729412078857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06729412078857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06778812408447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08246517181396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([406, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08318614959716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08318614959716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0835733413696289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09751224517822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([327, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09825420379638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09825420379638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09856605529785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11197566986083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([239, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11261749267578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11261749267578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 239, 128]), torch.Size([1, 239, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11284542083740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12424182891845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 239, 128])
m.shape torch.Size([231, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12500905990600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12500905990600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1252293586730957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1377863883972168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([156, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13834571838378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13834571838378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13849449157714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14801597595214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([1052, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15295791625976562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15295791625976562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.153961181640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.22519302368164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.21472930908203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.21973419189453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.22473907470703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2196950912475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5248, 256])
first layer input nodes number: 11257
first layer output nodes number: 5248
edges number: 25920
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2248249053955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2298297882080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23130226135253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23130226135253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([657, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.24657964706420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.24657964706420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2478327751159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.25797510147094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 657, 256])
m.shape torch.Size([470, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2582521438598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2582521438598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.25914859771728516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2732858657836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([380, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2743186950683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2743186950683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2750434875488281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2920875549316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([267, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2927517890930176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2927517890930176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2932610511779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3080906867980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([212, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3088550567626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3088550567626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.30925941467285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.32381629943847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.32446765899658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.32446765899658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3247499465942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.33688831329345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.33754825592041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.33754825592041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.33777523040771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3491239547729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3497333526611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3497333526611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3499126434326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.36013221740722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3607521057128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3607521057128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.36090850830078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.37091827392578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.37161874771118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.37161874771118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.37177324295043945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.38274240493774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3832259178161621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3832259178161621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.38332700729370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.39121198654174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3916921615600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3916921615600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.39177989959716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.39923763275146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3995938301086426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3995938301086426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3996548652648926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4052700996398926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.40560293197631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.40560293197631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4056544303894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4107527732849121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.41121721267700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.41121721267700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4112820625305176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.41815614700317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.41853904724121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.41853904724121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4185905456542969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4244098663330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4246950149536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4246950149536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4247312545776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4290800094604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.42937374114990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.42937374114990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.42940807342529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43376827239990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43397045135498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43397045135498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4339933395385742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4370603561401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4372415542602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4372415542602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43726062774658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43994998931884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4401826858520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4401826858520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44020557403564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44359302520751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44362401962280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44362401962280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44362783432006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44421911239624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44448280334472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44448280334472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4445056915283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4482135772705078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4482717514038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4482717514038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44827747344970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44924449920654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([65, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4508037567138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4508037567138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.450927734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.472747802734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 65, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4609560966491699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46138572692871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46181535720825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4613637924194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2882, 40])
input nodes number: 5248
output nodes number: 2882
edges number: 15101
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4614381790161133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4614386558532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01788330078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 16 input nodes size: 20557
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01692342758178711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01692342758178711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02672576904296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.026747703552246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.021358013153076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.021857738494873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.021857738494873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.021857738494873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([20557, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.021857738494873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([787, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04633665084838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04633665084838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 787, 128]), torch.Size([1, 787, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04708719253540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.053998470306396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 787, 128])
m.shape torch.Size([746, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05433464050292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05433464050292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 746, 128]), torch.Size([1, 746, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05504608154296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06666040420532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 746, 128])
m.shape torch.Size([768, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06740331649780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06740331649780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06813573837280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08424901962280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([664, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08514928817749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08514928817749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08578252792358398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10428380966186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([656, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10553121566772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10553121566772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10615682601928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12912893295288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([529, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13032960891723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13032960891723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13083410263061523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15320539474487305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([445, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15443849563598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15443849563598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1548628807067871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17608213424682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([374, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17729663848876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17729663848876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17765331268310547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1979837417602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([302, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19910144805908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19910144805908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 302, 128]), torch.Size([1, 302, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19938945770263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.21782207489013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 302, 128])
m.shape torch.Size([2632, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23022842407226562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23022842407226562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2632, 128]), torch.Size([1, 2632, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2332472801208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.41640233993530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2632, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.396026611328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4035634994506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4111003875732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4035043716430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7903, 256])
first layer input nodes number: 20557
first layer output nodes number: 7903
edges number: 48838
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4112558364868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.418792724609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.42136621475219727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.42136621475219727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([532, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43944883346557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43944883346557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4404635429382324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4493231773376465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([394, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4495735168457031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4495735168457031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.45032501220703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4625358581542969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([335, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46312618255615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46312618255615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46376514434814453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4784812927246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([264, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47917699813842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47917699813842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47968053817749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4950690269470215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([270, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49611520767211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49611520767211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4966301918029785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5159497261047363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([201, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5168514251708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5168514251708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5172348022460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5337200164794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5344500541687012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5344500541687012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5347113609313965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5477766990661621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5485610961914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5485610961914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5487880706787109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5617256164550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5624947547912598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5624947547912598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5626893043518066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5751404762268066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5758123397827148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5758123397827148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5759649276733398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5867986679077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5872406959533691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5872406959533691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.587334156036377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5946240425109863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5952234268188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5952234268188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5953302383422852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6044092178344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6050057411193848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6050057411193848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.605104923248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.614229679107666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6147456169128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6147456169128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6148257255554199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6227564811706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6231203079223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6231203079223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.623173713684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6288347244262695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6291465759277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6291465759277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6291885375976562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6339302062988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6343016624450684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6343016624450684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6343474388122559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6398406028747559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6401467323303223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6401467323303223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6401829719543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6447854042053223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6451144218444824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6451144218444824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6451506614685059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6500067710876465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6504116058349609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6504116058349609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6504535675048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6563701629638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6564302444458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6564302444458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.656437873840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.657567024230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6577324867248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6577324867248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.657747745513916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6601128578186035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6603484153747559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6603484153747559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6603693962097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6637682914733887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6639423370361328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6639423370361328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6639575958251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6665363311767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([123, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6694846153259277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6694846153259277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6697192192077637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7110095024108887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 123, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6962971687316895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6967325210571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6971678733825684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6967105865478516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2921, 40])
input nodes number: 7903
output nodes number: 2921
edges number: 18144
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6967973709106445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6967978477478027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02286243438720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 17 input nodes size: 14027
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02136373519897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02136373519897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.028052330017089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.028074264526367188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.018249988555908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.018688678741455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.018688678741455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.018688678741455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14027, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.018688678741455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([708, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0380864143371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0380864143371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 708, 128]), torch.Size([1, 708, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03876161575317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04416322708129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 708, 128])
m.shape torch.Size([750, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0445408821105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0445408821105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 750, 128]), torch.Size([1, 750, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04525613784790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05619335174560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 750, 128])
m.shape torch.Size([641, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.056752681732177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.056752681732177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05736398696899414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07081270217895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([576, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07160568237304688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07160568237304688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07215499877929688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08808517456054688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([525, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08906221389770508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08906221389770508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08956289291381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10815906524658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([417, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10910177230834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10910177230834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10949945449829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12659978866577148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 417, 128])
m.shape torch.Size([351, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12757253646850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12757253646850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12790727615356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14464426040649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([331, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14573955535888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14573955535888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1460552215576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1640481948852539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([265, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16502761840820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16502761840820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16528034210205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.18145465850830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 265, 128])
m.shape torch.Size([1978, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19076013565063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19076013565063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1978, 128]), torch.Size([1, 1978, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19264650344848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3305840492248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1978, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.31411314010620117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.32035207748413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.32659101486206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.32030296325683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6542, 256])
first layer input nodes number: 14027
first layer output nodes number: 6542
edges number: 38832
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.32669782638549805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.33293676376342773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.33449649810791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.33449649810791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([502, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.35478782653808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.35478782653808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3557453155517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.36369895935058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([429, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3640451431274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3640451431274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.36486339569091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3774909973144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([304, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3779587745666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3779587745666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3785386085510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3918647766113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([261, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3925786018371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3925786018371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.39307641983032227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.40770959854125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([220, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.40851831436157227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.40851831436157227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.408937931060791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.424044132232666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4247398376464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4247398376464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.42503929138183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4379158020019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4387216567993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4387216567993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4389925003051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.45253467559814453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4532761573791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4532761573791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.453493595123291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46588754653930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4665837287902832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4665837287902832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46676111221313477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47811365127563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4787750244140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4787750244140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4789237976074219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4894866943359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4900364875793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4900364875793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49014902114868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49892663955688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49959707260131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49959707260131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49971723556518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5099310874938965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5106081962585449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5106081962585449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5107207298278809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5210738182067871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5215964317321777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5215964317321777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5216784477233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5297980308532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5302762985229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5302762985229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5303449630737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.537623405456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5380659103393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5380659103393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5381250381469727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5448064804077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5452671051025391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5452671051025391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5453243255615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5521907806396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5526986122131348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5526986122131348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.552757740020752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5602669715881348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5607671737670898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5607671737670898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5608224868774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5682344436645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5686683654785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5686683654785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5687141418457031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5751686096191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5754284858703613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5754284858703613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5754551887512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5794072151184082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5797324180603027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5797324180603027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5797629356384277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5844931602478027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5847654342651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5847654342651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5847902297973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5888071060180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.589210033416748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.589210033416748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5892443656921387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5950465202331543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([152, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5986819267272949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5986819267272949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5989718437194824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6499972343444824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 152, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6330299377441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6334648132324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6338996887207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6334428787231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2918, 40])
input nodes number: 6542
output nodes number: 2918
edges number: 19967
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6335134506225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6335139274597168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.019561290740966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 18 input nodes size: 22283
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01824951171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01824951171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.028874874114990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.028896331787109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.022185802459716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02272939682006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02272939682006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02272939682006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([22283, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02272939682006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([696, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0494389533996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0494389533996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05010271072387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.056658267974853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 696, 128])
m.shape torch.Size([845, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05713224411010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05713224411010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0579380989074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07055187225341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([727, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07118892669677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07118892669677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 727, 128]), torch.Size([1, 727, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07188224792480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08774518966674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 727, 128])
m.shape torch.Size([666, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0886688232421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0886688232421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08930397033691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10772323608398438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([572, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10903644561767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10903644561767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10958194732666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12922000885009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([464, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13027477264404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13027477264404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13071727752685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14974498748779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([430, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15136241912841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15136241912841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15177249908447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17227649688720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([383, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17353248596191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17353248596191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17389774322509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1947174072265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 383, 128])
m.shape torch.Size([355, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1960582733154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1960582733154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1963968276977539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2180643081665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([3167, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23299646377563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23299646377563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3167, 128]), torch.Size([1, 3167, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23601675033569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4504570960998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3167, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.42708587646484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43500614166259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44292640686035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43494415283203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([8305, 256])
first layer input nodes number: 22283
first layer output nodes number: 8305
edges number: 53814
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.44309473037719727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.45101499557495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.45299530029296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.45299530029296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([475, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47188806533813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47188806533813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4727940559387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48010873794555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([438, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4804978370666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4804978370666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48133325576782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4943814277648926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([323, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49489545822143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49489545822143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.495511531829834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5106196403503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([280, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5114083290100098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5114083290100098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5119423866271973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5288681983947754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5296392440795898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5296392440795898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5300512313842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5448827743530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5455708503723145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5455708503723145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5458664894104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5585789680480957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5593461990356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5593461990356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.559605598449707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.572575569152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5732765197753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5732765197753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5734825134277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5852241516113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5859432220458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5859432220458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5861244201660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5977210998535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5983514785766602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5983514785766602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5984945297241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6086511611938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6093306541442871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6093306541442871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6094660758972168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6200289726257324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6206536293029785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6206536293029785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6207680702209473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.630495548248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6308631896972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6308631896972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6309280395507812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6368942260742188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.637413501739502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.637413501739502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6374917030334473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6452336311340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.645627498626709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.645627498626709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6456847190856934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6517500877380371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6522445678710938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6522445678710938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6523094177246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.659637451171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6600790023803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6600790023803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6601343154907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6667718887329102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6672806739807129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6672806739807129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6673398017883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6748490333557129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6752033233642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6752033233642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6752433776855469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6806106567382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6808981895446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6808981895446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6809287071228027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6852316856384277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6856002807617188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6856002807617188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6856365203857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6909999847412109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6912779808044434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6912779808044434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6913046836853027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6954436302185059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6957402229309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6957402229309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6957669258117676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7000927925109863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.700310230255127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.700310230255127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7003293037414551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7035527229309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([145, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7070274353027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7070274353027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7073040008544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7559795379638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 145, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7403383255004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7407660484313965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7411937713623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7407445907592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2870, 40])
input nodes number: 8305
output nodes number: 2870
edges number: 19046
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7408208847045898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.740821361541748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.023792743682861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 19 input nodes size: 15422
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02217864990234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02217864990234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.029532432556152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.029553890228271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.01890707015991211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.019281864166259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.019281864166259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.019281864166259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15422, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.019281864166259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([747, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03658103942871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03658103942871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.037293434143066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.043225765228271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([831, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.043662071228027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.043662071228027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04445457458496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.057216644287109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([696, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0578160285949707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0578160285949707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05847978591918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07308244705200195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 696, 128])
m.shape torch.Size([564, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07382631301879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07382631301879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07436418533325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09066247940063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([505, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0915975570678711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0915975570678711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09207916259765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10941696166992188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([394, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11030340194702148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11030340194702148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11067914962768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12683629989624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([305, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12766647338867188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12766647338867188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12795734405517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1425008773803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([305, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14351892471313477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14351892471313477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14380979537963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16038942337036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([232, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1612396240234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1612396240234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 232, 128]), torch.Size([1, 232, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16146087646484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17562103271484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 232, 128])
m.shape torch.Size([1619, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.18323040008544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.18323040008544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1619, 128]), torch.Size([1, 1619, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.18477439880371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.29439830780029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1619, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2800121307373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2859230041503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.29183387756347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2858767509460449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6198, 256])
first layer input nodes number: 15422
first layer output nodes number: 6198
edges number: 34495
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.29195070266723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.29786157608032227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.29966020584106445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.29966020584106445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([516, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.31532812118530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.31532812118530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.316312313079834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3247647285461426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([497, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.325228214263916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.325228214263916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.32617616653442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3420586585998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([359, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3428459167480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3428459167480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.34353065490722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3595461845397949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.36023807525634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.36023807525634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3607511520385742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.37563037872314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([257, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.37660932540893555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.37660932540893555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.37709951400756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3951106071472168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.395719051361084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.395719051361084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.39600133895874023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.408139705657959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.40877246856689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.40877246856689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.40899181365966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.41995906829833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.42071056365966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.42071056365966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.42092418670654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43310070037841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43379878997802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.43379878997802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4339761734008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4453287124633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4460763931274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4460763931274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4462423324584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4580240249633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.45853328704833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.45853328704833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.45864009857177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46697139739990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46746015548706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46746015548706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.46754980087280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47516965866088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4755997657775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4755997657775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.47567224502563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48234033584594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48273468017578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48273468017578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48279571533203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48883819580078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4891972541809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4891972541809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.48924875259399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4947075843811035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49509716033935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.49509716033935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.4951486587524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5009679794311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([16, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5012040138244629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5012040138244629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5012345314025879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5048966407775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5052275657653809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5052275657653809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5052657127380371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5101103782653809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5103836059570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5103836059570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5104141235351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5145034790039062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5147385597229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5147385597229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.514763355255127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5182595252990723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5183682441711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5183682441711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5183796882629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.520073413848877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5201525688171387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5201525688171387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5201601982116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5213427543640137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5214495658874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5214495658874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5214591026306152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5230040550231934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5230917930603027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5230917930603027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.523099422454834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5243887901306152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([73, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5261392593383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5261392593383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5262784957885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5507841110229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5384197235107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5388426780700684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5392656326293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5388212203979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2837, 40])
input nodes number: 6198
output nodes number: 2837
edges number: 15649
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.538884162902832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5388846397399902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.020055770874023438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 20 input nodes size: 38897
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.018902301788330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.018902301788330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03744983673095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03747081756591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.030095577239990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03132295608520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03132295608520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03132295608520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([38897, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03132295608520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([504, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09595727920532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09595727920532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09643793106079102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10028314590454102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([570, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1005864143371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1005864143371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10113000869750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10982179641723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([522, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11029672622680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11029672622680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1107945442199707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12174654006958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([487, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12242650985717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12242650985717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12289094924926758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13635969161987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([531, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13739347457885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13739347457885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13789987564086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15703296661376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([459, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15809297561645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15809297561645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15853071212768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1773533821105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([461, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17867326736450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17867326736450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17911291122436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2010951042175293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([474, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.20337533950805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.20337533950805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2038273811340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.22959375381469727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([496, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23149633407592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23149633407592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23196935653686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.26224279403686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([10971, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3147406578063965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3147406578063965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10971, 128]), torch.Size([1, 10971, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.32520341873168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0809130668640137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10971, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.019937515258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0346956253051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0494537353515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0345802307128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15475, 256])
first layer input nodes number: 38897
first layer output nodes number: 15475
edges number: 131760
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0497455596923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0645036697387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.06834077835083  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.06834077835083  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([322, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1003856658935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1003856658935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1009998321533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1068544387817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([263, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.107053279876709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.107053279876709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1075549125671387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1164159774780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([204, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1167535781860352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1167535781860352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.117142677307129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1257028579711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([145, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1260662078857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1260662078857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1263427734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1343631744384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([153, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1349601745605469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1349601745605469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1352519989013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1457576751708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([104, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1462116241455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1462116241455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1464099884033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1549396514892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([96, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1554865837097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1554865837097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1556696891784668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1648249626159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([69, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1652641296386719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1652641296386719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.165395736694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1728973388671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.173454761505127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.173454761505127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1735920906066895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1823811531066895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1829180717468262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1829180717468262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1830382347106934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1915698051452637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1921758651733398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1921758651733398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.192296028137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2016687393188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.202277660369873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.202277660369873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2023882865905762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2117915153503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2123737335205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2123737335205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2124710083007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2214202880859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2220582962036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2220582962036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2221555709838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.231785774230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.232314109802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.232314109802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2323904037475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2404775619506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2410087585449219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2410087585449219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.241079330444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.249053955078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2494926452636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2494926452636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2495479583740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.256185531616211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2569193840026855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2569193840026855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2570033073425293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2676615715026855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2683687210083008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2683687210083008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.268446922302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.278925895690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.279463768005371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.279463768005371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2795209884643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2875890731811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2881460189819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2881460189819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2882013320922852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2963876724243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2969098091125488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2969098091125488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.296959400177002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3046460151672363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.305107593536377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.305107593536377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3051495552062988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3119473457336426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3125033378601074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3125033378601074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3125510215759277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3206095695495605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([722, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3379344940185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3379344940185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 722, 256]), torch.Size([1, 722, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3393115997314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5843544006347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 722, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5548596382141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5552711486816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.55568265914917  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5552501678466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2759, 40])
input nodes number: 15475
output nodes number: 2759
edges number: 32890
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.555375099182129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.555375576019287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03345155715942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 21 input nodes size: 33926
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03008413314819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03008413314819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04626131057739258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.046282291412353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.027713775634765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02836894989013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02836894989013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02836894989013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([33926, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02836894989013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([837, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0637969970703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0637969970703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06459522247314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07098102569580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([981, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0715174674987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0715174674987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 981, 128]), torch.Size([1, 981, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07245302200317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0864863395690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 981, 128])
m.shape torch.Size([776, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08741950988769531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08741950988769531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08815956115722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10444068908691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([659, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10532760620117188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10532760620117188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1059560775756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12433052062988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([587, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12541580200195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12541580200195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1259756088256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14652204513549805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([485, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1476297378540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1476297378540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14809226989746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16798114776611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([407, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16910839080810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16910839080810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1694965362548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.18890380859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([411, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1902775764465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1902775764465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19066953659057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2130112648010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([359, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2143559455871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2143559455871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.21469831466674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23660993576049805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([4854, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2598762512207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2598762512207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4854, 128]), torch.Size([1, 4854, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.26450538635253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5931892395019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4854, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5615100860595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5713863372802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5812625885009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5713090896606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([10356, 256])
first layer input nodes number: 33926
first layer output nodes number: 10356
edges number: 71516
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5815176963806152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5913939476013184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.594414234161377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.594414234161377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([539, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6107206344604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6107206344604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6117486953735352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6202316284179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([514, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6207404136657715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6207404136657715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 514, 256]), torch.Size([1, 514, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6217207908630371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6374125480651855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 514, 256])
m.shape torch.Size([350, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6379451751708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6379451751708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6386127471923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6536960601806641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([257, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.654381275177002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.654381275177002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6548714637756348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6694989204406738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6701960563659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6701960563659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.670569896697998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.684028148651123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6847295761108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6847295761108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.685023307800293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6976537704467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6983146667480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6983146667480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6985435485839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7099876403808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7106194496154785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7106194496154785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7108044624328613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7213501930236816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7219324111938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7219324111938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.722081184387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.731602668762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([61, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7321147918701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7321147918701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7322311401367188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7404918670654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([48, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7409415245056152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7409415245056152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7410330772399902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7481741905212402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7486476898193359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7486476898193359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7487335205078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7560291290283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7564239501953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7564239501953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7564907073974609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7626323699951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7631373405456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7631373405456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7632136344909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7707667350769043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.771031379699707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.771031379699707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7710714340209961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7753171920776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7755589485168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7755589485168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7755913734436035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7792553901672363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([9, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7793865203857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7793865203857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7794036865234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.781463623046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7816801071166992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7816801071166992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7817049026489258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7848539352416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7851338386535645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7851338386535645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7851643562316895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7892537117004395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7895655632019043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7895655632019043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7895979881286621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7941699028015137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7942953109741211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7942953109741211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7943086624145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7962846755981445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7965106964111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7965106964111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7965316772460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7997837066650391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.799950122833252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.799950122833252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7999653816223145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8024373054504395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8026375770568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8026375770568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8026547431945801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8055558204650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([133, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8087430000305176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8087430000305176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8089966773986816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8536438941955566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 133, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.840569019317627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8409857749938965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.841402530670166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8409647941589355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2795, 40])
input nodes number: 10356
output nodes number: 2795
edges number: 16292
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8410682678222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8410687446594238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02966785430908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 22 input nodes size: 28454
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02771902084350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02771902084350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04128694534301758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.041307926177978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.02510976791381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.025722026824951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.025722026824951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.025722026824951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([28454, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.025722026824951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([832, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.058223724365234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.058223724365234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.059017181396484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06536483764648438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 832, 128])
m.shape torch.Size([890, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06581687927246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.06581687927246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0666656494140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07939720153808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([764, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08017539978027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08017539978027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08090400695800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09704017639160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([652, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09791946411132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09791946411132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 652, 128]), torch.Size([1, 652, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.098541259765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11659622192382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 652, 128])
m.shape torch.Size([545, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1175847053527832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1175847053527832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11810445785522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13696765899658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([464, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13803529739379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13803529739379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13847780227661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15750551223754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([402, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15862607955932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15862607955932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 402, 128]), torch.Size([1, 402, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15900945663452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1781783103942871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 402, 128])
m.shape torch.Size([365, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17937898635864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17937898635864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17972707748413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1995682716369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 365, 128])
m.shape torch.Size([333, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.20082330703735352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.20082330703735352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 333, 128]), torch.Size([1, 333, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2011408805847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2214655876159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 333, 128])
m.shape torch.Size([4366, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.24279117584228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.24279117584228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4366, 128]), torch.Size([1, 4366, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.24695491790771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5544967651367188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4366, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5255622863769531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5347299575805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5438976287841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5346579551696777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([9613, 256])
first layer input nodes number: 28454
first layer output nodes number: 9613
edges number: 65412
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5441117286682129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5532793998718262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5564284324645996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5564284324645996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([528, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5730299949645996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5730299949645996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5740370750427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5822291374206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([470, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5826292037963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5826292037963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5835256576538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.597015380859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([344, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5981054306030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5981054306030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.5987615585327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6134333610534668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([257, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6149320602416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6149320602416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.615422248840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6296377182006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6303877830505371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6303877830505371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6307826042175293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.644996166229248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6456465721130371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6456465721130371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6459269523620605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6579833030700684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6585631370544434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6585631370544434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6587672233581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6689715385437012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6696538925170898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6696538925170898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6698484420776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6809377670288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6815500259399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6815500259399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.681706428527832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.691716194152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6922726631164551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6922726631164551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.6923985481262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7013363838195801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7018656730651855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7018656730651855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.701972484588623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.710303783416748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7107696533203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7107696533203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7108554840087891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7181510925292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([29, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.718470573425293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.718470573425293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7185258865356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7236146926879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7239775657653809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7239775657653809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7240328788757324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7295088768005371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([17, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7297263145446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7297263145446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7297587394714355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7331957817077637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7334871292114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7334871292114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.733525276184082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7378358840942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7382416725158691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7382416725158691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7382912635803223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7442421913146973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.744408130645752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.744408130645752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7444291114807129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.747093677520752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.74737548828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.74737548828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.747406005859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.751495361328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7518839836120605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7518839836120605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7519240379333496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7575716972351074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7578749656677246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7578749656677246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7579054832458496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7624220848083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7627243995666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7627243995666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7627530097961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7671875953674316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.767240047454834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.767240047454834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7672457695007324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7681727409362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7684006690979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7684006690979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7684197425842285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7716431617736816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([134, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7748537063598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7748537063598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7751092910766602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8200922012329102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 134, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8066773414611816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8070883750915527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8074994087219238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8070673942565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 9613
output nodes number: 2758
edges number: 16611
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.807154655456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8071551322937012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.026912689208984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 23 input nodes size: 32858
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.025104045867919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.025104045867919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0407719612121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04079294204711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.027204036712646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.028102397918701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.028102397918701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.028102397918701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([32858, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.028102397918701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([669, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07595300674438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07595300674438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.07659101486206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08232927322387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([703, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08268070220947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08268070220947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.08335113525390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09340763092041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([600, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09393072128295898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09393072128295898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09450292587280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10711240768432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([603, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10797643661499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10797643661499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1085515022277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1256403923034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([608, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1268024444580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1268024444580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1273822784423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14902877807617188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([561, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1503438949584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1503438949584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15087890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17388439178466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([497, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1752758026123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1752758026123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1757497787475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1994485855102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([505, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.20113801956176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.20113801956176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.20161962509155273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.22907114028930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([450, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23076152801513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23076152801513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.23119068145751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.25865650177001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([7291, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.29320812225341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.29320812225341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7291, 128]), torch.Size([1, 7291, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.30016136169433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7950906753540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7291, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7503705024719238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7622790336608887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7741875648498535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7621855735778809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([12487, 256])
first layer input nodes number: 32858
first layer output nodes number: 12487
edges number: 97172
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7744345664978027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7863430976867676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7893204689025879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.7893204689025879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([430, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8121767044067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8121767044067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8129968643188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8210816383361816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8213772773742676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8213772773742676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8220772743225098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8360171318054199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([249, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8363852500915527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8363852500915527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.836860179901123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8473086357116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([193, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.847813606262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.847813606262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8481817245483398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8588571548461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([174, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8595094680786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8595094680786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8598413467407227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8717889785766602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8725342750549316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8725342750549316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.872835636138916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8857941627502441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8863906860351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8863906860351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8866024017333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8971881866455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8979668617248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.8979668617248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.898186206817627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9106888771057129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9113578796386719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9113578796386719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.911529541015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.922515869140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9232087135314941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9232087135314941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.923363208770752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9343323707580566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([85, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9351539611816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9351539611816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9353160858154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9479618072509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.948549747467041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.948549747467041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9486603736877441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9580636024475098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9585456848144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9585456848144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9586277008056641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9661731719970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9665493965148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9665493965148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9666085243225098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9724621772766113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9728798866271973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9728798866271973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9729390144348145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9792065620422363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9796848297119141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9796848297119141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9797477722167969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9868602752685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9873847961425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9873847961425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9874496459960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9952316284179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9956321716308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9956321716308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.9956798553466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0017356872558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.002333164215088  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.002333164215088  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0023980140686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0110878944396973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.011497974395752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.011497974395752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0115418434143066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0177273750305176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0180892944335938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0180892944335938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0181255340576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.023488998413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0237884521484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0237884521484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0238170623779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0282516479492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0285472869873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0285472869873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.028573989868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0328998565673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0334172248840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0334172248840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.033461093902588  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.04087495803833  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([322, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0485901832580566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0485901832580566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0492043495178223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.169100284576416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 322, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1492066383361816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1496176719665527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1500287055969238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1495966911315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 12487
output nodes number: 2758
edges number: 23222
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1497111320495605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1497116088867188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.029731273651123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 24 input nodes size: 37814
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.027204036712646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.027204036712646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04523515701293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.04525613784790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.029567241668701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03083181381225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03083181381225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03083181381225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([37814, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03083181381225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([503, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09800243377685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09800243377685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.09848213195800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10231971740722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([537, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10259199142456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10259199142456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1031041145324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11126184463500977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([552, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11179542541503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11179542541503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11232185363769531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12390327453613281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([478, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12455177307128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12455177307128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.12500762939453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1382274627685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([445, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13906049728393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13906049728393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13948488235473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15476274490356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([446, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15582656860351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.15582656860351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1562519073486328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17454147338867188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([447, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17582082748413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17582082748413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.17624711990356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19756174087524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([429, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19898509979248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19898509979248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19939422607421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.22271442413330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([413, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.22428226470947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.22428226470947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.22467613220214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.24988365173339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([11664, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.30530500411987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.30530500411987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11664, 128]), torch.Size([1, 11664, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.31642866134643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.106208324432373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11664, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0426225662231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0577993392944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0729761123657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.057680606842041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15914, 256])
first layer input nodes number: 37814
first layer output nodes number: 15914
edges number: 136964
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0732598304748535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0884366035461426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0927910804748535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0927910804748535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([310, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.124556064605713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.124556064605713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1251473426818848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1299004554748535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([264, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.130112648010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.130112648010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1306161880493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1405067443847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([227, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1409096717834473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1409096717834473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1413426399230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1508679389953613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([146, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1512131690979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1512131690979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.151491641998291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1595673561096191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([134, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1600723266601562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1600723266601562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1603279113769531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1695289611816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([118, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1700820922851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1700820922851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1703071594238281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1799850463867188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([106, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1805858612060547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1805858612060547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1807880401611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.190896987915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([78, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1913957595825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1913957595825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.191544532775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2000246047973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2006077766418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2006077766418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2007527351379395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2100300788879395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2105345726013184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2105345726013184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.210649013519287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2187743186950684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2194890975952148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2194890975952148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2196283340454102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2304887771606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2310538291931152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2310538291931152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.23115873336792  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2400755882263184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.240598201751709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.240598201751709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2406859397888184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2487578392028809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2492256164550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2492256164550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.249298095703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2564735412597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.256927490234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.256927490234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2569923400878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2638664245605469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.264387607574463  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.264387607574463  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2644562721252441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2722153663635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.272900104522705  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.272900104522705  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2729840278625488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2830548286437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2834973335266113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2834973335266113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.28355073928833  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2903332710266113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2907452583312988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2907452583312988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2907910346984863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2969250679016113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2975749969482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2975749969482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2976417541503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3070545196533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3076472282409668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3076472282409668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.307706356048584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3164572715759277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3169355392456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3169355392456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.316981315612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3240766525268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3244519233703613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3244519233703613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.324486255645752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3300480842590332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3306078910827637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3306078910827637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.330655574798584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3387141227722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([728, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3561830520629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3561830520629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 728, 256]), torch.Size([1, 728, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3575716018676758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.605433464050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 728, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5761981010437012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5766091346740723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5770201683044434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5765881538391113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 15914
output nodes number: 2758
edges number: 32611
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5767278671264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.576728343963623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03300952911376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 25 input nodes size: 43040
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.029567241668701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.029567241668701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05105161666870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05107259750366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03424215316772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03424215316772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03424215316772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([43040, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03424215316772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([592, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1009073257446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1009073257446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1014719009399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10619831085205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([625, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10651206970214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10651206970214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.10710811614990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11604881286621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([625, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11664485931396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11664485931396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.11724090576171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1312427520751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([542, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13197851181030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13197851181030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.13249540328979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14748525619506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([534, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1484999656677246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.1484999656677246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.14900922775268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16791391372680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([511, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16912126541137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16912126541137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.16960859298706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19056367874145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([511, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19202566146850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19202566146850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.19251298904418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.21687936782836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([460, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.21839046478271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.21839046478271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.21882915496826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2438344955444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([482, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2460017204284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2460017204284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2464613914489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.2758803367614746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([11260, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3293423652648926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3293423652648926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11260, 128]), torch.Size([1, 11260, 128])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.3401036262512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1051850318908691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11260, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0419468879699707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0573410987854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.07273530960083  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.057220458984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16142, 256])
first layer input nodes number: 43040
first layer output nodes number: 16142
edges number: 135816
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0730581283569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0884523391723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0925893783569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.0925893783569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([367, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1206164360046387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1206164360046387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1213164329528809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.128598690032959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([316, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1288561820983887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1288561820983887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1294589042663574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1384997367858887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([229, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1388587951660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1388587951660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1392955780029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.148904800415039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([171, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1493439674377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1493439674377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.149670124053955  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1591286659240723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([169, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.159778118133545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.159778118133545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1601004600524902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1717047691345215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([118, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.172224521636963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.172224521636963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1724495887756348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1821274757385254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1828022003173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1828022003173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1830253601074219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.194183349609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([78, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.194671630859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.194671630859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.1948204040527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2033004760742188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.203944206237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.203944206237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2041025161743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2142343521118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2148380279541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2148380279541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2149734497070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.224588394165039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2252397537231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2252397537231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2253694534301758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2354860305786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2362055778503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2362055778503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.236335277557373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2473597526550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2479324340820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2479324340820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2480297088623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.256978988647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2576031684875488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2576031684875488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2576985359191895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2671399116516113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2677125930786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2677125930786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2677946090698242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2764883041381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2769551277160645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2769551277160645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2770180702209473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.284130573272705  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2846384048461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2846384048461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2847013473510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2922544479370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2928285598754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2928285598754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.2928953170776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3013734817504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3020706176757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3020706176757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3021469116210938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3123703002929688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3127360343933105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3127360343933105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3127760887145996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3184237480163574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3188681602478027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3188681602478027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3189120292663574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3254046440124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3258271217346191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3258271217346191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3258671760559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.332075595855713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3326082229614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3326082229614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.332655906677246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3403806686401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3408184051513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3408184051513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3408565521240234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3473033905029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([508, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3594908714294434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.3594908714294434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.360459804534912  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5332436561584473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 508, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5079765319824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.508387565612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.508798599243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.508366584777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 16142
output nodes number: 2758
edges number: 27994
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5085082054138184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5085086822509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03638744354248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 26 input nodes size: 51032
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.05735445022583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.057375431060791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03587007522583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03740739822387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03740739822387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03740739822387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([51032, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 0.03740739822387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([549, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.12222671508789062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.12222671508789062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.12275028228759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.12827301025390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([632, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.12861394882202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.12861394882202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.12921667098999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.13825750350952148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([571, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.13877296447753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.13877296447753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.13931751251220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1518411636352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([585, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.15268468856811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.15268468856811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1532425880432129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.16942167282104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([583, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1705327033996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1705327033996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.17108869552612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1914043426513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([574, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.19276857376098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.19276857376098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.19331598281860352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.21702051162719727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([539, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.21854591369628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.21854591369628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.21905994415283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.24511003494262695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([590, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.24710369110107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.24710369110107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.2476663589477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.28023624420166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([604, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.2825469970703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.2825469970703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.2831230163574219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.3199882507324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([14690, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.38974761962890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.38974761962890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14690, 128]), torch.Size([1, 14690, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.40375709533691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3984298706054688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14690, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.318026065826416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.337557315826416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.357088565826416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3374085426330566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([19917, 256])
first layer input nodes number: 51032
first layer output nodes number: 19917
edges number: 173054
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.357470989227295  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.377002239227295  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.381782054901123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.381782054901123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([314, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4141874313354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4141874313354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4147863388061523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4198179244995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([276, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4200491905212402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4200491905212402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4205756187438965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4292378425598145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([185, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4295082092285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4295082092285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.429861068725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4376239776611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([159, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.438058853149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.438058853149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4383621215820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4471569061279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([127, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.447615623474121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.447615623474121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4478578567504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.456578254699707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([102, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.457045555114746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.457045555114746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.457240104675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4656057357788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([91, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.466120719909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.466120719909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.466294288635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4749727249145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([70, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4754242897033691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4754242897033691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.475557804107666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.483168125152588  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4838109016418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4838109016418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4839673042297363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4939770698547363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.494600772857666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.494600772857666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4947400093078613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5046257972717285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5051908493041992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5051908493041992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.505305290222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5142316818237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5147976875305176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5147976875305176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5149006843566895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5236554145812988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5241665840148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5241665840148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5242524147033691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.532148838043213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5326714515686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5326714515686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5327515602111816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.540682315826416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5412769317626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5412769317626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.541360855102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5502567291259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5509376525878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5509376525878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5510272979736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5611572265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5617170333862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5617170333862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5617876052856445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.570256233215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.570913314819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.570913314819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5709896087646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.580678939819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5812983512878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5812983512878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.581367015838623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5905680656433105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5912837982177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5912837982177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5913581848144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.601846694946289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6023750305175781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6023750305175781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6024284362792969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6103324890136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6108770370483398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6108770370483398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6109285354614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.618910789489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6195707321166992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6195707321166992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6196298599243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6292085647583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.629617691040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.629617691040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6296539306640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6357784271240234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([730, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6533012390136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6533012390136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 730, 256]), torch.Size([1, 730, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.654693603515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.9001960754394531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 730, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.8705406188964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.8709516525268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.8713626861572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.8709306716918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 19917
output nodes number: 2758
edges number: 33276
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.8711004257202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.871100902557373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.04005098342895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 27 input nodes size: 42017
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03587007522583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03587007522583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.05590534210205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.055927276611328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03157234191894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.0330047607421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.0330047607421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.0330047607421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([42017, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.0330047607421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([491, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1087808609008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1087808609008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.10924911499023438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11299514770507812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([483, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11322164535522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11322164535522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11368227005004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.12059164047241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([480, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1210479736328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1210479736328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1215057373046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1315765380859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([520, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1327967643737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1327967643737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.13329267501831055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14810609817504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([478, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14899778366088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14899778366088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14945363998413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1658644676208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([492, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16704416275024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16704416275024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16751337051391602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.18768930435180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([472, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.18903017044067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.18903017044067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.18948030471801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.21198701858520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([450, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.21347856521606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.21347856521606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.21390771865844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.23836946487426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([499, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2402963638305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2402963638305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.24077224731445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2712287902832031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([13290, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3343625068664551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3343625068664551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13290, 128]), torch.Size([1, 13290, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.34703683853149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2510724067687988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13290, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1785731315612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1954102516174316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.212247371673584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1952786445617676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17655, 256])
first layer input nodes number: 42017
first layer output nodes number: 17655
edges number: 154614
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2125625610351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2293996810913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2336091995239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2336091995239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([295, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2701797485351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2701797485351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.270742416381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2775206565856934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([210, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2776432037353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2776432037353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2780437469482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2840518951416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([181, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2843737602233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2843737602233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2847189903259277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.292314052581787  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([153, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2927298545837402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2927298545837402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2930216789245605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3014845848083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([124, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3019347190856934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3019347190856934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.302171230316162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.310685634613037  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([101, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.311150074005127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.311150074005127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.311342716217041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3196263313293457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([80, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.320068359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.320068359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.320220947265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.327850341796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.328427791595459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.328427791595459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.328589916229248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3378310203552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3385977745056152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3385977745056152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3387846946716309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3507475852966309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3514041900634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3514041900634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.351552963256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3621158599853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3627395629882812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3627395629882812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3628654479980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3726844787597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.373405933380127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.373405933380127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3735356330871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3845601081848145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([77, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3854575157165527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3854575157165527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3856043815612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.399116039276123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.399796485900879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.399796485900879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3999032974243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.410477638244629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4112319946289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4112319946289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4113388061523438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4226608276367188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.423499584197998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.423499584197998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4236102104187012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4361109733581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4367423057556152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4367423057556152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4368224143981934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4464354515075684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4472780227661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4472780227661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4473752975463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4597291946411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4606304168701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4606304168701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4607295989990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.474020004272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4759750366210938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4759750366210938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4760913848876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4924964904785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4933466911315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4933466911315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4934325218200684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5061354637145996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5066847801208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5066847801208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5067381858825684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5150160789489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5156526565551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5156526565551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5157098770141602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.524979591369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5257816314697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5257816314697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5258502960205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.537454605102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([783, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5570974349975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5570974349975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 783, 256]), torch.Size([1, 783, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5585908889770508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.82832670211792  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 783, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.7944073677062988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.7948417663574219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.795276165008545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.7948198318481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2914, 40])
input nodes number: 17655
output nodes number: 2914
edges number: 37623
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.794996738433838  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.794997215270996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.035481929779052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 28 input nodes size: 50929
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.031595706939697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.031595706939697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.05588054656982422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.055901527404785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03584432601928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.0372157096862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.0372157096862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.0372157096862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([50929, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.0372157096862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([673, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11307811737060547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11307811737060547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 673, 128]), torch.Size([1, 673, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11371994018554688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11934614181518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 673, 128])
m.shape torch.Size([664, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1196584701538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1196584701538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.12029170989990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1304006576538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([680, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1310567855834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1310567855834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 680, 128]), torch.Size([1, 680, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.13170528411865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14681148529052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 680, 128])
m.shape torch.Size([611, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14765262603759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14765262603759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14823532104492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16513347625732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([650, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16639184951782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16639184951782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16701173782348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.18967962265014648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([553, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.19095182418823242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.19095182418823242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.19147920608520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2149338722229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([586, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.21662616729736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.21662616729736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.21718502044677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.24641990661621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([574, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.24833011627197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.24833011627197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.24887752532958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2808847427368164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([571, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.28306150436401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.28306150436401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.28360605239868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3191213607788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([12767, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3797268867492676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3797268867492676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12767, 128]), torch.Size([1, 12767, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.39190244674682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2563672065734863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12767, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1849722862243652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2024521827697754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2199320793151855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.202315330505371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([18329, 256])
first layer input nodes number: 50929
first layer output nodes number: 18329
edges number: 154556
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.220313549041748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2377934455871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.242739200592041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.242739200592041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([372, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2714533805847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2714533805847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.272162914276123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.279736042022705  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([307, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2799715995788574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2799715995788574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2805571556091309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2899212837219238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([221, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2902660369873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2902660369873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2906875610351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2999610900878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([182, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.300450325012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.300450325012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.300797462463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3108644485473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([162, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.311469554901123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.311469554901123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3117785453796387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3229022026062012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([113, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.323399543762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.323399543762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3236150741577148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3328828811645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([93, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3334012031555176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3334012031555176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3335785865783691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3424477577209473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3430819511413574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3430819511413574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3432612419128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3534808158874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3541440963745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3541440963745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3543100357055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3649301528930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([55, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3653759956359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3653759956359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.365480899810791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3729290962219238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3735322952270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3735322952270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3736505508422852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3828744888305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3834266662597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3834266662597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3835277557373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.392120361328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3926949501037598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3926949501037598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3927903175354004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.401564121246338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4021492004394531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4021492004394531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4022388458251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4111137390136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.411789894104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.411789894104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4118852615356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4219942092895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4225311279296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4225311279296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4226036071777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4307937622070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4314112663269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4314112663269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4314875602722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4406428337097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4414525032043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4414525032043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4415459632873535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4534153938293457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4538984298706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4538984298706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.453953742980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4613656997680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4619340896606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4619340896606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4619932174682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4703302383422852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4711084365844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4711084365844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4711847305297852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4824762344360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4828824996948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4828824996948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4829225540161133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.489130973815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4895973205566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4895973205566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4896392822265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4964370727539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4969468116760254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4969468116760254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.49699068069458  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5044045448303223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([548, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5175504684448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5175504684448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.5185956954956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.7300643920898438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 548, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.7050790786743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.7054948806762695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.7059106826782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.7054738998413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2789, 40])
input nodes number: 18329
output nodes number: 2789
edges number: 29378
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.705613136291504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.705613613128662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03960990905761719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 29 input nodes size: 47190
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03582572937011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03582572937011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.05926322937011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.059284210205078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.034978389739990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03628206253051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03628206253051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03628206253051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([47190, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03628206253051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([663, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.10865211486816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.10865211486816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1092844009399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11434268951416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([682, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11467695236206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11467695236206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 682, 128]), torch.Size([1, 682, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.11532735824584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.12508344650268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 682, 128])
m.shape torch.Size([630, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.12565946578979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.12565946578979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.12626028060913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.13947820663452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([598, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1403508186340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1403508186340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14092111587524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.15843629837036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([599, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.15957927703857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.15957927703857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16015052795410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.18168306350708008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([536, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.18293094635009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.18293094635009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1834421157836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.20592021942138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([509, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.20736360549926758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.20736360549926758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.20784902572631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.23212003707885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([507, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2338113784790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2338113784790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.23429489135742188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2618551254272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([521, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.26384925842285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.26384925842285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2643461227416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2968320846557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([12109, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3543238639831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3543238639831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12109, 128]), torch.Size([1, 12109, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.36681079864501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1896238327026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12109, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1201167106628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1366667747497559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.15321683883667  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1365370750427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17354, 256])
first layer input nodes number: 47190
first layer output nodes number: 17354
edges number: 145918
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1535706520080566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1701207160949707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1743683815002441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1743683815002441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([399, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.202761173248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.202761173248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2035222053527832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2110905647277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([294, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.211275577545166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.211275577545166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.211836338043213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2209858894348145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([231, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2213716506958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2213716506958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2218122482299805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2315053939819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([191, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2320194244384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2320194244384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2323837280273438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2429485321044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([158, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2435259819030762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2435259819030762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2438273429870605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.254676342010498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([119, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2552123069763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2552123069763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.255439281463623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2651991844177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([91, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.265697956085205  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.265697956085205  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.265871524810791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.274549961090088  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([81, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2750864028930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2750864028930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2752408981323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2840471267700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2846274375915527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2846274375915527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2847723960876465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2940497398376465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.294631004333496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.294631004333496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2947607040405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.303969383239746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3044652938842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3044652938842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3045663833618164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3124513626098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3130698204040527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3130698204040527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3131804466247559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3225836753845215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.323028564453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.323028564453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3231048583984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3301239013671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3305702209472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3305702209472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3306388854980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3374366760253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3379502296447754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3379502296447754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3380227088928223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.345705509185791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3464231491088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3464231491088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3465166091918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3570775985717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3575048446655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3575048446655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.357560157775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3641977310180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3646893501281738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3646893501281738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3647465705871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3720135688781738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3725876808166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3725876808166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3726506233215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.38108491897583  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3814382553100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3814382553100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3814764022827148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.386855125427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3875832557678223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3875832557678223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3876538276672363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3980984687805176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3984651565551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3984651565551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3985013961791992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.404118537902832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4046530723571777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4046530723571777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.404700756072998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4124255180358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.412886142730713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.412886142730713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.412926197052002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4196953773498535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([577, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.433539867401123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.433539867401123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.4346404075622559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6306757926940918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 577, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6053743362426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.605787754058838  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.606201171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.605766773223877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2773, 40])
input nodes number: 17354
output nodes number: 2773
edges number: 29013
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6059150695800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.6059155464172363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03857231140136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 30 input nodes size: 42879
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03497600555419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03497600555419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.055422306060791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.05544328689575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.031984806060791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03294038772583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03294038772583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03294038772583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([42879, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03294038772583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([840, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.08543872833251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.08543872833251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.08623981475830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.09300041198730469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([870, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.0934295654296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.0934295654296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.09425926208496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1067047119140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([731, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.10733556747436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.10733556747436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 731, 128]), torch.Size([1, 731, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1080327033996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.12395286560058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 731, 128])
m.shape torch.Size([693, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.12492609024047852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.12492609024047852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.12558698654174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14527177810668945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([625, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14643144607543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14643144607543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14702749252319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16905879974365234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([562, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.17036867141723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.17036867141723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.17090463638305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.19395112991333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([522, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.19542551040649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.19542551040649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1959233283996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2209644317626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([489, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2225809097290039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2225809097290039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.22304725646972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.24962902069091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([414, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2511725425720215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2511725425720215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.25156736373901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.27683591842651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([8116, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3153386116027832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3153386116027832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8116, 128]), torch.Size([1, 8116, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3231501579284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8755908012390137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8116, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8272852897644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8405051231384277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8537249565124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8404016494750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13862, 256])
first layer input nodes number: 42879
first layer output nodes number: 13862
edges number: 106494
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8540463447570801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8672661781311035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8708205223083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8708205223083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([503, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8930745124816895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8930745124816895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8940339088439941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9023556709289551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([404, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9026527404785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9026527404785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9034233093261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9155750274658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([271, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9159712791442871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9159712791442871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9164881706237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9298968315124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9304957389831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9304957389831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9309210777282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9432559013366699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([180, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.94390869140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.94390869140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9442520141601562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9566116333007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9572420120239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9572420120239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9575071334838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.968907356262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([103, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9694681167602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9694681167602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9696645736694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.979487419128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9801735877990723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9801735877990723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9803681373596191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.991457462310791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([60, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9918794631958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9918794631958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9919939041137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9993181228637695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9999914169311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9999914169311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.000136375427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0104284286499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0109057426452637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0109057426452637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.01100492477417  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0187411308288574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.019141674041748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.019141674041748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0192160606384277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0255389213562012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.026139259338379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.026139259338379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0262365341186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0351858139038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0356216430664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0356216430664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0356903076171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0424880981445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0429439544677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0429439544677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.043008804321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0498828887939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.050281047821045  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.050281047821045  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0503344535827637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0563693046569824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0567350387573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0567350387573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0567808151245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0622739791870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0628046989440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0628046989440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0628657341003418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0706171989440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0709705352783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0709705352783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0710105895996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0763778686523438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0767426490783691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0767426490783691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0767807960510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0821595191955566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.082624912261963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.082624912261963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0826706886291504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0894455909729004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0898246765136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0898246765136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0898609161376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0954780578613281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.095858097076416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.095858097076416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0958924293518066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.101454257965088  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1018061637878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1018061637878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1018366813659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1069941520690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([300, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1141877174377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1141877174377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.114759922027588  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2192034721374512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 300, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2000079154968262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2004218101501465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2008357048034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2004008293151855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2775, 40])
input nodes number: 13862
output nodes number: 2775
edges number: 21755
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.2005257606506348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.200526237487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.034720420837402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 31 input nodes size: 41187
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03198528289794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03198528289794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.05162477493286133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.051645755767822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03117847442626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.032217979431152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.032217979431152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.032217979431152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([41187, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.032217979431152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([677, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.08838510513305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.08838510513305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.08903074264526367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.09474945068359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([751, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.09514284133911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.09514284133911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 751, 128]), torch.Size([1, 751, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.09585905075073242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.10686063766479492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 751, 128])
m.shape torch.Size([740, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.10756111145019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.10756111145019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 740, 128]), torch.Size([1, 740, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.10826683044433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.12379264831542969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 740, 128])
m.shape torch.Size([626, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1246337890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1246337890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1252307891845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14254379272460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([589, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14364957809448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.14364957809448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1442112922668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16492843627929688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([610, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16639280319213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16639280319213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.16697454452514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1927638053894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([530, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.19424200057983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.19424200057983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.1947474479675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.22080659866333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([495, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2224421501159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2224421501159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.2229142189025879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.24982213973999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([458, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.25155162811279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.25155162811279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.25198841094970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.27994251251220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([8889, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3221101760864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.3221101760864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8889, 128]), torch.Size([1, 8889, 128])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.33058738708496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9362568855285645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8889, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8835611343383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.8972606658935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9109601974487305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.897153377532959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14365, 256])
first layer input nodes number: 41187
first layer output nodes number: 14365
edges number: 114190
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9112691879272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9249687194824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9291729927062988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9291729927062988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([397, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.95379638671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.95379638671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9545536041259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9614043235778809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([339, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9616775512695312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9616775512695312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9623241424560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9720230102539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([325, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9726371765136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9726371765136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9732570648193359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9872550964355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9877605438232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9877605438232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9881649017333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.9998912811279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([156, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.000439167022705  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.000439167022705  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0007367134094238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0114483833312988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0121417045593262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0121417045593262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0124201774597168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0243945121765137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0250563621520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0250563621520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0252833366394043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0366320610046387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([89, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.037203311920166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.037203311920166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0373730659484863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0470490455627441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0476388931274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0476388931274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0477876663208008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0573091506958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0578789710998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0578789710998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.058006763458252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.067080020904541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0675978660583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0675978660583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0677027702331543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.07588529586792  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0765137672424316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0765137672424316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0766263008117676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0861916542053223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0867352485656738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0867352485656738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0868268013000488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0952496528625488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0956482887268066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0956482887268066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.0957112312316895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.101942539215088  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1026177406311035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1026177406311035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1027112007141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1126179695129395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1130328178405762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1130328178405762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1130900382995605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.119555950164795  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1199522018432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1199522018432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1200017929077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1259527206420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.126516342163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.126516342163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1265811920166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.134817123413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1352415084838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1352415084838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.135289192199707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.141678810119629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.141982078552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.141982078552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.142014503479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1465864181518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1470346450805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1470346450805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.147078514099121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1535711288452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1539511680603027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1539511680603027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1539874076843262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.159604549407959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1598296165466309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1598296165466309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1598505973815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1632494926452637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1636543273925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1636543273925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1636886596679688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1694908142089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([422, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1796135902404785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1796135902404785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.1804184913635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3301019668579102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 422, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.308365821838379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3087830543518066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3092002868652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3087620735168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2797, 40])
input nodes number: 14365
output nodes number: 2797
edges number: 25090
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.3088936805725098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 1.308894157409668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03410959243774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03410959243774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.5233154296875 GB
    Memory Allocated: 0.03410959243774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008733317255973816 |0.0018726065754890442 |0.1163838803768158 |8.569657802581787e-05 |0.07629719376564026 |0.0048143863677978516 |
----------------------------------------------------------pseudo_mini_loss sum 3.9087603092193604
Total (block generation + training)time/epoch 28.422248244285583
Training time/epoch 6.693965673446655
Training time without block to device /epoch 6.634042263031006
Training time without total dataloading part /epoch 6.173351049423218
load block tensor time/epoch 0.2794661521911621
block to device time/epoch 0.059923410415649414
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1117761
Number of first layer input nodes during this epoch:  800815
Number of first layer output nodes during this epoch:  316946
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
