[05:41:03] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28897942 edges into 32 parts and get 9305165 edge cuts
main start at this time 1651556442.8582523
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02817702293395996
global_2_local spend time (sec) 0.03567767143249512
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004908084869384766
A = g.adjacency_matrix() spent  0.007586002349853516
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0883026123046875
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2963910102844238
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1881539821624756

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 1.198 seconds
Metis partitioning: 5.339 seconds
Split the graph: 0.539 seconds
Construct subgraphs: 0.042 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.131033897399902
2885
2789
2921
2864
2927
2758
2860
2859
2926
2890
2868
2927
2903
2897
2925
2877
2898
2861
2895
2888
2758
2770
2781
2791
2767
2764
2774
2777
2758
2867
2758
2758
total k batches seeds list generation spend  16.937381982803345
after graph partition
graph partition algorithm spend time 17.015442848205566
2885
2789
2921
2864
2927
2758
2860
2859
2926
2890
2868
2927
2903
2897
2925
2877
2898
2861
2895
2888
2758
2770
2781
2791
2767
2764
2774
2777
2758
2867
2758
2758
partition_len_list
[5721, 5126, 6125, 6050, 8117, 8422, 6856, 6831, 7389, 8286, 6666, 8838, 5161, 5111, 7130, 5543, 6371, 6636, 7941, 6580, 15856, 11972, 9467, 11980, 15189, 13120, 18975, 17509, 18024, 18401, 17281, 16829]
shared_neighbor_graph_partition_s0 selection method  spend 17.10297203063965
time for parepare:  0.017544031143188477
local_output_nid generation:  0.0006659030914306641
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0008819103240966797
r_  generation:  0.005779743194580078
local_output_nid generation:  0.0006773471832275391
local_in_edges_tensor generation:  0.0008134841918945312
mini_batch_src_global generation:  0.0008962154388427734
r_  generation:  0.005930900573730469
local_output_nid generation:  0.0007345676422119141
local_in_edges_tensor generation:  0.0007905960083007812
mini_batch_src_global generation:  0.0009818077087402344
r_  generation:  0.007110595703125
local_output_nid generation:  0.0007395744323730469
local_in_edges_tensor generation:  0.0006623268127441406
mini_batch_src_global generation:  0.0007600784301757812
r_  generation:  0.006044864654541016
local_output_nid generation:  0.0007534027099609375
local_in_edges_tensor generation:  0.0007064342498779297
mini_batch_src_global generation:  0.0009529590606689453
r_  generation:  0.007985353469848633
local_output_nid generation:  0.0007455348968505859
local_in_edges_tensor generation:  0.0006251335144042969
mini_batch_src_global generation:  0.0007801055908203125
r_  generation:  0.0063741207122802734
local_output_nid generation:  0.0007779598236083984
local_in_edges_tensor generation:  0.0006368160247802734
mini_batch_src_global generation:  0.0007860660552978516
r_  generation:  0.007070302963256836
local_output_nid generation:  0.0007777214050292969
local_in_edges_tensor generation:  0.0006251335144042969
mini_batch_src_global generation:  0.0007007122039794922
r_  generation:  0.006182670593261719
local_output_nid generation:  0.0007808208465576172
local_in_edges_tensor generation:  0.0006413459777832031
mini_batch_src_global generation:  0.0008254051208496094
r_  generation:  0.007058858871459961
local_output_nid generation:  0.0007724761962890625
local_in_edges_tensor generation:  0.0006341934204101562
mini_batch_src_global generation:  0.0007748603820800781
r_  generation:  0.006669044494628906
local_output_nid generation:  0.0007619857788085938
local_in_edges_tensor generation:  0.0006284713745117188
mini_batch_src_global generation:  0.0007736682891845703
r_  generation:  0.00681757926940918
local_output_nid generation:  0.000774383544921875
local_in_edges_tensor generation:  0.0006346702575683594
mini_batch_src_global generation:  0.0008859634399414062
r_  generation:  0.007315158843994141
local_output_nid generation:  0.0007779598236083984
local_in_edges_tensor generation:  0.0006020069122314453
mini_batch_src_global generation:  0.0006117820739746094
r_  generation:  0.005055665969848633
local_output_nid generation:  0.0007684230804443359
local_in_edges_tensor generation:  0.0005908012390136719
mini_batch_src_global generation:  0.0005326271057128906
r_  generation:  0.005012035369873047
local_output_nid generation:  0.0007686614990234375
local_in_edges_tensor generation:  0.0006172657012939453
mini_batch_src_global generation:  0.0007188320159912109
r_  generation:  0.006528615951538086
local_output_nid generation:  0.0007488727569580078
local_in_edges_tensor generation:  0.0005950927734375
mini_batch_src_global generation:  0.0006330013275146484
r_  generation:  0.005693197250366211
local_output_nid generation:  0.0007388591766357422
local_in_edges_tensor generation:  0.0005915164947509766
mini_batch_src_global generation:  0.0005860328674316406
r_  generation:  0.005419492721557617
local_output_nid generation:  0.0007367134094238281
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0005753040313720703
r_  generation:  0.0052144527435302734
local_output_nid generation:  0.0007476806640625
local_in_edges_tensor generation:  0.000606536865234375
mini_batch_src_global generation:  0.0006709098815917969
r_  generation:  0.005795001983642578
local_output_nid generation:  0.0007436275482177734
local_in_edges_tensor generation:  0.0006842613220214844
mini_batch_src_global generation:  0.0006649494171142578
r_  generation:  0.006081819534301758
local_output_nid generation:  0.000720977783203125
local_in_edges_tensor generation:  0.0006341934204101562
mini_batch_src_global generation:  0.0011119842529296875
r_  generation:  0.00888681411743164
local_output_nid generation:  0.0008006095886230469
local_in_edges_tensor generation:  0.0006153583526611328
mini_batch_src_global generation:  0.0009443759918212891
r_  generation:  0.0067958831787109375
local_output_nid generation:  0.0007777214050292969
local_in_edges_tensor generation:  0.0005881786346435547
mini_batch_src_global generation:  0.0006387233734130859
r_  generation:  0.005391836166381836
local_output_nid generation:  0.0007791519165039062
local_in_edges_tensor generation:  0.0006101131439208984
mini_batch_src_global generation:  0.0007555484771728516
r_  generation:  0.006781101226806641
local_output_nid generation:  0.0007636547088623047
local_in_edges_tensor generation:  0.0006008148193359375
mini_batch_src_global generation:  0.0008759498596191406
r_  generation:  0.007111787796020508
local_output_nid generation:  0.0007791519165039062
local_in_edges_tensor generation:  0.0057697296142578125
mini_batch_src_global generation:  0.0009369850158691406
r_  generation:  0.0069615840911865234
local_output_nid generation:  0.0007829666137695312
local_in_edges_tensor generation:  0.0008652210235595703
mini_batch_src_global generation:  0.0012030601501464844
r_  generation:  0.00893855094909668
local_output_nid generation:  0.0008008480072021484
local_in_edges_tensor generation:  0.0006883144378662109
mini_batch_src_global generation:  0.0011799335479736328
r_  generation:  0.008653402328491211
local_output_nid generation:  0.0008172988891601562
local_in_edges_tensor generation:  0.0007030963897705078
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.011040449142456055
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.000751495361328125
mini_batch_src_global generation:  0.0011441707611083984
r_  generation:  0.012156009674072266
local_output_nid generation:  0.0008661746978759766
local_in_edges_tensor generation:  0.0006959438323974609
mini_batch_src_global generation:  0.001294851303100586
r_  generation:  0.008685588836669922
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0006630420684814453
mini_batch_src_global generation:  0.0010752677917480469
r_  generation:  0.008686065673828125
----------------------check_connections_block total spend ----------------------------- 0.38585448265075684
generate_one_block  0.011353254318237305
generate_one_block  0.009429454803466797
generate_one_block  0.010292530059814453
generate_one_block  0.008855104446411133
generate_one_block  0.012144327163696289
generate_one_block  0.009746074676513672
generate_one_block  0.010207414627075195
generate_one_block  0.008923053741455078
generate_one_block  0.010424375534057617
generate_one_block  0.010679244995117188
generate_one_block  0.0099334716796875
generate_one_block  0.010998010635375977
generate_one_block  0.007035493850708008
generate_one_block  0.007105350494384766
generate_one_block  0.009541988372802734
generate_one_block  0.00803065299987793
generate_one_block  0.007726907730102539
generate_one_block  0.007399559020996094
generate_one_block  0.008667945861816406
generate_one_block  0.0087738037109375
generate_one_block  0.01530003547668457
generate_one_block  0.01010894775390625
generate_one_block  0.008183002471923828
generate_one_block  0.010609865188598633
generate_one_block  0.011789560317993164
generate_one_block  0.009960174560546875
generate_one_block  0.014766454696655273
generate_one_block  0.013918161392211914
generate_one_block  0.01586461067199707
generate_one_block  0.019582033157348633
generate_one_block  0.01531672477722168
generate_one_block  0.013386726379394531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024620532989501953
gen group dst list time:  0.00951075553894043
time for parepare:  0.02095818519592285
local_output_nid generation:  0.001184701919555664
local_in_edges_tensor generation:  0.005351543426513672
mini_batch_src_global generation:  0.0012180805206298828
r_  generation:  0.011749505996704102
local_output_nid generation:  0.0012278556823730469
local_in_edges_tensor generation:  0.0013418197631835938
mini_batch_src_global generation:  0.0014557838439941406
r_  generation:  0.0094451904296875
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0015537738800048828
mini_batch_src_global generation:  0.0012412071228027344
r_  generation:  0.014350175857543945
local_output_nid generation:  0.0015397071838378906
local_in_edges_tensor generation:  0.001422882080078125
mini_batch_src_global generation:  0.0010294914245605469
r_  generation:  0.012987375259399414
local_output_nid generation:  0.0020372867584228516
local_in_edges_tensor generation:  0.00191497802734375
mini_batch_src_global generation:  0.0018310546875
r_  generation:  0.019368648529052734
local_output_nid generation:  0.002110719680786133
local_in_edges_tensor generation:  0.001953125
mini_batch_src_global generation:  0.0017652511596679688
r_  generation:  0.019559860229492188
local_output_nid generation:  0.0017490386962890625
local_in_edges_tensor generation:  0.0016446113586425781
mini_batch_src_global generation:  0.0014748573303222656
r_  generation:  0.01598358154296875
local_output_nid generation:  0.001791238784790039
local_in_edges_tensor generation:  0.0016303062438964844
mini_batch_src_global generation:  0.0012967586517333984
r_  generation:  0.015423774719238281
local_output_nid generation:  0.001984834671020508
local_in_edges_tensor generation:  0.0017707347869873047
mini_batch_src_global generation:  0.0012869834899902344
r_  generation:  0.016872167587280273
local_output_nid generation:  0.0021250247955322266
local_in_edges_tensor generation:  0.001880645751953125
mini_batch_src_global generation:  0.00171661376953125
r_  generation:  0.018863439559936523
local_output_nid generation:  0.0017595291137695312
local_in_edges_tensor generation:  0.0015506744384765625
mini_batch_src_global generation:  0.0014734268188476562
r_  generation:  0.015787601470947266
local_output_nid generation:  0.002171754837036133
local_in_edges_tensor generation:  0.002178668975830078
mini_batch_src_global generation:  0.001863241195678711
r_  generation:  0.022372961044311523
local_output_nid generation:  0.0013873577117919922
local_in_edges_tensor generation:  0.001191854476928711
mini_batch_src_global generation:  0.0012593269348144531
r_  generation:  0.008623361587524414
local_output_nid generation:  0.0013484954833984375
local_in_edges_tensor generation:  0.0011563301086425781
mini_batch_src_global generation:  0.0010564327239990234
r_  generation:  0.008594036102294922
local_output_nid generation:  0.0017971992492675781
local_in_edges_tensor generation:  0.001611471176147461
mini_batch_src_global generation:  0.0012590885162353516
r_  generation:  0.01574230194091797
local_output_nid generation:  0.0014028549194335938
local_in_edges_tensor generation:  0.001268148422241211
mini_batch_src_global generation:  0.0013651847839355469
r_  generation:  0.013155460357666016
local_output_nid generation:  0.0016291141510009766
local_in_edges_tensor generation:  0.001462697982788086
mini_batch_src_global generation:  0.0011394023895263672
r_  generation:  0.013135433197021484
local_output_nid generation:  0.0016818046569824219
local_in_edges_tensor generation:  0.0014767646789550781
mini_batch_src_global generation:  0.0010035037994384766
r_  generation:  0.013742923736572266
local_output_nid generation:  0.0019865036010742188
local_in_edges_tensor generation:  0.0017497539520263672
mini_batch_src_global generation:  0.0013654232025146484
r_  generation:  0.0169985294342041
local_output_nid generation:  0.0016455650329589844
local_in_edges_tensor generation:  0.0014510154724121094
mini_batch_src_global generation:  0.0011968612670898438
r_  generation:  0.014032840728759766
local_output_nid generation:  0.003810882568359375
local_in_edges_tensor generation:  0.0041692256927490234
mini_batch_src_global generation:  0.004134654998779297
r_  generation:  0.043084144592285156
local_output_nid generation:  0.0033330917358398438
local_in_edges_tensor generation:  0.003774404525756836
mini_batch_src_global generation:  0.0036056041717529297
r_  generation:  0.031215667724609375
local_output_nid generation:  0.0027441978454589844
local_in_edges_tensor generation:  0.0025281906127929688
mini_batch_src_global generation:  0.002228975296020508
r_  generation:  0.02346324920654297
local_output_nid generation:  0.003301382064819336
local_in_edges_tensor generation:  0.0032095909118652344
mini_batch_src_global generation:  0.0030379295349121094
r_  generation:  0.031525373458862305
local_output_nid generation:  0.0041615962982177734
local_in_edges_tensor generation:  0.004284858703613281
mini_batch_src_global generation:  0.003914356231689453
r_  generation:  0.041481971740722656
local_output_nid generation:  0.0037839412689208984
local_in_edges_tensor generation:  0.0038552284240722656
mini_batch_src_global generation:  0.0037190914154052734
r_  generation:  0.03500652313232422
local_output_nid generation:  0.005253791809082031
local_in_edges_tensor generation:  0.005640983581542969
mini_batch_src_global generation:  0.005502223968505859
r_  generation:  0.057352304458618164
local_output_nid generation:  0.004949092864990234
local_in_edges_tensor generation:  0.005193948745727539
mini_batch_src_global generation:  0.005799770355224609
r_  generation:  0.0526890754699707
local_output_nid generation:  0.005055427551269531
local_in_edges_tensor generation:  0.004976749420166016
mini_batch_src_global generation:  0.00576329231262207
r_  generation:  0.052556514739990234
local_output_nid generation:  0.005014657974243164
local_in_edges_tensor generation:  0.0050201416015625
mini_batch_src_global generation:  0.005967617034912109
r_  generation:  0.05567216873168945
local_output_nid generation:  0.004898786544799805
local_in_edges_tensor generation:  0.004602670669555664
mini_batch_src_global generation:  0.005481719970703125
r_  generation:  0.051492929458618164
local_output_nid generation:  0.0048677921295166016
local_in_edges_tensor generation:  0.00516963005065918
mini_batch_src_global generation:  0.005227804183959961
r_  generation:  0.048622846603393555
----------------------check_connections_block total spend ----------------------------- 1.2902958393096924
generate_one_block  0.015886783599853516
generate_one_block  0.014684915542602539
generate_one_block  0.019187211990356445
generate_one_block  0.01760697364807129
generate_one_block  0.025991201400756836
generate_one_block  0.026175975799560547
generate_one_block  0.021577119827270508
generate_one_block  0.020669937133789062
generate_one_block  0.02256488800048828
generate_one_block  0.025304794311523438
generate_one_block  0.021516084671020508
generate_one_block  0.03675699234008789
generate_one_block  0.013060808181762695
generate_one_block  0.012722253799438477
generate_one_block  0.019668102264404297
generate_one_block  0.015000343322753906
generate_one_block  0.017181396484375
generate_one_block  0.019037723541259766
generate_one_block  0.023287296295166016
generate_one_block  0.018970012664794922
generate_one_block  0.06312322616577148
generate_one_block  0.044031381607055664
generate_one_block  0.031168460845947266
generate_one_block  0.043070316314697266
generate_one_block  0.059006452560424805
generate_one_block  0.04837465286254883
generate_one_block  0.07713723182678223
generate_one_block  0.07074618339538574
generate_one_block  0.07268023490905762
generate_one_block  0.07523465156555176
generate_one_block  0.06779718399047852
generate_one_block  0.08255171775817871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.2902958393096924
block generation total time  1.1417725086212158
average batch blocks generation time:  0.035680390894412994
pseudo mini batch 0 input nodes size: 12447
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.0087127685546875  GigaBytes
Max Memory Allocated: 0.0087127685546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.008734703063964844  GigaBytes
Max Memory Allocated: 0.008734703063964844  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.008734703063964844  GigaBytes
Max Memory Allocated: 0.008734703063964844  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009128570556640625  GigaBytes
Max Memory Allocated: 0.009128570556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009128570556640625  GigaBytes
Max Memory Allocated: 0.009128570556640625  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009128570556640625  GigaBytes
Max Memory Allocated: 0.009128570556640625  GigaBytes

torch.Size([12447, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009128570556640625  GigaBytes
Max Memory Allocated: 0.009128570556640625  GigaBytes

m.shape torch.Size([730, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.02579975128173828  GigaBytes
Max Memory Allocated: 0.02591419219970703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.02579975128173828  GigaBytes
Max Memory Allocated: 0.02591419219970703  GigaBytes

 h.shape torch.Size([1, 730, 128]), torch.Size([1, 730, 128])
----------------------------------------3
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.026495933532714844  GigaBytes
Max Memory Allocated: 0.026495933532714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.03239774703979492  GigaBytes
Max Memory Allocated: 0.0327458381652832  GigaBytes

rst.shape  torch.Size([1, 730, 128])
m.shape torch.Size([664, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.03268289566040039  GigaBytes
Max Memory Allocated: 0.0327458381652832  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.03268289566040039  GigaBytes
Max Memory Allocated: 0.0327458381652832  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.03331613540649414  GigaBytes
Max Memory Allocated: 0.03331613540649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.04281473159790039  GigaBytes
Max Memory Allocated: 0.04344797134399414  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([596, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.0433506965637207  GigaBytes
Max Memory Allocated: 0.04344797134399414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.0433506965637207  GigaBytes
Max Memory Allocated: 0.04344797134399414  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.04391908645629883  GigaBytes
Max Memory Allocated: 0.04391908645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.05736255645751953  GigaBytes
Max Memory Allocated: 0.05821514129638672  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([486, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.058005332946777344  GigaBytes
Max Memory Allocated: 0.05821514129638672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.058005332946777344  GigaBytes
Max Memory Allocated: 0.05821514129638672  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.05846881866455078  GigaBytes
Max Memory Allocated: 0.05846881866455078  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.07190990447998047  GigaBytes
Max Memory Allocated: 0.07283687591552734  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([412, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.07266044616699219  GigaBytes
Max Memory Allocated: 0.07283687591552734  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.07266044616699219  GigaBytes
Max Memory Allocated: 0.07283687591552734  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.07305335998535156  GigaBytes
Max Memory Allocated: 0.07305335998535156  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08719825744628906  GigaBytes
Max Memory Allocated: 0.0881805419921875  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([336, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08796310424804688  GigaBytes
Max Memory Allocated: 0.0881805419921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08796310424804688  GigaBytes
Max Memory Allocated: 0.0881805419921875  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08828353881835938  GigaBytes
Max Memory Allocated: 0.08828353881835938  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.10206222534179688  GigaBytes
Max Memory Allocated: 0.10302352905273438  GigaBytes

rst.shape  torch.Size([1, 336, 128])
m.shape torch.Size([273, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.1028132438659668  GigaBytes
Max Memory Allocated: 0.10302352905273438  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.1028132438659668  GigaBytes
Max Memory Allocated: 0.10302352905273438  GigaBytes

 h.shape torch.Size([1, 273, 128]), torch.Size([1, 273, 128])
----------------------------------------3
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.1030735969543457  GigaBytes
Max Memory Allocated: 0.1030735969543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11609125137329102  GigaBytes
Max Memory Allocated: 0.11700248718261719  GigaBytes

rst.shape  torch.Size([1, 273, 128])
m.shape torch.Size([264, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11696815490722656  GigaBytes
Max Memory Allocated: 0.11700248718261719  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11696815490722656  GigaBytes
Max Memory Allocated: 0.11700248718261719  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11721992492675781  GigaBytes
Max Memory Allocated: 0.11721992492675781  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13157081604003906  GigaBytes
Max Memory Allocated: 0.13257789611816406  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([242, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13248348236083984  GigaBytes
Max Memory Allocated: 0.13257789611816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13248348236083984  GigaBytes
Max Memory Allocated: 0.13257789611816406  GigaBytes

 h.shape torch.Size([1, 242, 128]), torch.Size([1, 242, 128])
----------------------------------------3
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13271427154541016  GigaBytes
Max Memory Allocated: 0.13271427154541016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.14748477935791016  GigaBytes
Max Memory Allocated: 0.14852333068847656  GigaBytes

rst.shape  torch.Size([1, 242, 128])
m.shape torch.Size([1718, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.1559152603149414  GigaBytes
Max Memory Allocated: 0.15610790252685547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.1559152603149414  GigaBytes
Max Memory Allocated: 0.15610790252685547  GigaBytes

 h.shape torch.Size([1, 1718, 128]), torch.Size([1, 1718, 128])
----------------------------------------3
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.15755367279052734  GigaBytes
Max Memory Allocated: 0.15755367279052734  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2738809585571289  GigaBytes
Max Memory Allocated: 0.2820730209350586  GigaBytes

rst.shape  torch.Size([1, 1718, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.26066017150878906  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2661161422729492  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2715721130371094  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.26607322692871094  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

torch.Size([5721, 256])
first layer input nodes number: 12447
first layer output nodes number: 5721
edges number: 33247
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2716670036315918  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.27712297439575195  GigaBytes
Max Memory Allocated: 0.2825350761413574  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2784872055053711  GigaBytes
Max Memory Allocated: 0.28394317626953125  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2784872055053711  GigaBytes
Max Memory Allocated: 0.28394317626953125  GigaBytes

m.shape torch.Size([542, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2988147735595703  GigaBytes
Max Memory Allocated: 0.29881715774536133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2988147735595703  GigaBytes
Max Memory Allocated: 0.29881715774536133  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2998485565185547  GigaBytes
Max Memory Allocated: 0.2998485565185547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.3081188201904297  GigaBytes
Max Memory Allocated: 0.3086357116699219  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([405, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.3083806037902832  GigaBytes
Max Memory Allocated: 0.3086357116699219  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.3083806037902832  GigaBytes
Max Memory Allocated: 0.3086357116699219  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.30915307998657227  GigaBytes
Max Memory Allocated: 0.30915307998657227  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.3218727111816406  GigaBytes
Max Memory Allocated: 0.3226451873779297  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([314, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.32239198684692383  GigaBytes
Max Memory Allocated: 0.3226451873779297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.32239198684692383  GigaBytes
Max Memory Allocated: 0.3226451873779297  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.32299089431762695  GigaBytes
Max Memory Allocated: 0.32299089431762695  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.33698177337646484  GigaBytes
Max Memory Allocated: 0.33788013458251953  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.3375973701477051  GigaBytes
Max Memory Allocated: 0.33788013458251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.3375973701477051  GigaBytes
Max Memory Allocated: 0.33788013458251953  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.33805131912231445  GigaBytes
Max Memory Allocated: 0.33805131912231445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.35121583938598633  GigaBytes
Max Memory Allocated: 0.3521237373352051  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.35207653045654297  GigaBytes
Max Memory Allocated: 0.3521237373352051  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.35207653045654297  GigaBytes
Max Memory Allocated: 0.3521237373352051  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.35246753692626953  GigaBytes
Max Memory Allocated: 0.35246753692626953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3665437698364258  GigaBytes
Max Memory Allocated: 0.36762332916259766  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3672652244567871  GigaBytes
Max Memory Allocated: 0.36762332916259766  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3672652244567871  GigaBytes
Max Memory Allocated: 0.36762332916259766  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3675684928894043  GigaBytes
Max Memory Allocated: 0.36762332916259766  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.38060903549194336  GigaBytes
Max Memory Allocated: 0.3815188407897949  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.38125133514404297  GigaBytes
Max Memory Allocated: 0.3815188407897949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.38125133514404297  GigaBytes
Max Memory Allocated: 0.3815188407897949  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.38147640228271484  GigaBytes
Max Memory Allocated: 0.3815188407897949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3927297592163086  GigaBytes
Max Memory Allocated: 0.39351749420166016  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3935399055480957  GigaBytes
Max Memory Allocated: 0.39354372024536133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3935399055480957  GigaBytes
Max Memory Allocated: 0.39354372024536133  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3937687873840332  GigaBytes
Max Memory Allocated: 0.3937687873840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.4068150520324707  GigaBytes
Max Memory Allocated: 0.4077305793762207  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.40758323669433594  GigaBytes
Max Memory Allocated: 0.4077305793762207  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.40758323669433594  GigaBytes
Max Memory Allocated: 0.4077305793762207  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.4077777862548828  GigaBytes
Max Memory Allocated: 0.4077777862548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.4202289581298828  GigaBytes
Max Memory Allocated: 0.42110443115234375  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.420804500579834  GigaBytes
Max Memory Allocated: 0.42110443115234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.420804500579834  GigaBytes
Max Memory Allocated: 0.42110443115234375  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.42093801498413086  GigaBytes
Max Memory Allocated: 0.42110443115234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.430417537689209  GigaBytes
Max Memory Allocated: 0.43108510971069336  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.4311652183532715  GigaBytes
Max Memory Allocated: 0.4311685562133789  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.4311652183532715  GigaBytes
Max Memory Allocated: 0.4311685562133789  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.43131208419799805  GigaBytes
Max Memory Allocated: 0.43131208419799805  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.4427676200866699  GigaBytes
Max Memory Allocated: 0.443575382232666  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.44345569610595703  GigaBytes
Max Memory Allocated: 0.443575382232666  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.44345569610595703  GigaBytes
Max Memory Allocated: 0.443575382232666  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.44358158111572266  GigaBytes
Max Memory Allocated: 0.44358158111572266  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.4542818069458008  GigaBytes
Max Memory Allocated: 0.45503711700439453  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.4548811912536621  GigaBytes
Max Memory Allocated: 0.45503711700439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.4548811912536621  GigaBytes
Max Memory Allocated: 0.45503711700439453  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.45498228073120117  GigaBytes
Max Memory Allocated: 0.45503711700439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.4642825126647949  GigaBytes
Max Memory Allocated: 0.46493959426879883  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.464810848236084  GigaBytes
Max Memory Allocated: 0.46493959426879883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.464810848236084  GigaBytes
Max Memory Allocated: 0.46493959426879883  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.4648928642272949  GigaBytes
Max Memory Allocated: 0.46493959426879883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.47301244735717773  GigaBytes
Max Memory Allocated: 0.4735865592956543  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.47356271743774414  GigaBytes
Max Memory Allocated: 0.4735865592956543  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.47356271743774414  GigaBytes
Max Memory Allocated: 0.4735865592956543  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.47364091873168945  GigaBytes
Max Memory Allocated: 0.47364091873168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.4819302558898926  GigaBytes
Max Memory Allocated: 0.4825167655944824  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.48221445083618164  GigaBytes
Max Memory Allocated: 0.4825167655944824  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.48221445083618164  GigaBytes
Max Memory Allocated: 0.4825167655944824  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.4822545051574707  GigaBytes
Max Memory Allocated: 0.4825167655944824  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.48678064346313477  GigaBytes
Max Memory Allocated: 0.48710107803344727  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.48725080490112305  GigaBytes
Max Memory Allocated: 0.48725271224975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.48725080490112305  GigaBytes
Max Memory Allocated: 0.48725271224975586  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.4873080253601074  GigaBytes
Max Memory Allocated: 0.4873080253601074  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.4941744804382324  GigaBytes
Max Memory Allocated: 0.4946608543395996  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.49456119537353516  GigaBytes
Max Memory Allocated: 0.4946608543395996  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.49456119537353516  GigaBytes
Max Memory Allocated: 0.4946608543395996  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.49460697174072266  GigaBytes
Max Memory Allocated: 0.4946608543395996  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.5004205703735352  GigaBytes
Max Memory Allocated: 0.5008325576782227  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.5008177757263184  GigaBytes
Max Memory Allocated: 0.5008325576782227  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.5008177757263184  GigaBytes
Max Memory Allocated: 0.5008325576782227  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.500861644744873  GigaBytes
Max Memory Allocated: 0.500861644744873  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5067400932312012  GigaBytes
Max Memory Allocated: 0.5071568489074707  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5070834159851074  GigaBytes
Max Memory Allocated: 0.5071568489074707  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5070834159851074  GigaBytes
Max Memory Allocated: 0.5071568489074707  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5071196556091309  GigaBytes
Max Memory Allocated: 0.5071568489074707  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5122294425964355  GigaBytes
Max Memory Allocated: 0.5125918388366699  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5125546455383301  GigaBytes
Max Memory Allocated: 0.5125918388366699  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5125546455383301  GigaBytes
Max Memory Allocated: 0.5125918388366699  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5125870704650879  GigaBytes
Max Memory Allocated: 0.5125918388366699  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.5173859596252441  GigaBytes
Max Memory Allocated: 0.5177264213562012  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.5177717208862305  GigaBytes
Max Memory Allocated: 0.5177736282348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.5177717208862305  GigaBytes
Max Memory Allocated: 0.5177736282348633  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.5178079605102539  GigaBytes
Max Memory Allocated: 0.5178079605102539  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.5234251022338867  GigaBytes
Max Memory Allocated: 0.5238237380981445  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.523716926574707  GigaBytes
Max Memory Allocated: 0.5238237380981445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.523716926574707  GigaBytes
Max Memory Allocated: 0.5238237380981445  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.5237436294555664  GigaBytes
Max Memory Allocated: 0.5238237380981445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5280694961547852  GigaBytes
Max Memory Allocated: 0.528376579284668  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5283560752868652  GigaBytes
Max Memory Allocated: 0.528376579284668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5283560752868652  GigaBytes
Max Memory Allocated: 0.528376579284668  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5283808708190918  GigaBytes
Max Memory Allocated: 0.5283808708190918  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5325713157653809  GigaBytes
Max Memory Allocated: 0.5328688621520996  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([152, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5362114906311035  GigaBytes
Max Memory Allocated: 0.5362257957458496  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5362114906311035  GigaBytes
Max Memory Allocated: 0.5362257957458496  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.536501407623291  GigaBytes
Max Memory Allocated: 0.536501407623291  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.587526798248291  GigaBytes
Max Memory Allocated: 0.5911507606506348  GigaBytes

rst.shape  torch.Size([1, 152, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5705275535583496  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5709576606750488  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.571387767791748  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.5709357261657715  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([2885, 40])
input nodes number: 5721
output nodes number: 2885
edges number: 19478
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.5714306831359863  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.5714316368103027  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.013129234313964844  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

pseudo mini batch 1 input nodes size: 10001
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011940956115722656  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011940956115722656  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.01670980453491211  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.016730785369873047  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.010773658752441406  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011153221130371094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011153221130371094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011153221130371094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([10001, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.011153221130371094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

m.shape torch.Size([572, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.026267051696777344  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.026267051696777344  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.02681255340576172  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.03117656707763672  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([613, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.03148841857910156  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.03148841857910156  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.032073020935058594  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.04100942611694336  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([552, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.04150676727294922  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.04150676727294922  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.04203319549560547  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.053786277770996094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([448, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.05437755584716797  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.05437755584716797  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.05480480194091797  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.06719493865966797  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([355, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.06782770156860352  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.06782770156860352  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.06816625595092773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.08035421371459961  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([303, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.08105182647705078  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.08105182647705078  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 303, 128]), torch.Size([1, 303, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.08134078979492188  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.0937662124633789  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 303, 128])
m.shape torch.Size([265, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.09450626373291016  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.09450626373291016  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.09475898742675781  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.10739517211914062  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 265, 128])
m.shape torch.Size([216, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1080927848815918  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1080927848815918  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 216, 128]), torch.Size([1, 216, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.10829877853393555  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1200404167175293  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 216, 128])
m.shape torch.Size([209, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1208343505859375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1208343505859375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 209, 128]), torch.Size([1, 209, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1210336685180664  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1337900161743164  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 209, 128])
m.shape torch.Size([1593, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.14128637313842773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.14128637313842773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 1593, 128]), torch.Size([1, 1593, 128])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1428055763244629  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.250669002532959  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 1593, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.23809099197387695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2429795265197754  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.24786806106567383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.24294090270996094  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([5126, 256])
first layer input nodes number: 10001
first layer output nodes number: 5126
edges number: 30233
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.24794483184814453  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.25283336639404297  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2541341781616211  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2541341781616211  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

m.shape torch.Size([406, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.2743644714355469  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.2743644714355469  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.27513885498046875  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.28354358673095703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([387, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.28390073776245117  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.28390073776245117  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.2846388816833496  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.29638099670410156  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([317, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.29692602157592773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.29692602157592773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.2975306510925293  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.31110715866088867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([281, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.31188535690307617  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.31188535690307617  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3124213218688965  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.32831907272338867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.32894039154052734  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.32894039154052734  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.32929325103759766  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3419961929321289  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.34270238876342773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.34270238876342773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.34299421310424805  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3555426597595215  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.35628509521484375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.35628509521484375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.356536865234375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3691253662109375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3697991371154785  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3697991371154785  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.369997501373291  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3813042640686035  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.38213109970092773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.38213109970092773  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.38233518600463867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.39539670944213867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3959965705871582  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3959965705871582  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.3961358070373535  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4060215950012207  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.40654420852661133  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.40654420852661133  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.40665102005004883  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.41498231887817383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4156327247619629  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4156327247619629  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.41574907302856445  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.42563867568969727  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4261178970336914  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4261178970336914  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.42619991302490234  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4337453842163086  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4342966079711914  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4342966079711914  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.43438053131103516  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4426889419555664  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.44313716888427734  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.44313716888427734  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.44320201873779297  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4500761032104492  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45053577423095703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45053577423095703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45059680938720703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45749378204345703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45800256729125977  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45800256729125977  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4580655097961426  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4656186103820801  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.46617555618286133  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.46617555618286133  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.46624040603637695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.47447633743286133  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.47484588623046875  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.47484588623046875  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4748878479003906  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4805107116699219  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.48077821731567383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.48077821731567383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.480806827545166  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.48484086990356445  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.48539209365844727  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.48539209365844727  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.485445499420166  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.493349552154541  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4936823844909668  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4936823844909668  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4937148094177246  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.49874067306518555  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.49921083450317383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.49921083450317383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4992527961730957  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5060505867004395  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5063529014587402  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5063529014587402  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5063796043395996  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.510892391204834  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([189, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5154204368591309  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5154204368591309  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.5157809257507324  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5792269706726074  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 189, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5626468658447266  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5630626678466797  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5634784698486328  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5630416870117188  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([2789, 40])
input nodes number: 5126
output nodes number: 2789
edges number: 20512
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.563086986541748  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5630874633789062  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.011894702911376953  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

pseudo mini batch 2 input nodes size: 13198
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.010759353637695312  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.010759353637695312  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.017052650451660156  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.0170745849609375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.01228475570678711  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.012783527374267578  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.012783527374267578  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.012783527374267578  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([13198, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.012783527374267578  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

m.shape torch.Size([346, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.03386735916137695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.03386735916137695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.034197330474853516  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.036837100982666016  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([446, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.03709745407104492  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.03709745407104492  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.03752279281616211  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.04390287399291992  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([450, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.04433393478393555  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.04433393478393555  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.04476308822631836  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.054204463958740234  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([472, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.05489015579223633  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.05489015579223633  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.05534029006958008  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.06839418411254883  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([434, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.06928777694702148  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.06928777694702148  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.0697016716003418  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.08460187911987305  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([432, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.08563089370727539  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.08563089370727539  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.08604288101196289  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.10375833511352539  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([358, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.10485029220581055  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.10485029220581055  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.10519170761108398  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12226247787475586  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([328, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12334299087524414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12334299087524414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12365579605102539  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.14148569107055664  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([248, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.1423935890197754  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.1423935890197754  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 248, 128]), torch.Size([1, 248, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.14263010025024414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.15776681900024414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 248, 128])
m.shape torch.Size([2611, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.17009878158569336  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.17009878158569336  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 2611, 128]), torch.Size([1, 2611, 128])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.17258882522583008  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.35558366775512695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 2611, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.33591747283935547  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.34175872802734375  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.34759998321533203  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.34171295166015625  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

torch.Size([6125, 256])
first layer input nodes number: 13198
first layer output nodes number: 6125
edges number: 42710
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.3477005958557129  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.35354185104370117  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.3552122116088867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.3552122116088867  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

m.shape torch.Size([270, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.37921762466430664  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.37921762466430664  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.379732608795166  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3844928741455078  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([294, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.38480091094970703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.38480091094970703  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3853616714477539  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3943028450012207  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([277, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3948211669921875  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3948211669921875  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.39534950256347656  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.40765953063964844  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4083566665649414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4083566665649414  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.40883350372314453  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.42266178131103516  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([234, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.42354822158813477  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.42354822158813477  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4239945411682129  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4400620460510254  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([231, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.44117116928100586  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.44117116928100586  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.44161176681518555  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4605574607849121  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([176, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.46152162551879883  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.46152162551879883  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.46185731887817383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.47864198684692383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.479550838470459  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.479550838470459  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.47981786727905273  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4950385093688965  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([113, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.495882511138916  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.495882511138916  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.49609804153442383  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5098919868469238  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([121, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5109472274780273  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5109472274780273  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5111780166625977  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5275640487670898  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5286436080932617  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5286436080932617  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5288591384887695  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5456705093383789  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.546381950378418  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.546381950378418  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5465173721313477  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5580282211303711  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5587854385375977  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5587854385375977  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5589113235473633  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5704927444458008  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5713315010070801  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5713315010070801  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5714592933654785  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5841107368469238  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5846095085144043  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5846095085144043  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.584683895111084  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5925688743591309  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5931930541992188  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5931930541992188  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5932750701904297  GigaBytes
Max Memory Allocated: 0.59564208984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6025428771972656  GigaBytes
Max Memory Allocated: 0.6031990051269531  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6033844947814941  GigaBytes
Max Memory Allocated: 0.6033883094787598  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6033844947814941  GigaBytes
Max Memory Allocated: 0.6033883094787598  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.603487491607666  GigaBytes
Max Memory Allocated: 0.603487491607666  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.615847110748291  GigaBytes
Max Memory Allocated: 0.616722583770752  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6163668632507324  GigaBytes
Max Memory Allocated: 0.616722583770752  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6163668632507324  GigaBytes
Max Memory Allocated: 0.616722583770752  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6164298057556152  GigaBytes
Max Memory Allocated: 0.616722583770752  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6244235038757324  GigaBytes
Max Memory Allocated: 0.6249899864196777  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6248307228088379  GigaBytes
Max Memory Allocated: 0.6249899864196777  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6248307228088379  GigaBytes
Max Memory Allocated: 0.6249899864196777  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6248764991760254  GigaBytes
Max Memory Allocated: 0.6249899864196777  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6310105323791504  GigaBytes
Max Memory Allocated: 0.6314454078674316  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6316800117492676  GigaBytes
Max Memory Allocated: 0.6316828727722168  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6316800117492676  GigaBytes
Max Memory Allocated: 0.6316828727722168  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6317486763000488  GigaBytes
Max Memory Allocated: 0.6317486763000488  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6414303779602051  GigaBytes
Max Memory Allocated: 0.6421170234680176  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6419410705566406  GigaBytes
Max Memory Allocated: 0.6421170234680176  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6419410705566406  GigaBytes
Max Memory Allocated: 0.6421170234680176  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6419925689697266  GigaBytes
Max Memory Allocated: 0.6421170234680176  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6496143341064453  GigaBytes
Max Memory Allocated: 0.6501550674438477  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6500115394592285  GigaBytes
Max Memory Allocated: 0.6501550674438477  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6500115394592285  GigaBytes
Max Memory Allocated: 0.6501550674438477  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6500496864318848  GigaBytes
Max Memory Allocated: 0.6501550674438477  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6559624671936035  GigaBytes
Max Memory Allocated: 0.6563820838928223  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6562972068786621  GigaBytes
Max Memory Allocated: 0.6563820838928223  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6562972068786621  GigaBytes
Max Memory Allocated: 0.6563820838928223  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6563277244567871  GigaBytes
Max Memory Allocated: 0.6563820838928223  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6612715721130371  GigaBytes
Max Memory Allocated: 0.6616225242614746  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6616950035095215  GigaBytes
Max Memory Allocated: 0.6616969108581543  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6616950035095215  GigaBytes
Max Memory Allocated: 0.6616969108581543  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6617312431335449  GigaBytes
Max Memory Allocated: 0.6617312431335449  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.6678557395935059  GigaBytes
Max Memory Allocated: 0.6682906150817871  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([187, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.6723313331604004  GigaBytes
Max Memory Allocated: 0.6723489761352539  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.6723313331604004  GigaBytes
Max Memory Allocated: 0.6723489761352539  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.6726880073547363  GigaBytes
Max Memory Allocated: 0.6726880073547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7354626655578613  GigaBytes
Max Memory Allocated: 0.7399210929870605  GigaBytes

rst.shape  torch.Size([1, 187, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7145595550537109  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7149949073791504  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7154302597045898  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.714972972869873  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([2921, 40])
input nodes number: 6125
output nodes number: 2921
edges number: 24182
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7150602340698242  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7150607109069824  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.013751029968261719  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

pseudo mini batch 3 input nodes size: 13614
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.012304306030273438  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.012304306030273438  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.01879596710205078  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.018817424774169922  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.012502193450927734  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.01292562484741211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.01292562484741211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.01292562484741211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([13614, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.01292562484741211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

m.shape torch.Size([601, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.03129720687866211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.03129720687866211  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.031870365142822266  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.036455631256103516  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([665, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.036803245544433594  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.036803245544433594  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.03743743896484375  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.046950340270996094  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([626, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.047528743743896484  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.047528743743896484  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.0481257438659668  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.06205606460571289  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([548, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.06280279159545898  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.06280279159545898  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.06332540512084961  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.07905340194702148  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([434, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.07982683181762695  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.07982683181762695  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.08024072647094727  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.09514093399047852  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([359, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.09596109390258789  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.09596109390258789  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.09630346298217773  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.11102533340454102  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([343, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1119990348815918  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1119990348815918  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 343, 128]), torch.Size([1, 343, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.11232614517211914  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.12868165969848633  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 343, 128])
m.shape torch.Size([274, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1295633316040039  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1295633316040039  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.12982463836669922  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.14471912384033203  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([218, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1455240249633789  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1455240249633789  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.14573192596435547  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.15903759002685547  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 218, 128])
m.shape torch.Size([1982, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.16838455200195312  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.16838455200195312  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 1982, 128]), torch.Size([1, 1982, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.1702747344970703  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3082542419433594  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 1982, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.2924962043762207  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.2982659339904785  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.30403566360473633  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.2982206344604492  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([6050, 256])
first layer input nodes number: 13614
first layer output nodes number: 6050
edges number: 36700
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3041391372680664  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3101778030395508  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.311556339263916  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.311556339263916  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

m.shape torch.Size([433, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.33178281784057617  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.33178281784057617  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.332608699798584  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3392157554626465  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([412, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.33959484100341797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.33959484100341797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3403806686401367  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3523998260498047  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([350, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.35324811935424805  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.35324811935424805  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3539156913757324  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.36860227584838867  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([262, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3696002960205078  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3696002960205078  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3701000213623047  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3849658966064453  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.38567256927490234  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.38567256927490234  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.38605213165283203  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.3997163772583008  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.40044355392456055  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.40044355392456055  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.40074682235717773  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4137873649597168  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.41451072692871094  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.41451072692871094  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.41475868225097656  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4271564483642578  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4278244972229004  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4278244972229004  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4280209541320801  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.43921899795532227  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.43983888626098633  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.43983888626098633  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.43999719619750977  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.45012903213500977  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4508380889892578  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4508380889892578  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.45099449157714844  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4620990753173828  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4628138542175293  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4628138542175293  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.46295690536499023  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.47411489486694336  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4747586250305176  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4747586250305176  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.47487688064575195  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.48492860794067383  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.48554420471191406  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.48554420471191406  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.48564720153808594  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.49512290954589844  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.495758056640625  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.495758056640625  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.49585533142089844  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5054855346679688  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.50604248046875  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.50604248046875  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5061225891113281  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5146141052246094  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5152816772460938  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5152816772460938  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5153694152832031  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5252838134765625  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5256977081298828  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5256977081298828  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5257511138916016  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5321598052978516  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5328254699707031  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5328254699707031  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5329017639160156  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5425910949707031  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5429916381835938  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5429916381835938  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5430374145507812  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5491714477539062  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5497255325317383  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5497255325317383  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5497827529907227  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5578508377075195  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5582060813903809  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5582060813903809  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5582423210144043  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.563605785369873  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5638837814331055  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5638837814331055  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5639104843139648  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.568049430847168  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5683460235595703  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5683460235595703  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5683727264404297  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5726985931396484  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5730776786804199  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5730776786804199  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5731101036071777  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.578589916229248  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([135, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.581817626953125  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.581817626953125  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.5820751190185547  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6273937225341797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 135, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6105127334594727  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6109395027160645  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6113662719726562  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6109180450439453  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([2864, 40])
input nodes number: 6050
output nodes number: 2864
edges number: 20020
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6109762191772461  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.6109766960144043  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.013760566711425781  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

pseudo mini batch 4 input nodes size: 15996
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.012493610382080078  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.012493610382080078  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.020121097564697266  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.02014303207397461  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.013629913330078125  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.014285087585449219  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.014285087585449219  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.014285087585449219  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([15996, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.014285087585449219  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

m.shape torch.Size([441, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.04355335235595703  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.04355335235595703  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.04397392272949219  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.04733848571777344  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([529, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.047632694244384766  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.047632694244384766  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.04813718795776367  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.05607175827026367  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([542, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.0565948486328125  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.0565948486328125  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.05711174011230469  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.06879711151123047  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([501, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.06949424743652344  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.06949424743652344  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.06997203826904297  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.08382797241210938  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([501, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.08478355407714844  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.08478355407714844  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.08526134490966797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.1024618148803711  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([452, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.1035161018371582  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.1035161018371582  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.10394716262817383  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.1224827766418457  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([440, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.12373590469360352  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.12373590469360352  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.12415552139282227  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.14513635635375977  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 440, 128])
m.shape torch.Size([414, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.14650583267211914  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.14650583267211914  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.14690065383911133  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.16940546035766602  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([346, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.17069292068481445  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.17069292068481445  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.17102289199829102  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.19214105606079102  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([3951, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.21150732040405273  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.21150732040405273  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 3951, 128]), torch.Size([1, 3951, 128])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.21527528762817383  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.49048566818237305  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 3951, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.4633169174194336  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.4716825485229492  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.47942352294921875  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.47099733352661133  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

torch.Size([8117, 256])
first layer input nodes number: 15996
first layer output nodes number: 8117
edges number: 59362
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.47891998291015625  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.4868755340576172  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.48982763290405273  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.48982763290405273  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

m.shape torch.Size([282, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5176115036010742  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5176115036010742  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5181493759155273  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5228428840637207  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([294, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.523139476776123  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.523139476776123  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5237002372741699  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5324440002441406  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([256, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5329017639160156  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5329017639160156  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5333900451660156  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5441322326660156  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([179, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5445766448974609  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5445766448974609  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5449180603027344  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5548191070556641  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([176, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5554943084716797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5554943084716797  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5558300018310547  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5679149627685547  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5685892105102539  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5685892105102539  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5688676834106445  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5808420181274414  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([152, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5817608833312988  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5817608833312988  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5820508003234863  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5965466499328613  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5975050926208496  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5975050926208496  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.5977663993835449  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6126608848571777  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6134819984436035  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6134819984436035  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6136918067932129  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6271195411682129  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([104, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6280145645141602  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6280145645141602  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6282129287719727  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6422967910766602  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6433396339416504  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6433396339416504  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6435456275939941  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6596131324768066  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([85, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6604905128479004  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6604905128479004  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6606526374816895  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6744332313537598  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6753020286560059  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6753020286560059  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6754469871520996  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6887831687927246  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6898007392883301  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6898007392883301  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.6899552345275879  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7052502632141113  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.706153392791748  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.706153392791748  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7062830924987793  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7200312614440918  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7209815979003906  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7209815979003906  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7211074829101562  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7353324890136719  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.736152172088623  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.736152172088623  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7362551689147949  GigaBytes
Max Memory Allocated: 0.7436480522155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7486147880554199  GigaBytes
Max Memory Allocated: 0.7494902610778809  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7492380142211914  GigaBytes
Max Memory Allocated: 0.7494902610778809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7492380142211914  GigaBytes
Max Memory Allocated: 0.7494902610778809  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7493124008178711  GigaBytes
Max Memory Allocated: 0.7494902610778809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7587594985961914  GigaBytes
Max Memory Allocated: 0.7594289779663086  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.759270191192627  GigaBytes
Max Memory Allocated: 0.7594289779663086  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.759270191192627  GigaBytes
Max Memory Allocated: 0.7594289779663086  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7593274116516113  GigaBytes
Max Memory Allocated: 0.7594289779663086  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7669949531555176  GigaBytes
Max Memory Allocated: 0.7675385475158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7677931785583496  GigaBytes
Max Memory Allocated: 0.767796516418457  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7677931785583496  GigaBytes
Max Memory Allocated: 0.767796516418457  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7678751945495605  GigaBytes
Max Memory Allocated: 0.7678751945495605  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7794394493103027  GigaBytes
Max Memory Allocated: 0.7802596092224121  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7801456451416016  GigaBytes
Max Memory Allocated: 0.7802596092224121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7801456451416016  GigaBytes
Max Memory Allocated: 0.7802596092224121  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7802162170410156  GigaBytes
Max Memory Allocated: 0.7802596092224121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7906608581542969  GigaBytes
Max Memory Allocated: 0.7914018630981445  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.791111946105957  GigaBytes
Max Memory Allocated: 0.7914018630981445  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.791111946105957  GigaBytes
Max Memory Allocated: 0.7914018630981445  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7911558151245117  GigaBytes
Max Memory Allocated: 0.7914018630981445  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7979555130004883  GigaBytes
Max Memory Allocated: 0.7984380722045898  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7984423637390137  GigaBytes
Max Memory Allocated: 0.7984447479248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7984423637390137  GigaBytes
Max Memory Allocated: 0.7984447479248047  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7984862327575684  GigaBytes
Max Memory Allocated: 0.7984862327575684  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8055930137634277  GigaBytes
Max Memory Allocated: 0.8060975074768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8061943054199219  GigaBytes
Max Memory Allocated: 0.8061971664428711  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8061943054199219  GigaBytes
Max Memory Allocated: 0.8061971664428711  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8062458038330078  GigaBytes
Max Memory Allocated: 0.8062458038330078  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8149490356445312  GigaBytes
Max Memory Allocated: 0.8155670166015625  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([331, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8229408264160156  GigaBytes
Max Memory Allocated: 0.8229718208312988  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8229408264160156  GigaBytes
Max Memory Allocated: 0.8229718208312988  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.8235721588134766  GigaBytes
Max Memory Allocated: 0.8235721588134766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.9371700286865234  GigaBytes
Max Memory Allocated: 0.9450616836547852  GigaBytes

rst.shape  torch.Size([1, 331, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.9124007225036621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.912837028503418  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.9132733345031738  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.9128150939941406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2927, 40])
input nodes number: 8117
output nodes number: 2927
edges number: 28491
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.9129071235656738  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.912907600402832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01549673080444336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 5 input nodes size: 20476
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.013639450073242188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.013639450073242188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.023403167724609375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.023424148559570312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01577472686767578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016364097595214844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016364097595214844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016364097595214844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([20476, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016364097595214844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([682, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04477834701538086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04477834701538086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 682, 128]), torch.Size([1, 682, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04542875289916992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05063199996948242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 682, 128])
m.shape torch.Size([723, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05099630355834961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05099630355834961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05168581008911133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06202840805053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([635, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0625920295715332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0625920295715332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06319761276245117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07652044296264648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([613, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07738685607910156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07738685607910156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0779714584350586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09570121765136719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([544, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09670591354370117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09670591354370117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09722471237182617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11620283126831055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([489, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11734247207641602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11734247207641602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11780881881713867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1378617286682129  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([427, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1390538215637207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1390538215637207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13946104049682617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1598219871520996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([379, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16106414794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16106414794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16142559051513672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18202781677246094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([352, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18335771560668945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18335771560668945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18369340896606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.20517778396606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([3578, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.22207117080688477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.22207117080688477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 3578, 128]), torch.Size([1, 3578, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.22624731063842773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4738640785217285  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 3578, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4479045867919922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4559364318847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46396827697753906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4558734893798828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([8422, 256])
first layer input nodes number: 20476
first layer output nodes number: 8422
edges number: 57108
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4641227722167969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4721546173095703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47416257858276367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47416257858276367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([433, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4957256317138672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4957256317138672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.496551513671875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5041041374206543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([364, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5043911933898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5043911933898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5050854682922363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5154995918273926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([296, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5160059928894043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5160059928894043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5165705680847168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5297989845275879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5303740501403809  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5303740501403809  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.530799388885498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5431342124938965  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5438394546508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5438394546508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5442037582397461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5573186874389648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([145, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5579729080200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5579729080200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5582494735717773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5701417922973633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5708718299865723  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5708718299865723  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5711178779602051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5834202766418457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5840511322021484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5840511322021484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5842380523681641  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5948925018310547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5955862998962402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5955862998962402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5957598686218262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6068682670593262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6075024604797363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6075024604797363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6076455116271973  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6178021430969238  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6183547973632812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6183547973632812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6184673309326172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6272449493408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6277308464050293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6277308464050293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6278204917907715  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6354403495788574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.635920524597168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.635920524597168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6360006332397461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6433706283569336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6438016891479492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6438016891479492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6438684463500977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.650477409362793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6508913040161133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6508913040161133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6509504318237305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6572179794311523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6577115058898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6577115058898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6577763557434082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6651043891906738  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6657257080078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6657257080078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.665802001953125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.674957275390625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6754035949707031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6754035949707031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6754570007324219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6822395324707031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6828155517578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6828155517578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6828784942626953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6913127899169922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6918196678161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6918196678161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6918730735778809  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6994032859802246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6997804641723633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6997804641723633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6998186111450195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7054643630981445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7056994438171387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7056994438171387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7057223320007324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7092700004577637  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7097892761230469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7097892761230469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7098350524902344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7172508239746094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7175512313842773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7175512313842773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7175779342651367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7220907211303711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([266, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7284688949584961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7284688949584961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7289762496948242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8231115341186523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 266, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8045568466186523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8049678802490234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8053789138793945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8049468994140625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2758, 40])
input nodes number: 8422
output nodes number: 2758
edges number: 21873
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8050055503845215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8050060272216797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017464160919189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 6 input nodes size: 15241
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.015749454498291016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.015749454498291016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.023563861846923828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.02358531951904297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.013800621032714844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014326095581054688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014326095581054688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014326095581054688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([15241, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014326095581054688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([558, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03716897964477539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03716897964477539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03770112991333008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04236125946044922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([577, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04264545440673828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04264545440673828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04319572448730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05144977569580078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([568, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0519871711730957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0519871711730957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05252885818481445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06444597244262695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([481, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06509256362915039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06509256362915039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0655512809753418  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07885408401489258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([482, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0797739028930664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0797739028930664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08023357391357422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09678173065185547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([390, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09766769409179688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09766769409179688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09803962707519531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11403274536132812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([362, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11505508422851562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11505508422851562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11540031433105469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1326618194580078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 362, 128])
m.shape torch.Size([337, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1337747573852539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1337747573852539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1340961456298828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.15241527557373047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([255, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1533489227294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1533489227294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.15359210968017578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16915607452392578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([2846, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18260526657104492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18260526657104492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2846, 128]), torch.Size([1, 2846, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1853194236755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3833460807800293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2846, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.36315345764160156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3696918487548828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.37623023986816406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3696403503417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6856, 256])
first layer input nodes number: 15241
first layer output nodes number: 6856
edges number: 46075
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3763461112976074  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.38288450241088867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.384519100189209  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.384519100189209  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([379, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4086289405822754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4086289405822754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40935182571411133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4156174659729004  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([302, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.41583681106567383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.41583681106567383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4164128303527832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.42531490325927734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4258403778076172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4258403778076172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4263782501220703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43821144104003906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4388270378112793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4388270378112793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43926572799682617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45198774337768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4528083801269531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4528083801269531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45320892333984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46762847900390625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.468350887298584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.468350887298584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.468656063079834  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.481778621673584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.482480525970459  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.482480525970459  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48272275924682617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49483442306518555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49561309814453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49561309814453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4958362579345703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5085563659667969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5092406272888184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5092406272888184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5094161033630371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5206465721130371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([109, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5216069221496582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5216069221496582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5218148231506348  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5365757942199707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5373177528381348  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5373177528381348  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5374703407287598  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5493721961975098  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5500802993774414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5500802993774414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5502099990844727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5612344741821289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5619821548461914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5619821548461914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5621061325073242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.573512077331543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5740828514099121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5740828514099121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5741724967956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5830473899841309  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([61, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5838823318481445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5838823318481445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5839986801147461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5963315963745117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5969810485839844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5969810485839844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5970687866210938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6069831848144531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6076092720031738  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6076092720031738  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6076874732971191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6170716285705566  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6175861358642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6175861358642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6176471710205078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6253986358642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6259160041809082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6259160041809082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6259732246398926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6336407661437988  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6342272758483887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6342272758483887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6342883110046387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6428942680358887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6435904502868652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6435904502868652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6436591148376465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6538214683532715  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6541681289672852  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6541681289672852  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6542024612426758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6595239639282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6598606109619141  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6598606109619141  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6598911285400391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6648349761962891  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6652812957763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6652812957763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6653194427490234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6717662811279297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([260, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6779947280883789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6779947280883789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6784906387329102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7689619064331055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 260, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.747931957244873  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7483582496643066  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7487845420837402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7483367919921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2860, 40])
input nodes number: 6856
output nodes number: 2860
edges number: 24335
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7484250068664551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7484254837036133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.015349864959716797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 7 input nodes size: 14675
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.013815879821777344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.013815879821777344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.020813465118408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.020834922790527344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01299905776977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01348257064819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01348257064819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01348257064819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([14675, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01348257064819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([608, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03585052490234375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03585052490234375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.03643035888671875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04106903076171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([622, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04137229919433594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04137229919433594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.041965484619140625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05086326599121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([601, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05142641067504883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05142641067504883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.051999568939208984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06463241577148438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([544, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0653834342956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0653834342956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0659022331237793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08182096481323242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([463, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08266544342041016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08266544342041016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08310699462890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09900283813476562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([429, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10000944137573242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10000944137573242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1004185676574707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1180109977722168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([357, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11899805068969727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11899805068969727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1193385124206543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13636159896850586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([316, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13739681243896484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13739681243896484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13769817352294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1548757553100586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([262, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.15584945678710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.15584945678710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1560993194580078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1720905303955078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([2629, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18450164794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18450164794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2629, 128]), torch.Size([1, 2629, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18700885772705078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.37035274505615234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2629, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3507370948791504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3572516441345215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3637661933898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.35720062255859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6831, 256])
first layer input nodes number: 14675
first layer output nodes number: 6831
edges number: 44395
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3638777732849121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3703923225402832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3720211982727051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3720211982727051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([459, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3922743797302246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3922743797302246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.39314985275268555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40015363693237305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40042734146118164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40042734146118164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40113306045532227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.41257524490356445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([307, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.41310787200927734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.41310787200927734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4136934280395508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4274559020996094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([275, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4282207489013672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4282207489013672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4287452697753906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4442625045776367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44500017166137695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44500017166137695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44539690017700195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45967912673950195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([186, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4605536460876465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4605536460876465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4609084129333496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.476163387298584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47686767578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47686767578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47711753845214844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4896106719970703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4903855323791504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4903855323791504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49060869216918945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.503328800201416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5041604042053223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5041604042053223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5043683052062988  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5176739692687988  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5183777809143066  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5183777809143066  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5185379981994629  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5299134254455566  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5304465293884277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5304465293884277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5305571556091309  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5391860008239746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5398116111755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5398116111755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.539924144744873  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5494894981384277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5500454902648926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5500454902648926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5501389503479004  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5587372779846191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5593233108520508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5593233108520508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.559412956237793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5682878494262695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5687479972839355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5687479972839355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.568814754486084  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5758910179138184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.575965404510498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.575965404510498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5759787559509277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5774874687194824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5780038833618164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5780038833618164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5780649185180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5853891372680664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.585756778717041  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.585756778717041  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5858006477355957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.591372013092041  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5916972160339355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5916972160339355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.591733455657959  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5965895652770996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5970139503479004  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5970139503479004  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5970578193664551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.603243350982666  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.603705883026123  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.603705883026123  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6037516593933105  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6105265617370605  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.61077880859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.61077880859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6108036041259766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6146469116210938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6149663925170898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6149663925170898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.614995002746582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6196298599243164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6198697090148926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6198697090148926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6198906898498535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.623436450958252  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([198, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6281838417053223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6281838417053223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6285614967346191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6950287818908691  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 198, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6779613494873047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6783876419067383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6788139343261719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6783661842346191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2859, 40])
input nodes number: 6831
output nodes number: 2859
edges number: 20456
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.678438663482666  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6784391403198242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014414310455322266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 8 input nodes size: 17336
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01299905776977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01299905776977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.021265506744384766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.02128744125366211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01426839828491211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014816761016845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014816761016845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014816761016845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([17336, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014816761016845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([531, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.039193153381347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.039193153381347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.039699554443359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.044039249420166016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([642, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04439830780029297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04439830780029297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04501056671142578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.054604530334472656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([648, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.055225372314453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.055225372314453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.055843353271484375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07030248641967773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([591, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0711207389831543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0711207389831543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07168436050415039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08865499496459961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([503, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08957242965698242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08957242965698242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09005212783813477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10732126235961914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([438, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10833454132080078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10833454132080078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10875225067138672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12671375274658203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([409, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1278700828552246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1278700828552246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12826013565063477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14776277542114258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([408, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1491241455078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1491241455078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14951324462890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17169189453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([359, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17303800582885742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17303800582885742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17338037490844727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.19529199600219727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([2860, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.20875835418701172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.20875835418701172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2860, 128]), torch.Size([1, 2860, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.2114858627319336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40968751907348633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2860, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3877906799316406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3948373794555664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4018840789794922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.39478206634521484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([7389, 256])
first layer input nodes number: 17336
first layer output nodes number: 7389
edges number: 49224
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40201520919799805  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40906190872192383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4117722511291504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4117722511291504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([353, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43585777282714844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43585777282714844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43653106689453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4429755210876465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([332, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44327735900878906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44327735900878906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4439105987548828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4537811279296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45435571670532227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45435571670532227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.45494508743286133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4679112434387207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46858930587768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46858930587768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4690718650817871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4830660820007324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48387765884399414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48387765884399414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4842953681945801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49933290481567383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49997758865356445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49997758865356445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5002598762512207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5123982429504395  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5130915641784668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5130915641784668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5133280754089355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.525153636932373  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([150, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.526188850402832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.526188850402832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5264749526977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5427827835083008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([115, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5436544418334961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5436544418334961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5438737869262695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5579118728637695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5587248802185059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5587248802185059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5589079856872559  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5719084739685059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5725679397583008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5725679397583008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5727033615112305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5832662582397461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5840640068054199  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5840640068054199  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5842070579528809  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5963664054870605  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5971198081970215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5971198081970215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5972456932067871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6088271141052246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6095447540283203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6095447540283203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6096553802490234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6206073760986328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6212730407714844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6212730407714844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.621368408203125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6314773559570312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6321220397949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6321220397949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6322078704833984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.64190673828125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6424684524536133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6424684524536133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6425390243530273  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6510076522827148  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6516470909118652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6516470909118652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6517214775085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6611685752868652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6617889404296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6617889404296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6618576049804688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6710586547851562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6715435981750488  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6715435981750488  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6715950965881348  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.678856372833252  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6793556213378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6793556213378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6794052124023438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6867446899414062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6872062683105469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6872062683105469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6872501373291016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6940498352050781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6945366859436035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6945366859436035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6945805549621582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7016873359680176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7020578384399414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7020578384399414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7020902633666992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7075700759887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([234, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7131767272949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7131767272949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.713623046875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.79217529296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 234, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7712326049804688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7716689109802246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7721052169799805  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7716469764709473  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2926, 40])
input nodes number: 7389
output nodes number: 2926
edges number: 24217
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7717342376708984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7717347145080566  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0158843994140625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 9 input nodes size: 20385
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014278411865234375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014278411865234375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.023998737335205078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.024020671844482422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.015732288360595703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016306400299072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016306400299072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016306400299072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([20385, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.016306400299072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([692, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04327249526977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04327249526977539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.043932437896728516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.049320220947265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 692, 128])
m.shape torch.Size([800, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04975318908691406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04975318908691406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05051612854003906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06196022033691406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([666, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0625314712524414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0625314712524414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06316661834716797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07713985443115234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([635, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.078033447265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.078033447265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07863903045654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09687232971191406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([560, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09790468215942383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09790468215942383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09843873977661133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11826562881469727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([532, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11952066421508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11952066421508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12002801895141602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14206886291503906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([424, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14323043823242188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14323043823242188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14363479614257812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16385269165039062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([426, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16527557373046875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.16527557373046875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1656818389892578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18883895874023438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([359, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.19017648696899414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.19017648696899414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.19051885604858398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.21243047714233398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([3192, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.2274799346923828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.2274799346923828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 3192, 128]), torch.Size([1, 3192, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.23126840591430664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4474015235900879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 3192, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4237546920776367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4316568374633789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4395589828491211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4315948486328125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([8286, 256])
first layer input nodes number: 20385
first layer output nodes number: 8286
edges number: 54349
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4397130012512207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4476151466369629  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44959068298339844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44959068298339844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([430, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4718785285949707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4718785285949707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4726986885070801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4799013137817383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([377, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48021602630615234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48021602630615234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.48093509674072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4924163818359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4928760528564453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4928760528564453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.49341773986816406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5069828033447266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5076041221618652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5076041221618652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5080466270446777  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5208792686462402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.521571159362793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.521571159362793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5219335556030273  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5349798202514648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5360732078552246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5360732078552246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5364012718200684  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5505080223083496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5511112213134766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5511112213134766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5513286590576172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5622005462646484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5633664131164551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5633664131164551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5636258125305176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5784115791320801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5791730880737305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5791730880737305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5793695449829102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5919427871704102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([98, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5927867889404297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5927867889404297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5929737091064453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6062450408935547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([84, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6070399284362793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6070399284362793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6072001457214355  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.619697093963623  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.620297908782959  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.620297908782959  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6204104423522949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6299757957458496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6306319236755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6306319236755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6307406425476074  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6407427787780762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6412134170532227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6412134170532227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6412878036499023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6486520767211914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6493358612060547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6493358612060547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6494312286376953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6595401763916016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6600461006164551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6600461006164551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6601147651672363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6678738594055176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6685261726379395  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6685261726379395  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6686062812805176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6782193183898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.678715705871582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.678715705871582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6787748336791992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.686284065246582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6867661476135254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6867661476135254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6868195533752441  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6939759254455566  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.694526195526123  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.694526195526123  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6945834159851074  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7026515007019043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7030673027038574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7030673027038574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7031092643737793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7093195915222168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7097640037536621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7097640037536621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.709805965423584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7163100242614746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7167315483093262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7167315483093262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7167696952819824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7229495048522949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.723299503326416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.723299503326416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.723330020904541  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.728487491607666  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([218, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.733710765838623  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.733710765838623  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7341265678405762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8073077201843262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 218, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7882051467895508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7886362075805664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.789067268371582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7886142730712891  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2890, 40])
input nodes number: 8286
output nodes number: 2890
edges number: 22628
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7886929512023926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7886934280395508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01741504669189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 10 input nodes size: 17450
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01572704315185547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01572704315185547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0240478515625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.02406930923461914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014327049255371094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014840126037597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014840126037597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014840126037597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([17450, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014840126037597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([505, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0374298095703125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0374298095703125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.037911415100097656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.041764259338378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([548, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04204607009887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04204607009887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.04256868362426758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05149269104003906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([571, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0520482063293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0520482063293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.05259275436401367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.064666748046875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([461, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06527376174926758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06527376174926758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.06571340560913086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07846307754516602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([430, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0792684555053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.0792684555053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.07967853546142578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09444141387939453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([340, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09520912170410156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09520912170410156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.09553337097167969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10947608947753906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([310, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11034870147705078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11034870147705078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 310, 128]), torch.Size([1, 310, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.11064434051513672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1254262924194336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 310, 128])
m.shape torch.Size([320, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12649917602539062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12649917602539062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.12680435180664062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14419937133789062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([270, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14520549774169922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.14520549774169922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 270, 128]), torch.Size([1, 270, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1454629898071289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.1619424819946289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 270, 128])
m.shape torch.Size([2911, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17569446563720703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17569446563720703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2911, 128]), torch.Size([1, 2911, 128])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.17847061157226562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3770132064819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2911, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.35646677017211914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3628239631652832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.36918115615844727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3627738952636719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6666, 256])
first layer input nodes number: 17450
first layer output nodes number: 6666
edges number: 45618
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.36931324005126953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3761301040649414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3772597312927246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3772597312927246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([380, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3999762535095215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3999762535095215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40070104598999023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4066905975341797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([360, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40702056884765625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40702056884765625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.40770721435546875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4189939498901367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4194984436035156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4194984436035156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4200592041015625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4325981140136719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43327903747558594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43327903747558594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.43375587463378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4475841522216797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4483213424682617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4483213424682617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.44870853424072266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4626474380493164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([140, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46326160430908203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.46326160430908203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4635286331176758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47501087188720703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47580623626708984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47580623626708984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.47606945037841797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4892301559448242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4900212287902832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4900212287902832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.4902501106262207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5032963752746582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5041337013244629  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5041337013244629  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5043435096740723  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5177712440490723  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5185990333557129  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5185990333557129  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5187840461730957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5319199562072754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5326099395751953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5326099395751953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5327510833740234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5437602996826172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5445089340209961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5445089340209961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5446443557739258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5561552047729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5568747520446777  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5568747520446777  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5569949150085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5680499076843262  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5687437057495117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5687437057495117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5688505172729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5794248580932617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5801067352294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5801067352294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5802040100097656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.59051513671875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5908355712890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5908355712890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.59088134765625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5960540771484375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5965542793273926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5965542793273926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5966153144836426  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6039395332336426  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6044454574584961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6044454574584961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6045045852661133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6120138168334961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6123862266540527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6123862266540527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6124281883239746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6180510520935059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6184916496276855  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6184916496276855  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.618537425994873  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6249918937683105  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6254134178161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6254134178161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.625455379486084  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6316657066345215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6322579383850098  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6322579383850098  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6323132514953613  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6408867835998535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6411247253417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6411247253417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6411476135253906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6448554992675781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6452593803405762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6452593803405762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6452937126159668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6510958671569824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([247, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6570138931274414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6570138931274414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6574850082397461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7404012680053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 247, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7207760810852051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7212038040161133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7216315269470215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7211823463439941  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2868, 40])
input nodes number: 6666
output nodes number: 2868
edges number: 23124
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7212505340576172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7212510108947754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.01583576202392578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 11 input nodes size: 23529
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014323711395263672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.014323711395263672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.025543212890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.025565147399902344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017222881317138672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017880916595458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017880916595458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017880916595458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([23529, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.017880916595458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([578, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.048937320709228516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.048937320709228516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04948854446411133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.054070472717285156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([625, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.054390907287597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.054390907287597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05498695373535156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06450510025024414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([608, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06507682800292969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06507682800292969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06565666198730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07841300964355469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([598, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07926368713378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07926368713378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.079833984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09732818603515625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([574, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09841156005859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09841156005859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09895896911621094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.11889934539794922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([486, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12001609802246094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12001609802246094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12047958374023438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1404094696044922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([472, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1417531967163086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1417531967163086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14220333099365234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16471004486083984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([433, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1661367416381836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1661367416381836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1665496826171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19008731842041016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([375, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19149017333984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19149017333984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1918478012084961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2147359848022461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([4089, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.23408842086791992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.23408842086791992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 4089, 128]), torch.Size([1, 4089, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2386341094970703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5158743858337402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 4089, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48795652389526367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4963850975036621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5048136711120605  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4963188171386719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([8838, 256])
first layer input nodes number: 23529
first layer output nodes number: 8838
edges number: 62863
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5049910545349121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5134196281433105  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5155267715454102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5155267715454102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([385, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.540372371673584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.540372371673584  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5411067008972168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.547541618347168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([329, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5478072166442871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5478072166442871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5484347343444824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5584807395935059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([276, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5589628219604492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5589628219604492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5594892501831055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5722179412841797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5728082656860352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5728082656860352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5732316970825195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5855112075805664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5862369537353516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5862369537353516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.58660888671875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5999984741210938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6007928848266602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6007928848266602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6011171340942383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6150598526000977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6158533096313477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6158533096313477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.616124153137207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6296663284301758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.630584716796875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.630584716796875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6308460235595703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6457405090332031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6464056968688965  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6464056968688965  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6465811729431152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6578116416931152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6586465835571289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6586465835571289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6588296890258789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6718301773071289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6724262237548828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6724262237548828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6725502014160156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.682220458984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6830582618713379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6830582618713379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6832070350646973  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6958527565002441  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6964783668518066  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6964783668518066  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6965851783752441  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7064118385314941  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7072601318359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7072601318359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7073879241943359  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7200393676757812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7207541465759277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7207541465759277  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7208571434020996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7317748069763184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7325229644775391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7325229644775391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7326221466064453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7438297271728516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7443685531616211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7443685531616211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7444372177124023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7526769638061523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7531790733337402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7531790733337402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7532382011413574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7607474327087402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.761265754699707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.761265754699707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7613229751586914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7689905166625977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7695198059082031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7695198059082031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7695751190185547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.777374267578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7778310775756836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7778310775756836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7778768539428711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7846517562866211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7850518226623535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7850518226623535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7850899696350098  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7910027503967285  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7913599014282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7913599014282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7913923263549805  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7966451644897461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7970442771911621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7970442771911621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7970786094665527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8028807640075684  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([306, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8102164268493652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8102164268493652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8108000755310059  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.9138998985290527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 306, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8921680450439453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8926043510437012  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.893040657043457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8925824165344238  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2927, 40])
input nodes number: 8838
output nodes number: 2927
edges number: 25328
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8926792144775391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8926796913146973  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.019144058227539062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 12 input nodes size: 8819
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.017231464385986328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.017231464385986328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.021436691284179688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02145862579345703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01021718978881836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010518550872802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010518550872802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010518550872802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([8819, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010518550872802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([772, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.023201942443847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.023201942443847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02393817901611328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.030508995056152344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([797, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.030900955200195312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.030900955200195312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.031661033630371094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04316091537475586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([693, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.043772220611572266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.043772220611572266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0444331169128418  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05935335159301758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([518, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06001091003417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06001091003417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.060504913330078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07490921020507812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([479, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07580423355102539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07580423355102539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07626104354858398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09270620346069336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([349, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0934762954711914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0934762954711914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09380912780761719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10812091827392578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 349, 128])
m.shape torch.Size([292, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10892915725708008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10892915725708008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1092076301574707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12313127517700195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 292, 128])
m.shape torch.Size([231, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12387323379516602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12387323379516602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12409353256225586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13665056228637695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([185, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13733434677124023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13733434677124023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1375107765197754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1488022804260254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([845, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15274333953857422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15274333953857422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1535491943359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21142339706420898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 845, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20240306854248047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20732498168945312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21224689483642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20728635787963867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([5161, 256])
first layer input nodes number: 8819
first layer output nodes number: 5161
edges number: 25013
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21231460571289062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21723651885986328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21931982040405273  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21931982040405273  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([530, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.23472118377685547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.23472118377685547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 530, 256]), torch.Size([1, 530, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2357320785522461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2449803352355957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 530, 256])
m.shape torch.Size([468, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2453746795654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2453746795654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.24626731872558594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2596569061279297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([392, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26053667068481445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26053667068481445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26128435134887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.27773332595825195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([272, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2787189483642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2787189483642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2792377471923828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2947101593017578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([269, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2957439422607422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2957439422607422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.29625701904296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3154172897338867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([185, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31622791290283203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31622791290283203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31658077239990234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3317537307739258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33257341384887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33257341384887695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3328557014465332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3469700813293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3477439880371094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3477439880371094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34797096252441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36090850830078125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36154794692993164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36154794692993164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36171388626098633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37233400344848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37288570404052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37288570404052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37301158905029297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38194942474365234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3824577331542969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3824577331542969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38256072998046875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.390594482421875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39130449295043945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39130449295043945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3914303779602051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4021306037902832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40250539779663086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40250539779663086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4025721549987793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40871381759643555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40920543670654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40920543670654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40927982330322266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4166440963745117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4170970916748047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4170970916748047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4171619415283203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42403602600097656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42437267303466797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42437267303466797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42441844940185547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42959117889404297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4299278259277344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4299278259277344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42996978759765625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43500518798828125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4351921081542969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4351921081542969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4352149963378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4381217956542969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43823862075805664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43823862075805664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43825197219848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44004106521606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44013071060180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44013071060180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4401402473449707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4414849281311035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4417428970336914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4417428970336914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44176769256591797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4454374313354492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44555234909057617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44555234909057617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44556379318237305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44733762741088867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4474649429321289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4474649429321289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4474763870239258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44933032989501953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4495091438293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4495091438293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4495244026184082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4521031379699707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([36, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4529609680175781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4529609680175781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4530296325683594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4651145935058594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45409631729125977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4545292854309082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45496225357055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45450735092163086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2903, 40])
input nodes number: 5161
output nodes number: 2903
edges number: 15355
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45456457138061523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45456504821777344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011146068572998047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 13 input nodes size: 9935
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010213851928710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010213851928710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014951229095458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014973163604736328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010746002197265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011057853698730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011057853698730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011057853698730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([9935, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011057853698730469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([691, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.024618148803710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.024618148803710938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.025277137756347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.030549049377441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([759, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03094339370727539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03094339370727539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 759, 128]), torch.Size([1, 759, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.031667232513427734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04252481460571289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 759, 128])
m.shape torch.Size([633, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04306840896606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04306840896606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04367208480834961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05780744552612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([565, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05858325958251953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05858325958251953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05912208557128906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0754404067993164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([417, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07616519927978516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07616519927978516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07656288146972656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09087944030761719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 417, 128])
m.shape torch.Size([356, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09169912338256836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09169912338256836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 356, 128]), torch.Size([1, 356, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09203863143920898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10663747787475586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 356, 128])
m.shape torch.Size([297, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10745906829833984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10745906829833984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1077423095703125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12190437316894531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([232, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12264776229858398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12264776229858398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 232, 128]), torch.Size([1, 232, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12286901473999023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13548040390014648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 232, 128])
m.shape torch.Size([197, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1362152099609375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1362152099609375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13640308380126953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14842700958251953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([964, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15292978286743164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15292978286743164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 964, 128]), torch.Size([1, 964, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15384912490844727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.22002077102661133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 964, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20905637741088867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21393060684204102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21880483627319336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21389245986938477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([5111, 256])
first layer input nodes number: 9935
first layer output nodes number: 5111
edges number: 25937
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.21888113021850586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2237553596496582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2249741554260254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2249741554260254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([500, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.24076271057128906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.24076271057128906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2417163848876953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2500028610229492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([481, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.25045108795166016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.25045108795166016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.25136852264404297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26575708389282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([368, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2664299011230469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2664299011230469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2671318054199219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.28350257873535156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([322, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2843899726867676  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2843899726867676  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2850041389465332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3032193183898926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([230, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3040652275085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3040652275085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3045039176940918  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3202967643737793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([182, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.321230411529541  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.321230411529541  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3215775489807129  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3365044593811035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.337557315826416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.337557315826416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3378415107727051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3520512580871582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35277843475341797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35277843475341797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3529939651489258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3652791976928711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36601924896240234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36601924896240234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36620616912841797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37816905975341797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37872934341430664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37872934341430664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3788590431213379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38806772232055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38875389099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38875389099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3888893127441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39945220947265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39983463287353516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39983463287353516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39990901947021484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4062318801879883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40673208236694336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40673208236694336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4068140983581543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41435956954956055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4148435592651367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4148435592651367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4149179458618164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42228221893310547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42272090911865234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42272090911865234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42278385162353516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4294557571411133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42987060546875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42987060546875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42992591857910156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4361763000488281  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([9, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4362959861755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4362959861755371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4363131523132324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4383730888366699  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4387626647949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4387626647949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43880653381347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4443778991699219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44455718994140625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44455718994140625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4445781707763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4473896026611328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4475717544555664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4475717544555664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44759082794189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45028018951416016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4504728317260742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4504728317260742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45049190521240234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45331478118896484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.453432559967041  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.453432559967041  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4534440040588379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4552178382873535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4553670883178711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4553670883178711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4553804397583008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45754337310791016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4576754570007324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4576754570007324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4576869010925293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45962095260620117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([50, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4608168601989746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4608168601989746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46091222763061523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47769689559936523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46527719497680664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46570920944213867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4661412239074707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46568727493286133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2897, 40])
input nodes number: 5111
output nodes number: 2897
edges number: 15791
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4657464027404785  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4657468795776367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011708736419677734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 14 input nodes size: 16035
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010745048522949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.010745048522949219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.018391132354736328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.018413066864013672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013653755187988281  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014154434204101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014154434204101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014154434204101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([16035, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014154434204101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([656, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.036615848541259766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.036615848541259766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.037241458892822266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0428929328918457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([684, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04323244094848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04323244094848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0438847541809082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.054599761962890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([611, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.055147647857666016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.055147647857666016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.055730342864990234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0686650276184082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([576, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0694723129272461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0694723129272461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0700216293334961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0859518051147461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([562, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08701705932617188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08701705932617188  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08755302429199219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10770130157470703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([489, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10883235931396484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10883235931396484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1092987060546875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12935161590576172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([407, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1304769515991211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1304769515991211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.13086509704589844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15027236938476562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([358, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1514439582824707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1514439582824707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15178537368774414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.17124605178833008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([316, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.17243146896362305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.17243146896362305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.17273283004760742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19201993942260742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([2471, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20365190505981445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20365190505981445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2471, 128]), torch.Size([1, 2471, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2060084342956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37998390197753906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2471, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36052703857421875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36750221252441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3743019104003906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36727333068847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([7130, 256])
first layer input nodes number: 16035
first layer output nodes number: 7130
edges number: 45172
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37424802780151367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.381223201751709  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3827476501464844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3827476501464844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([461, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40496826171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40496826171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40584754943847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41353797912597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4138193130493164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4138193130493164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4145345687866211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42553281784057617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([301, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4260435104370117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4260435104370117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4266176223754883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43935298919677734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43994665145874023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43994665145874023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4403834342956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4530501365661621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([222, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45389890670776367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45389890670776367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45432233810424805  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46956586837768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47028303146362305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47028303146362305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47059011459350586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4837946891784668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([145, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.484616756439209  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.484616756439209  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4848933219909668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4987215995788574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49947547912597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49947547912597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4996967315673828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5123081207275391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5130801200866699  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5130801200866699  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5132746696472168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5257258415222168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([104, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266437530517578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266437530517578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5268421173095703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5409259796142578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([87, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5417466163635254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5417466163635254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5419125556945801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5548558235168457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5555343627929688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5555343627929688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5556602478027344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5663604736328125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5668973922729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5668973922729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5669889450073242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5754117965698242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5759449005126953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5759449005126953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5760269165039062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5841464996337891  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5846681594848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5846681594848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.584742546081543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5926275253295898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5932211875915527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5932211875915527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.593299388885498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6021361351013184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6025710105895996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6025710105895996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6026263236999512  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6092638969421387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6096172332763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6096172332763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6096591949462891  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6149883270263672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6155886650085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6155886650085449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6156535148620605  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6243433952331543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6249456405639648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6249456405639648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6250085830688477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6338834762573242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6342358589172363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6342358589172363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6342720985412598  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6396355628967285  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6399984359741211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6399984359741211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6400327682495117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6453542709350586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6456689834594727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6456689834594727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6456975936889648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6503324508666992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6505722999572754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6505722999572754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6505932807922363  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6541390419006348  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([204, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6590304374694824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6590304374694824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6594195365905762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7279009819030762  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 204, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7089376449584961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.709373950958252  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7098102569580078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7093520164489746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2925, 40])
input nodes number: 7130
output nodes number: 2925
edges number: 21922
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7094316482543945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7094321250915527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.015136241912841797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 15 input nodes size: 10948
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01365804672241211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01365804672241211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.018878459930419922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.018899917602539062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01123189926147461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01160287857055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01160287857055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01160287857055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([10948, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01160287857055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([624, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02731037139892578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02731037139892578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02790546417236328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03290271759033203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([654, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03322887420654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03322887420654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033852577209472656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04320812225341797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([626, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.043791770935058594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.043791770935058594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.044388771057128906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05838298797607422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([553, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.059139251708984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.059139251708984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05966663360595703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07586479187011719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([446, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07666444778442383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07666444778442383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07708978652954102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09240198135375977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([378, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09327077865600586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09327077865600586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09363126754760742  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10913228988647461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([331, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.11005687713623047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.11005687713623047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.11037254333496094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12615585327148438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([264, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12700510025024414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12700510025024414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1272568702697754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14160776138305664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([243, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14252471923828125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14252471923828125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14275646209716797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.15758800506591797  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([1424, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1642622947692871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1642622947692871  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 1424, 128]), torch.Size([1, 1424, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1656203269958496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26507043838500977  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 1424, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.25196313858032227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2572493553161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26253557205200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.25720787048339844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([5543, 256])
first layer input nodes number: 10948
first layer output nodes number: 5543
edges number: 31376
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2626194953918457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.26790571212768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2692275047302246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2692275047302246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([421, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2872953414916992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2872953414916992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2880983352661133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.29505062103271484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([414, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.29544496536254883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.29544496536254883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2962346076965332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3086276054382324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([349, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.30927038192749023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.30927038192749023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3099360466003418  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32458066940307617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([275, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32543325424194336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32543325424194336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3259577751159668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34215450286865234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3429450988769531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3429450988769531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34336280822753906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3584003448486328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3592066764831543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3592066764831543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3595423698425293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3739771842956543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([168, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3749399185180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3749399185180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3752603530883789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3912820816040039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39208316802978516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39208316802978516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3923215866088867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4059114456176758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([122, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4068479537963867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4068479537963867  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40708065032958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42197322845458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4227027893066406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4227027893066406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4228706359863281  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4347877502441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4354548454284668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4354548454284668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4355902671813965  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4461531639099121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44684696197509766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44684696197509766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4469728469848633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4576730728149414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45843505859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45843505859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4585609436035156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4701423645019531  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47061777114868164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47061777114868164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47069406509399414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47824716567993164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47885799407958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47885799407958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4789438247680664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48804187774658203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4884910583496094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4884910583496094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4885520935058594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4954490661621094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49579477310180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49579477310180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49583864212036133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5011029243469238  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.501427173614502  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.501427173614502  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5014653205871582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.506309986114502  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5066928863525391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5066928863525391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5067348480224609  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5123577117919922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5126638412475586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5126638412475586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5126962661743164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.517268180847168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5174541473388672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5174541473388672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5174732208251953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5202960968017578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5205192565917969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5205192565917969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5205402374267578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5237922668457031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.523958683013916  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.523958683013916  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5239739418029785  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5264458656311035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5265998840332031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5265998840332031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266132354736328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.52886962890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([82, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5308337211608887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5308337211608887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5309901237487793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5585169792175293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 82, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5437097549438477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5441389083862305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5445680618286133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5441174507141113  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2877, 40])
input nodes number: 5543
output nodes number: 2877
edges number: 18242
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5441732406616211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5441737174987793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.012342453002929688  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 16 input nodes size: 16182
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011224746704101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.011224746704101562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01894092559814453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.018962860107421875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013720989227294922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014122486114501953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014122486114501953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014122486114501953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([16182, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014122486114501953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([704, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.032552242279052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.032552242279052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 704, 128]), torch.Size([1, 704, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033223628997802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.038594722747802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 704, 128])
m.shape torch.Size([803, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03902482986450195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03902482986450195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03979063034057617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05174589157104492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([681, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0523371696472168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0523371696472168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05298662185668945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06727457046508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([568, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06814193725585938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06814193725585938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06868362426757812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08483695983886719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([490, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08573436737060547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08573436737060547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08620166778564453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10302448272705078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([413, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1039724349975586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1039724349975586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10436630249023438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12130260467529297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([365, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12232398986816406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12232398986816406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12267208099365234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1400766372680664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 365, 128])
m.shape torch.Size([310, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14108514785766602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14108514785766602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 310, 128]), torch.Size([1, 310, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14138078689575195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1582322120666504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 310, 128])
m.shape torch.Size([255, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1591787338256836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1591787338256836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1594219207763672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1749858856201172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([1782, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18336153030395508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18336153030395508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 1782, 128]), torch.Size([1, 1782, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18506097793579102  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.30655908584594727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 1782, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.291046142578125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2980647087097168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.304140567779541  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2970743179321289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6371, 256])
first layer input nodes number: 16182
first layer output nodes number: 6371
edges number: 36703
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.30332040786743164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31033897399902344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3110165596008301  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3110165596008301  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([499, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32799530029296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32799530029296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 499, 256]), torch.Size([1, 499, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3289470672607422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33846092224121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 499, 256])
m.shape torch.Size([472, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33889245986938477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33889245986938477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33979272842407227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.354769229888916  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([376, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35556507110595703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35556507110595703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35628223419189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37250518798828125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([256, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37313079833984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37313079833984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.37361907958984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38777923583984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([217, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.388824462890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.388824462890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3892383575439453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40413856506347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40491199493408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40491199493408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40523624420166016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41917896270751953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4199790954589844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4199790954589844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42025184631347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43388938903808594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([131, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43476057052612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.43476057052612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4350104331970215  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4492526054382324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4499931335449219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4499931335449219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4501838684082031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4623908996582031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([94, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4631991386413574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4631991386413574  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4633784294128418  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4761080741882324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4766530990600586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4766530990600586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47676753997802734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48569393157958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.486236572265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.486236572265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48633575439453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4947662353515625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49527931213378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49527931213378906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4953651428222656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5032615661621094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5036091804504395  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5036091804504395  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.503664493560791  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5091404914855957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5095458030700684  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5095458030700684  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5096030235290527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5156683921813965  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5161013603210449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5161013603210449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5161585807800293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5226244926452637  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5230536460876465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5230536460876465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5231070518493652  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5295157432556152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5298352241516113  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5298352241516113  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5298733711242676  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5347180366516113  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5350279808044434  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5350279808044434  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.535062313079834  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5396628379821777  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5398960113525391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5398960113525391  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5399208068847656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5434169769287109  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5436267852783203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5436267852783203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5436477661132812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5467529296875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5468697547912598  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5468697547912598  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5468811988830566  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5486550331115723  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5487160682678223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5487160682678223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5487217903137207  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5496487617492676  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.549830436706543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.549830436706543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5498456954956055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.552424430847168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([87, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5545072555541992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5545072555541992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5546731948852539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5838785171508789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 87, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5702428817749023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5706748962402344  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5711069107055664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.570652961730957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2898, 40])
input nodes number: 6371
output nodes number: 2898
edges number: 17031
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5707254409790039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5707259178161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014951229095458984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 17 input nodes size: 16478
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01372385025024414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01372385025024414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.021581172943115234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.021602630615234375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013864517211914062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014266014099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014266014099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014266014099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([16478, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014266014099121094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([763, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033278465270996094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033278465270996094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03400611877441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03982734680175781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([820, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04024553298950195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04024553298950195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04102754592895508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0534205436706543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([727, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05445051193237305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05445051193237305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 727, 128]), torch.Size([1, 727, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.05514383316040039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07039690017700195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 727, 128])
m.shape torch.Size([610, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0712137222290039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0712137222290039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.07179546356201172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0886983871459961  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([542, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08969974517822266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08969974517822266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09021663665771484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10909652709960938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([390, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1099538803100586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1099538803100586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.11032581329345703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12631893157958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([352, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12730789184570312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12730789184570312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12764358520507812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14442825317382812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([309, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14543914794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14543914794921875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14573383331298828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16253089904785156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 309, 128])
m.shape torch.Size([260, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1634993553161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1634993553161621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16374731063842773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.17961645126342773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([1863, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18837594985961914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18837594985961914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 1863, 128]), torch.Size([1, 1863, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19015264511108398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3162980079650879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 1863, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.30070924758911133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3070378303527832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3133664131164551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3069882392883301  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6636, 256])
first layer input nodes number: 16478
first layer output nodes number: 6636
edges number: 37980
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3134913444519043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32036542892456055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32158422470092773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32158422470092773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([556, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33750391006469727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33750391006469727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.338564395904541  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3472018241882324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([475, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34758472442626953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34758472442626953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.34849071502685547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36274051666259766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([356, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3633389472961426  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3633389472961426  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36401796340942383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3806614875793457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([303, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3814868927001953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3814868927001953  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3820648193359375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3993949890136719  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([215, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40016889572143555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40016889572143555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40057897567749023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.415341854095459  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4160194396972656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4160194396972656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41631126403808594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4288597106933594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42960214614868164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42960214614868164  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4298539161682129  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4424424171447754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44304704666137695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44304704666137695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.44322824478149414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45355653762817383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45424461364746094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45424461364746094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45441627502441406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46540260314941406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.466066837310791  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.466066837310791  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4662156105041504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.476778507232666  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4774446487426758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4774446487426758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47757816314697266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4879922866821289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48840999603271484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48840999603271484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48849010467529297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4952993392944336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4957594871520996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4957594871520996  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4958357810974121  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5028548240661621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5033283233642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5033283233642578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5034008026123047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5105762481689453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5109729766845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5109729766845703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5110301971435547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5170955657958984  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5173745155334473  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5173745155334473  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5174126625061035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5217232704162598  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5220150947570801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5220150947570801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5220513343811035  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.526400089263916  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266590118408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266590118408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5266895294189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5305652618408203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5307145118713379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5307145118713379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5307316780090332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5330319404602051  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5332927703857422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5332927703857422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5333194732666016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5370845794677734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5373339653015137  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5373339653015137  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5373587608337402  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5410284996032715  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5411219596862793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5411219596862793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5411314964294434  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.542609691619873  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.542759895324707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.542759895324707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5427732467651367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5449361801147461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5451374053955078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5451374053955078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5451545715332031  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5480556488037109  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([76, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5498733520507812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5498733520507812  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.550018310546875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.575531005859375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 76, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5632610321044922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.563687801361084  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5641145706176758  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5636663436889648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2861, 40])
input nodes number: 6636
output nodes number: 2861
edges number: 15871
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5637321472167969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5637326240539551  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01508474349975586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 18 input nodes size: 20223
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013859272003173828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013859272003173828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.023580074310302734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.023602008819580078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.015723228454589844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01622295379638672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01622295379638672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01622295379638672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([20223, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.01622295379638672  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([825, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04071760177612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04071760177612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0415043830871582  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04779863357543945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([810, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04817771911621094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04817771911621094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0489501953125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.060584068298339844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([813, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.061360836029052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.061360836029052734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.062136173248291016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0791935920715332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([640, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0801396369934082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0801396369934082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 640, 128]), torch.Size([1, 640, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0807499885559082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0984501838684082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 640, 128])
m.shape torch.Size([632, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09992647171020508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09992647171020508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10052919387817383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12222719192504883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([489, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12337541580200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12337541580200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12384176254272461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14389467239379883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([420, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1450634002685547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1450634002685547  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1454639434814453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16549110412597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([383, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16675186157226562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16675186157226562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16711711883544922  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18793678283691406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 383, 128])
m.shape torch.Size([306, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18906736373901367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18906736373901367  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18935918807983398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.20803594589233398  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 306, 128])
m.shape torch.Size([2623, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2203974723815918  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.2203974723815918  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 2623, 128]), torch.Size([1, 2623, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.22324514389038086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40624141693115234  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 2623, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38515329360961914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.39272642135620117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4002995491027832  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3926668167114258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([7941, 256])
first layer input nodes number: 20223
first layer output nodes number: 7941
edges number: 48526
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4004521369934082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40802526473999023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41064453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41064453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([523, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4289517402648926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4289517402648926  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4299492835998535  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4383244514465332  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([416, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4386253356933594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4386253356933594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4394187927246094  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.452667236328125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([350, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4536271095275879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4536271095275879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45429468154907227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4693751335144043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([248, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46999502182006836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46999502182006836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47046804428100586  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48418569564819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([252, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48516035079956055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.48516035079956055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4856410026550293  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5029444694519043  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5036730766296387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5036730766296387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5039935111999512  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5177721977233887  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5184869766235352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5184869766235352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5187349319458008  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.531132698059082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5319623947143555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5319623947143555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5321989059448242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.545680046081543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5464615821838379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5464615821838379  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5466599464416504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5593552589416504  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.559852123260498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.559852123260498  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5599703788757324  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.568366527557373  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5688571929931641  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5688571929931641  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5689563751220703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5766925811767578  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5772085189819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5772085189819336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5773019790649414  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5852460861206055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5858869552612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5858869552612305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5859918594360352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5956430435180664  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5961289405822754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5961289405822754  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5962052345275879  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6037583351135254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6041531562805176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6041531562805176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.604210376739502  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6102757453918457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6106777191162109  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6106777191162109  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6107311248779297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6167659759521484  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.617213249206543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.617213249206543  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6172685623168945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.623906135559082  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6241903305053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6241903305053711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6242246627807617  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6285848617553711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6289148330688477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6289148330688477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6289510726928711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6338071823120117  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6341352462768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6341352462768555  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6341695785522461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6390104293823242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6391348838806152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6391348838806152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6391482353210449  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6411242485046387  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.641413688659668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.641413688659668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6414403915405273  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6455793380737305  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6458091735839844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6458091735839844  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6458301544189453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6492290496826172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6494956016540527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6494956016540527  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6495184898376465  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6533865928649902  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([136, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6566433906555176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6566433906555176  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6569027900695801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7025570869445801  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 136, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6875762939453125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6880078315734863  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6884393692016602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.687985897064209  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2895, 40])
input nodes number: 7941
output nodes number: 2895
edges number: 18390
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6880722045898438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.688072681427002  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.017227649688720703  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 19 input nodes size: 14487
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.015727996826171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.015727996826171875  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.02358531951904297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.023607254028320312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013864517211914062  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014303207397460938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014303207397460938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014303207397460938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([14487, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.014303207397460938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([715, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03472089767456055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.03472089767456055  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 715, 128]), torch.Size([1, 715, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.035402774810791016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.040857791900634766  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 715, 128])
m.shape torch.Size([725, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04120826721191406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.04120826721191406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 725, 128]), torch.Size([1, 725, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.041899681091308594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.052369117736816406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 725, 128])
m.shape torch.Size([648, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.052950382232666016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.052950382232666016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.053568363189697266  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06716394424438477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([602, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06800317764282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06800317764282227  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.06857728958129883  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08522653579711914  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([515, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0861673355102539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0861673355102539  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.08665847778320312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10451745986938477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([441, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10553359985351562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10553359985351562  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.10595417022705078  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1240386962890625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([373, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12507343292236328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12507343292236328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1254291534423828  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14321517944335938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([344, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1443495750427246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1443495750427246  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 344, 128]), torch.Size([1, 344, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.14467763900756836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1633772850036621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 344, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16434621810913086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.16434621810913086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1645979881286621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1807112693786621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([1953, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18989801406860352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.18989801406860352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 1953, 128]), torch.Size([1, 1953, 128])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.19176054000854492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.32852983474731445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 1953, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31107330322265625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31746673583984375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3237419128417969  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.31729936599731445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([6580, 256])
first layer input nodes number: 14487
first layer output nodes number: 6580
edges number: 39007
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3237338066101074  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3301272392272949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33228349685668945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.33228349685668945  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([461, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3525376319885254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3525376319885254  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.35341691970825195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36045122146606445  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([389, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3607597351074219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3607597351074219  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.36150169372558594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3726310729980469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([327, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3732032775878906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3732032775878906  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3738269805908203  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38782501220703125  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3887209892272949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.3887209892272949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.38921499252319336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4042043685913086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40495729446411133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40495729446411133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.40535402297973633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.41963624954223633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42038965225219727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42038965225219727  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.42070436477661133  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.434237003326416  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([159, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4351496696472168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4351496696472168  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.435452938079834  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.45061635971069336  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4513721466064453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4513721466064453  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4515972137451172  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46442604064941406  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4652566909790039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4652566909790039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.46546459197998047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47877025604248047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4795413017272949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4795413017272949  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.47971487045288086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4920382499694824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4926600456237793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.4926600456237793  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.49278783798217773  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5027556419372559  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5034646987915039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5034646987915039  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5035924911499023  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5144548416137695  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5150408744812012  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5150408744812012  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5151400566101074  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5242648124694824  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5248479843139648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5248479843139648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.524937629699707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5338125228881836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5342869758605957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5342869758605957  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.534355640411377  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5416340827941895  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5421228408813477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5421228408813477  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5421876907348633  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5495157241821289  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5499410629272461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5499410629272461  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5499944686889648  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5564031600952148  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5569648742675781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5569648742675781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5570297241210938  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5652656555175781  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5656900405883789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5656900405883789  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5657377243041992  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5721273422241211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5725264549255371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5725264549255371  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.572568416595459  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5784850120544434  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5787062644958496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5787062644958496  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5787291526794434  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5821166038513184  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5824437141418457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5824437141418457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5824742317199707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5872044563293457  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5874991416931152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5874991416931152  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5875258445739746  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5918517112731934  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5921845436096191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5921845436096191  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5922131538391113  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.597048282623291  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([133, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6002297401428223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6002297401428223  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6004834175109863  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6451306343078613  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 133, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6281499862670898  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6285805702209473  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6290111541748047  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6285586357116699  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([2888, 40])
input nodes number: 6580
output nodes number: 2888
edges number: 19807
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.6286287307739258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.628629207611084  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.015177726745605469  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

pseudo mini batch 20 input nodes size: 40723
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013863563537597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.013863563537597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033394813537597656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.033415794372558594  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.025536537170410156  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.026769638061523438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.026769638061523438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.026769638061523438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

torch.Size([40723, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.026769638061523438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

m.shape torch.Size([578, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.0930943489074707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.0930943489074707  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.09364557266235352  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.09805536270141602  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([600, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.09835195541381836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.09835195541381836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.09892416000366211  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.10750722885131836  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([552, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.10801076889038086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.10801076889038086  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.10853719711303711  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.12015295028686523  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([553, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.12094449996948242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.12094449996948242  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.12147188186645508  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.1367659568786621  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([521, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.13774442672729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.13774442672729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.13824129104614258  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.15661239624023438  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([495, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.15778017044067383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.15778017044067383  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.15825223922729492  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.17855119705200195  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([510, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.18001747131347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.18001747131347656  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.18050384521484375  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.20482254028320312  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([489, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.20644474029541016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.20644474029541016  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.2069110870361328  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.23349285125732422  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([521, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.23549556732177734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.23549556732177734  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.235992431640625  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.2688288688659668  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([11037, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.32131481170654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.32131481170654297  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

 h.shape torch.Size([1, 11037, 128]), torch.Size([1, 11037, 128])
----------------------------------------3
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.33190250396728516  GigaBytes
Max Memory Allocated: 0.9452362060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0891857147216797  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

rst.shape  torch.Size([1, 11037, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0267276763916016  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.041849136352539  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0569705963134766  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0417308807373047  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

torch.Size([15856, 256])
first layer input nodes number: 40723
first layer output nodes number: 15856
edges number: 133762
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0572762489318848  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0723977088928223  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0768074989318848  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.0768074989318848  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

m.shape torch.Size([360, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1075677871704102  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1075677871704102  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1082544326782227  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1137475967407227  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([274, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1139311790466309  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1139311790466309  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1144537925720215  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1237921714782715  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([229, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1241912841796875  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1241912841796875  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1246280670166016  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.134237289428711  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([162, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1346421241760254  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1346421241760254  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.134951114654541  GigaBytes
Max Memory Allocated: 1.1419200897216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1439118385314941  GigaBytes
Max Memory Allocated: 1.1445298194885254  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([138, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1444206237792969  GigaBytes
Max Memory Allocated: 1.1445298194885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1444206237792969  GigaBytes
Max Memory Allocated: 1.1445298194885254  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.144683837890625  GigaBytes
Max Memory Allocated: 1.144683837890625  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1541595458984375  GigaBytes
Max Memory Allocated: 1.1548175811767578  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([107, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1546454429626465  GigaBytes
Max Memory Allocated: 1.1548175811767578  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1546454429626465  GigaBytes
Max Memory Allocated: 1.1548175811767578  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1548495292663574  GigaBytes
Max Memory Allocated: 1.1548495292663574  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1636252403259277  GigaBytes
Max Memory Allocated: 1.1642374992370605  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([94, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1641559600830078  GigaBytes
Max Memory Allocated: 1.1642374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1641559600830078  GigaBytes
Max Memory Allocated: 1.1642374992370605  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1643352508544922  GigaBytes
Max Memory Allocated: 1.1643352508544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.173299789428711  GigaBytes
Max Memory Allocated: 1.1739273071289062  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([68, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1737332344055176  GigaBytes
Max Memory Allocated: 1.1739273071289062  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1737332344055176  GigaBytes
Max Memory Allocated: 1.1739273071289062  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1738629341125488  GigaBytes
Max Memory Allocated: 1.1739273071289062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.18125581741333  GigaBytes
Max Memory Allocated: 1.181774616241455  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([69, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1817879676818848  GigaBytes
Max Memory Allocated: 1.1817903518676758  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1817879676818848  GigaBytes
Max Memory Allocated: 1.1817903518676758  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1819195747375488  GigaBytes
Max Memory Allocated: 1.1819195747375488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1903424263000488  GigaBytes
Max Memory Allocated: 1.190934658050537  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1909112930297852  GigaBytes
Max Memory Allocated: 1.190934658050537  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1909112930297852  GigaBytes
Max Memory Allocated: 1.190934658050537  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1910371780395508  GigaBytes
Max Memory Allocated: 1.1910371780395508  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.1999750137329102  GigaBytes
Max Memory Allocated: 1.2006044387817383  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2005677223205566  GigaBytes
Max Memory Allocated: 1.2006044387817383  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2005677223205566  GigaBytes
Max Memory Allocated: 1.2006044387817383  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.200685977935791  GigaBytes
Max Memory Allocated: 1.200685977935791  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2099099159240723  GigaBytes
Max Memory Allocated: 1.2105603218078613  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2104277610778809  GigaBytes
Max Memory Allocated: 1.2105603218078613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2104277610778809  GigaBytes
Max Memory Allocated: 1.2105603218078613  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2105231285095215  GigaBytes
Max Memory Allocated: 1.2105603218078613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2186293601989746  GigaBytes
Max Memory Allocated: 1.2192015647888184  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2191314697265625  GigaBytes
Max Memory Allocated: 1.2192015647888184  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2191314697265625  GigaBytes
Max Memory Allocated: 1.2192015647888184  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2192153930664062  GigaBytes
Max Memory Allocated: 1.2192153930664062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2269363403320312  GigaBytes
Max Memory Allocated: 1.2274818420410156  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2274999618530273  GigaBytes
Max Memory Allocated: 1.2275023460388184  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2274999618530273  GigaBytes
Max Memory Allocated: 1.2275023460388184  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.227585792541504  GigaBytes
Max Memory Allocated: 1.227585792541504  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2360830307006836  GigaBytes
Max Memory Allocated: 1.2366838455200195  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.236602783203125  GigaBytes
Max Memory Allocated: 1.2366838455200195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.236602783203125  GigaBytes
Max Memory Allocated: 1.2366838455200195  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2366771697998047  GigaBytes
Max Memory Allocated: 1.2366838455200195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2445621490478516  GigaBytes
Max Memory Allocated: 1.2451200485229492  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2450942993164062  GigaBytes
Max Memory Allocated: 1.2451200485229492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2450942993164062  GigaBytes
Max Memory Allocated: 1.2451200485229492  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2451648712158203  GigaBytes
Max Memory Allocated: 1.2451648712158203  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2531394958496094  GigaBytes
Max Memory Allocated: 1.2537040710449219  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2535619735717773  GigaBytes
Max Memory Allocated: 1.2537040710449219  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2535619735717773  GigaBytes
Max Memory Allocated: 1.2537040710449219  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.253615379333496  GigaBytes
Max Memory Allocated: 1.2537040710449219  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.260024070739746  GigaBytes
Max Memory Allocated: 1.2604780197143555  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2605857849121094  GigaBytes
Max Memory Allocated: 1.2605881690979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2605857849121094  GigaBytes
Max Memory Allocated: 1.2605881690979004  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.260650634765625  GigaBytes
Max Memory Allocated: 1.260650634765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2688865661621094  GigaBytes
Max Memory Allocated: 1.26947021484375  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2694387435913086  GigaBytes
Max Memory Allocated: 1.26947021484375  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2694387435913086  GigaBytes
Max Memory Allocated: 1.26947021484375  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2694997787475586  GigaBytes
Max Memory Allocated: 1.2694997787475586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2776784896850586  GigaBytes
Max Memory Allocated: 1.2782583236694336  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2783207893371582  GigaBytes
Max Memory Allocated: 1.2783236503601074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2783207893371582  GigaBytes
Max Memory Allocated: 1.2783236503601074  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2783875465393066  GigaBytes
Max Memory Allocated: 1.2783875465393066  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2878003120422363  GigaBytes
Max Memory Allocated: 1.2884678840637207  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2883119583129883  GigaBytes
Max Memory Allocated: 1.2884678840637207  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2883119583129883  GigaBytes
Max Memory Allocated: 1.2884678840637207  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2883634567260742  GigaBytes
Max Memory Allocated: 1.2884678840637207  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.295985221862793  GigaBytes
Max Memory Allocated: 1.2965259552001953  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2963190078735352  GigaBytes
Max Memory Allocated: 1.2965259552001953  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.2963190078735352  GigaBytes
Max Memory Allocated: 1.2965259552001953  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.296351432800293  GigaBytes
Max Memory Allocated: 1.2965259552001953  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.301377296447754  GigaBytes
Max Memory Allocated: 1.3017339706420898  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.301781177520752  GigaBytes
Max Memory Allocated: 1.3017830848693848  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.301781177520752  GigaBytes
Max Memory Allocated: 1.3017830848693848  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3018174171447754  GigaBytes
Max Memory Allocated: 1.3018174171447754  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3076882362365723  GigaBytes
Max Memory Allocated: 1.3081049919128418  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3083162307739258  GigaBytes
Max Memory Allocated: 1.308319091796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3083162307739258  GigaBytes
Max Memory Allocated: 1.308319091796875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3083696365356445  GigaBytes
Max Memory Allocated: 1.3083696365356445  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3173952102661133  GigaBytes
Max Memory Allocated: 1.3180360794067383  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([694, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3340444564819336  GigaBytes
Max Memory Allocated: 1.3341093063354492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3340444564819336  GigaBytes
Max Memory Allocated: 1.3341093063354492  GigaBytes

 h.shape torch.Size([1, 694, 256]), torch.Size([1, 694, 256])
----------------------------------------3
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.3353681564331055  GigaBytes
Max Memory Allocated: 1.3353681564331055  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.5696425437927246  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 694, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.5414848327636719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.541895866394043  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.542306900024414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.541874885559082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2758, 40])
input nodes number: 15856
output nodes number: 2758
edges number: 31515
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.541994571685791  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.5419950485229492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.028908729553222656  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 21 input nodes size: 35233
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.025516986846923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.025516986846923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.04309511184692383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.043116092681884766  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.023563861846923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.024398326873779297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.024398326873779297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.024398326873779297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([35233, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.024398326873779297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([733, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0690603256225586  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0690603256225586  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.06975936889648438  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07535171508789062  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([805, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07576990127563477  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07576990127563477  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0765376091003418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08880233764648438  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([691, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08940696716308594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08940696716308594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09006595611572266  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10456371307373047  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([623, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1063089370727539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1063089370727539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.106903076171875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.12413311004638672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([572, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1251997947692871  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1251997947692871  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.12574529647827148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.14601850509643555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([508, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.14719915390014648  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.14719915390014648  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.14768362045288086  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16851568222045898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([457, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1697988510131836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1697988510131836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17023468017578125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19202613830566406  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([458, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19355535507202148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19355535507202148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19399213790893555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2188887596130371  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([364, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2203836441040039  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2203836441040039  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22073078155517578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24294757843017578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([6761, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2750129699707031  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2750129699707031  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 6761, 128]), torch.Size([1, 6761, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2814607620239258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7415084838867188  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 6761, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7022461891174316  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7136635780334473  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7250809669494629  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7135739326477051  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([11972, 256])
first layer input nodes number: 35233
first layer output nodes number: 11972
edges number: 90565
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7253456115722656  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7367630004882812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7396173477172852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7396173477172852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([465, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7606468200683594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7606468200683594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7615337371826172  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7688627243041992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([407, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7692017555236816  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7692017555236816  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7699780464172363  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7818264961242676  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7823123931884766  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7823123931884766  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7828903198242188  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7973155975341797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7978878021240234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7978878021240234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7983150482177734  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8107051849365234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8114290237426758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8114290237426758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8118009567260742  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.825190544128418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8258066177368164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8258066177368164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8260717391967773  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8374719619750977  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([109, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8380727767944336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8380727767944336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8382806777954102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8486757278442383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8492717742919922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8492717742919922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8494453430175781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8593387603759766  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8598752021789551  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8598752021789551  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8600125312805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8688015937805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8694734573364258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8694734573364258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8696203231811523  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8800477981567383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8807148933410645  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8807148933410645  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8808484077453613  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8912625312805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.891761302947998  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.891761302947998  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8918547630310059  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8997988700866699  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.900177001953125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.900177001953125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9002418518066406  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9062080383300781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9066600799560547  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9066600799560547  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9067287445068359  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9135265350341797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9140834808349609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9140834808349609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9141616821289062  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9224510192871094  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9227657318115234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9227657318115234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9228096008300781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9277667999267578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9282188415527344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9282188415527344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9282741546630859  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9349117279052734  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9353342056274414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9353342056274414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9353837966918945  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9416818618774414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9420042037963867  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9420042037963867  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9420404434204102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9468965530395508  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9470901489257812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9470901489257812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9471111297607422  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9500694274902344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.950261116027832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.950261116027832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9502801895141602  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9531030654907227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9533262252807617  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9533262252807617  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9533472061157227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.956599235534668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9567217826843262  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9567217826843262  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.956733226776123  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9585871696472168  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9589047431945801  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9589047431945801  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9589314460754395  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9634442329406738  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([309, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9710884094238281  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9710884094238281  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9716777801513672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0795707702636719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 309, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0615472793579102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.061960220336914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.062373161315918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0619392395019531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2770, 40])
input nodes number: 11972
output nodes number: 2770
edges number: 21282
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.062051773071289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0620522499084473  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.025957107543945312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 22 input nodes size: 27980
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02356576919555664  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02356576919555664  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.03690767288208008  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.036928653717041016  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.019329547882080078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.019928455352783203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.019928455352783203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.019928455352783203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([27980, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.019928455352783203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([835, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.05241060256958008  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.05241060256958008  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 835, 128]), torch.Size([1, 835, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0532069206237793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.05957746505737305  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 835, 128])
m.shape torch.Size([883, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.060021400451660156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.060021400451660156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.060863494873046875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07349491119384766  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([788, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07448530197143555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07448530197143555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07523679733276367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09176969528198242  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([651, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09285497665405273  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09285497665405273  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0934758186340332  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11232137680053711  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([565, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1133580207824707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1133580207824707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11389684677124023  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1337442398071289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([487, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13486814498901367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13486814498901367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13533258438110352  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1553034782409668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([403, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1564164161682129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1564164161682129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 403, 128]), torch.Size([1, 403, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1568007469177246  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17601728439331055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 403, 128])
m.shape torch.Size([418, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17741966247558594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17741966247558594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17781829833984375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.20054054260253906  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([348, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.20183467864990234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.20183467864990234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.20216655731201172  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22340679168701172  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([4089, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24277210235595703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24277210235595703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 4089, 128]), torch.Size([1, 4089, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2466716766357422  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5239086151123047  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 4089, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.49500608444213867  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5040345191955566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5130629539489746  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5039639472961426  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([9467, 256])
first layer input nodes number: 27980
first layer output nodes number: 9467
edges number: 63503
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5132737159729004  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5223021507263184  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5254378318786621  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5254378318786621  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([565, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.542205810546875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.542205810546875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5432834625244141  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5519046783447266  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([466, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5522618293762207  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5522618293762207  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5531506538391113  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5672383308410645  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([336, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5677628517150879  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5677628517150879  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5684037208557129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5832595825195312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([256, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.58392333984375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.58392333984375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.58441162109375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.59857177734375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5996079444885254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5996079444885254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.600008487701416  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6144280433654785  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6150298118591309  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6150298118591309  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6152949333190918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6266951560974121  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([108, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6272892951965332  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6272892951965332  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.627495288848877  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6377949714660645  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6385302543640137  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6385302543640137  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6387381553649902  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6505885124206543  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6511077880859375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6511077880859375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6512451171875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6600341796875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6606097221374512  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6606097221374512  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6607375144958496  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6698107719421387  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([45, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6702227592468262  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6702227592468262  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6703085899353027  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6770033836364746  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6774449348449707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6774449348449707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6775250434875488  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6843342781066895  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6846942901611328  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6846942901611328  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6847553253173828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6903705596923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6908516883850098  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6908516883850098  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6909241676330566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6980996131896973  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([24, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6984095573425293  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6984095573425293  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6984553337097168  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7033076286315918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7035617828369141  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7035617828369141  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7035961151123047  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7074756622314453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7077364921569824  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7077364921569824  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7077689170837402  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7116599082946777  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7119555473327637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7119555473327637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7119898796081543  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7163500785827637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7166070938110352  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7166070938110352  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7166357040405273  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7204694747924805  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7207822799682617  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7207822799682617  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7208147048950195  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7253866195678711  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7256731986999512  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7256731986999512  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7257018089294434  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7299361228942871  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7301335334777832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7301335334777832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7301526069641113  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7331089973449707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7333207130432129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7333207130432129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.733339786529541  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7364296913146973  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7366046905517578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7366046905517578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7366199493408203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7391986846923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([144, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7426514625549316  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7426514625549316  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7429261207580566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7912659645080566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 144, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.777733325958252  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7781481742858887  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7785630226135254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7781271934509277  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2781, 40])
input nodes number: 9467
output nodes number: 2781
edges number: 16749
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7782206535339355  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7782211303710938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021106243133544922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 23 input nodes size: 31624
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.01933145523071289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.01933145523071289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.034410953521728516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.03443193435668945  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021069049835205078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021929264068603516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021929264068603516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021929264068603516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([31624, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021929264068603516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([676, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0674285888671875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0674285888671875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.06807327270507812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07323074340820312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([742, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07361602783203125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07361602783203125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 742, 128]), torch.Size([1, 742, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07432365417480469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08539819717407227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 742, 128])
m.shape torch.Size([581, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0858755111694336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0858755111694336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08642959594726562  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09872055053710938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([593, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09957456588745117  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09957456588745117  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10014009475708008  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11654043197631836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([564, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11760234832763672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11760234832763672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11814022064208984  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1380910873413086  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([531, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1393413543701172  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1393413543701172  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1398477554321289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16207599639892578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([488, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1634516716003418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1634516716003418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16391706466674805  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18718671798706055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([479, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1887812614440918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1887812614440918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1892380714416504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.21527624130249023  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([442, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.21694469451904297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.21694469451904297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.21736621856689453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24434375762939453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([6884, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2769584655761719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2769584655761719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 6884, 128]), torch.Size([1, 6884, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2835235595703125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7498588562011719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 6884, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7080245018005371  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.719449520111084  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7308745384216309  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7193598747253418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([11980, 256])
first layer input nodes number: 31624
first layer output nodes number: 11980
edges number: 92347
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7311124801635742  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7425374984741211  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7456560134887695  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7456560134887695  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([441, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7683024406433105  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7683024406433105  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7691435813903809  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7777915000915527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([390, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7781209945678711  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7781209945678711  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.778864860534668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7903814315795898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([238, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7906961441040039  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7906961441040039  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7911500930786133  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8011369705200195  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([197, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8016676902770996  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8016676902770996  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8020434379577637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8129401206970215  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8136415481567383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8136415481567383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8139944076538086  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8266973495483398  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8274726867675781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8274726867675781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8277873992919922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8413200378417969  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8420510292053223  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8420510292053223  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8423027992248535  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.854891300201416  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8555960655212402  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8555960655212402  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.855802059173584  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8675436973571777  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8681674003601074  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8681674003601074  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8683276176452637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8785815238952637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8792800903320312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8792800903320312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8794345855712891  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8904037475585938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8911089897155762  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8911089897155762  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8912501335144043  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.902259349822998  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9028811454772949  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9028811454772949  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9029955863952637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9127230644226074  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9131908416748047  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9131908416748047  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9132709503173828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9206409454345703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9210453033447266  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9210453033447266  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9211082458496094  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9273395538330078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9277839660644531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9277839660644531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9278469085693359  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9345188140869141  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9349641799926758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9349641799926758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.935023307800293  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9417047500610352  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9421982765197754  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9421982765197754  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9422593116760254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9495835304260254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9500894546508789  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9500894546508789  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9501485824584961  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9576578140258789  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9581947326660156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9581947326660156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9582538604736328  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9661769866943359  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.966609001159668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.966609001159668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9666547775268555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.973109245300293  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9734702110290527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9734702110290527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9735064506530762  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9788699150085449  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9792747497558594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9792747497558594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9793128967285156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9852256774902344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9854722023010254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9854722023010254  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9854950904846191  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9892029762268066  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9896531105041504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9896531105041504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9896912574768066  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9961380958557129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([308, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0035200119018555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0035200119018555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0041074752807617  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1189050674438477  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 308, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0992746353149414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0996909141540527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.100107192993164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0996699333190918  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2791, 40])
input nodes number: 11980
output nodes number: 2791
edges number: 22991
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0997819900512695  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0997824668884277  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.023499011993408203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 24 input nodes size: 45204
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021070480346679688  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021070480346679688  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.04262542724609375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.04264640808105469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.027545928955078125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02862834930419922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02862834930419922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02862834930419922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([45204, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02862834930419922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([717, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08846807479858398  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08846807479858398  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08915185928344727  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09513711929321289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([762, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09552192687988281  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09552192687988281  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 762, 128]), torch.Size([1, 762, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09624862670898438  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10794258117675781  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 762, 128])
m.shape torch.Size([741, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10863924026489258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10863924026489258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 741, 128]), torch.Size([1, 741, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10934591293334961  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1257038116455078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 741, 128])
m.shape torch.Size([664, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1266169548034668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1266169548034668  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.12725019454956055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.14585447311401367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([627, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1470327377319336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1470327377319336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1476306915283203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16925477981567383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([564, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17056941986083984  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17056941986083984  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.17110729217529297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19494152069091797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([552, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19651508331298828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19651508331298828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.19704151153564453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22416019439697266  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([499, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2258005142211914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2258005142211914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22627639770507812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2534017562866211  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([453, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2551078796386719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2551078796386719  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 453, 128]), torch.Size([1, 453, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2555398941040039  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2831888198852539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 453, 128])
m.shape torch.Size([9610, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3287968635559082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3287968635559082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 9610, 128]), torch.Size([1, 9610, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.33796167373657227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9886631965637207  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 9610, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.933016300201416  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9475016593933105  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9619870185852051  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9473881721496582  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([15189, 256])
first layer input nodes number: 45204
first layer output nodes number: 15189
edges number: 121672
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9623260498046875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.976811408996582  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9805426597595215  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9805426597595215  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([436, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0036630630493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0036630630493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0044946670532227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0118122100830078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([386, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.012138843536377  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.012138843536377  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0128750801086426  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.024376392364502  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([280, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0248160362243652  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0248160362243652  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0253500938415527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0383009910583496  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([208, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0388336181640625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0388336181640625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0392303466796875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0507354736328125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([151, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0512628555297852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0512628555297852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0515508651733398  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0619192123413086  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.062577247619629  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.062577247619629  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0628423690795898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0742425918579102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.074951171875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.074951171875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0751895904541016  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0871105194091797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.087721824645996  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.087721824645996  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0879030227661133  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.098231315612793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.098867416381836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.098867416381836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0990276336669922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1092815399169922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1098265647888184  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1098265647888184  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1099505424499512  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1187529563903809  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1193785667419434  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1193785667419434  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1195025444030762  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1291728019714355  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1297106742858887  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1297106742858887  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.129809856414795  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1382403373718262  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1387405395507812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1387405395507812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.138824462890625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.14654541015625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1470017433166504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1470017433166504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1470723152160645  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1540589332580566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1544709205627441  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1544709205627441  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1545300483703613  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1607975959777832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.161168098449707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.161168098449707  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1612176895141602  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1668214797973633  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1672053337097168  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1672053337097168  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.167253017425537  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1729750633239746  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1734356880187988  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1734356880187988  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1734890937805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1802716255187988  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1807928085327148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1807928085327148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1808500289916992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1885175704956055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.189065933227539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.189065933227539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1891231536865234  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1971912384033203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1975059509277344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1975059509277344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1975383758544922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2023372650146484  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2026596069335938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2026596069335938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2026901245117188  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2074203491210938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.207913875579834  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.207913875579834  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2079577445983887  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.215064525604248  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2154812812805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2154812812805176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.215517520904541  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.221642017364502  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([355, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.230642318725586  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.230642318725586  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2313194274902344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.360520362854004  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 355, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3403472900390625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3407597541809082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.341172218322754  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3407387733459473  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2767, 40])
input nodes number: 15189
output nodes number: 2767
edges number: 23488
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.340869426727295  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3408699035644531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.030591487884521484  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 25 input nodes size: 42855
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0275421142578125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0275421142578125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.04797697067260742  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.04799795150756836  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02642202377319336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02731943130493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02731943130493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02731943130493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([42855, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02731943130493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([718, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0763697624206543  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0763697624206543  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 718, 128]), torch.Size([1, 718, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07705450057983398  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08253240585327148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 718, 128])
m.shape torch.Size([851, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08300161361694336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08300161361694336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08381319046020508  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09598684310913086  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([824, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09675979614257812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09675979614257812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09754562377929688  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11520767211914062  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([674, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11610031127929688  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11610031127929688  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.11674308776855469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13548660278320312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([621, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13664579391479492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13664579391479492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1372380256652832  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.15855836868286133  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([579, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.15991878509521484  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.15991878509521484  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16047096252441406  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18517541885375977  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([562, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18677520751953125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18677520751953125  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18731117248535156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2143869400024414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([502, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.216033935546875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.216033935546875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.21651268005371094  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24380111694335938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([456, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24551868438720703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24551868438720703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24595355987548828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2737855911254883  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([7333, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3085346221923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3085346221923828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 7333, 128]), torch.Size([1, 7333, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.31552791595458984  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8135652542114258  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 7333, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7680988311767578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7806110382080078  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7931232452392578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7805132865905762  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([13120, 256])
first layer input nodes number: 42855
first layer output nodes number: 13120
edges number: 99551
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7934446334838867  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8059568405151367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8090848922729492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8090848922729492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([438, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8295722007751465  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8295722007751465  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8304076194763184  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8378720283508301  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([412, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8382463455200195  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8382463455200195  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8390321731567383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8536777496337891  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8541440963745117  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8541440963745117  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8547124862670898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8738055229187012  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8744134902954102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8744134902954102  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8748559951782227  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8876886367797852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8883471488952637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8883471488952637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8886961936950684  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9012618064880371  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9019985198974609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9019985198974609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9022998809814453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9152584075927734  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9160366058349609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9160366058349609  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9162998199462891  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9294605255126953  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9301981925964355  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9301981925964355  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9304137229919434  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9426989555358887  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9432315826416016  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9432315826416016  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9433727264404297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9524059295654297  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([57, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.952883243560791  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.952883243560791  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9529919624328613  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9607110023498535  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9612278938293457  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9612278938293457  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9613308906555176  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9693646430969238  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9700632095336914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9700632095336914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9701871871948242  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9807252883911133  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9811758995056152  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9811758995056152  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9812541007995605  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9884486198425293  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9887866973876953  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9887866973876953  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9888401031494141  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9941272735595703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9946198463439941  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9946198463439941  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9946885108947754  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.001966953277588  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.002394199371338  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.002394199371338  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0024514198303223  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0089173316955566  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.009199619293213  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.009199619293213  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0092358589172363  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0135846138000488  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0141029357910156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0141029357910156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0141620635986328  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0216712951660156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.022153377532959  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.022153377532959  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0222067832946777  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0293631553649902  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.029740333557129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.029740333557129  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.029780387878418  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0354280471801758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.035771369934082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.035771369934082  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0358057022094727  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0408868789672852  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0411872863769531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0411872863769531  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0412158966064453  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0456504821777344  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0459461212158203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0459461212158203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0459728240966797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0502986907958984  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0505623817443848  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0505623817443848  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0505852699279785  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0544533729553223  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([249, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0604252815246582  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0604252815246582  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0609002113342285  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1444878578186035  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 249, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1271882057189941  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1276001930236816  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1280121803283691  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1275792121887207  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([2764, 40])
input nodes number: 13120
output nodes number: 2764
edges number: 20748
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.127697467803955  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1276979446411133  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.029016494750976562  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

pseudo mini batch 26 input nodes size: 51251
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.026421546936035156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.026421546936035156  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.050859928131103516  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.05088090896606445  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.030425071716308594  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.031864166259765625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.031864166259765625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.031864166259765625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([51251, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.031864166259765625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([595, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11219644546508789  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11219644546508789  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11276388168334961  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11793899536132812  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([674, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11829805374145508  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11829805374145508  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.11894083023071289  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.12858247756958008  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([613, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.12913799285888672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.12913799285888672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.12972259521484375  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.1431293487548828  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([586, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.14395475387573242  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.14395475387573242  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.14451360702514648  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.1607203483581543  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([635, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.1619548797607422  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.1619548797607422  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.16256046295166016  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.18436145782470703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([593, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.18575525283813477  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.18575525283813477  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.18632078170776367  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.21175765991210938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([593, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.2134542465209961  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.2134542465209961  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.214019775390625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.24288225173950195  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([593, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.24486160278320312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.24486160278320312  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.24542713165283203  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.2779655456542969  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([612, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.28030920028686523  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.28030920028686523  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.28089284896850586  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.3190760612487793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([13481, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.383237361907959  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.383237361907959  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 13481, 128]), torch.Size([1, 13481, 128])
----------------------------------------3
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.39609384536743164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3108763694763184  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 13481, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2347636222839355  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2528595924377441  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2709555625915527  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2527179718017578  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

torch.Size([18975, 256])
first layer input nodes number: 51251
first layer output nodes number: 18975
edges number: 162072
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2713394165039062  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2894353866577148  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.293959617614746  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.293959617614746  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

m.shape torch.Size([327, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.324143409729004  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.324143409729004  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3247671127319336  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3300666809082031  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([287, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3303065299987793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3303065299987793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3308539390563965  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.342085361480713  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([209, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.342414379119873  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.342414379119873  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3428130149841309  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3515830039978027  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([153, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3519721031188965  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3519721031188965  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3522639274597168  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3607268333435059  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([164, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3613691329956055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3613691329956055  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3616819381713867  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3729429244995117  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([112, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3734326362609863  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3734326362609863  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3736462593078613  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3828320503234863  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3833646774291992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3833646774291992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3835458755493164  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3926057815551758  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([80, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3931303024291992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3931303024291992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3932828903198242  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4019804000854492  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.402587890625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.402587890625  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4027385711669922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4123821258544922  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([58, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4128646850585938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4128646850585938  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4129753112792969  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4208297729492188  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4215784072875977  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4215784072875977  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4217233657836914  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.433030128479004  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4336614608764648  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4336614608764648  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4337778091430664  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4436674118041992  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4444341659545898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4444341659545898  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4445600509643555  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.456141471862793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4567513465881348  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4567513465881348  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4568467140197754  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4662880897521973  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.46696138381958  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.46696138381958  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4670567512512207  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.477165699005127  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4779486656188965  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4779486656188965  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4780516624450684  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4896903038024902  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4902434349060059  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4902434349060059  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.49031400680542  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4987826347351074  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.499612808227539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.499612808227539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4997081756591797  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.511819839477539  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5123748779296875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5123748779296875  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5124378204345703  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5208721160888672  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5215134620666504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5215134620666504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5215802192687988  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5309929847717285  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5317673683166504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5317673683166504  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.531843662261963  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.543135166168213  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5437736511230469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5437736511230469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5438346862792969  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5532951354980469  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5537734031677246  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5537734031677246  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5538172721862793  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5609240531921387  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5614328384399414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5614328384399414  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.561476707458496  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5688905715942383  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([580, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5828051567077637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5828051567077637  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.583911418914795  GigaBytes
Max Memory Allocated: 1.5865263938903809  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.778613567352295  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 580, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7511200904846191  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7515335083007812  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7519469261169434  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7515125274658203  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([2774, 40])
input nodes number: 18975
output nodes number: 2774
edges number: 30949
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7516765594482422  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7516770362854004  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.034374237060546875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

pseudo mini batch 27 input nodes size: 48279
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030426502227783203  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030426502227783203  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.0538640022277832  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.05388498306274414  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.029425621032714844  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030744552612304688  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030744552612304688  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030744552612304688  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([48279, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.030744552612304688  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

m.shape torch.Size([619, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10322952270507812  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10322952270507812  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1038198471069336  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10854244232177734  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([693, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10890817642211914  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10890817642211914  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10956907272338867  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11967182159423828  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([647, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12026691436767578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12026691436767578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 647, 128]), torch.Size([1, 647, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12088394165039062  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1344585418701172  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 647, 128])
m.shape torch.Size([566, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13522958755493164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13522958755493164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13576936721801758  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.15177011489868164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([580, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.15288305282592773  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.15288305282592773  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.15343618392944336  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.17409086227416992  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([566, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.17543363571166992  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.17543363571166992  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.17597341537475586  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1995558738708496  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([545, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.20110511779785156  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.20110511779785156  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.20162487030029297  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2282118797302246  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([516, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2299203872680664  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2299203872680664  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.23041248321533203  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.26016902923583984  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([520, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.26215457916259766  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.26215457916259766  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2626504898071289  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2948732376098633  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([12257, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.3530712127685547  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.3530712127685547  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 12257, 128]), torch.Size([1, 12257, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.36492300033569336  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1952099800109863  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 12257, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1267890930175781  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1434869766235352  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1601848602294922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1433563232421875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([17509, 256])
first layer input nodes number: 48279
first layer output nodes number: 17509
edges number: 147699
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1605467796325684  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1772446632385254  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1814193725585938  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1814193725585938  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

m.shape torch.Size([360, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2099652290344238  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2099652290344238  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2106518745422363  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.217517375946045  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([301, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2177529335021973  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2177529335021973  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2183270454406738  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2312145233154297  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([229, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2315878868103027  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2315878868103027  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2320246696472168  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2416338920593262  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([165, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2420501708984375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2420501708984375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2423648834228516  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2514915466308594  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([163, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.25211763381958  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.25211763381958  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2524285316467285  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2636208534240723  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2642555236816406  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2642555236816406  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.264516830444336  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2757530212402344  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.276214599609375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.276214599609375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2763824462890625  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2847747802734375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2854290008544922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2854290008544922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2856121063232422  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2960491180419922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.29671049118042  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.29671049118042  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2968764305114746  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3074965476989746  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3081440925598145  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3081440925598145  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3082890510559082  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3185811042785645  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3191008567810059  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3191008567810059  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3192076683044434  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3275389671325684  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.328223705291748  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.328223705291748  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.328345775604248  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.338721752166748  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3392481803894043  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3392481803894043  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3393378257751465  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3475852012634277  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3482403755187988  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3482403755187988  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.348339557647705  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3581585884094238  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3586859703063965  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3586859703063965  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.358762264251709  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.366849422454834  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3673958778381348  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3673958778381348  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3674683570861816  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3756585121154785  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3762760162353516  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3762760162353516  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.376352310180664  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.385507583618164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3859367370605469  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3859367370605469  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3859882354736328  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3925285339355469  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3929228782653809  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3929228782653809  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3929667472839355  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3988451957702637  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3993425369262695  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3993425369262695  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3993940353393555  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4066553115844727  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4072351455688477  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4072351455688477  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.407292366027832  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4157609939575195  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4162187576293945  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4162187576293945  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4162626266479492  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4230623245239258  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4235930442810059  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4235930442810059  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4236407279968262  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4313654899597168  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.431826114654541  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.431826114654541  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.43186616897583  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4386353492736816  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([562, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.452406883239746  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.452406883239746  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4534788131713867  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6451210975646973  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 562, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6193046569824219  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6197185516357422  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6201324462890625  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6196975708007812  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([2777, 40])
input nodes number: 17509
output nodes number: 2777
edges number: 29212
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.619849681854248  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.6198501586914062  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.0330657958984375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

pseudo mini batch 28 input nodes size: 44305
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.029426097869873047  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.029426097869873047  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.05091047286987305  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.050931453704833984  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.027472972869873047  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028896808624267578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028896808624267578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028896808624267578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([44305, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028896808624267578  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

m.shape torch.Size([531, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10579156875610352  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10579156875610352  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10629796981811523  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1106414794921875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([558, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11092042922973633  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11092042922973633  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11145257949829102  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11943483352661133  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([515, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11990547180175781  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11990547180175781  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12039661407470703  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13120174407958984  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([524, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13195562362670898  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13195562362670898  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13245534896850586  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.14730024337768555  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([479, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1481924057006836  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1481924057006836  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1486492156982422  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16509437561035156  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([495, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16628217697143555  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16628217697143555  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16675424575805664  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.18705320358276367  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([512, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.18852615356445312  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.18852615356445312  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.18901443481445312  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21342849731445312  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([494, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21506881713867188  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21506881713867188  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21553993225097656  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.24239349365234375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([494, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.24454355239868164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.24454355239868164  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.24501466751098633  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.27516603469848633  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([13422, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.339383602142334  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.339383602142334  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 13422, 128]), torch.Size([1, 13422, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.35218381881713867  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2636466026306152  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 13422, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.1903738975524902  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2075629234313965  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2247519493103027  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2074284553527832  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

torch.Size([18024, 256])
first layer input nodes number: 44305
first layer output nodes number: 18024
edges number: 156855
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2250843048095703  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2422733306884766  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2465705871582031  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2465705871582031  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

m.shape torch.Size([305, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2798099517822266  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2798099517822266  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2803916931152344  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.286184310913086  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([253, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2863798141479492  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2863798141479492  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2868623733520508  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.2941007614135742  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([186, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.294395923614502  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.294395923614502  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.294750690460205  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3025555610656738  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([159, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3029894828796387  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3029894828796387  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3032927513122559  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3120875358581543  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([113, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.312479019165039  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.312479019165039  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3126945495605469  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3204536437988281  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([105, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3209514617919922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3209514617919922  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3211517333984375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.329763412475586  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3302555084228516  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3302555084228516  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.330423355102539  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.338815689086914  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([75, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.339308738708496  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.339308738708496  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.339451789855957  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3476057052612305  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.348278522491455  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.348278522491455  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.348442554473877  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.358940601348877  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3595027923583984  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3595027923583984  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3596305847167969  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.368703842163086  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3693485260009766  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3693485260009766  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.369476318359375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3794441223144531  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.380049228668213  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.380049228668213  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.380159854888916  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.3895630836486816  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.390244960784912  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.390244960784912  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.390357494354248  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4007105827331543  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.401179313659668  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.401179313659668  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4012537002563477  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4086179733276367  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4090137481689453  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4090137481689453  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4090709686279297  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4151363372802734  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.415738582611084  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.415738582611084  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4158167839050293  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4246535301208496  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4252357482910156  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4252357482910156  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4253082275390625  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4340057373046875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.434661865234375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.434661865234375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4347381591796875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.444427490234375  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4449920654296875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4449920654296875  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4450550079345703  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4534893035888672  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4540538787841797  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4540538787841797  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4541130065917969  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4624500274658203  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4631071090698242  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4631071090698242  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4631719589233398  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4727697372436523  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4732451438903809  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4732451438903809  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4732909202575684  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4803862571716309  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.480982780456543  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.480982780456543  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4810361862182617  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4896879196166992  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4904227256774902  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.4904227256774902  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.490485668182373  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5011229515075684  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([766, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5194973945617676  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.5194973945617676  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

 h.shape torch.Size([1, 766, 256]), torch.Size([1, 766, 256])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.520958423614502  GigaBytes
Max Memory Allocated: 1.7924418449401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7788739204406738  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 766, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7481346130371094  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7485456466674805  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7489566802978516  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7485246658325195  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

torch.Size([2758, 40])
input nodes number: 18024
output nodes number: 2758
edges number: 34153
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7486772537231445  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 1.7486777305603027  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.031337738037109375  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

pseudo mini batch 29 input nodes size: 43021
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.04895448684692383  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.04897594451904297  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.02747058868408203  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028966903686523438  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028966903686523438  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028966903686523438  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

torch.Size([43021, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.028966903686523438  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

m.shape torch.Size([482, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10922384262084961  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10922384262084961  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.10968351364135742  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11336088180541992  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([456, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11356592178344727  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11356592178344727  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.11400079727172852  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12052392959594727  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([451, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12095165252685547  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12095165252685547  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.12138175964355469  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1308441162109375  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([500, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13158273696899414  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13158273696899414  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.13205957412719727  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1458878517150879  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([538, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.14693212509155273  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.14693212509155273  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1474452018737793  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16681909561157227  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([494, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16797590255737305  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16797590255737305  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.16844701766967773  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.1887049674987793  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([490, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.19010496139526367  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.19010496139526367  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.19057226181030273  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21393728256225586  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([484, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21554994583129883  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21554994583129883  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.21601152420043945  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.24232149124145508  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([481, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2441549301147461  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2441549301147461  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2446136474609375  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6951904296875 GB
    Memory Allocated: 0.2739715576171875  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([14025, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7635498046875 GB
    Memory Allocated: 0.3406186103820801  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7635498046875 GB
    Memory Allocated: 0.3406186103820801  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 14025, 128]), torch.Size([1, 14025, 128])
----------------------------------------3
 Nvidia-smi: 3.7635498046875 GB
    Memory Allocated: 0.35399389266967773  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3184685707092285  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 14025, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2420806884765625  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.259629249572754  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2771778106689453  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2594919204711914  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

torch.Size([18401, 256])
first layer input nodes number: 43021
first layer output nodes number: 18401
edges number: 162282
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2775006294250488  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2950491905212402  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.299548625946045  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.299548625946045  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

m.shape torch.Size([264, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3369231224060059  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3369231224060059  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3374266624450684  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3438820838928223  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([199, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3440132141113281  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3440132141113281  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3443927764892578  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3500862121582031  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([151, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.350332260131836  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.350332260131836  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3506202697753906  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3569564819335938  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([144, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3573660850524902  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3573660850524902  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3576407432556152  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3656058311462402  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([140, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3661413192749023  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3661413192749023  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.366408348083496  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.376021385192871  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([106, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3764991760253906  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3764991760253906  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3767013549804688  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3853950500488281  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([90, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.385899543762207  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.385899543762207  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3860712051391602  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3946542739868164  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([63, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3950529098510742  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3950529098510742  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3951730728149414  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.402022361755371  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([67, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4025421142578125  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4025421142578125  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.402669906616211  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.410848617553711  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4115824699401855  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4115824699401855  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.411740779876709  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.422980785369873  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4236946105957031  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4236946105957031  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.423837661743164  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4349956512451172  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4357895851135254  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4357895851135254  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4359326362609863  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.448091983795166  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4489326477050781  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4489326477050781  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4490718841552734  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4618816375732422  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4624581336975098  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4624581336975098  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4625496864318848  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4716134071350098  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4723320007324219  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4723320007324219  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.472433090209961  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4831485748291016  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4838056564331055  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4838056564331055  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4838933944702148  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4938077926635742  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4945158958435059  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4945158958435059  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4946036338806152  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5051321983337402  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5060930252075195  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5060930252075195  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5062036514282227  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5202531814575195  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5211658477783203  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5211658477783203  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5212669372558594  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5348129272460938  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5356082916259766  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5356082916259766  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5356922149658203  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.547525405883789  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5494747161865234  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5494747161865234  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5495738983154297  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5642528533935547  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.564964771270752  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.564964771270752  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5650334358215332  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.575676441192627  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.576460361480713  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.576460361480713  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.576530933380127  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.587963581085205  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.588620662689209  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.588620662689209  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5886778831481934  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5983481407165527  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([834, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.618359088897705  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.618359088897705  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.6199498176574707  GigaBytes
Max Memory Allocated: 1.7971367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.9030184745788574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 834, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.8686585426330566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.8690857887268066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.8695130348205566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.8690643310546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2867, 40])
input nodes number: 18401
output nodes number: 2867
edges number: 38489
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.869239330291748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.8692398071289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03153181076049805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 30 input nodes size: 46428
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.027486801147460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.027486801147460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.049625396728515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04964637756347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028140544891357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.029444217681884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.029444217681884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.029444217681884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([46428, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.029444217681884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([627, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10104084014892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10104084014892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1016387939453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10652542114257812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([655, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10685110092163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10685110092163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10747575759887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11684560775756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([636, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11744308471679688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11744308471679688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11804962158203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1313934326171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([577, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13226842880249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13226842880249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13281869888305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14963674545288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([574, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15073013305664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15073013305664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1512775421142578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17157840728759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([526, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17280960083007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17280960083007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1733112335205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19511985778808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([534, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19665145874023438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19665145874023438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1971607208251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22319507598876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([534, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2249774932861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2249774932861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22548675537109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.25487327575683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([496, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2567472457885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2567472457885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2572202682495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2874937057495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([12122, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3450593948364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3450593948364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12122, 128]), torch.Size([1, 12122, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.35749053955078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1801815032958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12122, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1118836402893066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.128364086151123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1448445320129395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.12823486328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17281, 256])
first layer input nodes number: 46428
first layer output nodes number: 17281
edges number: 145873
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1451926231384277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1616730690002441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.165895938873291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.165895938873291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([391, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1943011283874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1943011283874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1950469017028809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.202843189239502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([290, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2030282020568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2030282020568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2035813331604004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2127165794372559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([236, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.213120937347412  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.213120937347412  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2135710716247559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2234740257263184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([173, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2239141464233398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2239141464233398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2242441177368164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2338132858276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([150, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2343692779541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2343692779541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2346553802490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.244955062866211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([127, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.24554443359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.24554443359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2457866668701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2562026977539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.256721019744873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.256721019744873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2569022178649902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2659621238708496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([83, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.266510009765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.266510009765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2666683197021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2756919860839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2762703895568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2762703895568848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2764153480529785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2856926918029785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2862257957458496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2862257957458496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2863459587097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.294877529144287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2953357696533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2953357696533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2954292297363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3027191162109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3033990859985352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3033990859985352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3035192489624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3137331008911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.314298152923584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.314298152923584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3143935203552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.323167324066162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3236579895019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3236579895019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3237342834472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3312873840332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3317971229553223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3317971229553223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3318696022033691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.339552402496338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3400545120239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3400545120239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3401212692260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3476648330688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.348219871520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.348219871520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3482885360717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3565282821655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3569960594177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3569960594177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3570513725280762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3640761375427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3646697998046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3646697998046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3647346496582031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3734245300292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3741226196289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3741226196289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3741950988769531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3844146728515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3849034309387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3849034309387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3849530220031738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3922924995422363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.392669677734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.392669677734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3927059173583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3983230590820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3986587524414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3986587524414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3986892700195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4036331176757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4041485786437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4041485786437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4041924476623535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4116063117980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([578, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4254727363586426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4254727363586426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4265751838684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.6232447624206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 578, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5975637435913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5979747772216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5983858108520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5979537963867188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 17281
output nodes number: 2758
edges number: 29035
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5980877876281738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.598088264465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03171396255493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 31 input nodes size: 45091
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028124332427978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028124332427978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.049625396728515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04964637756347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.027486801147460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028757095336914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028757095336914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028757095336914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([45091, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.028757095336914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([646, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09911584854125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09911584854125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0997319221496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10536479949951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([649, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10567569732666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10567569732666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 649, 128]), torch.Size([1, 649, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10629463195800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11557865142822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 649, 128])
m.shape torch.Size([583, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1161031723022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1161031723022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11665916442871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1288909912109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([597, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12975168228149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12975168228149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13032102584838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14683198928833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([562, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14793968200683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14793968200683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14847564697265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1677703857421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([507, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16895294189453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16895294189453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16943645477294922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19022750854492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([508, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1919875144958496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1919875144958496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19247198104858398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21669530868530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([470, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2182459831237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2182459831237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21869421005249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24424314498901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([512, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2462162971496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2462162971496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2467045783996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2779545783996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([11795, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3339533805847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3339533805847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11795, 128]), torch.Size([1, 11795, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3452019691467285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1457324028015137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11795, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.0794525146484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.0955018997192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.111551284790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.0953764915466309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16829, 256])
first layer input nodes number: 45091
first layer output nodes number: 16829
edges number: 141807
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.111889362335205  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1279387474060059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1322312355041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1322312355041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([373, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1601872444152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1601872444152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1608986854553223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1665902137756348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([325, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1668596267700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1668596267700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1674795150756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.177314281463623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([201, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.177584171295166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.177584171295166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1779675483703613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1864018440246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([188, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1869330406188965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1869330406188965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1872916221618652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.197690486907959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1983909606933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1983909606933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.198740005493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2113056182861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([105, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2117366790771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2117366790771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2119369506835938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2205486297607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([96, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2210946083068848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2210946083068848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2212777137756348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2304329872131348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([71, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2308874130249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2308874130249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.231022834777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2387418746948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.239427089691162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.239427089691162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2395930290222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2502131462097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2509279251098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2509279251098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2510862350463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2623262405395508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2628602981567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2628602981567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2629709243774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2715997695922852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2721099853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2721099853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2722034454345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2801475524902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2807259559631348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2807259559631348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2808213233947754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.289595127105713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2900590896606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2900590896606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2901315689086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.297307014465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2978620529174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2978620529174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2979402542114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.306229591369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3068366050720215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3068366050720215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3069167137145996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3159689903259277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3165335655212402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3165335655212402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3166041374206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3250727653503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3254876136779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3254876136779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3255372047424316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3318352699279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3325228691101074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3325228691101074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.332597255706787  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3425650596618652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3430280685424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3430280685424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3430776596069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3500699996948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.350691318511963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.350691318511963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.350752353668213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.359785556793213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3601994514465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3601994514465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3602395057678223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.366447925567627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3668479919433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3668479919433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3668842315673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3727550506591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes
[05:41:32] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28960368 edges into 32 parts and get 9232916 edge cuts

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3730602264404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3730602264404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.373086929321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3775997161865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([554, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3908982276916504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3908982276916504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3919548988342285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5970125198364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 554, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5717830657958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5721940994262695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5726051330566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5721731185913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 16829
output nodes number: 2758
edges number: 28586
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.572319507598877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.5723199844360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.030985355377197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03653573989868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03653573989868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008410416543483734 |0.012495897710323334 |0.130685955286026 |8.794665336608887e-05 |0.07583943009376526 |0.005846738815307617 |
----------------------------------------------------------pseudo_mini_loss sum 5.332906723022461
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1128952
Number of first layer input nodes during this epoch:  809449
Number of first layer output nodes during this epoch:  319503
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03653526306152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03153657913208008
global_2_local spend time (sec) 0.04649829864501953
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004372119903564453
A = g.adjacency_matrix() spent  0.007668972015380859
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08688974380493164
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3190979957580566
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1780412197113037

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 1.265 seconds
Metis partitioning: 5.619 seconds
Split the graph: 0.488 seconds
Construct subgraphs: 0.077 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.463634967803955
2763
2762
2789
2897
2767
2902
2811
2902
2767
2927
2758
2758
2759
2780
2837
2759
2898
2924
2886
2898
2916
2909
2873
2896
2820
2901
2900
2758
2880
2859
2758
2927
total k batches seeds list generation spend  17.383800506591797
after graph partition
graph partition algorithm spend time 17.476903438568115
2763
2762
2789
2897
2767
2902
2811
2902
2767
2927
2758
2758
2759
2780
2837
2759
2898
2924
2886
2898
2916
2909
2873
2896
2820
2901
2900
2758
2880
2859
2758
2927
partition_len_list
[11918, 10012, 10467, 7495, 8417, 6588, 8827, 8425, 17535, 19077, 16231, 15826, 18092, 16289, 15979, 16709, 5826, 6783, 6056, 5415, 8922, 6452, 7310, 6265, 5885, 6100, 6349, 6806, 6738, 7560, 8066, 7804]
shared_neighbor_graph_partition_s0 selection method  spend 17.579440355300903
time for parepare:  0.017446041107177734
local_output_nid generation:  0.0007798671722412109
local_in_edges_tensor generation:  0.0009064674377441406
mini_batch_src_global generation:  0.0011703968048095703
r_  generation:  0.006777524948120117
local_output_nid generation:  0.0007987022399902344
local_in_edges_tensor generation:  0.0007369518280029297
mini_batch_src_global generation:  0.000835418701171875
r_  generation:  0.0049724578857421875
local_output_nid generation:  0.0008237361907958984
local_in_edges_tensor generation:  0.0007085800170898438
mini_batch_src_global generation:  0.0006520748138427734
r_  generation:  0.005250215530395508
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0006937980651855469
mini_batch_src_global generation:  0.0006489753723144531
r_  generation:  0.005865573883056641
local_output_nid generation:  0.0008265972137451172
local_in_edges_tensor generation:  0.0006334781646728516
mini_batch_src_global generation:  0.0006957054138183594
r_  generation:  0.0057010650634765625
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0006597042083740234
mini_batch_src_global generation:  0.0006210803985595703
r_  generation:  0.0055811405181884766
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0006425380706787109
mini_batch_src_global generation:  0.0006794929504394531
r_  generation:  0.0058863162994384766
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0006632804870605469
mini_batch_src_global generation:  0.0007259845733642578
r_  generation:  0.0063250064849853516
local_output_nid generation:  0.0008275508880615234
local_in_edges_tensor generation:  0.0007750988006591797
mini_batch_src_global generation:  0.0012412071228027344
r_  generation:  0.009055852890014648
local_output_nid generation:  0.0009982585906982422
local_in_edges_tensor generation:  0.0008707046508789062
mini_batch_src_global generation:  0.0014491081237792969
r_  generation:  0.011414289474487305
local_output_nid generation:  0.0009610652923583984
local_in_edges_tensor generation:  0.0007998943328857422
mini_batch_src_global generation:  0.0009968280792236328
r_  generation:  0.011457681655883789
local_output_nid generation:  0.001003265380859375
local_in_edges_tensor generation:  0.0008418560028076172
mini_batch_src_global generation:  0.0011866092681884766
r_  generation:  0.007898330688476562
local_output_nid generation:  0.0009925365447998047
local_in_edges_tensor generation:  0.0007026195526123047
mini_batch_src_global generation:  0.0011451244354248047
r_  generation:  0.009508371353149414
local_output_nid generation:  0.0010170936584472656
local_in_edges_tensor generation:  0.0006990432739257812
mini_batch_src_global generation:  0.0010421276092529297
r_  generation:  0.00831294059753418
local_output_nid generation:  0.0010335445404052734
local_in_edges_tensor generation:  0.0007078647613525391
mini_batch_src_global generation:  0.0011601448059082031
r_  generation:  0.011884927749633789
local_output_nid generation:  0.0010139942169189453
local_in_edges_tensor generation:  0.0007295608520507812
mini_batch_src_global generation:  0.001257181167602539
r_  generation:  0.009612560272216797
local_output_nid generation:  0.0010623931884765625
local_in_edges_tensor generation:  0.0006809234619140625
mini_batch_src_global generation:  0.0008325576782226562
r_  generation:  0.006209373474121094
local_output_nid generation:  0.00106048583984375
local_in_edges_tensor generation:  0.0006947517395019531
mini_batch_src_global generation:  0.0007793903350830078
r_  generation:  0.006784677505493164
local_output_nid generation:  0.0010426044464111328
local_in_edges_tensor generation:  0.0006437301635742188
mini_batch_src_global generation:  0.0007233619689941406
r_  generation:  0.005342960357666016
local_output_nid generation:  0.0010221004486083984
local_in_edges_tensor generation:  0.0006365776062011719
mini_batch_src_global generation:  0.0006136894226074219
r_  generation:  0.00550532341003418
local_output_nid generation:  0.0009970664978027344
local_in_edges_tensor generation:  0.0006697177886962891
mini_batch_src_global generation:  0.0008327960968017578
r_  generation:  0.007390022277832031
local_output_nid generation:  0.0009889602661132812
local_in_edges_tensor generation:  0.0006697177886962891
mini_batch_src_global generation:  0.00083160400390625
r_  generation:  0.007295370101928711
local_output_nid generation:  0.0009715557098388672
local_in_edges_tensor generation:  0.0006272792816162109
mini_batch_src_global generation:  0.0007021427154541016
r_  generation:  0.006031036376953125
local_output_nid generation:  0.0009753704071044922
local_in_edges_tensor generation:  0.0006425380706787109
mini_batch_src_global generation:  0.0006783008575439453
r_  generation:  0.0062372684478759766
local_output_nid generation:  0.0009238719940185547
local_in_edges_tensor generation:  0.0006117820739746094
mini_batch_src_global generation:  0.00069427490234375
r_  generation:  0.006314516067504883
local_output_nid generation:  0.0009386539459228516
local_in_edges_tensor generation:  0.0006649494171142578
mini_batch_src_global generation:  0.0008287429809570312
r_  generation:  0.007048845291137695
local_output_nid generation:  0.0009152889251708984
local_in_edges_tensor generation:  0.0006611347198486328
mini_batch_src_global generation:  0.0008189678192138672
r_  generation:  0.007490873336791992
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0006258487701416016
mini_batch_src_global generation:  0.0006818771362304688
r_  generation:  0.005860090255737305
local_output_nid generation:  0.0008971691131591797
local_in_edges_tensor generation:  0.0006265640258789062
mini_batch_src_global generation:  0.0007159709930419922
r_  generation:  0.006277322769165039
local_output_nid generation:  0.0009109973907470703
local_in_edges_tensor generation:  0.0006642341613769531
mini_batch_src_global generation:  0.0008389949798583984
r_  generation:  0.007808685302734375
local_output_nid generation:  0.0008785724639892578
local_in_edges_tensor generation:  0.0006246566772460938
mini_batch_src_global generation:  0.0007264614105224609
r_  generation:  0.006124734878540039
local_output_nid generation:  0.0009474754333496094
local_in_edges_tensor generation:  0.0006721019744873047
mini_batch_src_global generation:  0.0008313655853271484
r_  generation:  0.00769495964050293
----------------------check_connections_block total spend ----------------------------- 0.39827823638916016
generate_one_block  0.019475936889648438
generate_one_block  0.00901341438293457
generate_one_block  0.008859872817993164
generate_one_block  0.008804798126220703
generate_one_block  0.008823871612548828
generate_one_block  0.007999897003173828
generate_one_block  0.009145498275756836
generate_one_block  0.009591341018676758
generate_one_block  0.0153656005859375
generate_one_block  0.016765117645263672
generate_one_block  0.018298864364624023
generate_one_block  0.014221668243408203
generate_one_block  0.015262365341186523
generate_one_block  0.013449668884277344
generate_one_block  0.017096996307373047
generate_one_block  0.0157012939453125
generate_one_block  0.01372075080871582
generate_one_block  0.010334968566894531
generate_one_block  0.007709503173828125
generate_one_block  0.00800013542175293
generate_one_block  0.011331319808959961
generate_one_block  0.010608196258544922
generate_one_block  0.008997201919555664
generate_one_block  0.008959054946899414
generate_one_block  0.009290218353271484
generate_one_block  0.010454893112182617
generate_one_block  0.011878013610839844
generate_one_block  0.008805036544799805
generate_one_block  0.009237289428710938
generate_one_block  0.01184988021850586
generate_one_block  0.009291648864746094
generate_one_block  0.01185750961303711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03852486610412598
gen group dst list time:  0.01096796989440918
time for parepare:  0.02324366569519043
local_output_nid generation:  0.0033299922943115234
local_in_edges_tensor generation:  0.010379314422607422
mini_batch_src_global generation:  0.0029649734497070312
r_  generation:  0.031069517135620117
local_output_nid generation:  0.003146648406982422
local_in_edges_tensor generation:  0.0030519962310791016
mini_batch_src_global generation:  0.0026772022247314453
r_  generation:  0.024317502975463867
local_output_nid generation:  0.0033049583435058594
local_in_edges_tensor generation:  0.002845287322998047
mini_batch_src_global generation:  0.0022628307342529297
r_  generation:  0.026560544967651367
local_output_nid generation:  0.002374410629272461
local_in_edges_tensor generation:  0.0021691322326660156
mini_batch_src_global generation:  0.0019505023956298828
r_  generation:  0.016637563705444336
local_output_nid generation:  0.0024993419647216797
local_in_edges_tensor generation:  0.0021665096282958984
mini_batch_src_global generation:  0.0014691352844238281
r_  generation:  0.019773006439208984
local_output_nid generation:  0.002001047134399414
local_in_edges_tensor generation:  0.001650094985961914
mini_batch_src_global generation:  0.0012805461883544922
r_  generation:  0.014213323593139648
local_output_nid generation:  0.002670764923095703
local_in_edges_tensor generation:  0.0021550655364990234
mini_batch_src_global generation:  0.0014801025390625
r_  generation:  0.021079063415527344
local_output_nid generation:  0.002442598342895508
local_in_edges_tensor generation:  0.0020380020141601562
mini_batch_src_global generation:  0.0016620159149169922
r_  generation:  0.01973891258239746
local_output_nid generation:  0.004755973815917969
local_in_edges_tensor generation:  0.005326271057128906
mini_batch_src_global generation:  0.004841327667236328
r_  generation:  0.052332162857055664
local_output_nid generation:  0.0053119659423828125
local_in_edges_tensor generation:  0.00607609748840332
mini_batch_src_global generation:  0.006921052932739258
r_  generation:  0.05922961235046387
local_output_nid generation:  0.0046427249908447266
local_in_edges_tensor generation:  0.004841327667236328
mini_batch_src_global generation:  0.005527496337890625
r_  generation:  0.04695439338684082
local_output_nid generation:  0.004695892333984375
local_in_edges_tensor generation:  0.004055500030517578
mini_batch_src_global generation:  0.0049593448638916016
r_  generation:  0.0458219051361084
local_output_nid generation:  0.005251884460449219
local_in_edges_tensor generation:  0.004514217376708984
mini_batch_src_global generation:  0.0058367252349853516
r_  generation:  0.05307292938232422
local_output_nid generation:  0.004877567291259766
local_in_edges_tensor generation:  0.004170656204223633
mini_batch_src_global generation:  0.0051555633544921875
r_  generation:  0.04832816123962402
local_output_nid generation:  0.004670381546020508
local_in_edges_tensor generation:  0.00444793701171875
mini_batch_src_global generation:  0.005759000778198242
r_  generation:  0.04687380790710449
local_output_nid generation:  0.004897117614746094
local_in_edges_tensor generation:  0.004597663879394531
mini_batch_src_global generation:  0.004965543746948242
r_  generation:  0.04874014854431152
local_output_nid generation:  0.0029001235961914062
local_in_edges_tensor generation:  0.001631021499633789
mini_batch_src_global generation:  0.002071857452392578
r_  generation:  0.013573646545410156
local_output_nid generation:  0.0022552013397216797
local_in_edges_tensor generation:  0.001768350601196289
mini_batch_src_global generation:  0.0011823177337646484
r_  generation:  0.015564918518066406
local_output_nid generation:  0.0018718242645263672
local_in_edges_tensor generation:  0.0015270709991455078
mini_batch_src_global generation:  0.0013875961303710938
r_  generation:  0.011168479919433594
local_output_nid generation:  0.001634359359741211
local_in_edges_tensor generation:  0.0012636184692382812
mini_batch_src_global generation:  0.0012214183807373047
r_  generation:  0.00954580307006836
local_output_nid generation:  0.0026540756225585938
local_in_edges_tensor generation:  0.0020532608032226562
mini_batch_src_global generation:  0.001653909683227539
r_  generation:  0.023224353790283203
local_output_nid generation:  0.0019028186798095703
local_in_edges_tensor generation:  0.0018162727355957031
mini_batch_src_global generation:  0.0015473365783691406
r_  generation:  0.015461206436157227
local_output_nid generation:  0.002200603485107422
local_in_edges_tensor generation:  0.0016384124755859375
mini_batch_src_global generation:  0.001322031021118164
r_  generation:  0.016409635543823242
local_output_nid generation:  0.001779794692993164
local_in_edges_tensor generation:  0.0014569759368896484
mini_batch_src_global generation:  0.0012192726135253906
r_  generation:  0.013596773147583008
local_output_nid generation:  0.0017495155334472656
local_in_edges_tensor generation:  0.0014264583587646484
mini_batch_src_global generation:  0.001115560531616211
r_  generation:  0.013151407241821289
local_output_nid generation:  0.0017435550689697266
local_in_edges_tensor generation:  0.0013499259948730469
mini_batch_src_global generation:  0.0011250972747802734
r_  generation:  0.013531923294067383
local_output_nid generation:  0.0017845630645751953
local_in_edges_tensor generation:  0.0014138221740722656
mini_batch_src_global generation:  0.0012340545654296875
r_  generation:  0.015525341033935547
local_output_nid generation:  0.0018703937530517578
local_in_edges_tensor generation:  0.0015330314636230469
mini_batch_src_global generation:  0.001294851303100586
r_  generation:  0.015924692153930664
local_output_nid generation:  0.0018684864044189453
local_in_edges_tensor generation:  0.001447916030883789
mini_batch_src_global generation:  0.0012974739074707031
r_  generation:  0.015267610549926758
local_output_nid generation:  0.002032756805419922
local_in_edges_tensor generation:  0.0016515254974365234
mini_batch_src_global generation:  0.0014755725860595703
r_  generation:  0.01798415184020996
local_output_nid generation:  0.0021457672119140625
local_in_edges_tensor generation:  0.0017998218536376953
mini_batch_src_global generation:  0.0015206336975097656
r_  generation:  0.018845558166503906
local_output_nid generation:  0.002019166946411133
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.001603841781616211
r_  generation:  0.019072294235229492
----------------------check_connections_block total spend ----------------------------- 1.3073804378509521
generate_one_block  0.043802499771118164
generate_one_block  0.04301738739013672
generate_one_block  0.03806304931640625
generate_one_block  0.02225184440612793
generate_one_block  0.026007413864135742
generate_one_block  0.019358158111572266
generate_one_block  0.027367353439331055
generate_one_block  0.026238203048706055
generate_one_block  0.07154273986816406
generate_one_block  0.07922625541687012
generate_one_block  0.06577348709106445
generate_one_block  0.06233549118041992
generate_one_block  0.07271766662597656
generate_one_block  0.06447196006774902
generate_one_block  0.06408905982971191
generate_one_block  0.06657147407531738
generate_one_block  0.01703023910522461
generate_one_block  0.020590782165527344
generate_one_block  0.016155004501342773
generate_one_block  0.012621402740478516
generate_one_block  0.028239011764526367
generate_one_block  0.021584272384643555
generate_one_block  0.021821022033691406
generate_one_block  0.017970561981201172
generate_one_block  0.017409801483154297
generate_one_block  0.017766714096069336
generate_one_block  0.020360708236694336
generate_one_block  0.021369457244873047
generate_one_block  0.020502090454101562
generate_one_block  0.02403545379638672
generate_one_block  0.025689363479614258
generate_one_block  0.02561330795288086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03653526306152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

connection checking time:  1.3073804378509521
block generation total time  1.1215932369232178
average batch blocks generation time:  0.035049788653850555
block dataloader generation time/epoch 21.03754448890686
pseudo mini batch 0 input nodes size: 31408
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.033036231994628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.033036231994628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.048012733459472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.048033714294433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.026511669158935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.027369022369384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.027369022369384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.027369022369384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([31408, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.027369022369384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([668, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0727086067199707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0727086067199707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07334566116333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07849550247192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([714, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0788578987121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0788578987121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 714, 128]), torch.Size([1, 714, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07953882217407227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09052181243896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 714, 128])
m.shape torch.Size([584, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09101676940917969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09101676940917969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 584, 128]), torch.Size([1, 584, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09157371520996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10382652282714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 584, 128])
m.shape torch.Size([594, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10468101501464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10468101501464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10524749755859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12188911437988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([545, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12290525436401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12290525436401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12342500686645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1421360969543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([542, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14342689514160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14342689514160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14394378662109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16655302047729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([489, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16792678833007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16792678833007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16839313507080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1917104721069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([489, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1933426856994629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1933426856994629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19380903244018555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22039079666137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([439, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22204160690307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22204160690307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22246026992797852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24925470352172852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([6854, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.28172779083251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.28172779083251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 6854, 128]), torch.Size([1, 6854, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.28826427459716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7527971267700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 6854, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7110996246337891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7224655151367188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7338314056396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7223763465881348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([11918, 256])
first layer input nodes number: 31408
first layer output nodes number: 11918
edges number: 92027
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.734067440032959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7454333305358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7486233711242676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7486233711242676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([445, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7712445259094238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7712445259094238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7720932960510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.779630184173584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([355, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7798886299133301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7798886299133301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7805657386779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7918705940246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([264, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7922935485839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7922935485839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7927970886230469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.805088996887207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([196, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8055911064147949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8055911064147949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8059649467468262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8168063163757324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([176, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8174653053283691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8174653053283691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8178009986877441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8298859596252441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8306527137756348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8306527137756348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8309617042541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8442482948303223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8448677062988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8448677062988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8450870513916016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8560543060302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8569135665893555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8569135665893555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8571538925170898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8708524703979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8713555335998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8713555335998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.871492862701416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.880281925201416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8810014724731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8810014724731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8811578750610352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8922624588012695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8929457664489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8929457664489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8930830955505371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9037947654724121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9043030738830566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9043030738830566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9043984413146973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9125046730041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9129319190979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9129319190979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9130043983459473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9196724891662598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9200940132141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9200940132141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.920158863067627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9265789985656738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9270944595336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9270944595336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9271669387817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.934849739074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9353518486022949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9353518486022949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9354186058044434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9429621696472168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9435334205627441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9435334205627441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9436039924621582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9520726203918457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9525566101074219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9525566101074219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9526138305664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9598808288574219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9603271484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9603271484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9603767395019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9670219421386719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9674973487854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9674973487854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9675469398498535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9745392799377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9749383926391602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9749383926391602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9749784469604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9809064865112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9812459945678711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9812459945678711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9812784194946289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9863042831420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9865312576293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9865312576293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9865522384643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9899511337280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9904022216796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9904022216796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.9904403686523438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.99688720703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.0053386688232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.0053386688232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.0059394836425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1206741333007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.101545810699463  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1019577980041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.102369785308838  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1019368171691895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2763, 40])
input nodes number: 11918
output nodes number: 2763
edges number: 22962
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1020479202270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1020488739013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02893352508544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 1 input nodes size: 29945
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02651357650756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02651357650756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04079246520996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.040813446044921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.025815963745117188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.026436805725097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.026436805725097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.026436805725097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([29945, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.026436805725097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([882, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06001615524291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06001615524291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 882, 128]), torch.Size([1, 882, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.060857295989990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06779193878173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 882, 128])
m.shape torch.Size([903, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06823253631591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06823253631591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 903, 128]), torch.Size([1, 903, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06909370422363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08201122283935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 903, 128])
m.shape torch.Size([775, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08268928527832031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08268928527832031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08342838287353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09991121292114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([713, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10090160369873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10090160369873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10158157348632812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12130069732666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([597, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12238407135009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12238407135009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12295341491699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1435718536376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([502, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14472341537475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14472341537475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1452021598815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1657881736755371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([462, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16709089279174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16709089279174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16753149032592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1895613670349121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([425, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1909623146057129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1909623146057129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19136762619018555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21447038650512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([346, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21575260162353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21575260162353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21608257293701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.23720073699951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([4407, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.25852012634277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.25852012634277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4407, 128]), torch.Size([1, 4407, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2627229690551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.570401668548584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4407, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5406074523925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5505905151367188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5601387023925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5500807762145996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([10012, 256])
first layer input nodes number: 29945
first layer output nodes number: 10012
edges number: 67680
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5599288940429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5699119567871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5718650817871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5718650817871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([567, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5874447822570801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5874447822570801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5885262489318848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5976262092590332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([476, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5980005264282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5980005264282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5989084243774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6130838394165039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([354, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6136980056762695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6136980056762695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6143732070922852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6293911933898926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([268, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6303062438964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6303062438964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6308174133300781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6456756591796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6464056968688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6464056968688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.646796703338623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6608729362487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6615543365478516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6615543365478516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6618442535400391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6743106842041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6749463081359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6749463081359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6751675605773926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6862301826477051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([90, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6868119239807129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6868119239807129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.686983585357666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6967682838439941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6974353790283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6974353790283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.697601318359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.708221435546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([59, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7087059020996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7087059020996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7088184356689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7168083190917969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7173233032226562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7173233032226562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7174263000488281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7254600524902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7258586883544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7258586883544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7259330749511719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7322559356689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7325687408447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7325687408447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7326221466064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7375354766845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7378320693969727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7378320693969727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7378778457641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7424097061157227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7426753044128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7426753044128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.742713451385498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7467570304870605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7470765113830566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7470765113830566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7471184730529785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7518601417541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7521333694458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7521333694458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7521677017211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7562875747680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.756495475769043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.756495475769043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7565202713012695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.759669303894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7598214149475098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7598214149475098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7598385810852051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.762138843536377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.762303352355957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.762303352355957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7623205184936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7647409439086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7649345397949219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7649345397949219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.76495361328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7677764892578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7679786682128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7679786682128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7679977416992188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7709541320800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7710776329040527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7710776329040527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7710890769958496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7729430198669434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7730989456176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7730989456176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7731122970581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7753686904907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([119, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.778221607208252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.778221607208252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7784485816955566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8183960914611816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 119, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8060507774353027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8064627647399902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8068747520446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8064417839050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2762, 40])
input nodes number: 10012
output nodes number: 2762
edges number: 15511
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8065376281738281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8065381050109863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02765369415283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 2 input nodes size: 33874
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.025815963745117188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.025815963745117188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.041968345642089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04198932647705078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.027689456939697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02834939956665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02834939956665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02834939956665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([33874, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02834939956665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([910, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06392383575439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06392383575439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06479167938232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07173442840576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([940, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07219696044921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07219696044921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07309341430664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08654022216796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([745, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08751773834228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08751773834228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 745, 128]), torch.Size([1, 745, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08822822570800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10385894775390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 745, 128])
m.shape torch.Size([691, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10482168197631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10482168197631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10548067092895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1248469352722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([635, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12603139877319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12603139877319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12663698196411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14875125885009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([515, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14992189407348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14992189407348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15041303634643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17220067977905273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([482, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17356395721435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17356395721435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17402362823486328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1970071792602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([411, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19834518432617188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19834518432617188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19873714447021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22107887268066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([356, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2224106788635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2224106788635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 356, 128]), torch.Size([1, 356, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22275018692016602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24447870254516602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 356, 128])
m.shape torch.Size([4782, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2677464485168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2677464485168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4782, 128]), torch.Size([1, 4782, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2723069190979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5961003303527832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4782, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5644011497497559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5743832588195801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5843653678894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5743050575256348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([10467, 256])
first layer input nodes number: 33874
first layer output nodes number: 10467
edges number: 71740
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5846199989318848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.594602108001709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5974140167236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5974140167236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([568, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6141328811645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6141328811645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6152162551879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.624110221862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([471, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.624474048614502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.624474048614502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6253724098205566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6390213966369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([321, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.639498233795166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.639498233795166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6401104927062988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6541638374328613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6548933982849121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6548933982849121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6554064750671387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6732850074768066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([221, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6740908622741699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6740908622741699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6745123863220215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6896872520446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6902666091918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6902666091918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6905279159545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7017641067504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7024879455566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7024879455566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7027301788330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7148418426513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7154746055603027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7154746055603027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7156615257263184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.726315975189209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7268972396850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7268972396850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.727046012878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.736567497253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([51, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7369832992553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7369832992553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7370805740356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7439870834350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7444248199462891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7444248199462891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7445125579833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7513561248779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7518315315246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7518315315246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7519173622131348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7592129707336426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7595949172973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7595949172973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7596597671508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7656259536743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7659568786621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7659568786621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7660083770751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7711067199707031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7714128494262695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7714128494262695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7714567184448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7761068344116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7764081954956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7764081954956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7764482498168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7809743881225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([11, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7811341285705566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7811341285705566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7811551094055176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7836728096008301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7839913368225098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7839913368225098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7840275764465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7886300086975098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7888860702514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7888860702514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.788914680480957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7927484512329102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7929844856262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7929844856262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7930092811584473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7965054512023926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7968363761901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7968363761901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7968688011169434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8016676902770996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.801969051361084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.801969051361084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8019976615905762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8064322471618652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8065948486328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8065948486328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.806610107421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.80908203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8092823028564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8092823028564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8092994689941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8122005462646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([145, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.815676212310791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.815676212310791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8159527778625488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8646283149719238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 145, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8511543273925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8515701293945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8519859313964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8515491485595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2789, 40])
input nodes number: 10467
output nodes number: 2789
edges number: 16694
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8516521453857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.8516526222229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02965688705444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 3 input nodes size: 17655
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02769327163696289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02769327163696289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03611183166503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.036133766174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.019960403442382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.020429611206054688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.020429611206054688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.020429611206054688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17655, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.020429611206054688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([812, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.042922019958496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.042922019958496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04369640350341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04989147186279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([848, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05031299591064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05031299591064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05112171173095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06325244903564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([721, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06446218490600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06446218490600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06514978408813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08062601089477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([629, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08148193359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08148193359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08208179473876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09947776794433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([613, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10063934326171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10063934326171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10122394561767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12240457534790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([492, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1235198974609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1235198974609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12398910522460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1441650390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([411, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14530229568481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14530229568481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14569425582885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16529226303100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([369, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16664838790893555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16664838790893555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16700029373168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1870589256286621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([287, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.18811464309692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.18811464309692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 287, 128]), torch.Size([1, 287, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.18838834762573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.20590543746948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 287, 128])
m.shape torch.Size([2313, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2167978286743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2167978286743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2313, 128]), torch.Size([1, 2313, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21900367736816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3825240135192871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2313, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.36336421966552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3705120086669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.37765979766845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3704557418823242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7495, 256])
first layer input nodes number: 17655
first layer output nodes number: 7495
edges number: 44746
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3777933120727539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.38494110107421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3876633644104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3876633644104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([563, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40579748153686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40579748153686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40687131881713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.41551828384399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([439, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.41582536697387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.41582536697387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.41666269302368164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.42943429946899414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([329, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.429964542388916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.429964542388916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.43059206008911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4458274841308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([258, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4465060234069824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4465060234069824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44699811935424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46126890182495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([234, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46214771270751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46214771270751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46259403228759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.47866153717041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.47934961318969727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.47934961318969727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.47965097427368164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.49260950088500977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.49335384368896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.49335384368896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4936075210571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.506291389465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5070338249206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5070338249206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5072493553161621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5195345878601074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5201191902160645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5201191902160645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5202717781066895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5300374031066895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5305666923522949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5305666923522949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5306868553161621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5392184257507324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.539708137512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.539708137512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5398073196411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5475435256958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5482320785522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5482320785522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5483541488647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5587301254272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5592942237854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5592942237854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.559389591217041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5681633949279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5685329437255859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5685329437255859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5685920715332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5744457244873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5748777389526367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5748777389526367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5749387741088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5814085006713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5817780494689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5817780494689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5818276405334473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5874314308166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5877175331115723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5877175331115723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5877537727355957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5921025276184082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5926036834716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5926036834716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5926609039306641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5999279022216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6003561019897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6003561019897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6004037857055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6067934036254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6070771217346191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6070771217346191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6071076393127441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6114106178283691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6116375923156738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6116375923156738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6116604804992676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6150479316711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.615290641784668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.615290641784668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6153135299682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.618861198425293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6191153526306152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6191153526306152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.619138240814209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6228461265563965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6231579780578613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6231579780578613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6231846809387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6276974678039551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([132, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6308560371398926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6308560371398926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6311078071594238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6754193305969238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 132, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6606535911560059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6610856056213379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6615176200866699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6610636711120605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2897, 40])
input nodes number: 7495
output nodes number: 2897
edges number: 18169
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6611580848693848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.661158561706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02138376235961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 4 input nodes size: 22748
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.01997661590576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.01997661590576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.031089305877685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.031110286712646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02266979217529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.023212432861328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.023212432861328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.023212432861328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([22748, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.023212432861328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([728, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.050395965576171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.050395965576171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 728, 128]), torch.Size([1, 728, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.051090240478515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.056644439697265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 728, 128])
m.shape torch.Size([793, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.057053565979003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.057053565979003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05780982971191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0691537857055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([789, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07000350952148438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07000350952148438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0707559585571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0873098373413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([631, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08817195892333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08817195892333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 631, 128]), torch.Size([1, 631, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08877372741699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10622501373291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 631, 128])
m.shape torch.Size([577, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10800313949584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10800313949584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10855340957641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12836313247680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([485, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12947559356689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12947559356689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12993812561035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1498270034790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([427, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1512312889099121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1512312889099121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15163850784301758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17199945449829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([392, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17329120635986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17329120635986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 392, 128]), torch.Size([1, 392, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17366504669189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19497394561767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 392, 128])
m.shape torch.Size([328, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19619464874267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19619464874267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19650745391845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.21652698516845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([3267, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2319488525390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2319488525390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3267, 128]), torch.Size([1, 3267, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.23506450653076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4663238525390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3267, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44167137145996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44969844818115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.45772552490234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44963550567626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([8417, 256])
first layer input nodes number: 22748
first layer output nodes number: 8417
edges number: 54747
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4578971862792969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4659242630004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46793127059936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46793127059936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([468, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48573875427246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48573875427246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4866313934326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.49442386627197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([412, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4947695732116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4947695732116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.49555540084838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5089292526245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([325, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5094738006591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5094738006591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5100936889648438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5245895385742188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([264, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5253376960754395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5253376960754395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.525841236114502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5412650108337402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.542022705078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.542022705078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5424232482910156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5568428039550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.557553768157959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.557553768157959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5578551292419434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5708136558532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5716052055358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5716052055358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5718722343444824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5852236747741699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5859131813049316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5859131813049316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5861172676086426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.597750186920166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5984010696411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5984010696411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.598567008972168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.609187126159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.609748363494873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.609748363494873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6098761558532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6189494132995605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6197209358215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6197209358215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6198716163635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.631624698638916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6320686340332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6320686340332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6321544647216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6394500732421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.640019416809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.640019416809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6401128768920898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6487112045288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.649202823638916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.649202823638916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6492791175842285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.656832218170166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6572556495666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6572556495666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6573166847229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6637864112854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6641407012939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6641407012939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6641883850097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6695766448974609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.669896125793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.669896125793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6699361801147461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6747426986694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.675137996673584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.675137996673584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6751837730407715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.680997371673584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6812305450439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6812305450439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6812572479248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6848354339599609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6852068901062012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6852068901062012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6852450370788574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6906237602233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6909680366516113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6909680366516113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.691002368927002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6960835456848145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6962146759033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6962146759033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.69622802734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6982975006103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6984901428222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6984901428222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6985073089599609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7012882232666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7016258239746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7016258239746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7016544342041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7064895629882812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([131, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7096233367919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7096233367919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7098731994628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7538490295410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 131, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7391924858093262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7396049499511719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7400174140930176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7395839691162109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2767, 40])
input nodes number: 8417
output nodes number: 2767
edges number: 17925
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7396483421325684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7396488189697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02426004409790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 5 input nodes size: 17120
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02265024185180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02265024185180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.031068801879882812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.031090736389160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.01995706558227539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.020368099212646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.020368099212646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.020368099212646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17120, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.020368099212646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([741, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03945493698120117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03945493698120117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 741, 128]), torch.Size([1, 741, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0401616096496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04581499099731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 741, 128])
m.shape torch.Size([820, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04624366760253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04624366760253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04702568054199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0593724250793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([665, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.059932708740234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.059932708740234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06056690216064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0745854377746582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([615, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07544136047363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07544136047363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07602787017822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09382057189941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([507, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09473609924316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09473609924316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09521961212158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1126260757446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([410, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11355733871459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11355733871459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11394834518432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13076162338256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([352, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13174104690551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13174104690551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13207674026489258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.14886140823364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([329, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1499485969543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1499485969543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15026235580444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16814661026000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([256, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16908836364746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16908836364746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16933250427246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.18495750427246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([1893, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1938619613647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1938619613647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1893, 128]), torch.Size([1, 1893, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19566726684570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.32384395599365234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1893, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.30789947509765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3141822814941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.320465087890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3141331672668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6588, 256])
first layer input nodes number: 17120
first layer output nodes number: 6588
edges number: 38161
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.32059478759765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3275604248046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.328768253326416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.328768253326416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([533, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.34552812576293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.34552812576293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3465447425842285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.35506105422973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([455, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.35542774200439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.35542774200439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3562955856323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3693361282348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([342, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.37001848220825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.37001848220825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.37067079544067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.3860907554626465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([289, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.38687610626220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.38687610626220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.38742733001708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.403531551361084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([240, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40440940856933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40440940856933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.40486717224121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.42134666442871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([178, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.42214441299438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.42214441299438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4224839210510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.43708276748657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4377274513244629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4377274513244629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4379582405090332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44949769973754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4502897262573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4502897262573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4505147933959961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46334362030029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4640531539916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4640531539916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4642343521118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4758310317993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4765286445617676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4765286445617676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4766850471496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4877896308898926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48836708068847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48836708068847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48848533630371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4977092742919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.49833106994628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.49833106994628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.498443603515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5080089569091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5085902214050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5085902214050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5086874961853027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.517636775970459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5181670188903809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5181670188903809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5182490348815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5263686180114746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.526702880859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.526702880859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5267524719238281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5320091247558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5324149131774902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5324149131774902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.532468318939209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5385031700134277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5389995574951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5389995574951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5390605926513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5463848114013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5466313362121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5466313362121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5466618537902832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5505375862121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5507965087890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5507965087890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5508251190185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5546588897705078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5549139976501465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5549139976501465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5549407005310059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5587058067321777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5588541030883789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5588541030883789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5588693618774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5611276626586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5612258911132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5612258911132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5612354278564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.562713623046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5627532005310059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5627532005310059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5627570152282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5633749961853027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5634655952453613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5634655952453613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5634732246398926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5647625923156738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([84, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.566777229309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.566777229309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5669374465942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5951356887817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 84, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.581756591796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5821890830993652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5826215744018555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5821671485900879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2902, 40])
input nodes number: 6588
output nodes number: 2902
edges number: 16769
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5822582244873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5822587013244629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.021233558654785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 6 input nodes size: 24616
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.019977092742919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.019977092742919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03171491622924805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.031735897064208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02329540252685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.023866653442382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.023866653442382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.023866653442382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([24616, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.023866653442382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([764, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05246543884277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05246543884277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05319404602050781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05939435958862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([824, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05981588363647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05981588363647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06060171127319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07238912582397461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([739, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07335042953491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07335042953491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.07405519485473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08995676040649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([676, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09089374542236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.09089374542236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0915384292602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11023426055908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([675, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11152124404907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11152124404907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 675, 128]), torch.Size([1, 675, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11216497421264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13541173934936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 675, 128])
m.shape torch.Size([515, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13656330108642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13656330108642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.137054443359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1584477424621582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([454, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15971755981445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15971755981445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.16015052795410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.18179893493652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([411, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1831502914428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1831502914428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.18354225158691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.20588397979736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([349, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2071857452392578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2071857452392578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2075185775756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2288198471069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 349, 128])
m.shape torch.Size([3420, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24496126174926758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24496126174926758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3420, 128]), torch.Size([1, 3420, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24822282791137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48006725311279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3420, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4550056457519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4634237289428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.47184181213378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.46335792541503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([8827, 256])
first layer input nodes number: 24616
first layer output nodes number: 8827
edges number: 57605
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4720273017883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48044538497924805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48272132873535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48272132873535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([463, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5013957023620605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5013957023620605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5022788047790527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5107822418212891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([417, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5111427307128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5111427307128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5119380950927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5238800048828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([310, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.524376392364502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.524376392364502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5249676704406738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5386605262756348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([260, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5394735336303711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5394735336303711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5399694442749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5552034378051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([233, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5560755729675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5560755729675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5565199851989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5725188255310059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5733118057250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5733118057250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5736474990844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5880823135375977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5888228416442871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5888228416442871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5890803337097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6019549369812012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6026415824890137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6026415824890137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6028437614440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6143679618835449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6150197982788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6150197982788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6151857376098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6258058547973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6263861656188965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6263861656188965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6265177726745605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.635861873626709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6364202499389648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6364202499389648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6365327835083008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6453104019165039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6459002494812012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6459002494812012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6460070610046387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6550860404968262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6556077003479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6556077003479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6556954383850098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6637673377990723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6642217636108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6642217636108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6642923355102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6712789535522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6717629432678223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6717629432678223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6718316078186035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.679110050201416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6795988082885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6795988082885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6796636581420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6869916915893555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6872372627258301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6872372627258301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6872696876525879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6911606788635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6914386749267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6914386749267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6914710998535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6955890655517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6959567070007324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6959567070007324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6959967613220215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7013640403747559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7017288208007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7017288208007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7017669677734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7071456909179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7074899673461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7074899673461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.707524299621582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7126054763793945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7127366065979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7127366065979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7127499580383301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7148194313049316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7151226997375488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7151226997375488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7151494026184082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.719475269317627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.719785213470459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.719785213470459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7198119163513184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7243247032165527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([159, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7281322479248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7281322479248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7284355163574219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7818107604980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 159, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7663178443908691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7667369842529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7671561241149902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7667160034179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2811, 40])
input nodes number: 8827
output nodes number: 2811
edges number: 18834
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.766789436340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7667899131774902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.024978160858154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 7 input nodes size: 21964
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02328205108642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.02328205108642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03375530242919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03377723693847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0220184326171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.022569656372070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.022569656372070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.022569656372070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([21964, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.022569656372070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([703, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04936027526855469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04936027526855469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05003070831298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.055666446685791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([801, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.056095123291015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.056095123291015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05685901641845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06858253479003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([777, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06931209564208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.06931209564208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 777, 128]), torch.Size([1, 777, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0700531005859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08642816543579102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 777, 128])
m.shape torch.Size([697, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0873870849609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.0873870849609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 697, 128]), torch.Size([1, 697, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.08805179595947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10732841491699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 697, 128])
m.shape torch.Size([655, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10924482345581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10924482345581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10986948013305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1331486701965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([517, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13431549072265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13431549072265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13480854034423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1563119888305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([478, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15766096115112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15766096115112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15811681747436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1809096336364746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([398, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.18219995498657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.18219995498657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 398, 128]), torch.Size([1, 398, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.18257951736450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.20421457290649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 398, 128])
m.shape torch.Size([360, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.20556974411010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.20556974411010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.20591306686401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22788572311401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([3039, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24258661270141602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.24258661270141602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3039, 128]), torch.Size([1, 3039, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2454848289489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4588794708251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3039, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4348592758178711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44289398193359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4509286880493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.44283103942871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([8425, 256])
first layer input nodes number: 21964
first layer output nodes number: 8425
edges number: 53961
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4510946273803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.45912933349609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4612712860107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4612712860107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([462, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48152780532836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48152780532836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4824090003967285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.4894585609436035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([399, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48978519439697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.48978519439697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.49054622650146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.503049373626709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([334, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5036320686340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5036320686340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5042691230773926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5190391540527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([267, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.519747257232666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.519747257232666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.520256519317627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5350251197814941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([236, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5359048843383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5359048843383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5363550186157227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5525598526000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5533270835876465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5533270835876465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5536551475524902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5677618980407715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.568486213684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.568486213684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5687379837036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5813264846801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([134, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5822310447692871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5822310447692871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.582486629486084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5970549583435059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5978012084960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5978012084960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.5979938507080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6103229522705078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6109189987182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6109189987182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6110563278198242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6208066940307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6213092803955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6213092803955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6214122772216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6294460296630859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6301674842834473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6301674842834473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6302952766418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6411576271057129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6417312622070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6417312622070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6418285369873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6507778167724609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6512947082519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6512947082519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6513748168945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6593055725097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6597270965576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6597270965576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6597881317138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6662578582763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6666889190673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6666889190673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6667461395263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6732120513916016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6736903190612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6736903190612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6737494468688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.680844783782959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6812996864318848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6812996864318848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6813530921936035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6881356239318848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.688474178314209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.688474178314209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6885123252868652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6936240196228027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6939125061035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6939125061035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6939430236816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6982460021972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.698493480682373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.698493480682373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.6985182762145996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7021880149841309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7024717330932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7024717330932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7024984359741211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7066373825073242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7069339752197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7069339752197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7069606781005859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7112865447998047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7114577293395996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7114577293395996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7114729881286621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7140517234802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([173, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7182011604309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7182011604309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7185311317443848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7766060829162598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 173, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7596001625061035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7600326538085938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.760465145111084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7600107192993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2902, 40])
input nodes number: 8425
output nodes number: 2902
edges number: 19927
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7601089477539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.7601094245910645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.023668766021728516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 8 input nodes size: 46272
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.022031784057617188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.022031784057617188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.04409599304199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.044116973876953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.033621788024902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03497123718261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03497123718261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03497123718261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([46272, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03497123718261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([597, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10851001739501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10851001739501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.10907936096191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11386871337890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([580, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11413717269897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11413717269897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.11469030380249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12298727035522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([601, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12357044219970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12357044219970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.12414360046386719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13675308227539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([531, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13752079010009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13752079010009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.13802719116210938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15361690521240234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([576, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15473699569702148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15473699569702148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.15528631210327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.17531538009643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([510, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1764998435974121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1764998435974121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1769862174987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19790029525756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([517, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19938278198242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.19938278198242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.1998758316040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2252955436706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([531, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22707462310791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22707462310791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.22758102416992188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2573690414428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([518, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2593388557434082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.2593388557434082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.25983285903930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.29193639755249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([12574, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.35164690017700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.35164690017700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12574, 128]), torch.Size([1, 12574, 128])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.36363840103149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2150349617004395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12574, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1455907821655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.162313461303711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1790361404418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1621828079223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17535, 256])
first layer input nodes number: 46272
first layer output nodes number: 17535
edges number: 149893
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1793828010559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.1961054801940918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2006011009216309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2006011009216309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([345, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.230943202972412  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.230943202972412  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2316012382507324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2375493049621582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([273, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2377452850341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2377452850341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2382659912109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.248398780822754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([208, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2487382888793945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2487382888793945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2491350173950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2578630447387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([163, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2582917213439941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2582917213439941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2586026191711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2676186561584473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([153, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2681984901428223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2681984901428223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2684903144836426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2789959907531738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([118, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2795310020446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2795310020446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2797560691833496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2894339561462402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([99, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.289987564086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.289987564086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2901763916015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.2996177673339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([84, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3001694679260254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3001694679260254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3003296852111816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.309462070465088  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3100829124450684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3100829124450684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3102374076843262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3201251029968262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3206439018249512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3206439018249512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3207621574401855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3291583061218262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3297653198242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3297653198242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.329885482788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3392581939697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3399362564086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3399362564086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3400583267211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3504343032836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3509984016418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3509984016418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3510937690734863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3598675727844238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.360452651977539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.360452651977539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3605422973632812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3694171905517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.370007038116455  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.370007038116455  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3700909614562988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3789868354797363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.379514217376709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.379514217376709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.379584789276123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.387559413909912  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3880963325500488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3880963325500488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3881630897521973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3961739540100098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.396902084350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.396902084350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.3969860076904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.407644271850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4082417488098145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4082417488098145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.408308506011963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4172539710998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4177207946777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4177207946777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4177703857421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4247627258300781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.425222396850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.425222396850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4252681732177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4320430755615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.432528018951416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.432528018951416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4325737953186035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.439669132232666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4403319358825684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4403319358825684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4403910636901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.44996976852417  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4503788948059082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4503788948059082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4504151344299316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4565396308898926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([638, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4718518257141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4718518257141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 638, 256]), torch.Size([1, 638, 256])
----------------------------------------3
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.4730687141418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.7130279541015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 638, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.6853322982788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.6857447624206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.6861572265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.6857237815856934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2767, 40])
input nodes number: 17535
output nodes number: 2767
edges number: 31098
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.6858553886413574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 1.6858558654785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03730058670043945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 9 input nodes size: 48555
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03360176086425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03360176086425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.05703926086425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.057061195373535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.03497600555419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.036469459533691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.036469459533691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.036469459533691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([48555, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8319091796875 GB
    Memory Allocated: 0.036469459533691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([522, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1172022819519043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1172022819519043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11770009994506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12222814559936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([603, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12255430221557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12255430221557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12312936782836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13175535202026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([606, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13233470916748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13233470916748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 606, 128]), torch.Size([1, 606, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13291263580322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14622211456298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 606, 128])
m.shape torch.Size([576, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1470317840576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1470317840576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1475811004638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1635112762451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([619, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16471242904663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16471242904663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16530275344848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.18683528900146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([583, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.18820810317993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.18820810317993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.18876409530639648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.21352148056030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([589, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2152094841003418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2152094841003418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.21577119827270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24457073211669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([539, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24634599685668945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24634599685668945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24686002731323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.276613712310791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([574, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2788200378417969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2788200378417969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.27936744689941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.31580638885498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([13866, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3816509246826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3816509246826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13866, 128]), torch.Size([1, 13866, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39487457275390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3561649322509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13866, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.279749870300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.297943115234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.316136360168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2978005409240723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([19077, 256])
first layer input nodes number: 48555
first layer output nodes number: 19077
edges number: 164704
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.316500186920166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.334693431854248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.33949613571167  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.33949613571167  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([275, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3741936683654785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3741936683654785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.374718189239502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3793463706970215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([254, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3795723915100098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3795723915100098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3800568580627441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3873238563537598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([209, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3876843452453613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3876843452453613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3880829811096191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.396852970123291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([152, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3972382545471191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3972382545471191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3975281715393066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4059357643127441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([163, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4065742492675781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4065742492675781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4068851470947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4180774688720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([100, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4184989929199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4184989929199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4186897277832031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4268913269042969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.42756986618042  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.42756986618042  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4277892112731934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4387564659118652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.439300537109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.439300537109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.439462661743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4487037658691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.449263095855713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.449263095855713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.449404239654541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.458437442779541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.459280014038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.459280014038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4594612121582031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4723262786865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4730076789855957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4730076789855957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.473146915435791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4840073585510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4847221374511719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4847221374511719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4848518371582031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4958763122558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4965362548828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4965362548828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4966468811035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5068244934082031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5074691772460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5074691772460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.507568359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5173873901367188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5183472633361816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5183472633361816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5184807777404785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5326333045959473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5333971977233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5333971977233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5335001945495605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5451388359069824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5459208488464355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5459208488464355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.546018123626709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5576910972595215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5585250854492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5585250854492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5586223602294922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5709762573242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5716948509216309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5716948509216309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.571774959564209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5825095176696777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.583315372467041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.583315372467041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5833992958068848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5952324867248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5970478057861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5970478057861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5971546173095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6129627227783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6133747100830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6133747100830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6134166717529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6199207305908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6204304695129395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6204304695129395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.620476245880127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.627892017364502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.628584384918213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.628584384918213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.62864351272583  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6386361122131348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([709, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6556425094604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6556425094604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6569948196411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.9051580429077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 709, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.8731613159179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.8735976219177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.8740339279174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.8735756874084473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2927, 40])
input nodes number: 19077
output nodes number: 2927
edges number: 35693
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.8737640380859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.8737645149230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03907585144042969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 10 input nodes size: 40599
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.034999847412109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.034999847412109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.054531097412109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05455207824707031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03109264373779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.032398223876953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.032398223876953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.032398223876953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([40599, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.032398223876953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([450, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10113096237182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10113096237182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10156011581420898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10499334335327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([548, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1053013801574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1053013801574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10582399368286133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11411809921264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([500, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11457204818725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11457204818725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11504888534545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12553930282592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([469, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12619543075561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12619543075561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12664270401000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13961362838745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([462, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14049148559570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14049148559570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1409320831298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15679359436035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([475, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15793228149414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15793228149414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1583852767944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17786407470703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([521, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17937660217285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17937660217285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17987346649169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.20491933822631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([517, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.20664310455322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.20664310455322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2071361541748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.23673152923583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([541, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.23880672454833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.23880672454833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.23932266235351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2730879783630371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([11748, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.32884883880615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.32884883880615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11748, 128]), torch.Size([1, 11748, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.34005260467529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1355199813842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11748, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0704874992370605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0859665870666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1014456748962402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0858454704284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16231, 256])
first layer input nodes number: 40599
first layer output nodes number: 16231
edges number: 140214
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.101750373840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1172294616699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.121281623840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.121281623840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([287, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1552209854125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1552209854125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1557683944702148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.160792350769043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([250, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1609992980957031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1609992980957031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1614761352539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1686286926269531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([195, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1689529418945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1689529418945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1693248748779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1775074005126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([126, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1778059005737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1778059005737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1780462265014648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1850156784057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([115, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.185448169708252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.185448169708252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1856675148010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1935639381408691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([108, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.194077491760254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.194077491760254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1942834854125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.203141212463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([92, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.203657627105713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.203657627105713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2038331031799316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2126069068908691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([71, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2130651473999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2130651473999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.213200569152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2209196090698242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2216825485229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2216825485229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2218656539916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2335844039916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.23406982421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.23406982421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2341842651367188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2423095703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2429399490356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2429399490356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2430639266967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2527341842651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2533531188964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2533531188964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2534656524658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.263031005859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2635746002197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2635746002197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2636661529541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2720890045166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2726893424987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2726893424987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2727808952331543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2818446159362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2823901176452637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2823901176452637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.282468318939209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.290757656097412  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.291287899017334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.291287899017334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.291358470916748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.299333095550537  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.299787998199463  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.299787998199463  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2998452186584473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3067116737365723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.30751371383667  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.30751371383667  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.307605266571045  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.31923246383667  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.319990634918213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.319990634918213  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3200745582580566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3313202857971191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3319706916809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3319706916809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3320393562316895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3417210578918457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.342252254486084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.342252254486084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3423056602478027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3502097129821777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3508810997009277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3508810997009277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3509440422058105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3607001304626465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.361088752746582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.361088752746582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3611249923706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3669958114624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.367739200592041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.367739200592041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3678021430969238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3784394264221191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([789, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3980073928833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3980073928833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 789, 256]), torch.Size([1, 789, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3995122909545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6651911735534668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 789, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6339092254638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6343202590942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6347312927246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6342992782592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 16231
output nodes number: 2758
edges number: 34899
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.634416103363037  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6344165802001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.034636497497558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 11 input nodes size: 45940
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.052973270416259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0529942512512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.033442020416259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0346064567565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0346064567565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0346064567565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([45940, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0346064567565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([626, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09856128692626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09856128692626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09915828704833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10427188873291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([733, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10467243194580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10467243194580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10537147521972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11585712432861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([668, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11646318435668945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11646318435668945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11710023880004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13146638870239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([598, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13231801986694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13231801986694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1328883171081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14942693710327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([626, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15116357803344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15116357803344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15176057815551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17325258255004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([556, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1745753288269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1745753288269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17510557174682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1983485221862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([496, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1997389793395996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1997389793395996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2002120018005371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2238631248474121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([488, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.22548818588256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.22548818588256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2259535789489746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.25248098373413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([470, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.25426530838012695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.25426530838012695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2547135353088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2834000587463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([10565, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3335537910461426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3335537910461426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10565, 128]), torch.Size([1, 10565, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3436293601989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0589947700500488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10565, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.9991135597229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0142064094543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.029299259185791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0140881538391113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15826, 256])
first layer input nodes number: 45940
first layer output nodes number: 15826
edges number: 130210
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0296435356140137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.044736385345459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0486578941345215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0486578941345215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0740737915039062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0740737915039062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0748462677001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0826101303100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([359, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0829143524169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0829143524169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0835990905761719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0959882736206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([242, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.096343994140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.096343994140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0968055725097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1069602966308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([190, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1074600219726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1074600219726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1078224182128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1183319091796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.119035243988037  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.119035243988037  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1193861961364746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1320204734802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([126, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1325716972351074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1325716972351074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1328120231628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.14314603805542  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([104, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.143725872039795  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.143725872039795  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1439242362976074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1538424491882324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([88, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1544198989868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1544198989868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.154587745666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1641550064086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.164720058441162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.164720058441162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.164863109588623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.174018383026123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1746296882629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1746296882629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1747651100158691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.184380054473877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1849045753479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1849045753479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.185011386871338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.193342685699463  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1938776969909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1938776969909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1939749717712402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2022433280944824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2026948928833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2026948928833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2027711868286133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2097902297973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2104387283325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2104387283325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.210536003112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2201662063598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.220550537109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.220550537109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2206077575683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2266731262207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2272753715515137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2272753715515137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.227353572845459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2361903190612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2365927696228027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2365927696228027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2366442680358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2428240776062012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2431445121765137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2431445121765137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.24318265914917  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2480273246765137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2485928535461426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2485928535461426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2486538887023926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2568325996398926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2573022842407227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2573022842407227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2573518753051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2643442153930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.264824390411377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.264824390411377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2648720741271973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2719292640686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2722649574279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2722649574279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2722973823547363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2773232460021973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2776832580566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2776832580566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2777156829833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.282968521118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2834367752075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2834367752075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2834768295288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2902460098266602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([460, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.301279067993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.301279067993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3021564483642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4662203788757324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 460, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.443631649017334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.444042682647705  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4444537162780762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4440217018127441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 15826
output nodes number: 2758
edges number: 25911
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4441609382629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4441614151000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03669309616088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 12 input nodes size: 44995
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.033442020416259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.033442020416259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.054926395416259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0549473762512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0344233512878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0344233512878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0344233512878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([44995, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0344233512878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([553, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11111640930175781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11111640930175781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11164379119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11624336242675781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([600, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11655187606811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11655187606811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11712408065795898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12570714950561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([569, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1262350082397461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1262350082397461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12677764892578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13965988159179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([556, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14044904708862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14044904708862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14097929000854492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1563563346862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([518, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15732622146606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15732622146606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1578202247619629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1761622428894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([515, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17738866806030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17738866806030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17787981033325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19931268692016602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([458, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.20059585571289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.20059585571289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2010326385498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2228717803955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([463, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.22441959381103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.22441959381103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.22486114501953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2500295639038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([468, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2518172264099121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2518172264099121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.25226354598999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.28082799911499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([13392, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.34505796432495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.34505796432495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13392, 128]), torch.Size([1, 13392, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.35782957077026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2676043510437012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13392, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1945452690124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.211799144744873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.229053020477295  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2116641998291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([18092, 256])
first layer input nodes number: 44995
first layer output nodes number: 18092
edges number: 156406
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2293906211853027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2466444969177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.25095796585083  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.25095796585083  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([340, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.281996726989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.281996726989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2826452255249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2887840270996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([281, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2890000343322754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2890000343322754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2895359992980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3019471168518066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([217, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3023052215576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3023052215576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3027191162109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3118247985839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([168, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3122639656066895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3122639656066895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.312584400177002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3218770027160645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([143, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.322404384613037  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.322404384613037  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3226771354675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.332496166229248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([112, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3330059051513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3330059051513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3332195281982422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3424053192138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([86, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3428773880004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3428773880004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3430414199829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.351243019104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([61, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3516302108764648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3516302108764648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3517465591430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3583784103393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3589606285095215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3589606285095215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3591017723083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3681349754333496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3687472343444824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3687472343444824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.368882656097412  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.37849760055542  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3790960311889648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3790960311889648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.379216194152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3885889053344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.389197826385498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.389197826385498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3893084526062012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3987116813659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3992061614990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3992061614990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3992900848388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4070110321044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.407494068145752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.407494068145752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4075684547424316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4149327278137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4153857231140137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4153857231140137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4154505729675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4223246574401855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.422800064086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.422800064086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4228630065917969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4299755096435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.430434226989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.430434226989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4304914474487305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4373579025268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4381251335144043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4381251335144043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4382128715515137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4493556022644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4499144554138184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4499144554138184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4499773979187012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.458411693572998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.459014892578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.459014892578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4590778350830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4679527282714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4684462547302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4684462547302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4684958457946777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4758353233337402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.47627592086792  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.47627592086792  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4763178825378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4828219413757324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4834423065185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4834423065185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4834976196289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4924583435058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4928693771362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4928693771362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.492905616760254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4990301132202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([697, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5157599449157715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5157599449157715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 697, 256]), torch.Size([1, 697, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5170893669128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.7571558952331543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 697, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.7287006378173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.729112148284912  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.7295236587524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.7290911674499512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2759, 40])
input nodes number: 18092
output nodes number: 2759
edges number: 31826
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.7292475700378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.729248046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03683662414550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 13 input nodes size: 45784
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05485248565673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05487346649169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03336811065673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03457450866699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03457450866699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03457450866699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([45784, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03457450866699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([689, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10097408294677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10097408294677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10163116455078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10717964172363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([701, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10751962661743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10751962661743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 701, 128]), torch.Size([1, 701, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10818815231323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11821603775024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 701, 128])
m.shape torch.Size([657, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11882162094116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11882162094116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 657, 128]), torch.Size([1, 657, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11944818496704102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1338944435119629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 657, 128])
m.shape torch.Size([580, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1346874237060547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1346874237060547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1352405548095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15141868591308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([613, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1526036262512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1526036262512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15318822860717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17476558685302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([528, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17598390579223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17598390579223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17648744583129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19903993606567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([563, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2006673812866211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2006673812866211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2012042999267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.22858762741088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([508, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2302570343017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2302570343017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2307415008544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.25835609436035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([471, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2601351737976074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2601351737976074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.26058435440063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.28933191299438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([10979, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3418416976928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3418416976928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10979, 128]), torch.Size([1, 10979, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3523120880126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1082124710083008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10979, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0459809303283691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0615153312683105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.077049732208252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0613937377929688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16289, 256])
first layer input nodes number: 45784
first layer output nodes number: 16289
edges number: 134649
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0773930549621582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0929274559020996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0968213081359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0968213081359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([399, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1235194206237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1235194206237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1242804527282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1323180198669434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([322, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1325569152832031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1325569152832031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1331710815429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1426520347595215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([247, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1430573463439941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1430573463439941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1435284614562988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.153892993927002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([179, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.154345989227295  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.154345989227295  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1546874046325684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.164588451385498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.165287971496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.165287971496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.165633201599121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1780614852905273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([130, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1786389350891113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1786389350891113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.178886890411377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1895489692687988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.190185546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.190185546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1904010772705078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2011775970458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([93, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2017850875854492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2017850875854492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2019624710083008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2120733261108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([65, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2125473022460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2125473022460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2126712799072266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2206058502197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2212457656860352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2212457656860352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2213850021362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2312707901000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2317619323730469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2317619323730469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.231863021850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2397480010986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.240285873413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.240285873413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2403831481933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2486515045166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.249152660369873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.249152660369873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2492365837097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2569575309753418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2574000358581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2574000358581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2574687004089355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2642664909362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.264866828918457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.264866828918457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2649507522583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2738466262817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2743892669677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2743892669677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2744617462158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2826519012451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2832856178283691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2832856178283691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2833638191223145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.292747974395752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2933144569396973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2933144569396973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2933812141418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3018593788146973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3023738861083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3023738861083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3024311065673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.310098648071289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.310685157775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.310685157775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.310746192932129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.319352149963379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3197860717773438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3197860717773438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3198299407958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3263225555419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.32666015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.32666015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3266925811767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3317184448242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3322548866271973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3322548866271973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3323025703430176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3400273323059082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.340418815612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.340418815612793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3404531478881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3462553024291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([491, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3580937385559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3580937385559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3590302467346191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5308070182800293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 491, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5069313049316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5073456764221191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5077600479125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5073246955871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2780, 40])
input nodes number: 16289
output nodes number: 2780
edges number: 27250
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5074701309204102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5074706077575684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03672504425048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 14 input nodes size: 36666
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0333709716796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0333709716796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0509490966796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05097055435180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.029118061065673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.030434131622314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.030434131622314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.030434131622314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([36666, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.030434131622314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([420, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09897708892822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09897708892822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09937763214111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10258197784423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([469, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1028289794921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1028289794921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10327625274658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1099853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([462, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11042261123657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11042261123657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11086320877075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12055635452270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([431, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12115812301635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12115812301635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12156915664672852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13348913192749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([425, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13494491577148438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13494491577148438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13535022735595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14994144439697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([455, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15104055404663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15104055404663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1514744758605957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17013311386108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([446, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17140483856201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17140483856201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1718301773071289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19309711456298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([422, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19449424743652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19449424743652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19489669799804688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2178363800048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([435, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.21950197219848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.21950197219848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.21991682052612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24646711349487305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([12014, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3035469055175781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3035469055175781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12014, 128]), torch.Size([1, 12014, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3150043487548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1307039260864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12014, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0655922889709473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0808310508728027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0960698127746582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.080711841583252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15979, 256])
first layer input nodes number: 36666
first layer output nodes number: 15979
edges number: 139876
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0963449478149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1115837097167969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1158761978149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1158761978149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([252, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1514887809753418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1514887809753418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1519694328308105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1558146476745605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([211, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.155980110168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.155980110168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1563825607299805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.162419319152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([194, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1627779006958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1627779006958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1631479263305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1712884902954102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([162, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1717267036437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1717267036437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1720356941223145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1809964179992676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([125, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1814427375793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1814427375793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1816811561584473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1902642250061035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([105, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1907505989074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1907505989074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.190950870513916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1995625495910645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.20005464553833  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.20005464553833  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2002224922180176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2086148262023926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([87, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2091999053955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2091999053955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2093658447265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2188243865966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2194857597351074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2194857597351074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2196497917175293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2301478385925293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2306427955627441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2306427955627441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.230757236480713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2388825416564941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([84, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2397136688232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2397136688232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2398738861083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.252370834350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2531676292419434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2531676292419434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.253312587738037  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2656340599060059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2662739753723145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2662739753723145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2663826942443848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2763848304748535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2770438194274902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2770438194274902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2771449089050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2871527671813965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2878808975219727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2878808975219727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2879838943481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2989015579223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2995576858520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2995576858520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2996454238891602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3095598220825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3102025985717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3102025985717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3102827072143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3198957443237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3206171989440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3206171989440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3207011222839355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3313593864440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.332066535949707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.332066535949707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3321447372436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3426237106323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.343430519104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.343430519104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3435144424438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3553476333618164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3561534881591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3561534881591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3562335968017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3680896759033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3687052726745605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3687052726745605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3687644004821777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3779292106628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3784966468811035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3784966468811035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3785481452941895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3868908882141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.387742042541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.387742042541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3878145217895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4000635147094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([788, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4197053909301758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4197053909301758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 788, 256]), torch.Size([1, 788, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.421208381652832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.685734748840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 788, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.652860164642334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6532831192016602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6537060737609863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.653261661529541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2837, 40])
input nodes number: 15979
output nodes number: 2837
edges number: 36672
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6534109115600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6534113883972168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.032695770263671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 15 input nodes size: 42746
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.029126644134521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.029126644134521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.049509525299072266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0495305061340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03193092346191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03321266174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03321266174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03321266174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([42746, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03321266174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([581, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10354089736938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10354089736938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1040949821472168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10852766036987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([625, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10884666442871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10884666442871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10944271087646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11838340759277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([542, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11886072158813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11886072158813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11937761306762695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1317152976989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([536, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13247919082641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13247919082641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13299036026000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14781427383422852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([533, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14882946014404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14882946014404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1493377685546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16850614547729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([486, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16964244842529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16964244842529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1701059341430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19003582000732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([487, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19142961502075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19142961502075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1918940544128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.21511602401733398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([435, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.21654319763183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.21654319763183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.21695804595947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24060440063476562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([463, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2423839569091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2423839569091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24282550811767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2710847854614258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([12021, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3281846046447754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3281846046447754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12021, 128]), torch.Size([1, 12021, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3396487236022949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.156113624572754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12021, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.0897712707519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1057062149047852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1216411590576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.105581283569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16709, 256])
first layer input nodes number: 42746
first layer output nodes number: 16709
edges number: 142448
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1219615936279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1378965377807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1423120498657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1423120498657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([367, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.171102523803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.171102523803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1718025207519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1785778999328613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([319, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1788411140441895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1788411140441895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1794495582580566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1887321472167969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([218, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1890568733215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1890568733215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1894726753234863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.198620319366455  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([179, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1991009712219238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1991009712219238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.1994423866271973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.209343433380127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([142, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.209855556488037  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.209855556488037  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2101263999938965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.219876766204834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([107, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2203588485717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2203588485717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2205629348754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2293386459350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([90, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.229842185974121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.229842185974121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2300138473510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2385969161987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([64, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2390031814575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2390031814575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2391252517700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2460832595825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2468180656433105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2468180656433105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2469935417175293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2582240104675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2589631080627441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2589631080627441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.259127140045166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2707734107971191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.271294116973877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.271294116973877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2714028358459473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2798829078674316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2804861068725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2804861068725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.280594825744629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2898359298706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2904815673828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.2904815673828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.29058837890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3004150390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3008732795715332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3008732795715332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.30094575881958  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3081212043762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3086762428283691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3086762428283691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3087544441223145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3170437812805176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.317589282989502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.317589282989502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3176617622375488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3258519172668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.326436996459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.326436996459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3265094757080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3352069854736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3356900215148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3356900215148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.335747241973877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3430142402648926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3435521125793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3435521125793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.343611240386963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.351534366607666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3520817756652832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3520817756652832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3521389961242676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3602070808410645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3607439994812012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3607439994812012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.36079740524292  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.368701457977295  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3691825866699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3691825866699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3692283630371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3763236999511719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.376720905303955  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.376720905303955  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3767571449279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3826279640197754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3830251693725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3830251693725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3830595016479492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3888616561889648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([590, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4030213356018066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.4030213356018066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.404146671295166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.6031689643859863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 590, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5770726203918457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.577484130859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5778956413269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.577463150024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2759, 40])
input nodes number: 16709
output nodes number: 2759
edges number: 29461
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5775976181030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.5775980949401855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03542804718017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 16 input nodes size: 11402
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03191947937011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03191947937011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03735637664794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03737831115722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.016974449157714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.017360687255859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.017360687255859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.017360687255859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([11402, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.017360687255859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([659, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03412818908691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03412818908691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03475666046142578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03978443145751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([651, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04009103775024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04009103775024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04071187973022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05002450942993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([638, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05062675476074219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05062675476074219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.051235198974609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0646209716796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([559, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0653829574584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0653829574584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06591606140136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0817270278930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([489, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0826263427734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0826263427734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08309268951416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09988117218017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([379, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10073232650756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10073232650756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10109376907348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11663579940795898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([326, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11754322052001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11754322052001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11785411834716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13339900970458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([299, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1343841552734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1343841552734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13466930389404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1509227752685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([253, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15186595916748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15186595916748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15210723876953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16754913330078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([1573, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17492914199829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17492914199829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1573, 128]), torch.Size([1, 1573, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17642927169799805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.283205509185791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1573, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.26913976669311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.27469587326049805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.28025197982788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.27465200424194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5826, 256])
first layer input nodes number: 11402
first layer output nodes number: 5826
edges number: 33511
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.28033924102783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.28589534759521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.28742504119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.28742504119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([450, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.30556488037109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.30556488037109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3064231872558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.31370067596435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([397, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.31403493881225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.31403493881225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3147921562194824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.32619619369506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([346, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3268260955810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3268260955810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3274860382080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.34282827377319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([293, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3436250686645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3436250686645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.34418392181396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.36039066314697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([224, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3611879348754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3611879348754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3616151809692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3769960403442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.37782859802246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.37782859802246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3781566619873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39226341247558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([176, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3932838439941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3932838439941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3936195373535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4104042053222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([132, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4112858772277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4112858772277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.41153764724731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4258885383605957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42670583724975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42670583724975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4269137382507324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4402194023132324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4409036636352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4409036636352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.44106006622314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4521646499633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4527740478515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4527740478515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4528980255126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4625682830810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46332550048828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46332550048828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46346092224121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4749717712402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4755539894104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4755539894104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47565317153930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48477792739868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4853477478027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4853477478027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48543548583984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4941215515136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4946112632751465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4946112632751465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49468183517456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5021624565124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5026655197143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5026655197143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5027322769165039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5102758407592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5106348991394043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5106348991394043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5106806755065918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5161738395690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5164799690246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5164799690246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5165162086486816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5211186408996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5215573310852051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5215573310852051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5216050148010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5279946327209473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.528355598449707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.528355598449707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5283937454223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5337724685668945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5339756011962891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5339756011962891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.53399658203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5371017456054688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5373663902282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5373663902282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.537391185760498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5412344932556152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5414433479309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5414433479309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5414624214172363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5445523262023926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5447273254394531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5447273254394531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5447425842285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5473213195800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([81, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.549260139465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.549260139465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5494146347045898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5766057968139648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5617766380310059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5622086524963379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5626406669616699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5621867179870605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2898, 40])
input nodes number: 5826
output nodes number: 2898
edges number: 18286
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5622730255126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5622735023498535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018153667449951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 17 input nodes size: 14827
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.016994953155517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.016994953155517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.024065017700195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.024086952209472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01862812042236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.019115447998046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.019115447998046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.019115447998046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14827, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.019115447998046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([621, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.041475772857666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.041475772857666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0420680046081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04680585861206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([667, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.047145843505859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.047145843505859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 667, 128]), torch.Size([1, 667, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.047781944274902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.057917118072509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 667, 128])
m.shape torch.Size([614, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05847740173339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05847740173339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.059062957763671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0719451904296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([546, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0726938247680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0726938247680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07321453094482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0887441635131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([506, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0896902084350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0896902084350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09017276763916016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1075448989868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([422, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10851097106933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10851097106933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10891342163085938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1262187957763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([379, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12728261947631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12728261947631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12764406204223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14571619033813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([327, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14678287506103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14678287506103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1470947265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1648702621459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([307, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1660318374633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1660318374633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 307, 128]), torch.Size([1, 307, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16632461547851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.18506240844726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 307, 128])
m.shape torch.Size([2394, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19633150100708008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19633150100708008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2394, 128]), torch.Size([1, 2394, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19861459732055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.36190366744995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2394, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3423800468444824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.348848819732666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3553175926208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3487982749938965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6783, 256])
first layer input nodes number: 14827
first layer output nodes number: 6783
edges number: 43015
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.35543012619018555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.36202383041381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3641819953918457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3641819953918457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([406, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3863511085510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3863511085510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.38712549209594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39345741271972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([391, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39382219314575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39382219314575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39456796646118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40638208389282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([314, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40691471099853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40691471099853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4075136184692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42070674896240234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([252, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42137622833251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42137622833251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4218568801879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43579578399658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([212, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4366130828857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4366130828857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43701744079589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45157432556152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45226621627807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45226621627807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4525618553161621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4652743339538574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4661226272583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4661226272583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46640491485595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48051929473876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4812474250793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4812474250793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4814629554748535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49374818801879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49455738067626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49455738067626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49475955963134766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5076990127563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.508549690246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.508549690246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5087385177612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5221452713012695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([95, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5230555534362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5230555534362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5232367515563965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5373702049255371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5378909111022949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5378909111022949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.537992000579834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5465846061706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5473089218139648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5473089218139648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5474271774291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5583066940307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5588936805725098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5588936805725098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5589852333068848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5680489540100098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.568580150604248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.568580150604248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5686564445495605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5767436027526855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5773515701293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5773515701293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5774316787719727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5864839553833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5868034362792969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5868034362792969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5868453979492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5918807983398438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5923271179199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5923271179199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5923786163330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5989189147949219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.599550724029541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.599550724029541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5996193885803223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6088204383850098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6093440055847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6093440055847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6093993186950684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6171984672546387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6175947189331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6175947189331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6176347732543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6235628128051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6239447593688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6239447593688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6239809989929199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6295981407165527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6299118995666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6299118995666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6299405097961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.634575366973877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6349301338195801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6349301338195801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6349606513977051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6401181221008301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([203, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6449809074401855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6449809074401855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6453680992126465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7135138511657715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 203, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6945509910583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6949868202209473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6954226493835449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6949648857116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2924, 40])
input nodes number: 6783
output nodes number: 2924
edges number: 22230
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6950411796569824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6950416564941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.020067691802978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 18 input nodes size: 13209
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018631935119628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018631935119628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.024930477142333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.024952411651611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01786041259765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018217086791992188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018217086791992188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018217086791992188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13209, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018217086791992188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([791, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03442096710205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03442096710205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.035175323486328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.041927337646484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([875, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04238462448120117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04238462448120117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 875, 128]), torch.Size([1, 875, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04321908950805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.055937767028808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 875, 128])
m.shape torch.Size([715, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05654335021972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05654335021972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 715, 128]), torch.Size([1, 715, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05722522735595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07222652435302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 715, 128])
m.shape torch.Size([594, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07301855087280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07301855087280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07358503341674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09058284759521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([465, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09140825271606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09140825271606445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09185171127319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10781621932983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([403, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10874748229980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10874748229980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 403, 128]), torch.Size([1, 403, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1091318130493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1256580352783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 403, 128])
m.shape torch.Size([315, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12651729583740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12651729583740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 315, 128]), torch.Size([1, 315, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1268177032470703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14183807373046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 315, 128])
m.shape torch.Size([285, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1427750587463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1427750587463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 285, 128]), torch.Size([1, 285, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14304685592651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1585392951965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 285, 128])
m.shape torch.Size([224, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1593647003173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1593647003173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 224, 128]), torch.Size([1, 224, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1595783233642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1732501983642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 224, 128])
m.shape torch.Size([1389, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17976665496826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17976665496826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1389, 128]), torch.Size([1, 1389, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.18109130859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2759103775024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1389, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2626628875732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.26843833923339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2742137908935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.26839303970336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6056, 256])
first layer input nodes number: 13209
first layer output nodes number: 6056
edges number: 32196
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.27431440353393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2800898551940918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.28229475021362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.28229475021362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([559, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2979583740234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2979583740234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2990245819091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.30927562713623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 559, 256])
m.shape torch.Size([486, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3096771240234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3096771240234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3106040954589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3256654739379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([362, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3262457847595215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3262457847595215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3269362449645996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.34212636947631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([286, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3429532051086426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3429532051086426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.34349870681762695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.35994386672973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([223, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.36074304580688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.36074304580688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.36116838455200195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3764805793762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3772621154785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3772621154785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3775901794433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3916969299316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39241456985473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39241456985473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39266443252563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40515756607055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4059786796569824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4059786796569824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40621328353881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4195857048034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42018651962280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42018651962280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42034482955932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43047666549682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43122434616088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43122434616088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43138837814331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.44303464889526367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.44362926483154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.44362926483154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.44375133514404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45327281951904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4536733627319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4536733627319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4537496566772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4602346420288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46060895919799805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46060895919799805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46067190170288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4664626121520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4668617248535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4668617248535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4669227600097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4729652404785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47339630126953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47339630126953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47345733642578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47992706298828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48018884658813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48018884658813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4802250862121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48432016372680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48462915420532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48462915420532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4846673011779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4892449378967285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48969316482543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48969316482543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4897446632385254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49628496170043945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4964418411254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4964418411254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4964609146118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49901676177978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49918031692504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49918031692504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49919748306274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5016179084777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5017709732055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5017709732055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5017862319946289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5040445327758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5042061805725098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5042061805725098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5042214393615723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5065865516662598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5067338943481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5067338943481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5067472457885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5089101791381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5091114044189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5091114044189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5091285705566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5120296478271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([57, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5133910179138184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5133910179138184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5134997367858887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5326342582702637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5203771591186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5208072662353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5212373733520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5207853317260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2886, 40])
input nodes number: 6056
output nodes number: 2886
edges number: 15603
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5208468437194824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5208473205566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018952369689941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 19 input nodes size: 9514
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.017854690551757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.017854690551757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.022391319274902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.022413253784179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.016092777252197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.016431331634521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.016431331634521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.016431331634521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([9514, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.016431331634521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([753, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.030607223510742188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.030607223510742188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 753, 128]), torch.Size([1, 753, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.031325340270996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.037070274353027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 753, 128])
m.shape torch.Size([754, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0374302864074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0374302864074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 754, 128]), torch.Size([1, 754, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.038149356842041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.049483299255371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 754, 128])
m.shape torch.Size([640, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05003929138183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05003929138183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 640, 128]), torch.Size([1, 640, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05064964294433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0648813247680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 640, 128])
m.shape torch.Size([533, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06559276580810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06559276580810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06610107421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0810537338256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([472, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0819249153137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0819249153137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08237504959106445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09857988357543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([379, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09943914413452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09943914413452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09980058670043945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11534261703491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([315, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11621332168579102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11621332168579102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 315, 128]), torch.Size([1, 315, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11651372909545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13153409957885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 315, 128])
m.shape torch.Size([255, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1323566436767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1323566436767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1325998306274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14646148681640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([229, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1473226547241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1473226547241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 229, 128]), torch.Size([1, 229, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14754104614257812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16151809692382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 229, 128])
m.shape torch.Size([1085, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16658258438110352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16658258438110352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1676173210144043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24289560317993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.23184823989868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.23701238632202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24217653274536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.23697185516357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5415, 256])
first layer input nodes number: 9514
first layer output nodes number: 5415
edges number: 28103
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2422494888305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24741363525390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24924945831298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24924945831298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([486, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2663536071777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2663536071777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.26728057861328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2754244804382324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([449, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.27582454681396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.27582454681396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.27668094635009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.29016590118408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([349, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.29096412658691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.29096412658691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2916297912597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3062744140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3068838119506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3068838119506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.30735111236572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.32090282440185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([245, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3219766616821289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3219766616821289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.32244396209716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3392667770385742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([194, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3401522636413574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3401522636413574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.34052228927612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3564333915710449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([169, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.35738563537597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.35738563537597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3577079772949219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3738250732421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.37462520599365234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.37462520599365234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3748636245727539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.38845348358154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3891563415527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3891563415527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.38933753967285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40093421936035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4017186164855957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4017186164855957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40189218521118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4142155647277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4147529602050781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4147529602050781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.41486549377441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4236431121826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42427921295166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42427921295166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4243936538696289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43412113189697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4346637725830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4346637725830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4347553253173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4431781768798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4436306953430176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4436306953430176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.44370126724243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45068788528442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4512295722961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4512295722961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4513058662414551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4593930244445801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45973968505859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45973968505859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45978736877441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4651756286621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4655933380126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4655933380126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46564483642578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47182464599609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4721798896789551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4721798896789551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47222185134887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4775509834289551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47773122787475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47773122787475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4777522087097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4805636405944824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4808225631713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4808225631713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4808492660522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48461437225341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48484325408935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48484325408935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4848661422729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4882535934448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48841142654418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48841142654418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48842668533325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49079179763793945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4910273551940918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4910273551940918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49104833602905273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4944472312927246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4946446418762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4946446418762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.494661808013916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49756288528442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([67, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4991645812988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4991645812988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49929237365722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5217838287353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5080304145812988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5084624290466309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5088944435119629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5084404945373535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2898, 40])
input nodes number: 5415
output nodes number: 2898
edges number: 17175
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5085048675537109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5085053443908691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01712656021118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 20 input nodes size: 23817
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.016094684600830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.016094684600830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.027451515197753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.02747344970703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.022914886474609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.023576736450195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.023576736450195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.023576736450195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([23817, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.023576736450195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([566, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05590963363647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05590963363647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05644941329956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06076765060424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([633, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.061101436614990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.061101436614990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06170511245727539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07132816314697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([602, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07188749313354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07188749313354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07246160507202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08509206771850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([607, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08596277236938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08596277236938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08654165267944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10422372817993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([557, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10526227951049805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10526227951049805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10579347610473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1251678466796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([498, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1263270378112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1263270378112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1268019676208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14722394943237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([498, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14864873886108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14864873886108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1491236686706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17287015914916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([449, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1743454933166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1743454933166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1747736930847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19918107986450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([367, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.20054197311401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.20054197311401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.20089197158813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.22329187393188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([4145, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24288177490234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24288177490234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4145, 128]), torch.Size([1, 4145, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.24683475494384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.527496337890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4145, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4983530044555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.506861686706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5153703689575195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5067949295043945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([8922, 256])
first layer input nodes number: 23817
first layer output nodes number: 8922
edges number: 63670
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5155501365661621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5240588188171387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5265727043151855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5265727043151855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([394, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5511589050292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5511589050292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.551910400390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5584940910339355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([337, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5587663650512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5587663650512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5594091415405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5717945098876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5722403526306152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5722403526306152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5727477073669434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5897345542907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([210, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5902886390686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5902886390686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5906891822814941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6023049354553223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6030130386352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6030130386352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6033735275268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6163511276245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([179, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6172032356262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6172032356262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6175446510314941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.632225513458252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6334772109985352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6334772109985352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6337575912475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6477766036987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([141, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6487207412719727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6487207412719727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6489896774291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6643190383911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6649894714355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6649894714355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6651668548583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6765193939208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6773533821105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6773533821105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6775364875793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6905369758605957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6910800933837891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6910800933837891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6911945343017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7001209259033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.700859546661377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.700859546661377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.700991153717041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7121777534484863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7130370140075684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7130370140075684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7131781578063965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.726163387298584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7268867492675781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7268867492675781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7269992828369141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7381401062011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7388191223144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7388191223144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7389163970947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7492275238037109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7499170303344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7499170303344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7500085830688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7603540420532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7609295845031738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7609295845031738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7610020637512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7696995735168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7701997756958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7701997756958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.770258903503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7777681350708008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7782135009765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7782135009765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7782630920410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7849082946777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7853641510009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7853641510009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7854118347167969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7921352386474609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7925558090209961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7925558090209961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.792597770690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7988080978393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7993159294128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7993159294128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7993636131286621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.8067545890808105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.8070626258850098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.8070626258850098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.807091236114502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.8117260932922363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.8121042251586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.8121042251586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.8121366500854492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.8176164627075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([304, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.8253293037414551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.8253293037414551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.8259091377258301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.9320111274719238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 304, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.9105367660522461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.9109716415405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.9114065170288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.91094970703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2916, 40])
input nodes number: 8922
output nodes number: 2916
edges number: 25051
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.911041259765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.9110417366027832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.024839401245117188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 21 input nodes size: 15482
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.022917747497558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.022917747497558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.030300140380859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03032207489013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018943309783935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.019451618194580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.019451618194580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.019451618194580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15482, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.019451618194580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([493, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04174613952636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04174613952636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 493, 128]), torch.Size([1, 493, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04221630096435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04597759246826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 493, 128])
m.shape torch.Size([546, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04626321792602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04626321792602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0467839241027832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05459451675415039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([543, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.055110931396484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.055110931396484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05562877655029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06774330139160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([470, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06838083267211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06838083267211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06882905960083008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08182764053344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([419, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08260250091552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08260250091552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 419, 128]), torch.Size([1, 419, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08300209045410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09738731384277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 419, 128])
m.shape torch.Size([342, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09816598892211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09816598892211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09849214553833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11251688003540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([320, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11342191696166992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11342191696166992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11372709274291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12898588180541992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([306, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13000059127807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13000059127807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13029241561889648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1469264030456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 306, 128])
m.shape torch.Size([274, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14795637130737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14795637130737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14821767807006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16494131088256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([2739, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1778712272644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1778712272644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2739, 128]), torch.Size([1, 2739, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.18048334121704102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3661537170410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2739, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3463125228881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3524656295776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.35861873626708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3524174690246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6452, 256])
first layer input nodes number: 15482
first layer output nodes number: 6452
edges number: 43785
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3587360382080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.36488914489746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3664274215698242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3664274215698242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([334, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39049720764160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39049720764160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39113426208496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39623069763183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([324, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39653539657592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39653539657592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.397153377532959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40648603439331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40703344345092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40703344345092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40759992599487305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42046213150024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([264, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4212331771850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4212331771850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4217367172241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43714427947998047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43787288665771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43787288665771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4382619857788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4522695541381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4529690742492676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4529690742492676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4532647132873535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46597719192504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([158, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46707582473754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46707582473754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4673771858215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48244524002075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48319435119628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48319435119628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4834175109863281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4961376190185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([116, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49702978134155273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49702978134155273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.497251033782959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.511411190032959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([113, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5123867988586426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5123867988586426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5126023292541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5279049873352051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5285797119140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5285797119140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5287208557128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5397300720214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.540501594543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.540501594543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5406408309936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5524759292602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5532937049865723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5532937049865723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.553429126739502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5658879280090332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([70, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5667624473571777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5667624473571777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5668959617614746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5801138877868652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([58, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5808835029602051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5808835029602051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5809941291809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5927205085754395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5931267738342285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5931267738342285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5931839942932129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5996499061584473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6002912521362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6002912521362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6003694534301758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6097536087036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6103200912475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6103200912475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.610386848449707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6188650131225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6193065643310547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6193065643310547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6193561553955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6260013580322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6265344619750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6265344619750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6265897750854492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6343889236450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6348457336425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6348457336425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6348915100097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6416664123535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6421723365783691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6421723365783691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6422200202941895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6496109962463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6498746871948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6498746871948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6498994827270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6539163589477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6543426513671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6543426513671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6543788909912109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6605033874511719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([239, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6662282943725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6662282943725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6666841506958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7469148635864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 239, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7259488105773926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7263827323913574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7268166542053223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7263607978820801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2909, 40])
input nodes number: 6452
output nodes number: 2909
edges number: 24223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7264299392700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7264304161071777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.020433425903320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 22 input nodes size: 18324
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01894235610961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01894235610961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.027679920196533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.027701377868652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.02029705047607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.020781517028808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.020781517028808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.020781517028808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([18324, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.020781517028808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([723, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.043549537658691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.043549537658691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.044239044189453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05066490173339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([762, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05104684829711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05104684829711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 762, 128]), torch.Size([1, 762, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0517735481262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0627894401550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 762, 128])
m.shape torch.Size([695, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06342029571533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06342029571533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 695, 128]), torch.Size([1, 695, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06408309936523438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07866477966308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 695, 128])
m.shape torch.Size([559, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07939958572387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07939958572387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07993268966674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09539413452148438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([534, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09640073776245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09640073776245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09690999984741211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11570978164672852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([436, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11670255661010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11670255661010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11711835861206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13499784469604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([373, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13603496551513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13603496551513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13639068603515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1541767120361328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([362, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1553797721862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1553797721862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15572500228881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17540311813354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 362, 128])
m.shape torch.Size([299, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.176513671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.176513671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17679882049560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.19504833221435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([2567, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.20714616775512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.20714616775512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2567, 128]), torch.Size([1, 2567, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2095942497253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.383514404296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2567, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3638315200805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3708028793334961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3777742385864258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.37074804306030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7310, 256])
first layer input nodes number: 18324
first layer output nodes number: 7310
edges number: 45722
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3779129981994629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3848843574523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.386627197265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.386627197265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([488, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40560293197631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40560293197631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40653371810913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.41398000717163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([435, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4143509864807129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4143509864807129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.41518068313598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42833423614501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([350, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4289522171020508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4289522171020508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42961978912353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4443502426147461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4449930191040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4449930191040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4454774856567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45952701568603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46024131774902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46024131774902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4606208801269531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4742851257324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47502994537353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47502994537353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4753389358520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48862552642822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4893054962158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4893054962158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48954200744628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5013675689697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.502133846282959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.502133846282959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5023531913757324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5148558616638184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.515620231628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.515620231628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.515812873840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.528141975402832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5287666320800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5287666320800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5289096832275391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5390663146972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5397353172302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5397353172302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5398688316345215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5502829551696777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5507583618164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5507583618164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5508480072021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5584678649902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5590105056762695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5590105056762695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5591001510620117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.567347526550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5677871704101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5677871704101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5678558349609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5746536254882812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5752396583557129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5752396583557129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5753216743469238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5840153694152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5843744277954102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5843744277954102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5844240188598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5900278091430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5904607772827148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5904607772827148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5905141830444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5969228744506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5972080230712891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5972080230712891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5972423553466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6016025543212891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6020054817199707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6020054817199707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6020493507385254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6079277992248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6083288192749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6083288192749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6083707809448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6142873764038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6145896911621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6145896911621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6146202087402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6191368103027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6194601058959961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6194601058959961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6194906234741211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6242208480834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6245594024658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6245594024658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6245899200439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6295337677001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6297264099121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6297264099121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6297435760498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6326446533203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([153, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6363124847412109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6363124847412109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6366043090820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6879653930664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 153, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6722497940063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6726779937744141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6731061935424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6726565361022949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2873, 40])
input nodes number: 7310
output nodes number: 2873
edges number: 19122
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.672727108001709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6727275848388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.02173757553100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 23 input nodes size: 13931
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.02029132843017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.02029132843017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.027673721313476562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.027695655822753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018936634063720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01936197280883789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01936197280883789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01936197280883789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13931, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01936197280883789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([710, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03792715072631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03792715072631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 710, 128]), torch.Size([1, 710, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0386042594909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.044489383697509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 710, 128])
m.shape torch.Size([722, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04483938217163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04483938217163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 722, 128]), torch.Size([1, 722, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04552793502807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05585622787475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 722, 128])
m.shape torch.Size([628, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05641031265258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05641031265258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 628, 128]), torch.Size([1, 628, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.057009220123291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07018518447875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 628, 128])
m.shape torch.Size([548, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07106351852416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07106351852416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07158613204956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08726835250854492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([463, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08811092376708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08811092376708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08855247497558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10444831848144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([373, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10529470443725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10529470443725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10565042495727539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12094640731811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([313, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12181329727172852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12181329727172852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12211179733276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13703680038452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([330, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13814640045166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13814640045166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13846111297607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15639972686767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 330, 128])
m.shape torch.Size([256, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15734100341796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15734100341796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15758514404296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17321014404296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([1922, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1822528839111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1822528839111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1922, 128]), torch.Size([1, 1922, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.18408584594726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.31458091735839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1922, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.29886674880981445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3048415184020996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.31081628799438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3047947883605957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6265, 256])
first layer input nodes number: 13931
first layer output nodes number: 6265
edges number: 37138
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.31092214584350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.316896915435791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3183908462524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3183908462524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([514, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3386964797973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3386964797973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 514, 256]), torch.Size([1, 514, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3396768569946289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3475198745727539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 514, 256])
m.shape torch.Size([419, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3478355407714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3478355407714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3486347198486328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.36086177825927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([327, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3614053726196289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3614053726196289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3620290756225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3762855529785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3771834373474121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3771834373474121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3776888847351074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39330339431762695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39403629302978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.39403629302978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3944272994995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40850353240966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40918493270874023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40918493270874023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40947484970092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42194128036499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([103, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42248964309692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42248964309692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4226861000061035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4325089454650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([131, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43341827392578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43341827392578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4336681365966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4479103088378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4485297203063965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4485297203063965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.44869375228881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45919179916381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45985984802246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45985984802246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4600086212158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47057151794433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.471099853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.471099853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4712085723876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4796886444091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4803957939147949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4803957939147949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48052167892456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49122190475463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49178409576416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49178409576416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4918794631958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5006532669067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5012249946594238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5012249946594238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5013127326965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5099987983703613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.510589599609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.510589599609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5106735229492188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5195693969726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5200352668762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5200352668762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5200982093811035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5272107124328613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.527587890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.527587890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5276355743408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5333576202392578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.533714771270752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.533714771270752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5337567329406738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.539085865020752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5395946502685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5395946502685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5396499633789062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5470619201660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5473418235778809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5473418235778809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5473723411560059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5516753196716309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5520439147949219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5520439147949219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5520801544189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5574436187744141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5577850341796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5577850341796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5578174591064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5628433227539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5631589889526367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5631589889526367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5631875991821289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5678224563598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5680851936340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5680851936340332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.568108081817627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5719761848449707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([165, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5759296417236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5759296417236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5762443542480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6316337585449219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 165, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6149101257324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6153416633605957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6157732009887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6153197288513184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2896, 40])
input nodes number: 6265
output nodes number: 2896
edges number: 19777
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.615391731262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6153922080993652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.020215511322021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 24 input nodes size: 12908
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018939971923828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018939971923828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.025094985961914062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.025116443634033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.017712116241455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018140316009521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018140316009521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018140316009521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([12908, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018140316009521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([592, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03650331497192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03650331497192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03706789016723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04158449172973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([613, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04188680648803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04188680648803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04247140884399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.051508426666259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([580, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05204582214355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05204582214355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05259895324707031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0652608871459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([471, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06588268280029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06588268280029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06633186340332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07935810089111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([388, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08005857467651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08005857467651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0804286003112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0937495231628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([356, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09458303451538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09458303451538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 356, 128]), torch.Size([1, 356, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09492254257202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.10952138900756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 356, 128])
m.shape torch.Size([282, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11029291152954102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11029291152954102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 282, 128]), torch.Size([1, 282, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11056184768676758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1240086555480957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 282, 128])
m.shape torch.Size([280, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12494230270385742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12494230270385742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 280, 128]), torch.Size([1, 280, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.12520933151245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14042997360229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 280, 128])
m.shape torch.Size([261, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1414165496826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1414165496826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14166545867919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.15759563446044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([2062, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16730356216430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16730356216430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2062, 128]), torch.Size([1, 2062, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.16927003860473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3155527114868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2062, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.2988286018371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.304440975189209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.31005334854125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3043971061706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5885, 256])
first layer input nodes number: 12908
first layer output nodes number: 5885
edges number: 36701
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3101515769958496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.31650495529174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3175969123840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3175969123840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([443, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.33806419372558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.33806419372558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3389091491699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3462643623352051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3465590476989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3465590476989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.34727048873901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.35860395431518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([306, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.359130859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.359130859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3597145080566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3726506233215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.37323570251464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.37323570251464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3736705780029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.38628196716308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3870115280151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3870115280151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3873872756958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40091419219970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4017472267150879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4017472267150879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4020848274230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.41660165786743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([109, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.41716623306274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.41716623306274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4173741340637207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42776918411254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4286189079284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4286189079284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42885541915893555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4423365592956543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.44304895401000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.44304895401000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.44323205947875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45495080947875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45561885833740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45561885833740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45576953887939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46646785736083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([90, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4673442840576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4673442840576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4675159454345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48090553283691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4816155433654785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4816155433654785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4817471504211426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4929337501525879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49363040924072266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49363040924072266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4937467575073242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.504450798034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5050253868103027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5050253868103027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5051150321960449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5139899253845215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5145220756530762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5145220756530762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5145983695983887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5226855278015137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5230779647827148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5230779647827148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5231313705444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5291662216186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.529548168182373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.529548168182373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5295958518981934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5353178977966309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5358133316040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5358133316040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5358705520629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5431375503540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5435476303100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5435476303100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5435934066772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5497274398803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.550262451171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.550262451171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5503177642822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5581169128417969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5584325790405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5584325790405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5584650039672852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5632638931274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5637764930725098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5637764930725098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5638241767883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5712151527404785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.571589469909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.571589469909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5716238021850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5771856307983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5775609016418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5775609016418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5775933265686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5830731391906738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([168, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5870938301086426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5870938301086426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5874142646789551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6438107490539551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 168, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6265068054199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.626927375793457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6273479461669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6269059181213379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2820, 40])
input nodes number: 5885
output nodes number: 2820
edges number: 20722
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.626960277557373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6269607543945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018972396850585938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 25 input nodes size: 12082
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.017701148986816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.017701148986816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.023694992065429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.02371692657470703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.017540454864501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018002986907958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018002986907958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018002986907958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([12082, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018002986907958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([564, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03696870803833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.03696870803833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0375065803527832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.042087554931640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([613, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.042403221130371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.042403221130371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.042987823486328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.051756858825683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([612, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.052340030670166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.052340030670166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05292367935180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06663274765014648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([541, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06737279891967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06737279891967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06788873672485352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08310651779174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([397, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08379507064819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08379507064819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.08417367935180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09780359268188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([379, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09869861602783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09869861602783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09906005859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11460208892822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([326, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1155095100402832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1155095100402832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11582040786743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13136529922485352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([301, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13235807418823242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13235807418823242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 301, 128]), torch.Size([1, 301, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1326451301574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14900732040405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 301, 128])
m.shape torch.Size([288, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1500997543334961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1500997543334961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1503744125366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1679525375366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([2079, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17772865295410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17772865295410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2079, 128]), torch.Size([1, 2079, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.18068552017211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.32702207565307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2079, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.30994558334350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.315762996673584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.32230567932128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.31644248962402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6100, 256])
first layer input nodes number: 12082
first layer output nodes number: 6100
edges number: 38121
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.32239770889282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3282151222229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3296694755554199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3296694755554199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([373, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.35376930236816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.35376930236816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3544807434082031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.36023521423339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([365, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3605813980102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3605813980102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.36127758026123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3719654083251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([304, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3724942207336426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3724942207336426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3730740547180176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3863224983215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.38699769973754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.38699769973754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.38747644424438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40136003494262695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40200042724609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40200042724609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40234947204589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4149150848388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.415651798248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.415651798248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4159531593322754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4289116859436035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42954158782958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42954158782958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4297628402709961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4408254623413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4415760040283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4415760040283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4417896270751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4539661407470703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([131, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45499277114868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.45499277114868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4552426338195801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4712338447570801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4719357490539551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4719357490539551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.47209978103637695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4837460517883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48444652557373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48444652557373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4845876693725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49559688568115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([83, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49648380279541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49648380279541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4966421127319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5100984573364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.510706901550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.510706901550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5108118057250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5204629898071289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5210700035095215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5210700035095215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5211634635925293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5304160118103027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5309171676635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5309171676635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5309896469116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5386724472045898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5392975807189941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5392975807189941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5393795967102051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.548647403717041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5493583679199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5493583679199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5494461059570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5599746704101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5605883598327637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5605883598327637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5606608390808105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5698657035827637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.570432186126709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.570432186126709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5704951286315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5789294242858887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5792250633239746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5792250633239746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5792574882507324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.583829402923584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5844593048095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5844593048095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5845203399658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5935535430908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5940093994140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5940093994140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5940532684326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6008529663085938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.601494312286377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.601494312286377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6015515327453613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6108212471008301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6112079620361328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6112079620361328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6112422943115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6170444488525391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([243, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.622866153717041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.622866153717041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6233296394348145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7049031257629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 243, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6839299201965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6843624114990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6847949028015137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6843404769897461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2901, 40])
input nodes number: 6100
output nodes number: 2901
edges number: 23906
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.684420108795166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6844205856323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01891613006591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 26 input nodes size: 13637
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01755237579345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.01755237579345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.024055004119873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.02407693862915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018061161041259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018587589263916016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018587589263916016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018587589263916016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13637, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.018587589263916016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([342, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0408167839050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0408167839050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.041142940521240234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.043752193450927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([442, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04401063919067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04401063919067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.04443216323852539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05075502395629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([457, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05119800567626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05119800567626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.05163383483886719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.061222076416015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([469, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06189870834350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06189870834350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.06234598159790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0753169059753418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([429, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07611608505249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07611608505249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.07652521133422852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.09125375747680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([416, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0922393798828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0922393798828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.0926361083984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1096954345703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([396, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11081886291503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11081886291503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 396, 128]), torch.Size([1, 396, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.11119651794433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1300792694091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 396, 128])
m.shape torch.Size([315, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13109207153320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.13109207153320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 315, 128]), torch.Size([1, 315, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1313924789428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1485157012939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 315, 128])
m.shape torch.Size([261, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14948558807373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.14948558807373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1497344970703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1656646728515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([2822, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17899656295776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.17899656295776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2822, 128]), torch.Size([1, 2822, 128])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.1816878318786621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3795280456542969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2822, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.359954833984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3660097122192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.37206459045410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.36596202850341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6349, 256])
first layer input nodes number: 13637
first layer output nodes number: 6349
edges number: 44975
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.37216854095458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.3782234191894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.37973737716674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.37973737716674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([260, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40471601486206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.40471601486206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4052119255065918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.41033363342285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([279, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.41062211990356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.41062211990356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.41115427017211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42003536224365234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([250, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4204902648925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4204902648925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.42096710205078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43145751953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([236, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.432126522064209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.432126522064209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.43257665634155273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4456305503845215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([209, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4464101791381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4464101791381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4468088150024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46115970611572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([201, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46211957931518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46211957931518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.46250295639038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4789881706237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([182, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48002099990844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48002099990844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.48036813735961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4977250099182129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4986281394958496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.4986281394958496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.49889516830444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5141158103942871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([121, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5150294303894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5150294303894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5152602195739746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5300307273864746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([124, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5311074256896973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5311074256896973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.531343936920166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5481362342834473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5491600036621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5491600036621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5493659973144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5654335021972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5662188529968262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5662188529968262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5663657188415527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5788493156433105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5796384811401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5796384811401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5797700881958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5918779373168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5926733016967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5926733016967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.5927953720092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6048803329467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6055116653442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6055116653442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6056032180786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6153078079223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6159849166870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6159849166870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6160745620727539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6262044906616211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6270914077758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6270914077758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6272001266479492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6402463912963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.640866756439209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.640866756439209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6409411430358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.650388240814209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6509537696838379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6509537696838379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6510167121887207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6594510078430176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6602654457092285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6602654457092285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6603493690490723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.672182559967041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6727261543273926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6727261543273926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6727814674377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6809678077697754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6814265251159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6814265251159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6814703941345215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.688270092010498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6886463165283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6886463165283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6886806488037109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6942424774169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.694756031036377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.694756031036377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.6947999000549316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7022137641906738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([219, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7074542045593262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7074542045593262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 0.7078719139099121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7813887596130371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 219, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.759462833404541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7598953247070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7603278160095215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7598733901977539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2900, 40])
input nodes number: 6349
output nodes number: 2900
edges number: 25597
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7599430084228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7599434852600098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019582748413085938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 27 input nodes size: 18117
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018061161041259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018061161041259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02670001983642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02672100067138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02019643783569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020672321319580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020672321319580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020672321319580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([18117, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020672321319580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([554, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.043019771575927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.043019771575927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0435481071472168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0477747917175293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([624, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.048105716705322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.048105716705322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.048700809478759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.058208465576171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([580, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05874061584472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05874061584472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05929374694824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07146263122558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([537, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07221031188964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07221031188964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0727224349975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08802604675292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([455, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08885478973388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08885478973388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08928871154785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10490989685058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([415, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1058802604675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1058802604675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 415, 128]), torch.Size([1, 415, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10627603530883789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12329435348510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 415, 128])
m.shape torch.Size([341, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12423467636108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12423467636108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12455987930297852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14082002639770508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([330, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14191627502441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14191627502441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14223098754882812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1601696014404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 330, 128])
m.shape torch.Size([277, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16120100021362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16120100021362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 277, 128]), torch.Size([1, 277, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16146516799926758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17837190628051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 277, 128])
m.shape torch.Size([2693, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19108104705810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19108104705810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2693, 128]), torch.Size([1, 2693, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1936492919921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3778805732727051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2693, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35970449447631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3661952018737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37268590927124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36614418029785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6806, 256])
first layer input nodes number: 18117
first layer output nodes number: 6806
edges number: 44905
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37282323837280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37937307357788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3809366226196289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3809366226196289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3995833396911621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3995833396911621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40040159225463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40779638290405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([387, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40813159942626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40813159942626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40886974334716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4206705093383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42119264602661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42119264602661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4217820167541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4347705841064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4354104995727539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4354104995727539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43587398529052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44931507110595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4501986503601074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4501986503601074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4505953788757324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4648776054382324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4658322334289551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4658322334289551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4661679267883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4806027412414551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4812626838684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4812626838684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48149728775024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.493227481842041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49396371841430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49396371841430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49417543411254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5062432289123535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5069160461425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5069160461425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5070877075195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5180740356445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5189685821533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5189685821533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5191631317138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5329761505126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5337247848510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5337247848510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5338773727416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5457792282104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.546349048614502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.546349048614502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5464558601379395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.555534839630127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5561814308166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5561814308166504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5562882423400879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5661149024963379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5666670799255371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5666670799255371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5667529106140137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5752501487731934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5756402015686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5756402015686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5756974220275879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5817627906799316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5822877883911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5822877883911133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5823564529418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5901155471801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.590604305267334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.590604305267334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.590665340423584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.597989559173584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5983572006225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5983572006225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5984010696411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6039724349975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6042795181274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6042795181274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.604313850402832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6089143753051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6092820167541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6092820167541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6093201637268066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6146988868713379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6151642799377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6151642799377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6152100563049316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6219849586486816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6222372055053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6222372055053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6222620010375977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6261053085327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6263585090637207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6263585090637207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6263813972473145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.630089282989502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6303086280822754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6303086280822754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6303277015686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6335511207580566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([125, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6365451812744141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6365451812744141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6367835998535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6787452697753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 125, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6632156372070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6636266708374023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6640377044677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6636056900024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 6806
output nodes number: 2758
edges number: 18844
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6636562347412109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6636567115783691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02158832550048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 28 input nodes size: 15410
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02017498016357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02017498016357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.027523040771484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.027544498443603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018884658813476562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01935863494873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01935863494873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01935863494873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15410, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01935863494873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([653, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04067707061767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04067707061767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04129981994628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04628181457519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([657, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04659700393676758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04659700393676758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 657, 128]), torch.Size([1, 657, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.047223567962646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05684995651245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 657, 128])
m.shape torch.Size([626, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05743217468261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05743217468261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0580291748046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07116317749023438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([540, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07191991806030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07191991806030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07243490219116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0876917839050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([468, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08855009078979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08855009078979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08899641036987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10506391525268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([376, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10591650009155273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10591650009155273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10627508163452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12169408798217773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 376, 128])
m.shape torch.Size([357, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12270641326904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12270641326904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.123046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14006996154785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([308, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14107465744018555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14107465744018555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14136838912963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1581110954284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([251, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1590414047241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1590414047241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15928077697753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17460060119628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 251, 128])
m.shape torch.Size([2502, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18641138076782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18641138076782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2502, 128]), torch.Size([1, 2502, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1887974739074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36258745193481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2502, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34485483169555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35128068923950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35770654678344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3512301445007324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6738, 256])
first layer input nodes number: 15410
first layer output nodes number: 6738
edges number: 42843
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35782337188720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3645029067993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36585569381713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36585569381713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([467, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38701725006103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38701725006103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3879079818725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3950338363647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([410, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39537668228149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39537668228149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39615869522094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4079313278198242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([341, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4085235595703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4085235595703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40917396545410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42368125915527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42427873611450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42427873611450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42473649978637695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43801164627075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4387054443359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4387054443359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4390716552734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4522552490234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45299482345581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45299482345581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45329999923706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46642255783081055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46718502044677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46718502044677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46744441986083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48041439056396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48103857040405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48103857040405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48122549057006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.491879940032959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4925823211669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4925823211669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49275779724121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5039882659912109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5047659873962402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5047659873962402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5049376487731934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5171256065368652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.517822265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.517822265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5179634094238281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5289726257324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5295829772949219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5295829772949219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5296955108642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5392608642578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5397171974182129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5397171974182129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5397953987121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.546989917755127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5474758148193359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5474758148193359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5475502014160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5549144744873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5554828643798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5554828643798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5555629730224609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5640544891357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5644450187683105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5644450187683105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5644984245300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.570533275604248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5711441040039062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5711441040039062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5712184906005859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5801448822021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5805058479309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5805058479309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5805497169494629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5861210823059082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5865926742553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5865926742553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.586644172668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5935449600219727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5939807891845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5939807891845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5940265655517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6004810333251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6008214950561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6008214950561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.600855827331543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6059370040893555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6062159538269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6062159538269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6062426567077637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6103816032409668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6106114387512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6106114387512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6106324195861816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6140313148498535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6143898963928223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6143898963928223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6144204139709473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6195778846740723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([199, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6243443489074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6243443489074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6247239112854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6915268898010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 199, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6735796928405762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.674008846282959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6744379997253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6739873886108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2880, 40])
input nodes number: 6738
output nodes number: 2880
edges number: 20701
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6740775108337402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6740779876708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020304203033447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 29 input nodes size: 16229
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01890277862548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01890277862548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.026641368865966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.026662826538085938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01929330825805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019895076751708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019895076751708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019895076751708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16229, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019895076751708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([497, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04631662368774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04631662368774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04679059982299805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0505824089050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([539, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05085945129394531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05085945129394531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05137348175048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06033897399902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([536, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06084871292114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06084871292114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06135988235473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07278013229370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([500, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07347822189331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07347822189331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07395505905151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0877833366394043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([496, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08872747421264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08872747421264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08920049667358398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10622930526733398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([474, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10734891891479492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10734891891479492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10780096054077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12723875045776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([399, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12834453582763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12834453582763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1287250518798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1477508544921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([350, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1488957405090332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1488957405090332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1492295265197754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16825532913208008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([321, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1694660186767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1694660186767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16977214813232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18936443328857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([3448, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20565271377563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20565271377563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3448, 128]), torch.Size([1, 3448, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20894098281860352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44240808486938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3448, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41872501373291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4259347915649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43314456939697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42587804794311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7560, 256])
first layer input nodes number: 16229
first layer output nodes number: 7560
edges number: 53469
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43326759338378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4404773712158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4432506561279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4432506561279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([334, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46987247467041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46987247467041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47050952911376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4760465621948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([277, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4762606620788574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4762606620788574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4767889976501465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48647356033325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([247, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4869217872619629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4869217872619629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4873929023742676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4977574348449707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([211, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4983334541320801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4983334541320801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4987359046936035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5104069709777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5111236572265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5111236572265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5114879608154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5246028900146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5253782272338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5253782272338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5256948471069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5393095016479492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5400261878967285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5400261878967285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5402741432189941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5526719093322754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5534477233886719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5534477233886719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5536708831787109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5663909912109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([116, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5680041313171387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5680041313171387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5682253837585449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5823855400085449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5831303596496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5831303596496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5833001136779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5953526496887207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5960607528686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5960607528686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5962038040161133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6073617935180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6081671714782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6081671714782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6083121299743652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.620633602142334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6213111877441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6213111877441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6214256286621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6319541931152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6326375007629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6326375007629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6327424049377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6431279182434082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6437821388244629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6437821388244629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6438755989074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6537823677062988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6542434692382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6542434692382812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6543064117431641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6614189147949219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6621885299682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6621885299682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6622819900512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.673497200012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6741428375244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6741428375244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6742191314697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6839084625244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6845278739929199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6845278739929199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6845965385437012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6937975883483887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6944746971130371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6944746971130371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6945452690124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.704495906829834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7051873207092285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7051873207092285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7052559852600098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7154183387756348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7158069610595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7158069610595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7158451080322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7217578887939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7222914695739746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7222914695739746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7223391532897949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7300639152526855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7304553985595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7304553985595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7304897308349609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7362918853759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([372, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.745213508605957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.745213508605957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7459230422973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8785181045532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 372, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8548464775085449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8552727699279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8556990623474121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8552513122558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2859, 40])
input nodes number: 7560
output nodes number: 2859
edges number: 27234
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8553266525268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8553271293640137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021021366119384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 30 input nodes size: 19555
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019290447235107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019290447235107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02861499786376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02863597869873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020875930786132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021427154541015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021427154541015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021427154541015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([19555, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021427154541015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([671, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0481867790222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0481867790222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04882669448852539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05428171157836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 671, 128])
m.shape torch.Size([747, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05467414855957031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05467414855957031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05538654327392578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06659555435180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([687, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06722211837768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06722211837768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06787729263305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0822911262512207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([543, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08299922943115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08299922943115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08351707458496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09880495071411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([525, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09979772567749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09979772567749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10029840469360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11923599243164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([430, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12021589279174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12021589279174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12062597274780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1382594108581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([410, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13942289352416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13942289352416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13981389999389648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1593642234802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([371, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1605839729309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1605839729309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 371, 128]), torch.Size([1, 371, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16093778610229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1811051368713379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 371, 128])
m.shape torch.Size([305, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1822371482849121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1822371482849121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18252801895141602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20114374160766602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([3377, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2171010971069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2171010971069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3377, 128]), torch.Size([1, 3377, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22052955627441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45168399810791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3377, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4278264045715332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.435518741607666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44321107864379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4354581832885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([8066, 256])
first layer input nodes number: 19555
first layer output nodes number: 8066
edges number: 53956
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4433588981628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4510512351989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4532747268676758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4532747268676758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([426, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47348690032958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47348690032958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47429943084716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4813981056213379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48171472549438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48171472549438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48243188858032227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4932699203491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([324, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49384593963623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49384593963623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4944639205932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5091075897216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5097136497497559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5097136497497559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5101675987243652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5233321189880371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5240230560302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5240230560302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5243873596191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5375022888183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5381450653076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5381450653076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5384178161621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5501461029052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5508980751037598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5508980751037598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.551149845123291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5637383460998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5644736289978027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5644736289978027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5646872520446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5768637657165527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.577613353729248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.577613353729248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5778021812438965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5898871421813965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5906291007995605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5906291007995605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5907950401306152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.602576732635498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6031179428100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6031179428100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6032304763793945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6120080947875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6126327514648438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6126327514648438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6127452850341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6223106384277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6229791641235352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6229791641235352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6230897903442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6332674026489258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6338448524475098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6338448524475098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.633934497833252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6428093910217285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.643427848815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.643427848815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6435155868530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6528158187866211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6533412933349609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6533412933349609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.653411865234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6613864898681641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6617436408996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6617436408996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6617894172668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6672825813293457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6676926612854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6676926612854004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6677403450012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6737961769104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6741743087768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6741743087768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6742162704467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6798391342163086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6803374290466309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6803374290466309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6803889274597168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.687650203704834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6881294250488281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6881294250488281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6881771087646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6952342987060547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6954221725463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6954221725463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6954412460327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6983976364135742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6986756324768066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6986756324768066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6987004280090332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7027173042297363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7029819488525391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7029819488525391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7030048370361328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7068729400634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([166, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7108502388000488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7108502388000488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7111668586730957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7668919563293457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 166, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7500295639038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7504405975341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7508516311645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7504196166992188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 8066
output nodes number: 2758
edges number: 19845
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.750485897064209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7504863739013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02247142791748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 31 input nodes size: 16083
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020860671997070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020860671997070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.028529644012451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.028551578521728516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01920604705810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019823074340820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019823074340820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019823074340820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16083, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019823074340820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([471, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.048110008239746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.048110008239746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04855918884277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05215263366699219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([550, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05245256423950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05245256423950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05297708511352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.061284542083740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([541, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06179618835449219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06179618835449219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06231212615966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07366275787353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([486, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07433176040649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07433176040649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07479524612426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08823633193969727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([470, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08912515640258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08912515640258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08957338333129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10570955276489258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([410, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1066584587097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1066584587097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10704946517944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12386274337768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([406, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12502241134643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12502241134643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12540960311889648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14476919174194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([375, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14600610733032227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14600610733032227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1463637351989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1667485237121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([322, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1679515838623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1679515838623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1682586669921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1879119873046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([3773, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20574951171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20574951171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3773, 128]), torch.Size([1, 3773, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20934772491455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4653811454772949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3773, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4398069381713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4472494125366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45469188690185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4471912384033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7804, 256])
first layer input nodes number: 16083
first layer output nodes number: 7804
edges number: 56418
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45481395721435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46225643157958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46411705017089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46411705017089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([326, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4898695945739746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4898695945739746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4904913902282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4960479736328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([308, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49632930755615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49632930755615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4969167709350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5079202651977539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([276, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5084223747253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5084223747253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.508948802947998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5226044654846191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([214, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5231642723083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5231642723083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5235724449157715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5354094505310059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5361137390136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5361137390136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5364742279052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5494518280029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5501194000244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5501194000244141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5503997802734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5624561309814453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5638117790222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5638117790222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5641074180603027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5788893699645996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5797872543334961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5797872543334961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5800466537475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5948324203491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([112, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5956716537475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5956716537475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5958852767944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6095571517944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6104021072387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6104021072387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.610590934753418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.623997688293457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([107, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6250348091125488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6250348091125488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6252388954162598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6411576271057129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6418633460998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6418633460998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6419968605041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6533455848693848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6542162895202637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6542162895202637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6543593406677246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6675200462341309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6684174537658691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6684174537658691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6685547828674316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6821503639221191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6828603744506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6828603744506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6829633712768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6938810348510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6946907043457031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6946907043457031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6947975158691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7068672180175781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7076802253723145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7076802253723145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7077813148498535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.719912052154541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7204499244689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7204499244689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7205147743225098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7287507057189941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7291569709777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7291569709777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7292027473449707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7353367805480957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7360830307006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7360830307006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7361593246459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7469167709350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7475652694702148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7475652694702148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7476301193237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.757227897644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7576184272766113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7576184272766113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7576565742492676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7635693550109863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7640590667724609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7640590667724609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7641029357910156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.771209716796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7717413902282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7717413902282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.771787166595459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7795233726501465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([279, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7869949340820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7869949340820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7875270843505859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8851327896118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 279, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8624706268310547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8629069328308105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8633432388305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8628849983215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2927, 40])
input nodes number: 7804
output nodes number: 2927
edges number: 26333
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8629903793334961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8629908561706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020989418029785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020989418029785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020989418029785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007921941578388214 |0.0013520792126655579 |0.11607380211353302 |8.603185415267944e-05 |0.07639919221401215 |0.004800558090209961 |
----------------------------------------------------------pseudo_mini_loss sum 4.857469081878662[05:41:59] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28962740 edges into 32 parts and get 9288964 edge cuts

Total (block generation + training)time/epoch 27.67478656768799
Training time/epoch 6.63695216178894
Training time without block to device /epoch 6.593685626983643
Training time without total dataloading part /epoch 6.166689395904541
load block tensor time/epoch 0.25350213050842285
block to device time/epoch 0.04326653480529785
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1111638
Number of first layer input nodes during this epoch:  795414
Number of first layer output nodes during this epoch:  316224
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020988941192626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.019800186157226562
global_2_local spend time (sec) 0.055206298828125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0043718814849853516
A = g.adjacency_matrix() spent  0.012849092483520508
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08519315719604492
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.311126470565796
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1738536357879639

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 1.258 seconds
Metis partitioning: 5.705 seconds
Split the graph: 0.743 seconds
Construct subgraphs: 0.107 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.827341556549072
2894
2888
2885
2904
2912
2898
2884
2927
2915
2759
2894
2921
2927
2849
2825
2887
2903
2889
2850
2834
2762
2766
2774
2760
2770
2758
2793
2772
2758
2867
2758
2758
total k batches seeds list generation spend  17.592511653900146
after graph partition
graph partition algorithm spend time 17.680010318756104
2894
2888
2885
2904
2912
2898
2884
2927
2915
2759
2894
2921
2927
2849
2825
2887
2903
2889
2850
2834
2762
2766
2774
2760
2770
2758
2793
2772
2758
2867
2758
2758
partition_len_list
[6619, 6551, 5186, 5552, 7512, 6210, 6781, 8841, 6748, 5760, 6893, 6155, 7772, 7315, 7038, 5316, 6297, 7594, 7818, 6752, 15902, 13483, 12472, 9126, 13789, 14588, 18882, 17799, 19094, 17696, 16968, 16239]
shared_neighbor_graph_partition_s0 selection method  spend 17.792631149291992
time for parepare:  0.01796579360961914
local_output_nid generation:  0.0008044242858886719
local_in_edges_tensor generation:  0.0009610652923583984
mini_batch_src_global generation:  0.0008807182312011719
r_  generation:  0.005901813507080078
local_output_nid generation:  0.0008032321929931641
local_in_edges_tensor generation:  0.0008511543273925781
mini_batch_src_global generation:  0.0009791851043701172
r_  generation:  0.0067217350006103516
local_output_nid generation:  0.00083160400390625
local_in_edges_tensor generation:  0.000751495361328125
mini_batch_src_global generation:  0.0006117820739746094
r_  generation:  0.00520634651184082
local_output_nid generation:  0.0008592605590820312
local_in_edges_tensor generation:  0.0007359981536865234
mini_batch_src_global generation:  0.0006389617919921875
r_  generation:  0.005766391754150391
local_output_nid generation:  0.0008497238159179688
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.0008044242858886719
r_  generation:  0.0069272518157958984
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.0006902217864990234
mini_batch_src_global generation:  0.0006299018859863281
r_  generation:  0.005622386932373047
local_output_nid generation:  0.0008695125579833984
local_in_edges_tensor generation:  0.0007374286651611328
mini_batch_src_global generation:  0.0008018016815185547
r_  generation:  0.007344722747802734
local_output_nid generation:  0.0009083747863769531
local_in_edges_tensor generation:  0.0007431507110595703
mini_batch_src_global generation:  0.0008313655853271484
r_  generation:  0.0069942474365234375
local_output_nid generation:  0.0009012222290039062
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.0009350776672363281
r_  generation:  0.007990837097167969
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0006601810455322266
mini_batch_src_global generation:  0.0006966590881347656
r_  generation:  0.006056308746337891
local_output_nid generation:  0.0009298324584960938
local_in_edges_tensor generation:  0.0007770061492919922
mini_batch_src_global generation:  0.0007307529449462891
r_  generation:  0.006871700286865234
local_output_nid generation:  0.0009338855743408203
local_in_edges_tensor generation:  0.0008058547973632812
mini_batch_src_global generation:  0.0007741451263427734
r_  generation:  0.0073659420013427734
local_output_nid generation:  0.0009837150573730469
local_in_edges_tensor generation:  0.0007431507110595703
mini_batch_src_global generation:  0.0008461475372314453
r_  generation:  0.007658481597900391
local_output_nid generation:  0.0009579658508300781
local_in_edges_tensor generation:  0.0007030963897705078
mini_batch_src_global generation:  0.0007970333099365234
r_  generation:  0.007070779800415039
local_output_nid generation:  0.0009214878082275391
local_in_edges_tensor generation:  0.0006725788116455078
mini_batch_src_global generation:  0.0006887912750244141
r_  generation:  0.0062143802642822266
local_output_nid generation:  0.000926971435546875
local_in_edges_tensor generation:  0.0006802082061767578
mini_batch_src_global generation:  0.0005731582641601562
r_  generation:  0.005061626434326172
local_output_nid generation:  0.0009410381317138672
local_in_edges_tensor generation:  0.0006701946258544922
mini_batch_src_global generation:  0.0006353855133056641
r_  generation:  0.00620579719543457
local_output_nid generation:  0.0009248256683349609
local_in_edges_tensor generation:  0.0007145404815673828
mini_batch_src_global generation:  0.0007531642913818359
r_  generation:  0.005833148956298828
local_output_nid generation:  0.0009214878082275391
local_in_edges_tensor generation:  0.0006585121154785156
mini_batch_src_global generation:  0.0006635189056396484
r_  generation:  0.006039619445800781
local_output_nid generation:  0.0009307861328125
local_in_edges_tensor generation:  0.0007269382476806641
mini_batch_src_global generation:  0.0005941390991210938
r_  generation:  0.0052089691162109375
local_output_nid generation:  0.0008780956268310547
local_in_edges_tensor generation:  0.0008287429809570312
mini_batch_src_global generation:  0.0010724067687988281
r_  generation:  0.009373664855957031
local_output_nid generation:  0.0009436607360839844
local_in_edges_tensor generation:  0.0006742477416992188
mini_batch_src_global generation:  0.0009233951568603516
r_  generation:  0.00664520263671875
local_output_nid generation:  0.0009706020355224609
local_in_edges_tensor generation:  0.0007617473602294922
mini_batch_src_global generation:  0.0008184909820556641
r_  generation:  0.007501125335693359
local_output_nid generation:  0.0009889602661132812
local_in_edges_tensor generation:  0.0006830692291259766
mini_batch_src_global generation:  0.000644683837890625
r_  generation:  0.005268573760986328
local_output_nid generation:  0.0009810924530029297
local_in_edges_tensor generation:  0.0006818771362304688
mini_batch_src_global generation:  0.0007841587066650391
r_  generation:  0.0070934295654296875
local_output_nid generation:  0.0009555816650390625
local_in_edges_tensor generation:  0.0008280277252197266
mini_batch_src_global generation:  0.0008318424224853516
r_  generation:  0.006873369216918945
local_output_nid generation:  0.0009920597076416016
local_in_edges_tensor generation:  0.0008308887481689453
mini_batch_src_global generation:  0.0010082721710205078
r_  generation:  0.009266853332519531
local_output_nid generation:  0.0010509490966796875
local_in_edges_tensor generation:  0.0009169578552246094
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.009019851684570312
local_output_nid generation:  0.0010445117950439453
local_in_edges_tensor generation:  0.0008301734924316406
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.009386777877807617
local_output_nid generation:  0.0011088848114013672
local_in_edges_tensor generation:  0.0008652210235595703
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.011353015899658203
local_output_nid generation:  0.0010712146759033203
local_in_edges_tensor generation:  0.0008282661437988281
mini_batch_src_global generation:  0.0012655258178710938
r_  generation:  0.009652853012084961
local_output_nid generation:  0.001064300537109375
local_in_edges_tensor generation:  0.000766754150390625
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.00985407829284668
----------------------check_connections_block total spend ----------------------------- 0.39835643768310547
generate_one_block  0.022094249725341797
generate_one_block  0.013213157653808594
generate_one_block  0.008353471755981445
generate_one_block  0.008868932723999023
generate_one_block  0.011067628860473633
generate_one_block  0.00819706916809082
generate_one_block  0.010995864868164062
generate_one_block  0.010812520980834961
generate_one_block  0.011878490447998047
generate_one_block  0.008835077285766602
generate_one_block  0.010157585144042969
generate_one_block  0.010724306106567383
generate_one_block  0.011615753173828125
generate_one_block  0.010475873947143555
generate_one_block  0.009023904800415039
generate_one_block  0.007284402847290039
generate_one_block  0.01365041732788086
generate_one_block  0.009607553482055664
generate_one_block  0.01137542724609375
generate_one_block  0.010059118270874023
generate_one_block  0.01808929443359375
generate_one_block  0.010210990905761719
generate_one_block  0.011280536651611328
generate_one_block  0.008172273635864258
generate_one_block  0.011158466339111328
generate_one_block  0.011424064636230469
generate_one_block  0.014931917190551758
generate_one_block  0.017867565155029297
generate_one_block  0.015215873718261719
generate_one_block  0.01627373695373535
generate_one_block  0.01587080955505371
generate_one_block  0.01580190658569336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03658580780029297
gen group dst list time:  0.010018110275268555
time for parepare:  0.020476579666137695
local_output_nid generation:  0.0018210411071777344
local_in_edges_tensor generation:  0.00481867790222168
mini_batch_src_global generation:  0.0013508796691894531
r_  generation:  0.014130353927612305
local_output_nid generation:  0.0020492076873779297
local_in_edges_tensor generation:  0.0021657943725585938
mini_batch_src_global generation:  0.0014605522155761719
r_  generation:  0.014592170715332031
local_output_nid generation:  0.0017788410186767578
local_in_edges_tensor generation:  0.0013587474822998047
mini_batch_src_global generation:  0.004642486572265625
r_  generation:  0.008913516998291016
local_output_nid generation:  0.0018842220306396484
local_in_edges_tensor generation:  0.0014219284057617188
mini_batch_src_global generation:  0.0010874271392822266
r_  generation:  0.010018110275268555
local_output_nid generation:  0.0025055408477783203
local_in_edges_tensor generation:  0.0018093585968017578
mini_batch_src_global generation:  0.001988649368286133
r_  generation:  0.017210960388183594
local_output_nid generation:  0.0020563602447509766
local_in_edges_tensor generation:  0.0014567375183105469
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.01296854019165039
local_output_nid generation:  0.002223491668701172
local_in_edges_tensor generation:  0.0016777515411376953
mini_batch_src_global generation:  0.001363992691040039
r_  generation:  0.016284704208374023
local_output_nid generation:  0.002759695053100586
local_in_edges_tensor generation:  0.0026929378509521484
mini_batch_src_global generation:  0.001993417739868164
r_  generation:  0.022275447845458984
local_output_nid generation:  0.002248525619506836
local_in_edges_tensor generation:  0.0017666816711425781
mini_batch_src_global generation:  0.0014410018920898438
r_  generation:  0.015958070755004883
local_output_nid generation:  0.0019087791442871094
local_in_edges_tensor generation:  0.0013742446899414062
mini_batch_src_global generation:  0.001138448715209961
r_  generation:  0.012993812561035156
local_output_nid generation:  0.0023088455200195312
local_in_edges_tensor generation:  0.001623392105102539
mini_batch_src_global generation:  0.0012896060943603516
r_  generation:  0.016889095306396484
local_output_nid generation:  0.0019032955169677734
local_in_edges_tensor generation:  0.0016083717346191406
mini_batch_src_global generation:  0.0014235973358154297
r_  generation:  0.014719724655151367
local_output_nid generation:  0.0024318695068359375
local_in_edges_tensor generation:  0.0018000602722167969
mini_batch_src_global generation:  0.0014619827270507812
r_  generation:  0.018639564514160156
local_output_nid generation:  0.0021791458129882812
local_in_edges_tensor generation:  0.0018610954284667969
mini_batch_src_global generation:  0.0020227432250976562
r_  generation:  0.017271757125854492
local_output_nid generation:  0.0021440982818603516
local_in_edges_tensor generation:  0.0016019344329833984
mini_batch_src_global generation:  0.0013206005096435547
r_  generation:  0.017670154571533203
local_output_nid generation:  0.0025832653045654297
local_in_edges_tensor generation:  0.0012965202331542969
mini_batch_src_global generation:  0.0012078285217285156
r_  generation:  0.00931859016418457
local_output_nid generation:  0.0021071434020996094
local_in_edges_tensor generation:  0.0014972686767578125
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.013449907302856445
local_output_nid generation:  0.002446889877319336
local_in_edges_tensor generation:  0.0018091201782226562
mini_batch_src_global generation:  0.00128173828125
r_  generation:  0.01637744903564453
local_output_nid generation:  0.0024318695068359375
local_in_edges_tensor generation:  0.0019278526306152344
mini_batch_src_global generation:  0.0014312267303466797
r_  generation:  0.017583608627319336
local_output_nid generation:  0.002129077911376953
local_in_edges_tensor generation:  0.001718282699584961
mini_batch_src_global generation:  0.001188516616821289
r_  generation:  0.014092206954956055
local_output_nid generation:  0.0059430599212646484
local_in_edges_tensor generation:  0.007856130599975586
mini_batch_src_global generation:  0.004161357879638672
r_  generation:  0.0442962646484375
local_output_nid generation:  0.0048792362213134766
local_in_edges_tensor generation:  0.00410771369934082
mini_batch_src_global generation:  0.004400968551635742
r_  generation:  0.03639388084411621
local_output_nid generation:  0.0044934749603271484
local_in_edges_tensor generation:  0.0036029815673828125
mini_batch_src_global generation:  0.0033919811248779297
r_  generation:  0.03425288200378418
local_output_nid generation:  0.0033991336822509766
local_in_edges_tensor generation:  0.002446413040161133
mini_batch_src_global generation:  0.0021741390228271484
r_  generation:  0.023018598556518555
local_output_nid generation:  0.004948616027832031
local_in_edges_tensor generation:  0.0035898685455322266
mini_batch_src_global generation:  0.0032923221588134766
r_  generation:  0.03763937950134277
local_output_nid generation:  0.005339860916137695
local_in_edges_tensor generation:  0.0043582916259765625
mini_batch_src_global generation:  0.004488945007324219
r_  generation:  0.04055190086364746
local_output_nid generation:  0.007910013198852539
local_in_edges_tensor generation:  0.006313800811767578
mini_batch_src_global generation:  0.006186723709106445
r_  generation:  0.06158733367919922
local_output_nid generation:  0.006381511688232422
local_in_edges_tensor generation:  0.005408048629760742
mini_batch_src_global generation:  0.005892038345336914
r_  generation:  0.0551910400390625
local_output_nid generation:  0.00693058967590332
local_in_edges_tensor generation:  0.005535125732421875
mini_batch_src_global generation:  0.006417274475097656
r_  generation:  0.05841660499572754
local_output_nid generation:  0.006457805633544922
local_in_edges_tensor generation:  0.0046045780181884766
mini_batch_src_global generation:  0.0061113834381103516
r_  generation:  0.05310821533203125
local_output_nid generation:  0.00623321533203125
local_in_edges_tensor generation:  0.00452423095703125
mini_batch_src_global generation:  0.005280733108520508
r_  generation:  0.05003762245178223
local_output_nid generation:  0.00569915771484375
local_in_edges_tensor generation:  0.004266500473022461
mini_batch_src_global generation:  0.005223989486694336
r_  generation:  0.047083139419555664
----------------------check_connections_block total spend ----------------------------- 1.3686199188232422
generate_one_block  0.02367115020751953
generate_one_block  0.030667543411254883
generate_one_block  0.013459920883178711
generate_one_block  0.014293670654296875
generate_one_block  0.021930217742919922
generate_one_block  0.016992807388305664
generate_one_block  0.0226287841796875
generate_one_block  0.029091596603393555
generate_one_block  0.02167820930480957
generate_one_block  0.017261266708374023
generate_one_block  0.020871877670288086
generate_one_block  0.01955890655517578
generate_one_block  0.025162935256958008
generate_one_block  0.023064613342285156
generate_one_block  0.0209808349609375
generate_one_block  0.013425588607788086
generate_one_block  0.018192052841186523
generate_one_block  0.025910377502441406
generate_one_block  0.024012088775634766
generate_one_block  0.0189211368560791
generate_one_block  0.06502866744995117
generate_one_block  0.05033707618713379
generate_one_block  0.04977083206176758
generate_one_block  0.029974699020385742
generate_one_block  0.05202770233154297
generate_one_block  0.0568394660949707
generate_one_block  0.07814645767211914
generate_one_block  0.07329559326171875
generate_one_block  0.08204960823059082
generate_one_block  0.07244563102722168
generate_one_block  0.0682682991027832
generate_one_block  0.06645703315734863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020988941192626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

connection checking time:  1.3686199188232422
block generation total time  1.1664166450500488
average batch blocks generation time:  0.036450520157814026
block dataloader generation time/epoch 21.20266330242157
pseudo mini batch 0 input nodes size: 15104
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019230365753173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019230365753173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.026432514190673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.026454448699951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01876354217529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019196510314941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019196510314941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019196510314941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15104, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019196510314941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([780, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.039646148681640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.039646148681640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0403900146484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0463409423828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([795, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04672718048095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04672718048095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0474853515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.059142112731933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([678, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.059732913970947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.059732913970947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0603795051574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07460451126098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([528, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07528829574584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07528829574584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07579183578491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0907893180847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([464, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0916438102722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0916438102722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0920863151550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1080164909362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([418, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10899114608764648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10899114608764648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1093897819519043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12653112411499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([360, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1275334358215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1275334358215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12787675857543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14504289627075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([297, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14600419998168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14600419998168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1462874412536621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16243219375610352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([249, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1633591651916504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1633591651916504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 249, 128]), torch.Size([1, 249, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16359663009643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17879438400268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 249, 128])
m.shape torch.Size([2050, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18845081329345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18845081329345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2050, 128]), torch.Size([1, 2050, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19040584564208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3367743492126465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2050, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3183317184448242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3246440887451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33095645904541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32459449768066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6619, 256])
first layer input nodes number: 15104
first layer output nodes number: 6619
edges number: 38981
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3310708999633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33797740936279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33931922912597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33931922912597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([508, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3582291603088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3582291603088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35919809341430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36694955825805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([428, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36728811264038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36728811264038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3681044578552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3812255859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([341, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38180065155029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38180065155029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38245105743408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3968391418457031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3974790573120117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3974790573120117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39795780181884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41184139251708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4128284454345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4128284454345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41322898864746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42764854431152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42848634719848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42848634719848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4288296699523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44359254837036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4443631172180176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4443631172180176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44463014602661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45798158645629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4587092399597168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4587092399597168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4589228630065918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4710993766784668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4717884063720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4717884063720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47196388244628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48319435119628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4839043617248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4839043617248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48406267166137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.495302677154541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49588966369628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49588966369628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49600982666015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5053825378417969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5058417320251465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5058417320251465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.505927562713623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5132231712341309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5137052536010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5137052536010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5137853622436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5211553573608398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5215325355529785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5215325355529785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5215916633605957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5274453163146973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5280790328979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5280790328979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5281667709350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5374670028686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5377306938171387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5377306938171387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5377688407897949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5420794486999512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5425505638122559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5425505638122559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5426077842712402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5494742393493652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5499820709228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5499820709228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5500411987304688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5575504302978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5578861236572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5578861236572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5579242706298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5630359649658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.563286304473877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.563286304473877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5633130073547363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5670781135559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.567347526550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.567347526550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5673742294311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5713262557983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5715880393981934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5715880393981934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5716128349304199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5754561424255371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5758862495422363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5758862495422363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5759243965148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5821042060852051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5823850631713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5823850631713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5824098587036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5866003036499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([147, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5901203155517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5901203155517578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5904006958007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6397476196289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 147, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6241426467895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6245741844177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6250057220458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6245522499084473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2894, 40])
input nodes number: 6619
output nodes number: 2894
edges number: 19033
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6246190071105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6246199607849121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020061969757080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 1 input nodes size: 14665
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018759727478027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018759727478027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.025752544403076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.025774478912353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018550395965576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01902151107788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01902151107788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01902151107788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14665, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01902151107788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([607, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03939962387084961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03939962387084961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0399785041809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04460954666137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([674, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04496288299560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04496288299560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04560565948486328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05659914016723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([616, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0571589469909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0571589469909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05774641036987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07067060470581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([572, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07146787643432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07146787643432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07201337814331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08829069137573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([459, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0891122817993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0891122817993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08955001831054688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10530853271484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([411, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10626554489135742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10626554489135742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10665750503540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12351179122924805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([357, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12450742721557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12450742721557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1248478889465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14187097549438477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([352, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14304351806640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14304351806640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14337921142578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16251373291015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([273, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16351747512817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16351747512817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 273, 128]), torch.Size([1, 273, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16377782821655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18044042587280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 273, 128])
m.shape torch.Size([2230, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19094371795654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19094371795654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2230, 128]), torch.Size([1, 2230, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1930704116821289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3477950096130371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2230, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33026123046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33650875091552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34354496002197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3372483253479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6551, 256])
first layer input nodes number: 14665
first layer output nodes number: 6551
edges number: 40924
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3436565399169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34990406036376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35146617889404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35146617889404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([389, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37361907958984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37361907958984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3743610382080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3803744316101074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([365, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3807053565979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3807053565979004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38140153884887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39258432388305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39305830001831055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39305830001831055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3936018943786621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4055628776550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4062638282775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4062638282775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40674638748168945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42074060440063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([218, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42154741287231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42154741287231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4219632148742676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4369320869445801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43768739700317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43768739700317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4380059242248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4517025947570801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4524517059326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4524517059326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4527091979980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46558380126953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([150, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46660852432250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46660852432250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46689462661743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4832024574279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4838986396789551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4838986396789551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4840836524963379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4959244728088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([98, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49677419662475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49677419662475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4969611167907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5102324485778809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5109109878540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5109109878540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5110502243041992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5219106674194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5226716995239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5226716995239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5228090286254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5344820022583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5351881980895996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5351881980895996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.535306453704834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5461859703063965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5468401908874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5468401908874512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5469412803649902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5569491386413574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5576052665710449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5576052665710449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5576987266540527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5676054954528809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5681281089782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5681281089782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5681986808776855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5761733055114746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5766611099243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5766611099243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5767221450805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5840463638305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5844831466674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5844831466674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5845346450805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5910749435424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5916156768798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5916156768798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5916748046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5995979309082031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6000685691833496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6000685691833496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6001181602478027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6071105003356934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6076712608337402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6076712608337402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6077265739440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.615912914276123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6164140701293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6164140701293945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6164617538452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6238527297973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6242270469665527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6242270469665527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6242613792419434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6298232078552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6301059722900391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6301059722900391  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6301307678222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6343212127685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([184, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6387300491333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6387300491333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6390810012817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7008485794067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 184, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6818695068359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6823000907897949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6827306747436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6822781562805176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2888, 40])
input nodes number: 6551
output nodes number: 2888
edges number: 22242
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6823482513427734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6823487281799316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01994800567626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 2 input nodes size: 9611
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018549442291259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018549442291259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.023885726928710938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02390766143798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01689291000366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017206668853759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017206668853759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017206668853759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([9611, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017206668853759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([744, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.030319690704345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.030319690704345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.031029224395751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.037119388580322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([785, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03751325607299805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03751325607299805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03826189041137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04949140548706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([671, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.050076961517333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.050076961517333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05071687698364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06543207168579102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 671, 128])
m.shape torch.Size([553, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06616687774658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06616687774658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06669425964355469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08246326446533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([431, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08322715759277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08322715759277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08363819122314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0984354019165039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([337, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09919404983520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09919404983520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09951543807983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11333513259887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([271, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11407899856567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11407899856567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11433744430541992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1272597312927246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 271, 128])
m.shape torch.Size([217, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1279582977294922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1279582977294922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12816524505615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13996124267578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 217, 128])
m.shape torch.Size([194, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14069032669067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14069032669067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14087533950805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15271615982055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 194, 128])
m.shape torch.Size([983, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15731096267700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15731096267700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1582484245300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22637224197387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 983, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21590948104858398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2208552360534668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2258009910583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22081613540649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5186, 256])
first layer input nodes number: 9611
first layer output nodes number: 5186
edges number: 25925
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2258749008178711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2308206558227539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23233270645141602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23233270645141602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([526, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2483673095703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2483673095703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 526, 256]), torch.Size([1, 526, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24937057495117188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2581024169921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 526, 256])
m.shape torch.Size([478, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.25851964950561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.25851964950561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2594313621520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.27419567108154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([365, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2747926712036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2747926712036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.27548885345458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.291046142578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([294, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.29182863235473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.29182863235473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2923893928527832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.30942583084106445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([228, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3102412223815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3102412223815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.31067609786987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32633161544799805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([174, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.327117919921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.327117919921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3274497985839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3417205810546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3424968719482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3424968719482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34276390075683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35611534118652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35686635971069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35686635971069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3570857048034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36958837509155273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37024879455566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37024879455566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3704185485839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3812828063964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3819093704223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3819093704223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3820505142211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3920717239379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39254045486450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39254045486450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3926377296447754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4002251625061035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40069580078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40069580078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40078163146972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4080772399902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40853452682495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40853452682495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40861082077026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41562986373901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41615724563598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41615724563598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41623735427856445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42416810989379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42467594146728516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42467594146728516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42474842071533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4324312210083008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43276405334472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43276405334472656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43280982971191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43798255920410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.438352108001709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.438352108001709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4383978843688965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4438910484313965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44430112838745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44430112838745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4443488121032715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45040464401245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45058202743530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45058202743530273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45060300827026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4534144401550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4535965919494629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4535965919494629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.453615665435791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45630502700805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45647716522216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45647716522216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4564943313598633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45903491973876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4592170715332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4592170715332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45923423767089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4618949890136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46204137802124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46204137802124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4620547294616699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4642176628112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46444177627563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46444177627563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4644608497619629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.467684268951416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([57, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46904468536376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46904468536376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46915340423583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48828792572021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4756312370300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4760613441467285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47649145126342773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47603940963745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2885, 40])
input nodes number: 5186
output nodes number: 2885
edges number: 16021
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47609996795654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47610044479370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017862319946289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 3 input nodes size: 10316
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.016892433166503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.016892433166503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021811485290527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021833419799804688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.016475200653076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.016845226287841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.016845226287841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.016845226287841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([10316, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.016845226287841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([612, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03237581253051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03237581253051758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0329594612121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.038079261779785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([660, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03841686248779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03841686248779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.039046287536621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04848766326904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([634, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04907989501953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04907989501953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04968452453613281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06298637390136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([564, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06375980377197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06375980377197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06429767608642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08047199249267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([480, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08134746551513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08134746551513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08180522918701172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09828472137451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([398, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09919452667236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09919452667236328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 398, 128]), torch.Size([1, 398, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09957408905029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11589527130126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 398, 128])
m.shape torch.Size([344, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11685371398925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11685371398925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 344, 128]), torch.Size([1, 344, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11718177795410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13358497619628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 344, 128])
m.shape torch.Size([304, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1345806121826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1345806121826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1348705291748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1513957977294922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([255, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1523451805114746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1523451805114746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1525883674621582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1681523323059082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([1301, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17423439025878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17423439025878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1301, 128]), torch.Size([1, 1301, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1754751205444336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2635669708251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1301, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.25069093704223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.25598573684692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.26128053665161133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.25594425201416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5552, 256])
first layer input nodes number: 10316
first layer output nodes number: 5552
edges number: 31023
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.26135969161987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.26665449142456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.26825809478759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.26825809478759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.28655576705932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.28655576705932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.28736066818237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.29520177841186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([407, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2955818176269531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2955818176269531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2963581085205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3092193603515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([336, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3098001480102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3098001480102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3104410171508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3245401382446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([273, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3252830505371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3252830505371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3258037567138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34115171432495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3420863151550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3420863151550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34250402450561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.357541561126709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([193, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3584461212158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3584461212158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3588142395019531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37464332580566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([176, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3756437301635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3756437301635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3759794235229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3927640914916992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3936729431152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3936729431152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3939399719238281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4091606140136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([118, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4100480079650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4100480079650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41027307510375977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42467737197875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4253726005554199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4253726005554199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42553281784057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4369082450866699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43764257431030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43764257431030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4377894401550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44924497604370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4500713348388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4500713348388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45022010803222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46286582946777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4635162353515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4635162353515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4636268615722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4738044738769531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4744086265563965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4744086265563965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4745020866394043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48375463485717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4843282699584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4843282699584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48441028594970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4931039810180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49367809295654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49367809295654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49375438690185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.502375602722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5027952194213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5027952194213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5028486251831055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5092573165893555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5095767974853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5095767974853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5096149444580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5144596099853516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5147695541381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5147695541381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5148038864135742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.519404411315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.519618034362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.519618034362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5196409225463867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5228681564331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5230789184570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5230789184570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5230998992919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5262050628662109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5265121459960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5265121459960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5265407562255859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.530975341796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5311603546142578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5311603546142578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5311775207519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5339584350585938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5341577529907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5341577529907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.534174919128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5370759963989258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([69, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5387253761291504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5387253761291504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5388569831848145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5620198249816895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5470247268676758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5474576950073242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5478906631469727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5474357604980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2904, 40])
input nodes number: 5552
output nodes number: 2904
edges number: 18478
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5475020408630371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5475025177001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017591476440429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 4 input nodes size: 17402
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01647806167602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01647806167602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024775981903076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024797916412353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019856929779052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020397663116455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020397663116455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020397663116455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17402, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020397663116455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([635, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04482555389404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04482555389404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04543113708496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05051565170288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([632, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.050815582275390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.050815582275390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.051418304443359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06055641174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([663, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0612034797668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0612034797668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06183576583862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07585573196411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([597, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07667827606201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07667827606201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07724761962890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09463977813720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([572, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0957188606262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0957188606262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09626436233520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11637544631958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([424, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11731576919555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11731576919555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11772012710571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13510751724243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([410, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13627386093139648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13627386093139648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13666486740112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15621519088745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([394, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15752267837524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15752267837524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1578984260559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17931604385375977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([331, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18054866790771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18054866790771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1808643341064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2010669708251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([2854, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21451807022094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21451807022094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2854, 128]), torch.Size([1, 2854, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2172398567199707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41527414321899414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2854, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3938779830932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40104198455810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4082059860229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4009857177734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7512, 256])
first layer input nodes number: 17402
first layer output nodes number: 7512
edges number: 49221
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4083375930786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41550159454345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41729259490966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41729259490966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([430, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44017744064331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44017744064331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4409976005554199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4483461380004883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([353, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44861507415771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44861507415771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44928836822509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4600973129272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4606170654296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4606170654296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4611835479736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47396373748779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47461509704589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47461509704589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4750785827636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48851966857910156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([209, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48929262161254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48929262161254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48969125747680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5040421485900879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([131, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5045986175537109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5045986175537109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5048484802246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5155925750732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5164704322814941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5164704322814941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5167546272277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5309643745422363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5317912101745605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5317912101745605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5320315361022949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5457301139831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.546414852142334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.546414852142334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5465922355651855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5579447746276855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5587310791015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5587310791015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5589046478271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.57122802734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([82, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5720086097717285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5720086097717285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5721650123596191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5843644142150879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5850939750671387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5850939750671387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5852274894714355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5965762138366699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5971345901489258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5971345901489258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5972299575805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6060037612915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6065616607666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6065616607666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6066474914550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6151447296142578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6158084869384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6158084869384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6159019470214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6258087158203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6265158653259277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6265158653259277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6266093254089355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6371703147888184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6376795768737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6376795768737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6377444267272949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6455264091491699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6460304260253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6460304260253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6460895538330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6535987854003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6542816162109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6542816162109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6543560028076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6643238067626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6648826599121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6648826599121094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6649417877197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.67327880859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6736125946044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6736125946044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6736469268798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6787281036376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6790704727172852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6790704727172852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.679102897644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6841287612915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6844887733459473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6844887733459473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6845211982727051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6897740364074707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6900348663330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6900348663330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6900577545166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6939258575439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([246, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6998257637023926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6998257637023926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7002949714660645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7828755378723145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 246, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7631750106811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7636089324951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.764042854309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7635869979858398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2912, 40])
input nodes number: 7512
output nodes number: 2912
edges number: 23247
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7636661529541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7636666297912598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021444320678710938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 5 input nodes size: 13495
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01985788345336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01985788345336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.026292800903320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.026314735412597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01799488067626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01838397979736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01838397979736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01838397979736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13495, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01838397979736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([736, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03592491149902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03592491149902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 736, 128]), torch.Size([1, 736, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03662681579589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04227638244628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 736, 128])
m.shape torch.Size([768, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04265785217285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04265785217285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04339027404785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05532693862915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([687, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05594348907470703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05594348907470703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.056598663330078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07101249694824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([597, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0718235969543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0718235969543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07239294052124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08890390396118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([484, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08977317810058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08977317810058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09023475646972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10685157775878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([407, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10778522491455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10778522491455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10817337036132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1248636245727539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([342, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12581110000610352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12581110000610352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12613725662231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14244508743286133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([304, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14344167709350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14344167709350586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14373159408569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16025686264038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([259, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1612234115600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1612234115600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1614704132080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1772785186767578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([1626, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18490839004516602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18490839004516602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1626, 128]), torch.Size([1, 1626, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18645906448364258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3002495765686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1626, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.28562355041503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2915458679199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2974681854248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.29149913787841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6210, 256])
first layer input nodes number: 13495
first layer output nodes number: 6210
edges number: 35000
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.29757070541381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.30349302291870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3050823211669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3050823211669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([502, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32208871841430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32208871841430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3230462074279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3312649726867676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([452, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33165550231933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33165550231933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3325176239013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3462390899658203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([355, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3468623161315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3468623161315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34753942489624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36243581771850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([288, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36339330673217773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36339330673217773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36394262313842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3801236152648926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([231, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38095951080322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38095951080322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38140010833740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3972616195678711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39811134338378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39811134338378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3984546661376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41321754455566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([151, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4140620231628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4140620231628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4143500328063965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42875051498413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42945241928100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42945241928100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42966222763061523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4416213035583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44246816635131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44246816635131836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44267797470092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45610570907592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4566836357116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4566836357116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4568190574645996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4664340019226074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4670429229736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4670429229736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4671649932861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4766864776611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47716760635375977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47716760635375977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47725725173950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4848771095275879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4855070114135742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4855070114135742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4856100082397461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4950857162475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49558591842651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49558591842651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.495664119720459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5034060478210449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5038285255432129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5038285255432129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5038895606994629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5103592872619629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5106520652770996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5106520652770996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5106921195983887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5152182579040527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5154600143432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5154600143432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5154905319213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5191526412963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5193796157836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5193796157836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5194063186645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5227975845336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5230765342712402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5230765342712402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5231070518493652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5271964073181152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5275082588195801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5275082588195801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5275406837463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5321125984191895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.532379150390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.532379150390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5324058532714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5363578796386719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5365562438964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5365562438964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5365753173828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5395317077636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5397653579711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5397653579711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5397863388061523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5431852340698242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5433592796325684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5433592796325684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5433745384216309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5459532737731934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([83, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5485897064208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5485897064208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5487480163574219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5766105651855469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5629539489746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5633859634399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5638179779052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5633640289306641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2898, 40])
input nodes number: 6210
output nodes number: 2898
edges number: 17057
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5634307861328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5634312629699707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01917266845703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 6 input nodes size: 17591
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01799297332763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01799297332763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02638101577758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.026402950286865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01994609832763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02048778533935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02048778533935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02048778533935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17591, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02048778533935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([452, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.044756412506103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.044756412506103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04518747329711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04863595962524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([516, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04891252517700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04891252517700195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04940462112426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05757284164428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([534, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0580906867980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0580906867980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05859994888305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07026481628417969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([467, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07090091705322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07090091705322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 467, 128]), torch.Size([1, 467, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07134628295898438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08426189422607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 467, 128])
m.shape torch.Size([442, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08509302139282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08509302139282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08551454544067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10068941116333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([337, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10144281387329102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10144281387329102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10176420211791992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11558389663696289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([335, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11654138565063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11654138565063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11686086654663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13283491134643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([345, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13399124145507812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13399124145507812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13432025909423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1530742645263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([281, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1541156768798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1541156768798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 281, 128]), torch.Size([1, 281, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15438365936279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17153453826904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 281, 128])
m.shape torch.Size([3072, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1860489845275879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1860489845275879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3072, 128]), torch.Size([1, 3072, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1889786720275879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4027409553527832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3072, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3809375762939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3874044418334961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39400196075439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3874845504760742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6781, 256])
first layer input nodes number: 17591
first layer output nodes number: 6781
edges number: 47540
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3941349983215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.400601863861084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4022188186645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4022188186645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([332, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42676305770874023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42676305770874023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.427396297454834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4337143898010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([320, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43401288986206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43401288986206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43462324142456055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4440879821777344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([276, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4445786476135254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4445786476135254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44510507583618164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4573855400085449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45804500579833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45804500579833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45850276947021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47177791595458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47252941131591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47252941131591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4729185104370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4869260787963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4875335693359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4875335693359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48779869079589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49919891357421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([153, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5000958442687988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5000958442687988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5003876686096191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5149788856506348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([131, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5158405303955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5158405303955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5160903930664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5303325653076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([112, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5311765670776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5311765670776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5313901901245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5450620651245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([109, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5460033416748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5460033416748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5462112426757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5609722137451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5616931915283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5616931915283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5618419647216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5734462738037109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5742487907409668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5742487907409668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5743937492370605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5867152214050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5875425338745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5875425338745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5876798629760742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6003141403198242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6010260581970215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6010260581970215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6011366844177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.612088680267334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([58, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6128697395324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6128697395324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6129803657531738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6247067451477051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6251435279846191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6251435279846191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6252045631408691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6321015357971191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.632627010345459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.632627010345459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6326918601989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6404738426208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6410126686096191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6410126686096191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.641075611114502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6490693092346191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6494579315185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6494579315185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6495018005371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6553802490234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6559352874755859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6559352874755859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6559925079345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6640605926513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6645369529724121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6645369529724121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6645846366882324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6716418266296387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6721467971801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6721467971801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6721944808959961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6795854568481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6798715591430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6798715591430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6798982620239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6842241287231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.684603214263916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.684603214263916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6846356391906738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6901154518127441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([293, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6971397399902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6971397399902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6976985931396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7982969284057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 293, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7767848968505859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7772150039672852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7776451110839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7771930694580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2884, 40])
input nodes number: 6781
output nodes number: 2884
edges number: 25070
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7772636413574219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7772641181945801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0215301513671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 7 input nodes size: 24063
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019944190979003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019944190979003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0314183235168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03144025802612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02303028106689453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.023665428161621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.023665428161621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.023665428161621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([24063, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.023665428161621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([656, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05422496795654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05422496795654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05485057830810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06040763854980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([670, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.060733795166015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.060733795166015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06137275695800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07140016555786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([619, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07196617126464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07196617126464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0725564956665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08554363250732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([595, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08638334274291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08638334274291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08695077896118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10340642929077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([553, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10444116592407227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10444116592407227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10496854782104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12448978424072266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([538, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12576532363891602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12576532363891602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12627840042114258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14863061904907227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([473, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14995288848876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14995288848876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1504039764404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1729583740234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([404, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17427396774291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17427396774291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 404, 128]), torch.Size([1, 404, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17465925216674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19662046432495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 404, 128])
m.shape torch.Size([345, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1979084014892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1979084014892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19823741912841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21929454803466797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([3988, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2386612892150879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2386612892150879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3988, 128]), torch.Size([1, 3988, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2433304786682129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5190262794494629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3988, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4914102554321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49984169006347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5082731246948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49977540969848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([8841, 256])
first layer input nodes number: 24063
first layer output nodes number: 8841
edges number: 61754
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5084543228149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5168857574462891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5195541381835938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5195541381835938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([411, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5424900054931641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5424900054931641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.54327392578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5495452880859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([338, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5498032569885254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5498032569885254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.550447940826416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5607399940490723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5612654685974121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5612654685974121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.561826229095459  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.574303150177002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5749034881591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5749034881591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5753402709960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5880069732666016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5887689590454102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5887689590454102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5891580581665039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6031656265258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([190, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6040687561035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6040687561035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.60443115234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6200141906738281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([160, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6209096908569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6209096908569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6212148666381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6364736557006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([131, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.638084888458252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.638084888458252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6383347511291504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6525769233703613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6532478332519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6532478332519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6534233093261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6646537780761719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6654887199401855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6654887199401855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6656718254089355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6786723136901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6794266700744629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6794266700744629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6795792579650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6914811134338379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([82, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6923508644104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6923508644104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.692507266998291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7058014869689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7063484191894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7063484191894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7064437866210938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7152175903320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7159104347229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7159104347229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7160153388977051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7264008522033691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7270407676696777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7270407676696777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7271323204040527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7368369102478027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7375140190124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7375140190124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7376036643981934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7477335929870605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7484731674194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7484731674194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7485647201538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7595510482788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7597651481628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7597651481628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.759793758392334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7634272575378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7638330459594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7638330459594727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7638769149780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7697553634643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7702140808105469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7702140808105469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7702617645263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7769851684570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7773451805114746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7773451805114746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.777381420135498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7827448844909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7831921577453613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7831921577453613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7832341194152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7897381782531738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7900271415710449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7900271415710449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7900538444519043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.794379711151123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7947816848754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7947816848754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7948160171508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8006181716918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([236, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.806272029876709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.806272029876709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8067221641540527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8859457969665527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 236, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8662009239196777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8666372299194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8670735359191895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8666152954101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2927, 40])
input nodes number: 8841
output nodes number: 2927
edges number: 23317
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8667097091674805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8667101860046387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024892807006835938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 8 input nodes size: 14470
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.023036479949951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.023036479949951172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02993631362915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.029958248138427734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018462181091308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019011497497558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019011497497558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019011497497558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14470, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019011497497558594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([501, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.041597843170166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.041597843170166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04207563400268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0458979606628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([598, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04622936248779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04622936248779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.046799659729003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.055919647216796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([541, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05640840530395508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05640840530395508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05692434310913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06899547576904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([517, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06972360610961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06972360610961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07021665573120117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08451509475708008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([421, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08593177795410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08593177795410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 421, 128]), torch.Size([1, 421, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0863332748413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10078716278076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 421, 128])
m.shape torch.Size([396, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10171937942504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10171937942504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 396, 128]), torch.Size([1, 396, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1020970344543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11833620071411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 396, 128])
m.shape torch.Size([364, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11936235427856445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11936235427856445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11970949172973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13706636428833008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([308, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13806772232055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13806772232055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13836145401000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1551041603088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([292, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15621042251586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15621042251586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15648889541625977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17431116104125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 292, 128])
m.shape torch.Size([2810, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18757104873657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18757104873657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2810, 128]), torch.Size([1, 2810, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19026708602905273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3882594108581543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2810, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3682565689086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3746919631958008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38112735748291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37464141845703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6748, 256])
first layer input nodes number: 14470
first layer output nodes number: 6748
edges number: 45609
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3812375068664551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38789796829223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38977575302124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38977575302124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([313, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4177546501159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4177546501159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4183516502380371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42395734786987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([321, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42427635192871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42427635192871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42488861083984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43464088439941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([265, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43509912490844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43509912490844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4356045722961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44672441482543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4473714828491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4473714828491211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4478178024291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46076107025146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4614272117614746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4614272117614746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4617800712585449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47448301315307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.475125789642334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.475125789642334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47539663314819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4870429039001465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48776865005493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48776865005493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48801279067993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5002198219299316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5009207725524902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5009207725524902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5011248588562012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5127577781677246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([118, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.513676643371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.513676643371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5139017105102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5283060073852539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5289912223815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5289912223815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5291495323181152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5403895378112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5410294532775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5410294532775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5411591529846191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5512757301330566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([81, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5521454811096191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5521454811096191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.552299976348877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.565432071685791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5661420822143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5661420822143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5662622451782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5773172378540039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5779838562011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5779838562011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5780868530273438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5882835388183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.588895320892334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.588895320892334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5889830589294434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5982832908630371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5989160537719727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5989160537719727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5989999771118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6084833145141602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6092095375061035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6092095375061035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6092991828918457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6200566291809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.620842456817627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.620842456817627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.620934009552002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.632561206817627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6332826614379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6332826614379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6333627700805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6440973281860352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6445379257202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6445379257202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6445856094360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6513090133666992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6521329879760742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6521329879760742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6522130966186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6640691757202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.664494514465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.664494514465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6645364761352539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6710405349731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6718378067016602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6718378067016602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6719083786010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6833410263061523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6837444305419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6837444305419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6837806701660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6899051666259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([381, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6990418434143066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6990418434143066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6997685432434082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8304896354675293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 381, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8054919242858887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8059263229370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8063607215881348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8059043884277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2915, 40])
input nodes number: 6748
output nodes number: 2915
edges number: 27955
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8059749603271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8059754371643066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02006053924560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 9 input nodes size: 12907
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01846027374267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01846027374267578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024614810943603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024635791778564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01771402359008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018135547637939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018135547637939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018135547637939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([12907, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018135547637939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([517, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03645515441894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03645515441894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.036948204040527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.040892601013183594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([598, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.041216373443603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.041216373443603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04178667068481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.050341129302978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([533, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.050818443298339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.050818443298339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.051326751708984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0630345344543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([489, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06371307373046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06371307373046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0641794204711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07770347595214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([372, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07835721969604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07835721969604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07871198654174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09148359298706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([349, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09230470657348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09230470657348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09263753890991211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1069493293762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 349, 128])
m.shape torch.Size([302, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10779094696044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10779094696044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 302, 128]), torch.Size([1, 302, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1080789566040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12247943878173828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 302, 128])
m.shape torch.Size([285, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12342262268066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12342262268066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 285, 128]), torch.Size([1, 285, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12369441986083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13918685913085938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 285, 128])
m.shape torch.Size([251, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14012813568115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14012813568115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1403675079345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1556873321533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 251, 128])
m.shape torch.Size([2064, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16540956497192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16540956497192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2064, 128]), torch.Size([1, 2064, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16737794876098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3133573532104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2064, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.29659557342529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.30208873748779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.30788707733154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3023509979248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5760, 256])
first layer input nodes number: 12907
first layer output nodes number: 5760
edges number: 36515
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3079853057861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3134784698486328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3148517608642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3148517608642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([383, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3350205421447754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3350205421447754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3357510566711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34218645095825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([382, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34255552291870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34255552291870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34328413009643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35421323776245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([307, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3547344207763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3547344207763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3553199768066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3691444396972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3698129653930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3698129653930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37028980255126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38411808013916016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38480234146118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38480234146118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38516855239868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39835214614868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39909791946411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39909791946411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39940500259399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4126095771789551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41331052780151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41331052780151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41355276107788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42566442489624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42651987075805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42651987075805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42676210403442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4405694007873535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44127893447875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44127893447875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44146203994750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45318078994750977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45389699935913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45389699935913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4540572166442871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46543264389038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([91, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46631479263305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46631479263305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4664883613586426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4800267219543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([85, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48092031478881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48092031478881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4810824394226074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49486303329467773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49550676345825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49550676345825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4956173896789551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5057950019836426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5062646865844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5062646865844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5063390731811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5137033462524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5141997337341309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5141997337341309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5142703056335449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5217509269714355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5221309661865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5221309661865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5221824645996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5280017852783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5284337997436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5284337997436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5284872055053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5348958969116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5353193283081055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5353193283081055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5353689193725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5416669845581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5421171188354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5421171188354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5421667098999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5488119125366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5492100715637207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5492100715637207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5492520332336426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.555168628692627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5554909706115723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5554909706115723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5555233955383301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5603222846984863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5606656074523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5606656074523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5606980323791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5657238960266113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.565950870513916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.565950870513916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.565971851348877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5693707466125488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5696835517883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5696835517883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5697102546691895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5742230415344238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([152, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5778622627258301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5778622627258301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5781521797180176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6291775703430176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 152, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6120643615722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6124758720397949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6128873825073242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.612454891204834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2759, 40])
input nodes number: 5760
output nodes number: 2759
edges number: 19909
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6124958992004395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6124963760375977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018940448760986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 10 input nodes size: 16234
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01769113540649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01769113540649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.025432109832763672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.025454044342041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019278526306152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019788742065429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019788742065429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019788742065429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16234, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019788742065429688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([573, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04232168197631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04232168197631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04286813735961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0479278564453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([619, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04824495315551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04824495315551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04883527755737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05769014358520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([588, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.058236122131347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.058236122131347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 588, 128]), torch.Size([1, 588, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05879688262939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07144403457641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 588, 128])
m.shape torch.Size([535, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07225227355957031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07225227355957031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07276248931884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08800125122070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([479, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08888816833496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08888816833496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08934497833251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1057901382446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([412, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10674047470092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10674047470092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10713338851928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12402868270874023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([361, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12503719329833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12503719329833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1253814697265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1425952911376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([333, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1436934471130371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1436934471130371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 333, 128]), torch.Size([1, 333, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1440110206604004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16211271286010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 333, 128])
m.shape torch.Size([286, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16318130493164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16318130493164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1634540557861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1809101104736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 286, 128])
m.shape torch.Size([2707, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1936817169189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1936817169189453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2707, 128]), torch.Size([1, 2707, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19626331329345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38074159622192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2707, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3625068664550781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3690805435180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3756542205810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36902904510498047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6893, 256])
first layer input nodes number: 16234
first layer output nodes number: 6893
edges number: 45417
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3757772445678711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3823509216308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38399457931518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38399457931518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([370, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.406585693359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.406585693359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4072914123535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4130744934082031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([342, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4133791923522949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4133791923522949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4140315055847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4239649772644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42450428009033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42450428009033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4250764846801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43901824951171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43968963623046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43968963623046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44016456604003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4539375305175781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45466136932373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45466136932373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45504283905029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46877574920654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4695596694946289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4695596694946289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4698820114135742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48374271392822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48450326919555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48450326919555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48476457595825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4978299140930176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49862194061279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49862194061279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49885082244873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.511897087097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([111, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5127429962158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5127429962158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5129547119140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5265045166015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([100, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5273599624633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5273599624633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5275506973266602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5410928726196289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([94, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5419931411743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5419931411743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5421724319458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.556157112121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5568752288818359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5568752288818359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5570087432861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5683574676513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5691781044006348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5691781044006348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5693135261535645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5817723274230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.582512378692627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.582512378692627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5826268196105957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.593956470489502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5945773124694824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5945773124694824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5946669578552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6041693687438965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6049399375915527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6049399375915527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6050410270690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6164641380310059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6169528961181641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6169528961181641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6170158386230469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6245689392089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6251950263977051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6251950263977051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.625267505645752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6344723701477051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6349477767944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6349477767944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6350011825561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6421575546264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6427655220031738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6427655220031738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6428284645080566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6517033576965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6523380279541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6523380279541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6524009704589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6617164611816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6620869636535645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6620869636535645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6621232032775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6677403450012207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6679654121398926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6679654121398926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6679863929748535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6713852882385254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6718363761901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6718363761901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6718745231628418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.678321361541748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([186, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6827716827392578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6827716827392578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6831264495849609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7455654144287109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 186, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7263822555541992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.726813793182373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7272453308105469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7267918586730957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2894, 40])
input nodes number: 6893
output nodes number: 2894
edges number: 23003
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7268853187561035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7268857955932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02079916000366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 11 input nodes size: 12924
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019298553466796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019298553466796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.025461196899414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.025483131408691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01772022247314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01822376251220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01822376251220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01822376251220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([12924, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01822376251220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([345, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03925514221191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03925514221191406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03958415985107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04221630096435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([463, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.042493343353271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.042493343353271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04293489456176758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.049558162689208984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([480, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05002403259277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05002403259277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05048179626464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06055259704589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([472, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06122398376464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06122398376464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06167411804199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07472801208496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([433, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07567548751831055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07567548751831055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07608842849731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09095430374145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([436, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0919952392578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0919952392578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09241104125976562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11029052734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([367, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11130762100219727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11130762100219727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11165761947631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12915754318237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([341, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13028335571289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13028335571289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13060855865478516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14914512634277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([260, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15009832382202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15009832382202148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1503462791442871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1662154197692871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([2558, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17828893661499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17828893661499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2558, 128]), torch.Size([1, 2558, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18072843551635742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35449790954589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2558, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33576440811157227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34163427352905273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3475041389465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34158802032470703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6155, 256])
first layer input nodes number: 12924
first layer output nodes number: 6155
edges number: 42597
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34760236740112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3534722328186035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3553938865661621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3553938865661621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([255, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37964820861816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37964820861816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38013458251953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38402557373046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([298, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3843555450439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3843555450439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38492393493652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39444589614868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([272, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3949460983276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3949460983276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3954648971557617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40753793716430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40818214416503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40818214416503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40863037109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4216289520263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([235, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42313337326049805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42313337326049805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.423581600189209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43971776962280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([230, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44082021713256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44082021713256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44125890731811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46012258529663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([169, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4610404968261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4610404968261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4613628387451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4774799346923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([134, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4783492088317871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4783492088317871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.478604793548584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49317312240600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([115, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49404048919677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49404048919677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4942598342895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5082979202270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([114, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5092840194702148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5092840194702148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5095014572143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5249395370483398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([116, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.526057243347168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.526057243347168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5262784957885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5435361862182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5441985130310059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5441985130310059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5443263053894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5551886558532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.555999755859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.555999755859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5561332702636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5684165954589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([77, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5693860054016113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5693860054016113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5695328712463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5840725898742676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5845904350280762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5845904350280762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5846686363220215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5929579734802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5935955047607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5935955047607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5936794281005859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6031627655029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6040687561035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6040687561035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6041793823242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6174545288085938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6180739402770996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6180739402770996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6181483268737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6275954246520996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6279969215393066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6279969215393066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6280426979064941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6341767311096191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6349806785583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6349806785583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6350626945495605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6466269493103027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.647212028503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.647212028503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6472711563110352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6560220718383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6565423011779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6565423011779785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6565918922424316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.664278507232666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6646299362182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6646299362182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6646623611450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6699151992797852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6704525947570801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6704525947570801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6704983711242676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6782345771789551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([187, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6827054023742676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6827054023742676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6830620765686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7458367347717285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 187, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7246756553649902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7251110076904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7255463600158691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7250890731811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2921, 40])
input nodes number: 6155
output nodes number: 2921
edges number: 24848
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.725161075592041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7251615524291992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019185543060302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 12 input nodes size: 15520
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017724037170410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017724037170410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.025124549865722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.025146484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01896190643310547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0195770263671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0195770263671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0195770263671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15520, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0195770263671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([467, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04785919189453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04785919189453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 467, 128]), torch.Size([1, 467, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04830455780029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05186748504638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 467, 128])
m.shape torch.Size([522, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05214262008666992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05214262008666992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.052640438079833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.060140132904052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([548, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06067514419555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06067514419555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.061197757720947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07269525527954102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([495, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07337808609008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07337808609008789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07385015487670898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0875401496887207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([503, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08850336074829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08850336074829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08898305892944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10625219345092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([414, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10719680786132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10719680786132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10759162902832031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12456893920898438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([403, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1257166862487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1257166862487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 403, 128]), torch.Size([1, 403, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12610101699829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14531755447387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 403, 128])
m.shape torch.Size([374, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14655208587646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14655208587646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14690876007080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16723918914794922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([313, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16840410232543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16840410232543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1687026023864746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1878066062927246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([3733, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2054576873779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2054576873779297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3733, 128]), torch.Size([1, 3733, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20901775360107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46178245544433594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3733, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43621301651000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44362497329711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4510369300842285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44356679916381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7772, 256])
first layer input nodes number: 15520
first layer output nodes number: 7772
edges number: 56094
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4511547088623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45856666564941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4604196548461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4604196548461914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([337, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4862055778503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4862055778503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4868483543395996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4927248954772949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([298, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49297666549682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49297666549682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4935450553894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5055627822875977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.506103515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.506103515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5066490173339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5218753814697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([210, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5224103927612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5224103927612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5228109359741211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5344266891479492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([176, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5350723266601562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5350723266601562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5354080200195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5474929809570312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5481672286987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5481672286987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5484457015991211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.560420036315918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([158, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5613441467285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5613441467285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5616455078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5767135620117188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([145, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5780425071716309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5780425071716309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5783190727233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.594083309173584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5948796272277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5948796272277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.595085620880127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.608269214630127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([100, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6091275215148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6091275215148926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6093182563781738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6228604316711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([100, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6238226890563965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6238226890563965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6240134239196777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6388907432556152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6396951675415039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6396951675415039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6398439407348633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6524896621704102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6532526016235352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6532526016235352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6533803939819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6651372909545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6661171913146973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6661171913146973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.666262149810791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6806130409240723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6813626289367676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6813626289367676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6814713478088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.692995548248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6938486099243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6938486099243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6939611434936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7066774368286133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7074055671691895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7074055671691895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7074971199035645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7184834480285645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7190432548522949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7190432548522949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7191100120544434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7275881767272949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7280116081237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7280116081237793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7280592918395996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7344489097595215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7351555824279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7351555824279785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7352280616760254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7454476356506348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7459163665771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7459163665771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7459640502929688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.753021240234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7533359527587891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7533359527587891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7533664703369141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7580966949462891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7585902214050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7585902214050293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.758634090423584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7657408714294434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7662959098815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7662959098815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7663435935974121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7744021415710449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7818446159362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7818446159362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7823996543884277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8846793174743652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8619828224182129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8624191284179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8628554344177246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8623971939086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2927, 40])
input nodes number: 7772
output nodes number: 2927
edges number: 26357
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8624782562255859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8624787330627441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020712852478027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 13 input nodes size: 15222
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018962860107421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018962860107421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.026221275329589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.026242733001708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01882028579711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019368648529052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019368648529052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019368648529052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15222, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019368648529052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([523, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04405832290649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04405832290649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04455709457397461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04911231994628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([574, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.049410343170166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.049410343170166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0499577522277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.058168888092041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([590, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05873918533325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05873918533325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05930185317993164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07175779342651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([519, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07246637344360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07246637344360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07296133041381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08752298355102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([530, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08853912353515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08853912353515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08904457092285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10724067687988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([464, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10831546783447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10831546783447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10875797271728516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12778568267822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([409, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12934112548828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12934112548828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1297311782836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14923381805419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([346, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1503586769104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1503586769104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15068864822387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16949701309204102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([299, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17061519622802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17061519622802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1709003448486328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1891498565673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([3061, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20360326766967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20360326766967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3061, 128]), torch.Size([1, 3061, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20739507675170898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4207792282104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3061, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39832019805908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40529632568359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41227245330810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4052414894104004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7315, 256])
first layer input nodes number: 15222
first layer output nodes number: 7315
edges number: 49883
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4123878479003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41936397552490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42145490646362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42145490646362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([359, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4455404281616211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4455404281616211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4462251663208008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4524397850036621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([325, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45272254943847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45272254943847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4533424377441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.464139461517334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46465444564819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46465444564819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46519994735717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47748231887817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.478151798248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.478151798248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4786190986633301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4921708106994629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4929323196411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4929323196411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49332714080810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5075407028198242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([182, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5083932876586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5083932876586914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5087404251098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5236673355102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5244359970092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5244359970092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5247030258178711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5380544662475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5388360023498535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5388360023498535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5390629768371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5520005226135254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([120, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5529251098632812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5529251098632812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5531539916992188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5678024291992188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5686397552490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5686397552490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5688285827636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5822353363037109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5828919410705566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5828919410705566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5830273628234863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.593590259552002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5942263603210449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5942263603210449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5943427085876465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6042323112487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6048617362976074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6048617362976074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6049666404724121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6146178245544434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6152114868164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6152114868164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6153030395507812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6243667602539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.624941349029541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.624941349029541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.625023365020752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6337170600891113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6339068412780762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6339068412780762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6339354515075684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6371684074401855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6378078460693359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6378078460693359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6378841400146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6470394134521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6474685668945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6474685668945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6475200653076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6540603637695312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6545281410217285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6545281410217285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6545796394348145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6614804267883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6620697975158691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6620697975158691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6621308326721191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6707367897033691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6712512969970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6712512969970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6713027954101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.678924560546875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6792373657226562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6792373657226562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6792678833007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6839981079101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6844029426574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6844029426574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6844391822814941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.690310001373291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6907072067260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6907072067260742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6907415390014648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6965436935424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([268, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7029662132263184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7029662132263184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7034773826599121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7946581840515137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 268, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7736096382141113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7740345001220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7744593620300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7740130424499512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2849, 40])
input nodes number: 7315
output nodes number: 2849
edges number: 23568
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7740778923034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.774078369140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020392894744873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 14 input nodes size: 16183
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018808841705322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018808841705322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.026525497436523438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.026546955108642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01926708221435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019750595092773438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019750595092773438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019750595092773438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16183, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019750595092773438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([677, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0421605110168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0421605110168457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.042806148529052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.048653602600097656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([695, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.048993587493896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.048993587493896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 695, 128]), torch.Size([1, 695, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04965639114379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.060228824615478516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 695, 128])
m.shape torch.Size([642, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06081581115722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06081581115722656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.061428070068359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07489776611328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([586, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07570934295654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07570934295654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07626819610595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09323596954345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([517, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09418916702270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09418916702270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09468221664428711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11278247833251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([393, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11366033554077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11366033554077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 393, 128]), torch.Size([1, 393, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11403512954711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13015127182006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 393, 128])
m.shape torch.Size([374, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1312122344970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1312122344970703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13156890869140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14940261840820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([335, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15050220489501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15050220489501953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15082168579101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16903209686279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([238, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16989374160766602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16989374160766602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1701207160949707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1846470832824707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 238, 128])
m.shape torch.Size([2581, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19684076309204102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19684076309204102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2581, 128]), torch.Size([1, 2581, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19930219650268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.374636173248291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2581, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35513734817504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.361849308013916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3685612678527832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36179685592651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7038, 256])
first layer input nodes number: 16183
first layer output nodes number: 7038
edges number: 44530
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3686838150024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3753957748413086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3770737648010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3770737648010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([463, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39733219146728516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39733219146728516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39821529388427734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40528011322021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([400, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4056077003479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4056077003479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4063706398010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.417818546295166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([324, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41837167739868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41837167739868164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4189896583557129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43346309661865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([260, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4342327117919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4342327117919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43472862243652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44974184036254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4505033493041992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4505033493041992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45090389251708984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46532344818115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4660172462463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4660172462463379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46631288528442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47902536392211914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47974586486816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47974586486816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4799919128417969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4922943115234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49289417266845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49289417266845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4930734634399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5032930374145508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.503852367401123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.503852367401123  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.503995418548584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.513150691986084  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5138387680053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5138387680053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5139894485473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5246877670288086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5252575874328613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5252575874328613  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5253739356994629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5344491004943848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5349907875061035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5349907875061035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5350899696350098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.543520450592041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5440082550048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5440082550048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5440902709960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5516357421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5520792007446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5520792007446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5521478652954102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5589456558227539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5595316886901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5595316886901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5596137046813965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5683073997497559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5687432289123535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5687432289123535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5688023567199707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5754837989807129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.576042652130127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.576042652130127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5761113166809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5843510627746582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5847320556640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5847320556640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.58477783203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5905914306640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5910072326660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5910072326660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5910530090332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5971870422363281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5977025032043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5977025032043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5977559089660645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6052861213684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6056632995605469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6056632995605469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6057014465332031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6113471984863281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6116456985473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6116456985473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6116743087768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6161088943481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.616337776184082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.616337776184082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.616358757019043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6197576522827148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6200013160705566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6200013160705566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6200222969055176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.623568058013916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([201, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.628387451171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.628387451171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6287708282470703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6962451934814453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 201, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6791400909423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6795611381530762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6799821853637695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.679539680480957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2825, 40])
input nodes number: 7038
output nodes number: 2825
edges number: 20226
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6796097755432129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6796102523803711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02069234848022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 15 input nodes size: 11464
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019263267517089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019263267517089844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02472972869873047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024751663208007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0170135498046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017325401306152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017325401306152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017325401306152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([11464, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017325401306152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([860, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03076171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03076171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.031581878662109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.038143157958984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([812, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03850746154785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03850746154785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03928184509277344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05089759826660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([639, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.051424503326416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.051424503326416016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05203390121459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0665898323059082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([532, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06729984283447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06729984283447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06780719757080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08256244659423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([410, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08328628540039062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08328628540039062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08367729187011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09775352478027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([344, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0985422134399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0985422134399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 344, 128]), torch.Size([1, 344, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09887027740478516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1129770278930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 344, 128])
m.shape torch.Size([241, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1136174201965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1136174201965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 241, 128]), torch.Size([1, 241, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11384725570678711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12533903121948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 241, 128])
m.shape torch.Size([236, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12612438201904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12612438201904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12634944915771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13917827606201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([164, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1397695541381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1397695541381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 164, 128]), torch.Size([1, 164, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13992595672607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14993572235107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 164, 128])
m.shape torch.Size([1078, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1549978256225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1549978256225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15602588653564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2290182113647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21831035614013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22338008880615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22844982147216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22334003448486328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([5316, 256])
first layer input nodes number: 11464
first layer output nodes number: 5316
edges number: 26474
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22853755950927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23360729217529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23539447784423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23539447784423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([642, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.25087594985961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.25087594985961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 642, 256]), torch.Size([1, 642, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.25210046768188477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2620663642883301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 642, 256])
m.shape torch.Size([463, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2623443603515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2623443603515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2632274627685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2769632339477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([379, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2776641845703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2776641845703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.27838706970214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.29438209533691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([277, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2950859069824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2950859069824219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.29561424255371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3115043640136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3122744560241699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3122744560241699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.31267499923706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32709455490112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32776546478271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32776546478271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32805347442626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3404378890991211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34111499786376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34111499786376953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34134769439697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3529825210571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35365819931030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35365819931030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3538546562194824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3650527000427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.365664005279541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.365664005279541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36582040786743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37583017349243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3764824867248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3764824867248535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37662744522094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3869194984436035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([50, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3873758316040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3873758316040039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38747119903564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3949098587036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3954620361328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3954620361328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39556121826171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40399169921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([33, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4043545722961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4043545722961426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4044175148010254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41020822525024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4105539321899414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4105539321899414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41060733795166016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4158945083618164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41635799407958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41635799407958984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41642284393310547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4232969284057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42371082305908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42371082305908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4237661361694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43001651763916016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4303321838378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4303321838378906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4303722381591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4351787567138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43543577194213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43543577194213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43546628952026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43934202194213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4395461082458496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4395461082458496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43956899642944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44263601303100586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44281721115112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44281721115112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44283628463745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4455256462097168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4457583427429199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4457583427429199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44578123092651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44916868209838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44924211502075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44924211502075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4492497444152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45043230056762695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4506497383117676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4506497383117676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4506688117980957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45375871658325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4538416862487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4538416862487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45384931564331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4551386833190918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([67, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4567451477050781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4567451477050781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45687294006347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47936439514160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4673590660095215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4677896499633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46822023391723633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46776771545410156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2887, 40])
input nodes number: 5316
output nodes number: 2887
edges number: 15328
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46783924102783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46783971786499023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018000125885009766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 16 input nodes size: 13942
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017023086547851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.017023086547851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02367115020751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.023693084716796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018204689025878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018630027770996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018630027770996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018630027770996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13942, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018630027770996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([665, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.037305355072021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.037305355072021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03793954849243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.043439388275146484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([731, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.043819427490234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.043819427490234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 731, 128]), torch.Size([1, 731, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.044516563415527344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05511474609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 731, 128])
m.shape torch.Size([627, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.055663108825683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.055663108825683594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05626106262207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07005977630615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([560, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07082891464233398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07082891464233398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07136297225952148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08738470077514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([494, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08829545974731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08829545974731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08876657485961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10572671890258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([400, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10663557052612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10663557052612305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10701704025268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12342023849487305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([338, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12435770034790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12435770034790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1246800422668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14079713821411133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([322, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14186429977416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14186429977416992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14217138290405273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15967512130737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([254, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16061162948608398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16061162948608398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 254, 128]), torch.Size([1, 254, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16085386276245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17635679244995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 254, 128])
m.shape torch.Size([1906, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18532419204711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18532419204711914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1906, 128]), torch.Size([1, 1906, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18714189529418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.316281795501709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1906, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3005843162536621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.30658960342407227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3125948905944824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.30654239654541016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6297, 256])
first layer input nodes number: 13942
first layer output nodes number: 6297
edges number: 37406
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3127007484436035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.31870603561401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3202075958251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3202075958251953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([481, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34047698974609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34047698974609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34139442443847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.34905529022216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([433, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3494291305541992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3494291305541992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35025501251220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3626432418823242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([324, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36316490173339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36316490173339844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3637828826904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3786306381225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([274, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3793754577636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3793754577636719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3798980712890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3950538635253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([218, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3958415985107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3958415985107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3962574005126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4112262725830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41190099716186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41190099716186523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41219282150268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.424741268157959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4255037307739258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4255037307739258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42576122283935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43863582611083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43938398361206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43938398361206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43960142135620117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4519953727722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45276927947998047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45276927947998047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45296382904052734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46541500091552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46603870391845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46603870391845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46618175506591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47633838653564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4769120216369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4769120216369629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.47702836990356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48610353469848633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4867262840270996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4867262840270996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48683881759643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49640417098999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4969978332519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4969978332519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4970970153808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5062217712402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5067644119262695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5067644119262695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5068483352661133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5151567459106445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.515662670135498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.515662670135498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5157351493835449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5234179496765137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5238585472106934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5238585472106934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5239176750183105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5305991172790527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5310764312744141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5310764312744141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5311355590820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5382308959960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5387725830078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5387725830078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5388355255126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5468292236328125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.547236442565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.547236442565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5472822189331055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5534162521362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5537586212158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5537586212158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5537948608398438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5589046478271484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5591692924499512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5591692924499512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5591959953308105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.563148021697998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5634522438049316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5634522438049316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5634808540344238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5679154396057129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5681667327880859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5681667327880859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5681896209716797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5718975067138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5723013877868652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5723013877868652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5723357200622559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5781378746032715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([143, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5815567970275879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5815567970275879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5818295478820801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6298336982727051  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 143, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6128597259521484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6132926940917969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6137256622314453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6132707595825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2903, 40])
input nodes number: 6297
output nodes number: 2903
edges number: 19549
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.61334228515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6133427619934082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01948261260986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 17 input nodes size: 19264
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018207073211669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.018207073211669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.027392864227294922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.027414798736572266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020744800567626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02122354507446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02122354507446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02122354507446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([19264, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02122354507446289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([786, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.044168949127197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.044168949127197266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 786, 128]), torch.Size([1, 786, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04491853713989258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0509181022644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 786, 128])
m.shape torch.Size([785, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05129194259643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05129194259643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05204057693481445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06417226791381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([763, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06488943099975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06488943099975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06561708450317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08247566223144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([641, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08333444595336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08333444595336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08394575119018555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10167360305786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([618, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10284137725830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10284137725830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10343074798583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1246480941772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([513, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12582111358642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12582111358642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1263103485107422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14793682098388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([419, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14909076690673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14909076690673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 419, 128]), torch.Size([1, 419, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1494903564453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16946983337402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 419, 128])
m.shape torch.Size([360, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17064332962036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17064332962036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17098665237426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19055604934692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([278, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19157743453979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19157743453979492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 278, 128]), torch.Size([1, 278, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19184255599975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20881032943725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 278, 128])
m.shape torch.Size([2431, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22026968002319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22026968002319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2431, 128]), torch.Size([1, 2431, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22258806228637695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38814353942871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2431, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.36852025985717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3757624626159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38300466537475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3757057189941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7594, 256])
first layer input nodes number: 19264
first layer output nodes number: 7594
edges number: 46002
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3831501007080078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3903923034667969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39224863052368164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.39224863052368164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([537, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4102597236633301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4102597236633301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 537, 256]), torch.Size([1, 537, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4112839698791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41973066329956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 537, 256])
m.shape torch.Size([392, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41997241973876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41997241973876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42072010040283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4325246810913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([339, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43312835693359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43312835693359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4337749481201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4482460021972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([255, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44890308380126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44890308380126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4493894577026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.46349430084228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([246, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4644336700439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4644336700439453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4649028778076172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4817943572998047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([193, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48267316818237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48267316818237305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48304128646850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4988703727722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49960803985595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49960803985595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49986934661865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.512934684753418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5137348175048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5137348175048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5139656066894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5271205902099609  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5278186798095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5278186798095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5279979705810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5394725799560547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5401520729064941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5401520729064941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5403046607971191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5511384010314941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5515804290771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5515804290771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5516738891601562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5589637756347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5595517158508301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5595517158508301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5596566200256348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5685734748840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5691709518432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5691709518432617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.569270133972168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.578394889831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5789508819580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5789508819580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5790367126464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5875339508056641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5879383087158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5879383087158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5879974365234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5942649841308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5946202278137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5946202278137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.594667911529541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6000561714172363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6004085540771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6004085540771484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6004524230957031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6057167053222656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6059889793395996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6059889793395996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6060214042663574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6101393699645996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6104521751403809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6104521751403809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6104865074157715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6150870323181152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6153583526611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6153583526611328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.615386962890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6194210052490234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6195483207702637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6195483207702637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6195616722106934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6215376853942871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6217002868652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6217002868652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6217155456542969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6240806579589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6243386268615723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6243386268615723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.624361515045166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6280694007873535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.628288745880127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.628288745880127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6283078193664551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6315312385559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([128, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6345973014831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6345973014831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6348414421081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6778101921081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 128, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6631388664245605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.663569450378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6640000343322754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6635475158691406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2889, 40])
input nodes number: 7594
output nodes number: 2889
edges number: 18067
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6636238098144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6636242866516113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.022182464599609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 18 input nodes size: 20038
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020742416381835938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020742416381835938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.030297279357910156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.030318737030029297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021111011505126953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021618366241455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021618366241455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021618366241455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([20038, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021618366241455078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([712, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04620552062988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04620552062988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 712, 128]), torch.Size([1, 712, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04688453674316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05231666564941406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 712, 128])
m.shape torch.Size([834, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05277252197265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05277252197265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05356788635253906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0661630630493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([730, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06681632995605469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06681632995605469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 730, 128]), torch.Size([1, 730, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06751251220703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08282852172851562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 730, 128])
m.shape torch.Size([629, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0836801528930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0836801528930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08428001403808594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10167598724365234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([532, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10264444351196289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10264444351196289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10315179824829102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12145853042602539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([452, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1224980354309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1224980354309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12292909622192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1414647102355957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([407, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1426076889038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1426076889038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14299583435058594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16240310668945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([381, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16366243362426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16366243362426758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16402578353881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1847367286682129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([321, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18593263626098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18593263626098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18623876571655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20583105087280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([2820, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21912479400634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21912479400634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 2820, 128]), torch.Size([1, 2820, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22181415557861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4198160171508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 2820, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3984675407409668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4068150520324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.41427087783813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4058647155761719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([7818, 256])
first layer input nodes number: 20038
first layer output nodes number: 7818
edges number: 49444
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4135308265686035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4218783378601074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4228506088256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4228506088256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([491, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4412245750427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4412245750427246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44216108322143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45055150985717773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([449, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4509468078613281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4509468078613281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.45180320739746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4657464027404785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([328, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4662642478942871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4662642478942871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4668898582458496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4806532859802246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([270, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48151683807373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48151683807373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48203182220458984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49759674072265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49837732315063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49837732315063477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49878931045532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5136208534240723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5142569541931152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5142569541931152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5145354270935059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5265097618103027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5272789001464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5272789001464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5275363922119141  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5404109954833984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5411667823791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5411667823791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5413861274719238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5538887977600098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5545663833618164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5545663833618164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5547399520874023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5658483505249023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5664634704589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5664634704589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5666027069091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5764884948730469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.577085018157959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.577085018157959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5772051811218262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5865778923034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5871291160583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5871291160583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5872302055358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.595822811126709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5962224006652832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5962224006652832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5962910652160645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6026082038879395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6031527519226074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6031527519226074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6032347679138184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6113543510437012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6118035316467285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6118035316467285  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6118683815002441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6187424659729004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6191253662109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6191253662109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6191768646240234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6249961853027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6252646446228027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6252646446228027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6252989768981934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6294188499450684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6298861503601074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6298861503601074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6299395561218262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6367220878601074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6370425224304199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6370425224304199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6370787620544434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.641934871673584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6421670913696289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6421670913696289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6421918869018555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6456880569458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6460795402526855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6460795402526855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6461176872253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6517634391784668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6520195007324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6520195007324219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6520442962646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6558876037597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6561408042907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6561408042907715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6561636924743652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6598715782165527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6601371765136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6601371765136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6601600646972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6640281677246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([145, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6675009727478027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6675009727478027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6677775382995605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7164530754089355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 145, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7013230323791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7017478942871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7021727561950684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7017264366149902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2850, 40])
input nodes number: 7818
output nodes number: 2850
edges number: 18490
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7018008232116699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7018013000488281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.022616863250732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 19 input nodes size: 17191
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021105289459228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.021105289459228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.029302597045898438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.029324054718017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.01974773406982422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020145416259765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020145416259765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020145416259765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17191, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.020145416259765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([806, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03895378112792969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03895378112792969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.039722442626953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.046222686767578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([921, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04671669006347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04671669006347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04759502410888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06077003479003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([754, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06140947341918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06140947341918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 754, 128]), torch.Size([1, 754, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.062128543853759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07799100875854492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 754, 128])
m.shape torch.Size([618, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07881021499633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07881021499633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07939958572387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09649133682250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([559, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09752941131591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09752941131591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09806251525878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1179966926574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([408, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1188974380493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1188974380493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11928653717041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1360177993774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([369, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1370549201965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1370549201965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1374068260192871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15500211715698242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([301, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1559743881225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1559743881225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 301, 128]), torch.Size([1, 301, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15626144409179688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1726236343383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 301, 128])
m.shape torch.Size([269, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17460346221923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17460346221923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17486000061035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19127845764160156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([1747, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19948053359985352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19948053359985352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 1747, 128]), torch.Size([1, 1747, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20114660263061523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.31943750381469727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 1747, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.30380678176879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.31024599075317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.31668519973754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3101954460144043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([6752, 256])
first layer input nodes number: 17191
first layer output nodes number: 6752
edges number: 37507
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3168153762817383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3234682083129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32486438751220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32486438751220703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([526, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3405156135559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3405156135559082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 526, 256]), torch.Size([1, 526, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3415188789367676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35213708877563477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 526, 256])
m.shape torch.Size([518, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3526344299316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3526344299316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 518, 256]), torch.Size([1, 518, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3536224365234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37001705169677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 518, 256])
m.shape torch.Size([351, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37073564529418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37073564529418945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37140512466430664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3867936134338379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3873934745788574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3873934745788574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38785696029663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40129804611206055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([241, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40230751037597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.40230751037597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4027671813964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4193153381347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4199509620666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4199509620666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.42023706436157227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4325394630432129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4332308769226074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4332308769226074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.43346738815307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44529294967651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4459514617919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4459514617919922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.44614410400390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4571247100830078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4579195976257324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4579195976257324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4581160545349121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4706892967224121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4713315963745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4713315963745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4714784622192383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4819059371948242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4825730323791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4825730323791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48270654678344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4931206703186035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49355030059814453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49355030059814453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49363231658935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5006036758422852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5011501312255859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5011501312255859  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5012397766113281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5094871520996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5099000930786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5099000930786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5099649429321289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5163850784301758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5166845321655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5166845321655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.516728401184082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5213785171508789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5217413902282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5217413902282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5217890739440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5271773338317871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5274806022644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5274806022644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5275187492370605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5320963859558105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5323023796081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5323023796081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5323271751403809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5354762077331543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5357561111450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5357561111450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5357866287231445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5398759841918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.540168285369873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.540168285369873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.540198802947998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.544501781463623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5447087287902832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5447087287902832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5447297096252441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5478348731994629  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5479936599731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5479936599731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.548008918762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5503740310668945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5504550933837891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5504550933837891  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5504627227783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5516986846923828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.551856517791748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.551856517791748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5518698692321777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5541262626647949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([63, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.555633544921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.555633544921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5557537078857422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5769023895263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5645709037780762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5649933815002441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5654158592224121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.564971923828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2834, 40])
input nodes number: 6752
output nodes number: 2834
edges number: 15623
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5650415420532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5650420188903809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02097034454345703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 20 input nodes size: 40196
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019745349884033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.019745349884033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0392765998840332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03929758071899414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.031078815460205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.032328128814697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.032328128814697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.032328128814697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([40196, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.032328128814697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([531, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09863996505737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09863996505737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09914636611938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10319757461547852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([640, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10355472564697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10355472564697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 640, 128]), torch.Size([1, 640, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10416507720947266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11332035064697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 640, 128])
m.shape torch.Size([511, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11374616622924805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11374616622924805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11423349380493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1249547004699707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([514, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12569141387939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12569141387939453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12618160247802734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14074993133544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([547, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14180898666381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14180898666381836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14233064651489258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16197872161865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([489, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1631169319152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1631169319152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16358327865600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18363618850708008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([481, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18500852584838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18500852584838867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18546724319458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2084031105041504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([478, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20999717712402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20999717712402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21045303344726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2364368438720703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([520, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23844051361083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23844051361083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2389364242553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2717251777648926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([11191, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32484006881713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32484006881713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11191, 128]), torch.Size([1, 11191, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33593034744262695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.099534511566162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11191, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0363621711730957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.051527500152588  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.06669282913208  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0514087677001953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([15902, 256])
first layer input nodes number: 40196
first layer output nodes number: 15902
edges number: 134850
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0669946670532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0821599960327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0865259170532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0865259170532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([323, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1184544563293457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1184544563293457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1190705299377441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.126579761505127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([299, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1268467903137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1268467903137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1274170875549316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1361727714538574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([190, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1364355087280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1364355087280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1367979049682617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.144770622253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([143, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.145139217376709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.145139217376709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1454119682312012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1533217430114746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([134, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.153829574584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.153829574584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1540851593017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1632862091064453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([113, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1638102531433105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1638102531433105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1640257835388184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1732935905456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([96, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1738319396972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1738319396972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1740150451660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1831703186035156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([68, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1836018562316895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1836018562316895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1837315559387207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.191124439239502  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.191725730895996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.191725730895996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1918725967407227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2012720108032227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2018136978149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2018136978149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2019357681274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2106027603149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2112503051757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2112503051757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2113780975341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2213459014892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.221916675567627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.221916675567627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2220215797424316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.23093843460083  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2314109802246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2314109802246094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2314910888671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.238861083984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2396016120910645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2396016120910645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2397122383117676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.250664234161377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2510991096496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2510991096496582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2511639595031738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.25803804397583  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.258497714996338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.258497714996338  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.258558750152588  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.265455722808838  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2658991813659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2658991813659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2659544944763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2725920677185059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2733778953552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2733778953552246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2734675407409668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2848525047302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.285520076751709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.285520076751709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2855944633483887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2955622673034668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2961978912353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2961978912353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2962646484375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3056774139404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3061890602111816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3061890602111816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3062405586242676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3138623237609863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3143229484558105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3143229484558105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3143668174743652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3211665153503418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3216533660888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3216533660888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3216972351074219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3288040161132812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3292665481567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3292665481567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3293066024780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.336075782775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([723, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3534283638000488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3534283638000488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 723, 256]), torch.Size([1, 723, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3548073768615723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6038322448730469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 723, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.574455738067627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5748677253723145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.575279712677002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5748467445373535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2762, 40])
input nodes number: 15902
output nodes number: 2762
edges number: 32698
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5749759674072266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5749764442443848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.034499168395996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 21 input nodes size: 44494
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05255270004272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05257368087768555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03302145004272461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03392457962036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03392457962036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03392457962036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([44494, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03392457962036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([786, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08398771286010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08398771286010742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 786, 128]), torch.Size([1, 786, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08473730087280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09073400497436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 786, 128])
m.shape torch.Size([932, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0912480354309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0912480354309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09213685989379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1054692268371582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([850, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10634088516235352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10634088516235352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10715150833129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1255345344543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([694, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12645292282104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12645292282104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 694, 128]), torch.Size([1, 694, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12711477279663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14684629440307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 694, 128])
m.shape torch.Size([679, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1481342315673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1481342315673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14878177642822266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17299795150756836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([560, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17427635192871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17427635192871094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17481040954589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19786643981933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([523, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19934511184692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19934511184692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1998438835144043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22483348846435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([477, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22640371322631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22640371322631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22685861587524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.25278806686401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([484, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2553091049194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2553091049194336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2557706832885742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2853116989135742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([7498, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3208341598510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3208341598510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7498, 128]), torch.Size([1, 7498, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3279848098754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8357782363891602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7498, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7914280891418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8042864799499512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8171448707580566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8041858673095703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13483, 256])
first layer input nodes number: 44494
first layer output nodes number: 13483
edges number: 101544
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8174786567687988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8303370475769043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8335518836975098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8335518836975098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([489, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8529176712036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8529176712036133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8538503646850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8615493774414062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([436, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8619213104248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8619213104248047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8627529144287109  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8757572174072266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([317, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8762555122375488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8762555122375488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8768601417541504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8941702842712402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([214, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.894690990447998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.894690990447998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8950991630554199  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9069361686706543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.907707691192627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.907707691192627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9080948829650879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9220337867736816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([132, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9226016998291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9226016998291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9228534698486328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9336795806884766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9344015121459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9344015121459961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9346418380737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9466581344604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([93, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9472532272338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9472532272338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9474306106567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9575414657592773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9581537246704102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9581537246704102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.958308219909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.968195915222168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9688782691955566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9688782691955566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9690289497375488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9797272682189941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9802865982055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9802865982055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9804010391235352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9893274307250977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9898586273193359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9898586273193359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9899559020996094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9982242584228516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9985756874084473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9985756874084473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9986367225646973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0042519569396973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0047197341918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0047197341918945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0047903060913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0117769241333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0121169090270996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0121169090270996  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0121665000915527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.017423152923584  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0178289413452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0178289413452148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0178823471069336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0239171981811523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0242013931274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0242013931274414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0242376327514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0285863876342773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0289835929870605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0289835929870605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.029029369354248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0348429679870605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0351672172546387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0351672172546387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.035203456878662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0400595664978027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0405607223510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0405607223510742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0406122207641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0478734970092773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0480499267578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0480499267578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0480690002441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0508918762207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0511784553527832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0511784553527832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0512051582336426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0553441047668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.055530071258545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.055530071258545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0555472373962402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0583281517028809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0586657524108887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0586657524108887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0586943626403809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0635294914245605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([225, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0689215660095215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0689215660095215  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0693507194519043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1448817253112793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 225, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1286077499389648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1290202140808105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1294326782226562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1289992332458496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2766, 40])
input nodes number: 13483
output nodes number: 2766
edges number: 19530
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1291213035583496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1291217803955078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03563976287841797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 22 input nodes size: 32772
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03302192687988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03302192687988281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.048648834228515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04866981506347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.027164459228515625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.028070449829101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.028070449829101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.028070449829101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([32772, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.028070449829101562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([656, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07614421844482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07614421844482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07676982879638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0824747085571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([671, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08280181884765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08280181884765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08344173431396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09304046630859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 671, 128])
m.shape torch.Size([611, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09359455108642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09359455108642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09417724609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10699653625488281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([588, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10782670974731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10782670974731445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 588, 128]), torch.Size([1, 588, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10838747024536133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12520837783813477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 588, 128])
m.shape torch.Size([585, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12632274627685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12632274627685547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12688064575195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14719152450561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([542, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14846324920654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14846324920654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14898014068603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17198610305786133  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([490, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17336320877075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17336320877075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17383050918579102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19719552993774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([501, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19887304306030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19887304306030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19935083389282227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22658491134643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([433, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22820425033569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22820425033569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22861719131469727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.25504541397094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([7395, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2901010513305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2901010513305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 7395, 128]), torch.Size([1, 7395, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.29741573333740234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7987918853759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 7395, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7540850639343262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7659792900085449  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7778735160827637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7658863067626953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([12472, 256])
first layer input nodes number: 32772
first layer output nodes number: 12472
edges number: 97645
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7781200408935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7900142669677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7938675880432129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7938675880432129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8180079460144043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8180079460144043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8188014030456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8260889053344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([347, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8263592720031738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8263592720031738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8270211219787598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8394722938537598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([259, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8398885726928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8398885726928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8403825759887695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8594603538513184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([195, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8599634170532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8599634170532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8603353500366211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8711214065551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8718533515930176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8718533515930176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8722176551818848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8853325843811035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8860445022583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8860445022583008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8863401412963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.899052619934082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.899665355682373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.899665355682373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8998808860778809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9106574058532715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9114189147949219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9114189147949219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9116344451904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.923919677734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9244956970214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9244956970214844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9246463775634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9342899322509766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9350123405456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9350123405456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9351706504821777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9464106559753418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.947166919708252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.947166919708252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9473176002502441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9590706825256348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9596877098083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9596877098083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9598021507263184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9695296287536621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9700098037719727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9700098037719727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9700918197631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9776372909545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9780268669128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9780268669128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9780879020690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9841303825378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9847488403320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9847488403320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9848346710205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9939327239990234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9945049285888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9945049285888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9945812225341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0032024383544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0036544799804688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0036544799804688  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0037117004394531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0105781555175781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0109996795654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0109996795654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0110492706298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0173473358154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0178523063659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0178523063659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0179076194763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0253195762634277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.02569580078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.02569580078125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.025735855102539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0313835144042969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0318279266357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0318279266357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0318717956542969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0383644104003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0388288497924805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0388288497924805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0388727188110352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0456724166870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0459160804748535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0459160804748535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0459389686584473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0496468544006348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0502352714538574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0502352714538574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0502848625183105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0586657524108887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([334, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.066666603088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.066666603088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0673036575317383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1818532943725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 334, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1606707572937012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1610841751098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1614975929260254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1610631942749023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2774, 40])
input nodes number: 12472
output nodes number: 2774
edges number: 23887
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1611781120300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1611785888671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.029711246490478516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 23 input nodes size: 26623
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02716541290283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02716541290283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03986024856567383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.039881229400634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024233341217041016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024806499481201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024806499481201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024806499481201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([26623, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024806499481201172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([861, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.055314064025878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.055314064025878906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05613517761230469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06270408630371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([890, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06314229965209961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06314229965209961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06399106979370117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.076934814453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([709, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07752466201782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.07752466201782227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0782008171081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09307622909545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([638, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09405279159545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09405279159545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09466123580932617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11304235458374023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([551, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11405181884765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11405181884765625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1145772933959961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13349437713623047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([469, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13457345962524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13457345962524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13502073287963867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15425348281860352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([386, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1553182601928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1553182601928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 386, 128]), torch.Size([1, 386, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1556863784790039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17409229278564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 386, 128])
m.shape torch.Size([384, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17537307739257812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17537307739257812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 384, 128]), torch.Size([1, 384, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17573928833007812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19661331176757812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 384, 128])
m.shape torch.Size([360, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19797515869140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19797515869140625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1983184814453125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2202911376953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([3878, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23861122131347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23861122131347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 3878, 128]), torch.Size([1, 3878, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2423095703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5058393478393555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 3878, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4796409606933594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.4883441925048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49704742431640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.48827600479125977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([9126, 256])
first layer input nodes number: 26623
first layer output nodes number: 9126
edges number: 60683
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.49724769592285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.505950927734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5088396072387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5088396072387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([581, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5249185562133789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5249185562133789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.526026725769043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5351972579956055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([473, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5355525016784668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5355525016784668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5364546775817871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5518231391906738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([337, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5523438453674316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5523438453674316  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5529866218566895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5671734809875488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5677981376647949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5677981376647949  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5682673454284668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5818743705749512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5825915336608887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5825915336608887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5829691886901855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.596564769744873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5973162651062012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5973162651062012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.5976271629333496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6109957695007324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([104, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6115403175354004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6115403175354004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6117386817932129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6216568946838379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6223573684692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6223573684692383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6225557327270508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6338624954223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.634455680847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.634455680847168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.634608268737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.644373893737793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6448745727539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6448745727539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.644989013671875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6531143188476562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6536388397216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6536388397216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6537437438964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.66192626953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([36, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6622891426086426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6622891426086426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6623578071594238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6681942939758301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6686100959777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6686100959777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6686787605285645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6749958992004395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6753387451171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6753387451171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6753921508789062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6806793212890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([13, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6808404922485352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6808404922485352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6808652877807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6834936141967773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6836814880371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6836814880371094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6837062835693359  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6865081787109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6867246627807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6867246627807617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6867513656616211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6899557113647461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.690150260925293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.690150260925293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6901731491088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.693079948425293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6933975219726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6933975219726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6934318542480469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6980323791503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6983613967895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6983613967895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.6983957290649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7032365798950195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7034616470336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7034616470336914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7034845352172852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7068719863891602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7070298194885254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7070298194885254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7070450782775879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7094101905822754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7094912528991699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7094912528991699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7094988822937012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7107348442077637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7108697891235352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7108697891235352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.710881233215332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7128152847290039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([141, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7161979675292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7161979675292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7164669036865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7637996673583984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 141, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7511873245239258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7515988349914551  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7520103454589844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7515778541564941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2760, 40])
input nodes number: 9126
output nodes number: 2760
edges number: 16015
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7516651153564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.7516655921936035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.025932788848876953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 24 input nodes size: 41557
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024231433868408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.024231433868408203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04404735565185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.044068336486816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03135251998901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03232908248901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03232908248901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03232908248901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([41557, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03232908248901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([744, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08547163009643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.08547163009643555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0861811637878418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09210681915283203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([756, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09247303009033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09247303009033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 756, 128]), torch.Size([1, 756, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09319400787353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10400867462158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 756, 128])
m.shape torch.Size([710, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1049199104309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1049199104309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 710, 128]), torch.Size([1, 710, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10559701919555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12116479873657227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 710, 128])
m.shape torch.Size([669, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12210226058959961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12210226058959961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12274026870727539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14124250411987305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([600, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14235401153564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14235401153564453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14292621612548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16406536102294922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([570, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16541004180908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16541004180908203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1659536361694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18966197967529297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([505, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19107580184936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19107580184936523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1915574073791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2156376838684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([494, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21728134155273438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21728134155273438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21775245666503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24460601806640625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([454, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24631881713867188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24631881713867188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2467517852783203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2744617462158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([8287, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.31376075744628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.31376075744628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8287, 128]), torch.Size([1, 8287, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32233762741088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8834576606750488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8287, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8343558311462402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.847506046295166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8606562614440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8474030494689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([13789, 256])
first layer input nodes number: 41557
first layer output nodes number: 13789
edges number: 107925
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8609681129455566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8741183280944824  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8778433799743652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8778433799743652  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([431, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9004921913146973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9004921913146973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9013142585754395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9081382751464844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([347, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9083943367004395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9083943367004395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9090561866760254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.920811653137207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9213314056396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9213314056396484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9218940734863281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.936774730682373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([241, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9374203681945801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9374203681945801  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9378800392150879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9512104988098145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9519181251525879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9519181251525879  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9522900581359863  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9656796455383301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9663763046264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9663763046264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9666681289672852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9792165756225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([91, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9796829223632812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9796829223632812  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9798564910888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9885349273681641  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([86, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9891095161437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9891095161437988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9892735481262207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9986233711242676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9993371963500977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9993371963500977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9995126724243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0107431411743164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0114150047302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0114150047302246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0115656852722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.022264003753662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0227069854736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0227069854736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0228004455566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.03009033203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.03059720993042  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.03059720993042  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.030688762664795  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.03847074508667  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0390996932983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0390996932983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0392026901245117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0486783981323242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0490174293518066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0490174293518066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0490727424621582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.054548740386963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.055112361907959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.055112361907959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0551905632019043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0634799003601074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0638408660888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0638408660888672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0638904571533203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0694942474365234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0700254440307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0700254440307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0700902938842773  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0778722763061523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0783071517944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0783071517944336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0783586502075195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0848989486694336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.085439682006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.085439682006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0854988098144531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0934219360351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0936808586120605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0936808586120605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0937094688415527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0977435111999512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0980925559997559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0980925559997559  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0981268882751465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.103208065032959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1035504341125488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1035504341125488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1035828590393066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1086087226867676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1089024543762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1089024543762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.10892915725708  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1132550239562988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1135187149047852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1135187149047852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.113541603088379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1174097061157227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([345, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1257967948913574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1257967948913574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1264548301696777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2456517219543457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 345, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2259540557861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2263669967651367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2267799377441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2263460159301758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2770, 40])
input nodes number: 13789
output nodes number: 2770
edges number: 23004
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2264714241027832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2264719009399414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03412914276123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 25 input nodes size: 45359
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03135395050048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03135395050048828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05298280715942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.053003787994384766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03316688537597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.034180641174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.034180641174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.034180641174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([45359, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.034180641174316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([818, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09018850326538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09018850326538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09096860885620117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0974578857421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([796, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09782695770263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09782695770263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0985860824584961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10997295379638672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([802, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11074066162109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11074066162109375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11150550842285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12833213806152344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([684, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12925434112548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12925434112548828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12990665435791016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14882373809814453  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([678, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1501140594482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1501140594482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15076065063476562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17403793334960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([585, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17538833618164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17538833618164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17594623565673828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2007427215576172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([516, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20218610763549805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20218610763549805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20267820358276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22806739807128906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([511, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22977066040039062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22977066040039062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23025798797607422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.25803565979003906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([427, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2596244812011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2596244812011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.26003170013427734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.28609371185302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([8771, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3277134895324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3277134895324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 8771, 128]), torch.Size([1, 8771, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3360781669616699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9374151229858398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 8771, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8845734596252441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8984856605529785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9123978614807129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.8983769416809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([14588, 256])
first layer input nodes number: 45359
first layer output nodes number: 14588
edges number: 113705
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9127378463745117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9266500473022461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9301280975341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9301280975341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([508, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.952390193939209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.952390193939209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9533591270446777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.963109016418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9633359909057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9633359909057617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9640417098999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9746274948120117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([296, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.975128173828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.975128173828125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9756927490234375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9903726577758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([198, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.990851879119873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.990851879119873  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.9912295341491699  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0021815299987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([170, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.002810001373291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.002810001373291  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0031342506408691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0148072242736816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([134, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0154180526733398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0154180526733398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0156736373901367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0266637802124023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0271754264831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0271754264831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0273566246032715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0364165306091309  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0371179580688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0371179580688477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0373144149780273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0485124588012695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([73, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0490460395812988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0490460395812988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0491852760314941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0580964088439941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.058699607849121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.058699607849121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.058833122253418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.068312644958496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.068880558013916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.068880558013916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0689949989318848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0779213905334473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0784177780151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0784177780151367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0785093307495117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0862913131713867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0867705345153809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0867705345153809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.086850643157959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0942206382751465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0946111679077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0946111679077148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0946722030639648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1007146835327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1011171340942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1011171340942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1011743545532227  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1072397232055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1076574325561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1076574325561523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.107712745666504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1139631271362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1143770217895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1143770217895508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1144285202026367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1206083297729492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1211190223693848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1211190223693848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.121178150177002  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1286873817443848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.128931999206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.128931999206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1289606094360352  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1327943801879883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.133260726928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.133260726928711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1333084106445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1400318145751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1404318809509277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1404318809509277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1404719352722168  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.146399974822998  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1468453407287598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1468453407287598  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1468873023986816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1533913612365723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1537904739379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1537904739379883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1538267135620117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1596975326538086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1601638793945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1601638793945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1602039337158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1669731140136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([319, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1746182441711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1746182441711426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1752266883850098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2873377799987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 319, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2681083679199219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.268519401550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.268930435180664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.268498420715332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 14588
output nodes number: 2758
edges number: 22215
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2686262130737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2686266899108887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.036054134368896484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 26 input nodes size: 51167
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03316497802734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03316497802734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05756330490112305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.057584285736083984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0359344482421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03736114501953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03736114501953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03736114501953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([51167, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03736114501953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([661, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11632537841796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11632537841796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11695575714111328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12255001068115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([613, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12281942367553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12281942367553711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12340402603149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1321730613708496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([639, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13279485702514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13279485702514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13340425491333008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14762353897094727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([595, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1484537124633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1484537124633789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14902114868164062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16547679901123047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([646, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1667332649230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1667332649230957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16734933853149414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19031476974487305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([586, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19228792190551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19228792190551758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19284677505493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2174077033996582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([555, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2189807891845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2189807891845703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21951007843017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2466568946838379  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([587, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24863147735595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24863147735595703  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2491912841796875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2819643020629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([582, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.284421443939209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.284421443939209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2849764823913574  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32115888595581055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([13418, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38533449172973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38533449172973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13418, 128]), torch.Size([1, 13418, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3981308937072754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3090319633483887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13418, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2345409393310547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2525482177734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2705554962158203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2524070739746094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([18882, 256])
first layer input nodes number: 51167
first layer output nodes number: 18882
edges number: 160929
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2709388732910156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2889461517333984  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2934479713439941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2934479713439941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([378, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3231549263000488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3231549263000488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.323875904083252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3298897743225098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([269, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3300466537475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3300466537475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3305597305297852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3416047096252441  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([206, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.341942310333252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.341942310333252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3423352241516113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3509793281555176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([180, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3514752388000488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3514752388000488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.351818561553955  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3617749214172363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([164, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.362391471862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.362391471862793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3627042770385742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3739652633666992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([121, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.374506950378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.374506950378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3747377395629883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3846616744995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([93, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3851723670959473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3851723670959473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3853497505187988  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.394218921661377  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3948607444763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3948607444763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3950419425964355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4053702354431152  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4059371948242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4059371948242188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4060821533203125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4153594970703125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([45, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.415719985961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.415719985961914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4158058166503906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4218997955322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4225654602050781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4225654602050781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4226932525634766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4326610565185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4332432746887207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4332432746887207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4333500862121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4424290657043457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4430255889892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4430255889892578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.443124771118164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.452249526977539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4528999328613281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4528999328613281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4529991149902344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4628181457519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.463460922241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.463460922241211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.463552474975586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.473257064819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4739341735839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4739341735839844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4740238189697266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4841537475585938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.484827995300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.484827995300293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4849119186401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4949827194213867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4957714080810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4957714080810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4958629608154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5074901580810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5080108642578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5080108642578125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5080699920654297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5159931182861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.51654052734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.51654052734375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5165977478027344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5246658325195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5254850387573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5254850387573242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5255651473999023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5374212265014648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.537867546081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.537867546081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5379114151000977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5447111129760742  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5451536178588867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5451536178588867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5451936721801758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.551682472229004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5522160530090332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5522160530090332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5522618293762207  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5599980354309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([581, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5739355087280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5739355087280273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5750436782836914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7700815200805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 581, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7431268692016602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7435431480407715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7439594268798828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7435221672058105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2793, 40])
input nodes number: 18882
output nodes number: 2793
edges number: 30403
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7436895370483398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.743690013885498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0398564338684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 27 input nodes size: 47807
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.035939693450927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.035939693450927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.059377193450927734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05939817428588867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03497886657714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.036330223083496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.036330223083496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.036330223083496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([47807, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.036330223083496094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([619, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1104593276977539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1104593276977539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11104965209960938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11577224731445312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([654, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11610078811645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11610078811645508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11672449111938477  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12613153457641602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([627, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12671661376953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12671661376953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12731456756591797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14046955108642578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([587, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14199590682983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14199590682983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14255571365356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15879011154174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([566, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15985965728759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15985965728759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1603994369506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18025970458984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([560, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18159198760986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18159198760986328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18212604522705078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20580387115478516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([522, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20727920532226562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20727920532226562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2077770233154297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23358440399169922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([511, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23528480529785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23528480529785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23577213287353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2635498046875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([546, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.26564931869506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.26564931869506836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.26617002487182617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.300722599029541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([12607, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3605771064758301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3605771064758301  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12607, 128]), torch.Size([1, 12607, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37260007858276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2262310981750488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12607, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.156332015991211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1733064651489258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1902809143066406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.173173427581787  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17799, 256])
first layer input nodes number: 47807
first layer output nodes number: 17799
edges number: 151072
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1906390190124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.207613468170166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.211951732635498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.211951732635498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([355, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2414212226867676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2414212226867676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.242098331451416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2479429244995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([295, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2481718063354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2481718063354492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.248734474182129  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.258662223815918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([239, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2590703964233398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2590703964233398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.259526252746582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2695550918579102  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([168, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2699732780456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2699732780456543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2702937126159668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2795863151550293  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([152, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2801566123962402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2801566123962402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2804465293884277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2908835411071777  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([112, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2913846969604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2913846969604492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2915983200073242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3007841110229492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.301316738128662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.301316738128662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3014979362487793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3105578422546387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([77, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3110594749450684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3110594749450684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.311206340789795  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.319577693939209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([71, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3201184272766113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3201184272766113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.320253849029541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.328920841217041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3295836448669434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3295836448669434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.329728603363037  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3400206565856934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3404979705810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3404979705810547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.340597152709961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3483333587646484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3490104675292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3490104675292969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.349130630493164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.359344482421875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.360084056854248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.360084056854248  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.360206127166748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.371436595916748  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3717927932739258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3717927932739258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.371851921081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3777055740356445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3782386779785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3782386779785156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3783130645751953  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3861980438232422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.386791706085205  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.386791706085205  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3868699073791504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3957066535949707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3961906433105469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3961906433105469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3962516784667969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4035758972167969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4042720794677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4042720794677734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4043521881103516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4145259857177734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.415107250213623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.415107250213623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4151721000671387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4238619804382324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4243102073669434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4243102073669434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4243578910827637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4310812950134277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4316835403442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4316835403442383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4317426681518555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4404935836791992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.440971851348877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.440971851348877  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4410176277160645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.448112964630127  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4487314224243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4487314224243164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.448786735534668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.457747459411621  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4581584930419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4581584930419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4581947326660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4643192291259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([606, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4788622856140137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4788622856140137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.480018138885498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6869511604309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 606, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6601662635803223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6605796813964844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6609930992126465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6605587005615234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2772, 40])
input nodes number: 17799
output nodes number: 2772
edges number: 30179
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6607098579406738  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.660710334777832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.038691043853759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 28 input nodes size: 50641
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03497600555419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03497600555419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05912351608276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05914449691772461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03568601608276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03715372085571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03715372085571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03715372085571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([50641, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03715372085571289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([562, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1182398796081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1182398796081543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11877584457397461  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12320232391357422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([628, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12353324890136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12353324890136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 628, 128]), torch.Size([1, 628, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12413215637207031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1331157684326172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 628, 128])
m.shape torch.Size([576, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13364028930664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13364028930664062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13418960571289062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14677810668945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([557, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1475658416748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1475658416748047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14809703826904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16350173950195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([512, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16445684432983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16445684432983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16494512557983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18252325057983398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([564, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18389272689819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18389272689819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18443059921264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20829343795776367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([532, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2103438377380371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2103438377380371  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21085119247436523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23650836944580078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([555, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2383718490600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2383718490600586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23890113830566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2695913314819336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([565, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.27175140380859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.27175140380859375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2722902297973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3069443702697754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([14043, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37363719940185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.37363719940185547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 14043, 128]), torch.Size([1, 14043, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.38702964782714844  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3513059616088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 14043, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2744860649108887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2926955223083496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3109049797058105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2925529479980469  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([19094, 256])
first layer input nodes number: 50641
first layer output nodes number: 19094
edges number: 165397
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3112845420837402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3294939994812012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3340463638305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3340463638305664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([334, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3647465705871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3647465705871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3653836250305176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3706984519958496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([292, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3709416389465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3709416389465332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3714985847473145  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3806095123291016  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([195, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3808937072753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3808937072753906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.381265640258789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3894481658935547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([170, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.389915943145752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.389915943145752  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.39024019241333  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3996434211730957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([130, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.400106430053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.400106430053711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4003543853759766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.409280776977539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([107, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4097743034362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4097743034362793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4099783897399902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4187541007995605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([92, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.419271469116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.419271469116211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4194469451904297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4282207489013672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([86, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4287943840026855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4287943840026855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4289584159851074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4383082389831543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.439004898071289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.439004898071289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4391765594482422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4501628875732422  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4507403373718262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4507403373718262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4508719444274902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4602160453796387  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4608378410339355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4608378410339355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4609618186950684  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4706320762634277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4711356163024902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4711356163024902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.471229076385498  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.479173183441162  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.479814052581787  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.479814052581787  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4799189567565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.489570140838623  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4900832176208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4900832176208496  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4901633262634277  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.498094081878662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4987030029296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4987030029296875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.498788833618164  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5078868865966797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5084900856018066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5084900856018066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5085701942443848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.517622470855713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5181217193603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5181217193603516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5181846618652344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5257377624511719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5262598991394043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5262598991394043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5263209342956543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5340723991394043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.534663200378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.534663200378418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5347280502319336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5434179306030273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5441737174987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5441737174987793  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5442519187927246  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5552783012390137  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5559258460998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5559258460998535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5559906959533691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5655884742736816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.56602144241333  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.56602144241333  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.566063404083252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5725674629211426  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.572922706604004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.572922706604004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5729551315307617  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5782079696655273  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5787453651428223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5787453651428223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5787911415100098  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5865273475646973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([658, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6023154258728027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6023154258728027  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 658, 256]), torch.Size([1, 658, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6035704612731934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.8249492645263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 658, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7968602180480957  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7972712516784668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.797682285308838  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7972502708435059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 19094
output nodes number: 2758
edges number: 31478
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7974114418029785  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7974119186401367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03969097137451172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 29 input nodes size: 43603
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.035683631896972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.035683631896972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.057168006896972656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0571894645690918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.034427642822265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.034427642822265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.034427642822265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([43603, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.034427642822265625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([503, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10977315902709961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10977315902709961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11025285720825195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1140904426574707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([535, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11436080932617188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11436080932617188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11487102508544922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1232757568359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([521, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12376594543457031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12376594543457031  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12426280975341797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1351938247680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([543, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13598108291625977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13598108291625977  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13649892807006836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15189599990844727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([517, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15286970138549805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15286970138549805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15336275100708008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17131423950195312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([514, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17253828048706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17253828048706055  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17302846908569336  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19449758529663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([494, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19590139389038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19590139389038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19637250900268555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.21992826461791992  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([466, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22147035598754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22147035598754883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22191476821899414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24724626541137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([489, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24912261962890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24912261962890625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2495889663696289  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2794351577758789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([13114, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3417344093322754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3417344093322754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 13114, 128]), torch.Size([1, 13114, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.35424089431762695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2476019859313965  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 13114, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.176156997680664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.193033218383789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.209909439086914  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1929011344909668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([17696, 256])
first layer input nodes number: 43603
first layer output nodes number: 17696
edges number: 153704
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2102365493774414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2271127700805664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2313966751098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2313966751098633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([311, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.265458583831787  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.265458583831787  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2660517692565918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.271531581878662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([242, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.271700382232666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.271700382232666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2721619606018066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.279085636138916  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([196, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2794203758239746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2794203758239746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2797942161560059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2880187034606934  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([161, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2884511947631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2884511947631836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2887582778930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.297663688659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([131, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.298140048980713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.298140048980713  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2983899116516113  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.307384967803955  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([117, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3079347610473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3079347610473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3081579208374023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.317753791809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([86, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.318221092224121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.318221092224121  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.318385124206543  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3265867233276367  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([74, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3270740509033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3270740509033203  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3272151947021484  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3352603912353516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3359251022338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3359251022338867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3360872268676758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3464632034301758  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3471994400024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3471994400024414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3473615646362305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.358872413635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3593730926513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3593730926513672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3594779968261719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3676605224609375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3684039115905762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3684039115905762  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3685355186462402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3797221183776855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.380518913269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.380518913269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.380650520324707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3927583694458008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.393338680267334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.393338680267334  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.393430233001709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.402493953704834  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4030394554138184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4030394554138184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4031176567077637  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4114069938659668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4122138023376465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4122138023376465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4123187065124512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4241728782653809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4249539375305176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4249539375305176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.425051212310791  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4367241859436035  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4376444816589355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4376444816589355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.437751293182373  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4513163566589355  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4524154663085938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4524154663085938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4525222778320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4668350219726562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.467742919921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.467742919921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4678382873535156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4812850952148438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4823904037475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4823904037475586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4824895858764648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4971685409545898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.497541904449463  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.497541904449463  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4975800514221191  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.503492832183838  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5041813850402832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5041813850402832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5042424201965332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5141301155090332  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.514653205871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.514653205871582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5146989822387695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.522435188293457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([701, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5392560958862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5392560958862305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.540593147277832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7821121215820312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 701, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.750730037689209  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.751157283782959  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.751584529876709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7511358261108398  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2867, 40])
input nodes number: 17696
output nodes number: 2867
edges number: 34998
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7513055801391602  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.7513060569763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.036866188049316406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 30 input nodes size: 44323
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03303718566894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03303718566894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05452156066894531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05454254150390625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03303670883178711  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03433656692504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03433656692504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03433656692504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([44323, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03433656692504883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([566, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10525369644165039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10525369644165039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10579347610473633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11011171340942383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([636, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11044836044311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11044836044311523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11105489730834961  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12015295028686523  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([570, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12066507339477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12066507339477539  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12120866775512695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13318395614624023  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([536, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13393449783325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.13393449783325195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1344456672668457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14959001541137695  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([528, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15059328079223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15059328079223633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.15109682083129883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16926240921020508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([506, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17045831680297852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17045831680297852  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.17094087600708008  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19169092178344727  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([531, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1932220458984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1932220458984375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.19372844696044922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2191777229309082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([485, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22077465057373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.22077465057373047  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2212371826171875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24760150909423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([507, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24954605102539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.24954605102539062  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2500295639038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2809743881225586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([12103, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33844423294067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.33844423294067383  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 12103, 128]), torch.Size([1, 12103, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.3515758514404297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1735506057739258  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 12103, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1056475639343262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1218295097351074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1380114555358887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1217026710510254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16968, 256])
first layer input nodes number: 44323
first layer output nodes number: 16968
edges number: 144558
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1383438110351562  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1545257568359375  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1587848663330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1587848663330078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([328, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1878318786621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1878318786621094  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1884574890136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.196362018585205  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([312, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1966490745544434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1966490745544434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1972441673278809  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2061843872070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([213, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2065010070800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2065010070800781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2069072723388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2158451080322266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([176, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2163186073303223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2163186073303223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2166543006896973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2263894081115723  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([152, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.226952075958252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.226952075958252  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2272419929504395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2376790046691895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([117, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2382087707519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2382087707519531  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2384319305419922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2480278015136719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([102, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2486028671264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2486028671264648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2487974166870117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2585248947143555  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([79, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2590351104736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2590351104736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.259185791015625  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2677745819091797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2684087753295898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2684087753295898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2685651779174805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2785749435424805  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2792563438415527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2792563438415527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.279407024383545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2901053428649902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2906856536865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2906856536865234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2908039093017578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.300027847290039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3006725311279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3006725311279297  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3007888793945312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.310678482055664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3112826347351074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3112826347351074  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3113837242126465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3206839561462402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3213200569152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3213200569152832  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3214173316955566  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.331047534942627  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.331676959991455  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.331676959991455  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3317666053771973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3412690162658691  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.34183931350708  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.34183931350708  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3419156074523926  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.350536823272705  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3510379791259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3510379791259766  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3511009216308594  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3586540222167969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3592281341552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3592281341552734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3592948913574219  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3677730560302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3684520721435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3684520721435547  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3685264587402344  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3784942626953125  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3790531158447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3790531158447266  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3791122436523438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3874492645263672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3878436088562012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3878436088562012  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3878836631774902  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3938117027282715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3942780494689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3942780494689941  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3943219184875488  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4011216163635254  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4016966819763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4016966819763184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4017481803894043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4100909233093262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4105496406555176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4105496406555176  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4105896949768066  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4173588752746582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([574, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.431131362915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.431131362915039  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.4322261810302734  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6249141693115234  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 574, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5985403060913086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5989513397216797  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5993623733520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5989303588867188  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 16968
output nodes number: 2758
edges number: 29767
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5990619659423828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.599062442779541  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03658485412597656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

pseudo mini batch 31 input nodes size: 37989
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05113506317138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.051156044006347656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.02965068817138672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.030931472778320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.030931472778320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.030931472778320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([37989, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.030931472778320312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([506, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09911441802978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09911441802978516  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.09959697723388672  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10345745086669922  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([580, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10376930236816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10376930236816406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.10432243347167969  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11388778686523438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([576, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11443519592285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11443519592285156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.11498451232910156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12706947326660156  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([504, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12775611877441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.12775611877441406  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1282367706298828  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14217567443847656  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([489, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14310121536254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14310121536254883  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.14356756210327148  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1603560447692871  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([478, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16222238540649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16222238540649414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.16267824172973633  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.1822800636291504  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([482, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18366098403930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18366098403930664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.18412065505981445  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20710420608520508  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([444, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20856809616088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20856809616088867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 444, 128]), torch.Size([1, 444, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.20899152755737305  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.23312711715698242  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 444, 128])
m.shape torch.Size([418, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2347092628479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2347092628479004  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2351078987121582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.2606205940246582  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([11762, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.31650686264038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.31650686264038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 11762, 128]), torch.Size([1, 11762, 128])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.32772397994995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1241393089294434  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 11762, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0596718788146973  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0751585960388184  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0906453132629395  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0750374794006348  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([16239, 256])
first layer input nodes number: 37989
first layer output nodes number: 16239
edges number: 139031
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.090930461883545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.106417179107666  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.110461711883545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.110461711883545  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

m.shape torch.Size([297, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.142289638519287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.142289638519287  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1428561210632324  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1479487419128418  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([262, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1481695175170898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1481695175170898  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1486692428588867  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1568832397460938  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([224, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1572794914245605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1572794914245605  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1577067375183105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1671061515808105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([155, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1674885749816895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1674885749816895  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1677842140197754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1763577461242676  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([143, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1768975257873535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1768975257873535  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1771702766418457  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1869893074035645  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([112, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1874990463256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1874990463256836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1877126693725586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1968984603881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1975116729736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1975116729736328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.1977157592773438  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2079200744628906  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([79, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.208425521850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.208425521850586  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2085762023925781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2171649932861328  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2177128791809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2177128791809082  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2178502082824707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2266392707824707  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2271857261657715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2271857261657715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2273077964782715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2359747886657715  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.236654281616211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.236654281616211  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2367877960205078  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.247201919555664  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2479429244995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2479429244995117  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2480764389038086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.259425163269043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2598457336425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2598457336425781  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2599201202392578  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.266763687133789  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2672109603881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2672109603881836  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2672796249389648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2740774154663086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2746634483337402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2746634483337402  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2747454643249512  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2834391593933105  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.283982753753662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.283982753753662  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.284055233001709  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2922453880310059  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2927813529968262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2927813529968262  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.2928481101989746  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.300858974456787  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3013100624084473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3013100624084473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.301363468170166  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3081459999084473  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3085761070251465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3085761070251465  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3086237907409668  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3150134086608887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3155665397644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3155665397644043  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3156237602233887  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3236918449401855  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3242287635803223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3242287635803223  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.324282169342041  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.332186222076416  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.332624912261963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.332624912261963  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3326668739318848  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3391709327697754  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3396587371826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3396587371826172  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3397026062011719  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3468093872070312  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3474798202514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3474798202514648  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3475370407104492  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3572072982788086  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([726, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3746232986450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3746232986450195  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

 h.shape torch.Size([1, 726, 256]), torch.Size([1, 726, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.3760080337524414  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.6228218078613281  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

rst.shape  torch.Size([1, 726, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5936646461486816  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5940756797790527  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5944867134094238  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5940546989440918  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

torch.Size([2758, 40])
input nodes number: 16239
output nodes number: 2758
edges number: 32688
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5941967964172363  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.5941972732543945  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03313446044921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03313446044921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03313446044921875  GigaBytes
Max Memory Allocated: 1.9229025840759277  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00818159431219101 |0.0018918216228485107 |0.11346573382616043 |8.381903171539307e-05 |0.07067861407995224 |0.0026979446411132812 |
----------------------------------------------------------pseudo_mini_loss sum 3.9021084308624268
Total (block generation + training)time/epoch 27.696746706962585
Training time/epoch 6.350667715072632
Training time without block to device /epoch 6.2901294231414795
Training time without total dataloading part /epoch 5.897999286651611
load block tensor time/epoch 0.2618110179901123
block to device time/epoch 0.060538291931152344
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1134885
Number of first layer input nodes during this epoch:  814137
Number of first layer output nodes during this epoch:  320748
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
