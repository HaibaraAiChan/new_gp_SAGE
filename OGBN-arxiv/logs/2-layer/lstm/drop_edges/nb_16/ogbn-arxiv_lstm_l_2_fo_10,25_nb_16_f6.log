[05:39:39] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28897942 edges into 16 parts and get 6736143 edge cuts
main start at this time 1651556358.304363
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.053137779235839844
global_2_local spend time (sec) 0.03610086441040039
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004324913024902344
A = g.adjacency_matrix() spent  0.007704973220825195
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08658075332641602
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2982120513916016
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1636204719543457

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 1.244 seconds
Metis partitioning: 5.438 seconds
Split the graph: 1.323 seconds
Construct subgraphs: 0.073 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.091465473175049
5517
5518
5823
5517
5537
5517
5517
5837
5854
5525
5517
5854
5853
5854
5853
5848
total k batches seeds list generation spend  17.89547634124756
after graph partition
graph partition algorithm spend time 17.998692274093628
5517
5518
5823
5517
5537
5517
5517
5837
5854
5525
5517
5854
5853
5854
5853
5848
partition_len_list
[29547, 25127, 27492, 28287, 15118, 11866, 24077, 18055, 12558, 12005, 11110, 10970, 11347, 13695, 9869, 12671]
shared_neighbor_graph_partition_s0 selection method  spend 18.08456802368164
time for parepare:  0.016878604888916016
local_output_nid generation:  0.0011425018310546875
local_in_edges_tensor generation:  0.0015163421630859375
mini_batch_src_global generation:  0.002074718475341797
r_  generation:  0.01935577392578125
local_output_nid generation:  0.0014505386352539062
local_in_edges_tensor generation:  0.0013568401336669922
mini_batch_src_global generation:  0.0018362998962402344
r_  generation:  0.01588129997253418
local_output_nid generation:  0.0016357898712158203
local_in_edges_tensor generation:  0.0017409324645996094
mini_batch_src_global generation:  0.0020291805267333984
r_  generation:  0.02559828758239746
local_output_nid generation:  0.0016903877258300781
local_in_edges_tensor generation:  0.0014181137084960938
mini_batch_src_global generation:  0.0018551349639892578
r_  generation:  0.020556926727294922
local_output_nid generation:  0.0017933845520019531
local_in_edges_tensor generation:  0.0013287067413330078
mini_batch_src_global generation:  0.001461029052734375
r_  generation:  0.015581369400024414
local_output_nid generation:  0.0017113685607910156
local_in_edges_tensor generation:  0.00122833251953125
mini_batch_src_global generation:  0.0012638568878173828
r_  generation:  0.010090112686157227
local_output_nid generation:  0.0015747547149658203
local_in_edges_tensor generation:  0.0013599395751953125
mini_batch_src_global generation:  0.0014126300811767578
r_  generation:  0.01710820198059082
local_output_nid generation:  0.001680135726928711
local_in_edges_tensor generation:  0.0013880729675292969
mini_batch_src_global generation:  0.001500844955444336
r_  generation:  0.015245437622070312
local_output_nid generation:  0.0016481876373291016
local_in_edges_tensor generation:  0.00131988525390625
mini_batch_src_global generation:  0.0014421939849853516
r_  generation:  0.017392396926879883
local_output_nid generation:  0.001650094985961914
local_in_edges_tensor generation:  0.0012252330780029297
mini_batch_src_global generation:  0.0012385845184326172
r_  generation:  0.014217376708984375
local_output_nid generation:  0.001546621322631836
local_in_edges_tensor generation:  0.0012478828430175781
mini_batch_src_global generation:  0.0012636184692382812
r_  generation:  0.014108419418334961
local_output_nid generation:  0.0015649795532226562
local_in_edges_tensor generation:  0.001268148422241211
mini_batch_src_global generation:  0.0014085769653320312
r_  generation:  0.016868114471435547
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0012383460998535156
mini_batch_src_global generation:  0.0012786388397216797
r_  generation:  0.014273881912231445
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.0012614727020263672
mini_batch_src_global generation:  0.0011806488037109375
r_  generation:  0.01427912712097168
local_output_nid generation:  0.0015363693237304688
local_in_edges_tensor generation:  0.0011951923370361328
mini_batch_src_global generation:  0.0012078285217285156
r_  generation:  0.010751724243164062
local_output_nid generation:  0.001535654067993164
local_in_edges_tensor generation:  0.0012204647064208984
mini_batch_src_global generation:  0.0012390613555908203
r_  generation:  0.015302181243896484
----------------------check_connections_block total spend ----------------------------- 0.41274428367614746
generate_one_block  0.03168749809265137
generate_one_block  0.021586894989013672
generate_one_block  0.03560900688171387
generate_one_block  0.027779817581176758
generate_one_block  0.026891469955444336
generate_one_block  0.014989137649536133
generate_one_block  0.022038936614990234
generate_one_block  0.020918846130371094
generate_one_block  0.022458791732788086
generate_one_block  0.018674612045288086
generate_one_block  0.01874709129333496
generate_one_block  0.02329087257385254
generate_one_block  0.018618106842041016
generate_one_block  0.018476009368896484
generate_one_block  0.014624357223510742
generate_one_block  0.018866300582885742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04157423973083496
gen group dst list time:  0.007962942123413086
time for parepare:  0.02339792251586914
local_output_nid generation:  0.005358219146728516
local_in_edges_tensor generation:  0.02042984962463379
mini_batch_src_global generation:  0.007768392562866211
r_  generation:  0.08197665214538574
local_output_nid generation:  0.007161617279052734
local_in_edges_tensor generation:  0.007622718811035156
mini_batch_src_global generation:  0.008064031600952148
r_  generation:  0.06821131706237793
local_output_nid generation:  0.007317066192626953
local_in_edges_tensor generation:  0.006797313690185547
mini_batch_src_global generation:  0.008937358856201172
r_  generation:  0.08337259292602539
local_output_nid generation:  0.007467508316040039
local_in_edges_tensor generation:  0.009136676788330078
mini_batch_src_global generation:  0.008901834487915039
r_  generation:  0.08037424087524414
local_output_nid generation:  0.0044214725494384766
local_in_edges_tensor generation:  0.005789041519165039
mini_batch_src_global generation:  0.007441997528076172
r_  generation:  0.03747677803039551
local_output_nid generation:  0.0037276744842529297
local_in_edges_tensor generation:  0.0027709007263183594
mini_batch_src_global generation:  0.002529621124267578
r_  generation:  0.02614116668701172
local_output_nid generation:  0.0063898563385009766
local_in_edges_tensor generation:  0.0053479671478271484
mini_batch_src_global generation:  0.006066799163818359
r_  generation:  0.06520795822143555
local_output_nid generation:  0.0049207210540771484
local_in_edges_tensor generation:  0.0040323734283447266
mini_batch_src_global generation:  0.005662441253662109
r_  generation:  0.04456615447998047
local_output_nid generation:  0.0034933090209960938
local_in_edges_tensor generation:  0.0028908252716064453
mini_batch_src_global generation:  0.0031571388244628906
r_  generation:  0.02985358238220215
local_output_nid generation:  0.003290891647338867
local_in_edges_tensor generation:  0.0026051998138427734
mini_batch_src_global generation:  0.0023839473724365234
r_  generation:  0.02702951431274414
local_output_nid generation:  0.0030374526977539062
local_in_edges_tensor generation:  0.0024080276489257812
mini_batch_src_global generation:  0.0021712779998779297
r_  generation:  0.02587413787841797
local_output_nid generation:  0.002856731414794922
local_in_edges_tensor generation:  0.002315044403076172
mini_batch_src_global generation:  0.0022096633911132812
r_  generation:  0.025460004806518555
local_output_nid generation:  0.0029227733612060547
local_in_edges_tensor generation:  0.002379179000854492
mini_batch_src_global generation:  0.0020301342010498047
r_  generation:  0.02419567108154297
local_output_nid generation:  0.003459930419921875
local_in_edges_tensor generation:  0.002782106399536133
mini_batch_src_global generation:  0.002319812774658203
r_  generation:  0.029833555221557617
local_output_nid generation:  0.002629995346069336
local_in_edges_tensor generation:  0.0020394325256347656
mini_batch_src_global generation:  0.0017883777618408203
r_  generation:  0.018818140029907227
local_output_nid generation:  0.0032944679260253906
local_in_edges_tensor generation:  0.002580404281616211
mini_batch_src_global generation:  0.0021028518676757812
r_  generation:  0.027791738510131836
----------------------check_connections_block total spend ----------------------------- 1.1136910915374756
generate_one_block  0.11404657363891602
generate_one_block  0.09301352500915527
generate_one_block  0.10511970520019531
generate_one_block  0.1058809757232666
generate_one_block  0.04904937744140625
generate_one_block  0.03213071823120117
generate_one_block  0.09548163414001465
generate_one_block  0.05796527862548828
generate_one_block  0.03742647171020508
generate_one_block  0.03346610069274902
generate_one_block  0.03214573860168457
generate_one_block  0.032408952713012695
generate_one_block  0.030052661895751953
generate_one_block  0.03756594657897949
generate_one_block  0.022411823272705078
generate_one_block  0.03506588935852051
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.1136910915374756
block generation total time  0.913231372833252
average batch blocks generation time:  0.05707696080207825
pseudo mini batch 0 input nodes size: 62254
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0506591796875 GB
    Memory Allocated: 0.03246259689331055  GigaBytes
Max Memory Allocated: 0.03246259689331055  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0506591796875 GB
    Memory Allocated: 0.03250408172607422  GigaBytes
Max Memory Allocated: 0.03250408172607422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0506591796875 GB
    Memory Allocated: 0.03250408172607422  GigaBytes
Max Memory Allocated: 0.03250408172607422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03477001190185547  GigaBytes
Max Memory Allocated: 0.03477001190185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03477001190185547  GigaBytes
Max Memory Allocated: 0.03477001190185547  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03477001190185547  GigaBytes
Max Memory Allocated: 0.03477001190185547  GigaBytes

torch.Size([62254, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03477001190185547  GigaBytes
Max Memory Allocated: 0.03477001190185547  GigaBytes

m.shape torch.Size([1116, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.15541791915893555  GigaBytes
Max Memory Allocated: 0.1586599349975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.15541791915893555  GigaBytes
Max Memory Allocated: 0.1586599349975586  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.15648221969604492  GigaBytes
Max Memory Allocated: 0.1586599349975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.16499662399291992  GigaBytes
Max Memory Allocated: 0.1655287742614746  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1244, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.1660294532775879  GigaBytes
Max Memory Allocated: 0.16605758666992188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.1660294532775879  GigaBytes
Max Memory Allocated: 0.16605758666992188  GigaBytes

 h.shape torch.Size([1, 1244, 128]), torch.Size([1, 1244, 128])
----------------------------------------3
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.16721582412719727  GigaBytes
Max Memory Allocated: 0.16721582412719727  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1850113868713379  GigaBytes
Max Memory Allocated: 0.1862931251525879  GigaBytes

rst.shape  torch.Size([1, 1244, 128])
m.shape torch.Size([1225, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1861705780029297  GigaBytes
Max Memory Allocated: 0.1862931251525879  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1861705780029297  GigaBytes
Max Memory Allocated: 0.1862931251525879  GigaBytes

 h.shape torch.Size([1, 1225, 128]), torch.Size([1, 1225, 128])
----------------------------------------3
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.18733882904052734  GigaBytes
Max Memory Allocated: 0.18733882904052734  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.21304035186767578  GigaBytes
Max Memory Allocated: 0.21479272842407227  GigaBytes

rst.shape  torch.Size([1, 1225, 128])
m.shape torch.Size([1103, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.21456003189086914  GigaBytes
Max Memory Allocated: 0.21479272842407227  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.21456003189086914  GigaBytes
Max Memory Allocated: 0.21479272842407227  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.21561193466186523  GigaBytes
Max Memory Allocated: 0.21561193466186523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.24611711502075195  GigaBytes
Max Memory Allocated: 0.24881792068481445  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1138, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.2483043670654297  GigaBytes
Max Memory Allocated: 0.24881792068481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.2483043670654297  GigaBytes
Max Memory Allocated: 0.24881792068481445  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.2493896484375  GigaBytes
Max Memory Allocated: 0.2493896484375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.2889900207519531  GigaBytes
Max Memory Allocated: 0.2917032241821289  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1083, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.2915458679199219  GigaBytes
Max Memory Allocated: 0.2917032241821289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.2915458679199219  GigaBytes
Max Memory Allocated: 0.2917032241821289  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.29257869720458984  GigaBytes
Max Memory Allocated: 0.29257869720458984  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.3388710021972656  GigaBytes
Max Memory Allocated: 0.34196949005126953  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([996, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.34167909622192383  GigaBytes
Max Memory Allocated: 0.34196949005126953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.34167909622192383  GigaBytes
Max Memory Allocated: 0.34196949005126953  GigaBytes

 h.shape torch.Size([1, 996, 128]), torch.Size([1, 996, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.34262895584106445  GigaBytes
Max Memory Allocated: 0.34262895584106445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.3907589912414551  GigaBytes
Max Memory Allocated: 0.39408349990844727  GigaBytes

rst.shape  torch.Size([1, 996, 128])
m.shape torch.Size([992, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.39406824111938477  GigaBytes
Max Memory Allocated: 0.39415693283081055  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.39406824111938477  GigaBytes
Max Memory Allocated: 0.39415693283081055  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.39501428604125977  GigaBytes
Max Memory Allocated: 0.39501428604125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.45014429092407227  GigaBytes
Max Memory Allocated: 0.45453882217407227  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([976, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.45406579971313477  GigaBytes
Max Memory Allocated: 0.45453882217407227  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.45406579971313477  GigaBytes
Max Memory Allocated: 0.45453882217407227  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.45499658584594727  GigaBytes
Max Memory Allocated: 0.45499658584594727  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.5163979530334473  GigaBytes
Max Memory Allocated: 0.5205864906311035  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([19674, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.6097455024719238  GigaBytes
Max Memory Allocated: 0.6121029853820801  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.6097455024719238  GigaBytes
Max Memory Allocated: 0.6121029853820801  GigaBytes

 h.shape torch.Size([1, 19674, 128]), torch.Size([1, 19674, 128])
----------------------------------------3
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.6292767524719238  GigaBytes
Max Memory Allocated: 0.6292767524719238  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9698758125305176  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

rst.shape  torch.Size([1, 19674, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.8560705184936523  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.8842487335205078  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9124269485473633  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.884028434753418  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

torch.Size([29547, 256])
first layer input nodes number: 62254
first layer output nodes number: 29547
edges number: 244311
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9128928184509277  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9410710334777832  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9481158256530762  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9481158256530762  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

m.shape torch.Size([675, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.006336212158203  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.006336212158203  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

 h.shape torch.Size([1, 675, 256]), torch.Size([1, 675, 256])
----------------------------------------3
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.0076236724853516  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3846435546875 GB
    Memory Allocated: 2.017923355102539  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

rst.shape  torch.Size([1, 675, 256])
m.shape torch.Size([600, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.3846435546875 GB
    Memory Allocated: 2.0185275077819824  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3846435546875 GB
    Memory Allocated: 2.0185275077819824  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 3.3846435546875 GB
    Memory Allocated: 2.01967191696167  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0368380546569824  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

rst.shape  torch.Size([1, 600, 256])
m.shape torch.Size([474, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0376639366149902  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0376639366149902  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0385680198669434  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0597667694091797  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([336, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0606064796447754  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0606064796447754  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0612473487854004  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0827126502990723  GigaBytes
Max Memory Allocated: 2.084249973297119  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([311, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0839414596557617  GigaBytes
Max Memory Allocated: 2.084249973297119  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0839414596557617  GigaBytes
Max Memory Allocated: 2.084249973297119  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0845346450805664  GigaBytes
Max Memory Allocated: 2.0845346450805664  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3905029296875 GB
    Memory Allocated: 2.1111536026000977  GigaBytes
Max Memory Allocated: 2.1126909255981445  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([238, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.3905029296875 GB
    Memory Allocated: 2.112405300140381  GigaBytes
Max Memory Allocated: 2.1126909255981445  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3905029296875 GB
    Memory Allocated: 2.112405300140381  GigaBytes
Max Memory Allocated: 2.1126909255981445  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.3905029296875 GB
    Memory Allocated: 2.1128592491149902  GigaBytes
Max Memory Allocated: 2.1128592491149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 2.1323790550231934  GigaBytes
Max Memory Allocated: 2.1339163780212402  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([181, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 2.1336989402770996  GigaBytes
Max Memory Allocated: 2.1339163780212402  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 2.1336989402770996  GigaBytes
Max Memory Allocated: 2.1339163780212402  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 2.1340441703796387  GigaBytes
Max Memory Allocated: 2.1340441703796387  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4315185546875 GB
    Memory Allocated: 2.151305675506592  GigaBytes
Max Memory Allocated: 2.1528429985046387  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([162, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4315185546875 GB
    Memory Allocated: 2.1526803970336914  GigaBytes
Max Memory Allocated: 2.1528429985046387  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4315185546875 GB
    Memory Allocated: 2.1526803970336914  GigaBytes
Max Memory Allocated: 2.1528429985046387  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.4315185546875 GB
    Memory Allocated: 2.152989387512207  GigaBytes
Max Memory Allocated: 2.152989387512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.1706018447875977  GigaBytes
Max Memory Allocated: 2.1722259521484375  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([143, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.172081470489502  GigaBytes
Max Memory Allocated: 2.1722259521484375  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.172081470489502  GigaBytes
Max Memory Allocated: 2.1722259521484375  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.172354221343994  GigaBytes
Max Memory Allocated: 2.172354221343994  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4647216796875 GB
    Memory Allocated: 2.189810276031494  GigaBytes
Max Memory Allocated: 2.1915030479431152  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([126, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4647216796875 GB
    Memory Allocated: 2.191376209259033  GigaBytes
Max Memory Allocated: 2.1915030479431152  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4647216796875 GB
    Memory Allocated: 2.191376209259033  GigaBytes
Max Memory Allocated: 2.1915030479431152  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.4647216796875 GB
    Memory Allocated: 2.1916165351867676  GigaBytes
Max Memory Allocated: 2.1916165351867676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4822998046875 GB
    Memory Allocated: 2.208679676055908  GigaBytes
Max Memory Allocated: 2.20988130569458  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4822998046875 GB
    Memory Allocated: 2.210029125213623  GigaBytes
Max Memory Allocated: 2.2100348472595215  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4822998046875 GB
    Memory Allocated: 2.210029125213623  GigaBytes
Max Memory Allocated: 2.2100348472595215  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.4822998046875 GB
    Memory Allocated: 2.210294246673584  GigaBytes
Max Memory Allocated: 2.210294246673584  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 2.230973720550537  GigaBytes
Max Memory Allocated: 2.2324318885803223  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 2.2320871353149414  GigaBytes
Max Memory Allocated: 2.2324318885803223  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 2.2320871353149414  GigaBytes
Max Memory Allocated: 2.2324318885803223  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 2.232293128967285  GigaBytes
Max Memory Allocated: 2.2324318885803223  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 2.249802589416504  GigaBytes
Max Memory Allocated: 2.2510385513305664  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([114, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 2.251124382019043  GigaBytes
Max Memory Allocated: 2.2511301040649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 2.251124382019043  GigaBytes
Max Memory Allocated: 2.2511301040649414  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 2.2513418197631836  GigaBytes
Max Memory Allocated: 2.2513418197631836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5428466796875 GB
    Memory Allocated: 2.271346092224121  GigaBytes
Max Memory Allocated: 2.272759437561035  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([90, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.5428466796875 GB
    Memory Allocated: 2.2724485397338867  GigaBytes
Max Memory Allocated: 2.272759437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5428466796875 GB
    Memory Allocated: 2.2724485397338867  GigaBytes
Max Memory Allocated: 2.272759437561035  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.5428466796875 GB
    Memory Allocated: 2.27262020111084  GigaBytes
Max Memory Allocated: 2.272759437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5584716796875 GB
    Memory Allocated: 2.289614677429199  GigaBytes
Max Memory Allocated: 2.290816307067871  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([98, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.5584716796875 GB
    Memory Allocated: 2.2909417152404785  GigaBytes
Max Memory Allocated: 2.290947437286377  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5584716796875 GB
    Memory Allocated: 2.2909417152404785  GigaBytes
Max Memory Allocated: 2.290947437286377  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.5584716796875 GB
    Memory Allocated: 2.291128635406494  GigaBytes
Max Memory Allocated: 2.291128635406494  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5760498046875 GB
    Memory Allocated: 2.3109421730041504  GigaBytes
Max Memory Allocated: 2.3123440742492676  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.5760498046875 GB
    Memory Allocated: 2.3120946884155273  GigaBytes
Max Memory Allocated: 2.3123440742492676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5760498046875 GB
    Memory Allocated: 2.3120946884155273  GigaBytes
Max Memory Allocated: 2.3123440742492676  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.5760498046875 GB
    Memory Allocated: 2.312249183654785  GigaBytes
Max Memory Allocated: 2.3123440742492676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 2.329707145690918  GigaBytes
Max Memory Allocated: 2.3309431076049805  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 2.330855369567871  GigaBytes
Max Memory Allocated: 2.3309431076049805  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 2.330855369567871  GigaBytes
Max Memory Allocated: 2.3309431076049805  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 2.330998420715332  GigaBytes
Max Memory Allocated: 2.330998420715332  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 2.3481645584106445  GigaBytes
Max Memory Allocated: 2.3493804931640625  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([83, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 2.349529266357422  GigaBytes
Max Memory Allocated: 2.3495349884033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 2.349529266357422  GigaBytes
Max Memory Allocated: 2.3495349884033203  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 2.3496875762939453  GigaBytes
Max Memory Allocated: 2.3496875762939453  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 2.369792938232422  GigaBytes
Max Memory Allocated: 2.371217727661133  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([63, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 2.3708643913269043  GigaBytes
Max Memory Allocated: 2.371217727661133  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 2.3708643913269043  GigaBytes
Max Memory Allocated: 2.371217727661133  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 2.3709845542907715  GigaBytes
Max Memory Allocated: 2.371217727661133  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.3870863914489746  GigaBytes
Max Memory Allocated: 2.388227939605713  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([65, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.3882761001586914  GigaBytes
Max Memory Allocated: 2.3882813453674316  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.3882761001586914  GigaBytes
Max Memory Allocated: 2.3882813453674316  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.388400077819824  GigaBytes
Max Memory Allocated: 2.388400077819824  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 2.405880928039551  GigaBytes
Max Memory Allocated: 2.407120704650879  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([69, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 2.4072117805480957  GigaBytes
Max Memory Allocated: 2.407217502593994  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 2.4072117805480957  GigaBytes
Max Memory Allocated: 2.407217502593994  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.6658935546875 GB
    Memory Allocated: 2.4073433876037598  GigaBytes
Max Memory Allocated: 2.4073433876037598  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6854248046875 GB
    Memory Allocated: 2.426821231842041  GigaBytes
Max Memory Allocated: 2.4282031059265137  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([49, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.6854248046875 GB
    Memory Allocated: 2.4277915954589844  GigaBytes
Max Memory Allocated: 2.4282031059265137  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6854248046875 GB
    Memory Allocated: 2.4277915954589844  GigaBytes
Max Memory Allocated: 2.4282031059265137  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.6854248046875 GB
    Memory Allocated: 2.427885055541992  GigaBytes
Max Memory Allocated: 2.4282031059265137  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 2.442371368408203  GigaBytes
Max Memory Allocated: 2.443399429321289  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 2.443209171295166  GigaBytes
Max Memory Allocated: 2.443399429321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 2.443209171295166  GigaBytes
Max Memory Allocated: 2.443399429321289  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 2.4432854652404785  GigaBytes
Max Memory Allocated: 2.443399429321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7127685546875 GB
    Memory Allocated: 2.4556450843811035  GigaBytes
Max Memory Allocated: 2.4565224647521973  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7127685546875 GB
    Memory Allocated: 2.4565296173095703  GigaBytes
Max Memory Allocated: 2.456533432006836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7127685546875 GB
    Memory Allocated: 2.4565296173095703  GigaBytes
Max Memory Allocated: 2.456533432006836  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7127685546875 GB
    Memory Allocated: 2.456605911254883  GigaBytes
Max Memory Allocated: 2.456605911254883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 2.4694995880126953  GigaBytes
Max Memory Allocated: 2.4704151153564453  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([1157, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 2.4972620010375977  GigaBytes
Max Memory Allocated: 2.4973697662353516  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 2.4972620010375977  GigaBytes
Max Memory Allocated: 2.4973697662353516  GigaBytes

 h.shape torch.Size([1, 1157, 256]), torch.Size([1, 1157, 256])
----------------------------------------3
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 2.4994688034057617  GigaBytes
Max Memory Allocated: 2.4994688034057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.903684139251709  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1157, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.8502116203308105  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.851034164428711  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.8518567085266113  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.8509926795959473  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([5517, 40])
input nodes number: 29547
output nodes number: 5517
edges number: 59665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.852077007293701  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.8520779609680176  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.0422673225402832  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

pseudo mini batch 1 input nodes size: 65888
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.0361027717590332  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.0361027717590332  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.0675206184387207  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.06756210327148438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.03783559799194336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.039571285247802734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.039571285247802734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.039571285247802734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([65888, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.039571285247802734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

m.shape torch.Size([1494, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.13376855850219727  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.13376855850219727  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1351933479309082  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1465916633605957  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([1581, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.14761734008789062  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.14761734008789062  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1581, 128]), torch.Size([1, 1581, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1491250991821289  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.17174148559570312  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1581, 128])
m.shape torch.Size([1453, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1730661392211914  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1730661392211914  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1453, 128]), torch.Size([1, 1453, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1744518280029297  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.20576143264770508  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1453, 128])
m.shape torch.Size([1322, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.20759010314941406  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.20759010314941406  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1322, 128]), torch.Size([1, 1322, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.20885086059570312  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24541282653808594  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1322, 128])
m.shape torch.Size([1168, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24756717681884766  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24756717681884766  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1168, 128]), torch.Size([1, 1168, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24868106842041016  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.28934574127197266  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1168, 128])
m.shape torch.Size([1086, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.29189586639404297  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.29189586639404297  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1086, 128]), torch.Size([1, 1086, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.29293155670166016  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.33835506439208984  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1086, 128])
m.shape torch.Size([1038, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.34130191802978516  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.34130191802978516  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1038, 128]), torch.Size([1, 1038, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.34229183197021484  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3917875289916992  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1038, 128])
m.shape torch.Size([919, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.39479827880859375  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.39479827880859375  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3956747055053711  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.44653987884521484  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([854, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4497666358947754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4497666358947754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.45058107376098633  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.502953052520752  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([14212, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.5703139305114746  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.5703139305114746  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 14212, 128]), torch.Size([1, 14212, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.5838675498962402  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5470023155212402  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 14212, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.4613876342773438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.4853506088256836  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5093135833740234  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.4851632118225098  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([25127, 256])
first layer input nodes number: 65888
first layer output nodes number: 25127
edges number: 191083
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5098066329956055  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5337696075439453  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5397605895996094  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5397605895996094  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

m.shape torch.Size([962, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5810694694519043  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5810694694519043  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 962, 256]), torch.Size([1, 962, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.58290433883667  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.598996639251709  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 962, 256])
m.shape torch.Size([819, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.599703311920166  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.599703311920166  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 819, 256]), torch.Size([1, 819, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6012654304504395  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.624697208404541  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 819, 256])
m.shape torch.Size([577, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.625983715057373  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.625983715057373  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6270842552185059  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6544013023376465  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([445, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6559185981750488  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6559185981750488  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6567673683166504  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6834721565246582  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([363, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6847925186157227  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6847925186157227  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6854848861694336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7116684913635254  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([286, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7129716873168945  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7129716873168945  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.713517189025879  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.738051414489746  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([255, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7394943237304688  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7394943237304688  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.739980697631836  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7642993927001953  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([200, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7655940055847168  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7655940055847168  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7659754753112793  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7877192497253418  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([151, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.788835048675537  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.788835048675537  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7891230583190918  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8075556755065918  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([120, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8085651397705078  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8085651397705078  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8087940216064453  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8250446319580078  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8268623352050781  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8268623352050781  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.827077865600586  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8438892364501953  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([115, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8451080322265625  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8451080322265625  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.845327377319336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8639717102050781  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.864774227142334  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.864774227142334  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8649134635925293  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.877723217010498  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8785147666931152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8785147666931152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8786368370056152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8907217979431152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8915982246398926  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8915982246398926  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8917222023010254  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9048638343811035  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9056015014648438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9056015014648438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.90570068359375  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9169082641601562  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.917757511138916  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.917757511138916  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9178624153137207  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9304509162902832  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9311771392822266  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9311771392822266  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9312629699707031  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9421634674072266  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.943152904510498  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.943152904510498  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.94325590133667  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9570574760437012  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9576597213745117  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9576597213745117  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9577245712280273  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9668684005737305  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9674415588378906  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9674415588378906  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.967498779296875  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9759674072265625  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9765310287475586  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9765310287475586  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9765844345092773  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9848623275756836  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.98545503616333  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.98545503616333  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9855084419250488  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9941601753234863  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9945487976074219  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9945487976074219  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9945831298828125  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.000385284423828  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([566, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.0139684677124023  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.0139684677124023  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.015048027038574  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.205348014831543  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 566, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.170102596282959  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1709251403808594  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1717476844787598  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1708836555480957  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([5518, 40])
input nodes number: 25127
output nodes number: 5518
edges number: 41784
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.171112537384033  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1711130142211914  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.04273509979248047  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

pseudo mini batch 2 input nodes size: 51093
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.03783559799194336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.03783559799194336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.062198638916015625  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.06224203109741211  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.030782699584960938  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.033148765563964844  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.033148765563964844  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.033148765563964844  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([51093, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.033148765563964844  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

m.shape torch.Size([827, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.14983320236206055  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.14983320236206055  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.15062189102172852  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.15747976303100586  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([808, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.15785598754882812  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.15785598754882812  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.15862655639648438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.17045927047729492  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([848, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.17128705978393555  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.17128705978393555  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.17209577560424805  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1907191276550293  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([816, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.19187116622924805  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.19187116622924805  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.19264936447143555  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.21594953536987305  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([834, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.21754884719848633  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.21754884719848633  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.21834421157836914  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24712514877319336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([806, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24903345108032227  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24903345108032227  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.2498021125793457  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.2828545570373535  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([808, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.28516721725463867  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.28516721725463867  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.2859377861022949  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3244662284851074  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([773, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3270297050476074  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3270297050476074  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.32776689529418945  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.37038564682006836  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([823, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3735489845275879  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3735489845275879  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.37433385848999023  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4256572723388672  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([20149, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 0.5213427543640137  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 0.5213427543640137  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 20149, 128]), torch.Size([1, 20149, 128])
----------------------------------------3
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 0.5410633087158203  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9277820587158203  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 20149, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.8169641494750977  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.8431825637817383  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.869400978088379  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.842977523803711  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([27492, 256])
first layer input nodes number: 51093
first layer output nodes number: 27492
edges number: 237994
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.869783878326416  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.8960022926330566  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9025568962097168  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9025568962097168  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

m.shape torch.Size([502, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.979569435119629  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.979569435119629  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9805269241333008  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9881868362426758  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([388, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9884543418884277  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9884543418884277  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.989194393157959  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.001741886138916  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([346, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.00241756439209  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.00241756439209  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.003077507019043  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0178446769714355  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([276, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.018606662750244  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.018606662750244  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0191330909729004  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.034489154815674  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([253, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0354418754577637  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0354418754577637  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0359244346618652  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0532965660095215  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([217, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.054306983947754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.054306983947754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.054720878601074  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0725183486938477  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([171, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0738625526428223  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0738625526428223  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.074188709259033  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.09049654006958  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([138, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0913949012756348  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0913949012756348  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.091658115386963  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.106661319732666  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([179, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1080784797668457  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1080784797668457  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.108419895172119  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.130270481109619  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.13169527053833  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.13169527053833  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.132011890411377  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.154491901397705  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([149, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1559090614318848  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1559090614318848  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.156193256378174  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1783604621887207  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([148, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1799254417419434  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1799254417419434  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1802077293395996  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.204202175140381  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([127, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2056479454040527  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2056479454040527  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.20589017868042  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.228175640106201  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([105, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2294673919677734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2294673919677734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2296676635742188  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2494945526123047  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([101, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2508506774902344  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2508506774902344  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2510433197021484  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.271463394165039  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([97, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2728590965270996  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2728590965270996  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2730441093444824  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2939505577087402  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([95, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.295410633087158  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.295410633087158  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2955918312072754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.317335605621338  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([99, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.318957805633545  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.318957805633545  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3191466331481934  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.343127727508545  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([98, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3448233604431152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3448233604431152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.345010280609131  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3700575828552246  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([95, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3717904090881348  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3717904090881348  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.371971607208252  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3975205421447754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3992466926574707  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3992466926574707  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.399418354034424  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4569091796875 GB
    Memory Allocated: 2.4248242378234863  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([64, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4569091796875 GB
    Memory Allocated: 2.4260916709899902  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4569091796875 GB
    Memory Allocated: 2.4260916709899902  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.4569091796875 GB
    Memory Allocated: 2.4262137413024902  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4725341796875 GB
    Memory Allocated: 2.4451346397399902  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([68, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4725341796875 GB
    Memory Allocated: 2.4465770721435547  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4725341796875 GB
    Memory Allocated: 2.4465770721435547  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.4725341796875 GB
    Memory Allocated: 2.446706771850586  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.4677181243896484  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([77, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.4694294929504395  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.4694294929504395  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 2.469576358795166  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 2.494396686553955  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([1774, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 2.5369491577148438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 2.5369491577148438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1774, 256]), torch.Size([1, 1774, 256])
----------------------------------------3
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 2.540332794189453  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 3.151660919189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1774, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 3.0796589851379395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 3.080526828765869  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5213623046875 GB
    Memory Allocated: 3.081394672393799  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5213623046875 GB
    Memory Allocated: 3.0804834365844727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5823, 40])
input nodes number: 27492
output nodes number: 5823
edges number: 79381
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5213623046875 GB
    Memory Allocated: 3.080777168273926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5213623046875 GB
    Memory Allocated: 3.080777645111084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.037213802337646484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 3 input nodes size: 60509
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.030827999114990234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.030827999114990234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.059680938720703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0597224235534668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03531599044799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03746461868286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03746461868286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03746461868286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([60509, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03746461868286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1265, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1512761116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1512761116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1265, 128]), torch.Size([1, 1265, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1524825096130371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16213369369506836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1265, 128])
m.shape torch.Size([1273, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16347026824951172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16347026824951172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1273, 128]), torch.Size([1, 1273, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16468429565429688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18289470672607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1273, 128])
m.shape torch.Size([1203, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18468475341796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18468475341796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1203, 128]), torch.Size([1, 1203, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18583202362060547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21132755279541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1203, 128])
m.shape torch.Size([1105, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2128615379333496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2128615379333496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21391534805297852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24503850936889648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1058, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24703407287597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24703407287597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24804306030273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28487300872802734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([976, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28716087341308594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28716087341308594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28809165954589844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32903099060058594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([940, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33170318603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33170318603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3325996398925781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37754249572753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([920, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3806037902832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3806037902832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3814811706542969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4317970275878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([824, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4348945617675781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4348945617675781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4356803894042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.48773193359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([18723, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5766172409057617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5766172409057617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18723, 128]), torch.Size([1, 18723, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5945768356323242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8623275756835938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18723, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7559328079223633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7829093933105469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8098859786987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.782698631286621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([28287, 256])
first layer input nodes number: 60509
first layer output nodes number: 28287
edges number: 231572
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8103389739990234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.837315559387207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.844059944152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.844059944152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([763, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8994669914245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8994669914245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9009222984313965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.913886547088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([623, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9145379066467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9145379066467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 623, 256]), torch.Size([1, 623, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9157261848449707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9393982887268066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 623, 256])
m.shape torch.Size([457, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9403481483459473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9403481483459473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9412198066711426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9603962898254395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([363, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9615793228149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9615793228149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9622716903686523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9852991104125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([321, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9866409301757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9866409301757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.987253189086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0160608291625977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([240, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.017138957977295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.017138957977295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.01759672164917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.037280559539795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([203, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0390405654907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0390405654907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0394277572631836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0587873458862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([183, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0600008964538574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0600008964538574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.060349941253662  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0802454948425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([142, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.082035541534424  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.082035541534424  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.082306385040283  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.099640369415283  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([139, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1008410453796387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1008410453796387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1011061668395996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.119929790496826  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([119, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.121832847595215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.121832847595215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1220598220825195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.139763832092285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.140942096710205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.140942096710205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.14115571975708  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.159313678741455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.161287307739258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.161287307739258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1614952087402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.180622100830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.181701183319092  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.181701183319092  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1818461418151855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.196197032928467  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([79, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.197263717651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.197263717651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1974143981933594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2133865356445312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2145261764526367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2145261764526367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.214676856994629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.231703758239746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2326579093933105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2326579093933105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2327780723571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2471976280212402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2483315467834473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2483315467834473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2484631538391113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2651772499084473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2661352157592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2661352157592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.266238212585449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2800397872924805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.281161308288574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.281161308288574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.281277656555176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.297682762145996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2988357543945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2988357543945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2989501953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.315887451171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.316549301147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.316549301147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3166141510009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3266658782958984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.327606201171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.327606201171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3276901245117188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3412857055664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3421435356140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3421435356140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3422179222106934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3547892570495605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([1085, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3808226585388184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3808226585388184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1085, 256]), torch.Size([1, 1085, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.383002758026123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.766209125518799  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1085, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7162885665893555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.717111110687256  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7179336547851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.717069625854492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 28287
output nodes number: 5517
edges number: 56653
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7172765731811523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7172770500183105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04113626480102539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 4 input nodes size: 36651
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03527069091796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03527069091796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.052747249603271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.052788734436035156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023894309997558594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024967193603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024967193603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024967193603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([36651, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024967193603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1281, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07478713989257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07478713989257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1281, 128]), torch.Size([1, 1281, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07600879669189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08578205108642578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1281, 128])
m.shape torch.Size([1334, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08722591400146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08722591400146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1334, 128]), torch.Size([1, 1334, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08849811553955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10841178894042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1334, 128])
m.shape torch.Size([1255, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10957098007202148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10957098007202148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1255, 128]), torch.Size([1, 1255, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11076784133911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13732528686523438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1255, 128])
m.shape torch.Size([1117, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13950204849243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13950204849243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14056730270385742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17181634902954102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1045, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17377519607543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17377519607543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17477178573608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21133136749267578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([869, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2133193016052246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2133193016052246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21414804458618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24991846084594727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([785, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2521243095397949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2521243095397949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25287294387817383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29096317291259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([695, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2932400703430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2932400703430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 695, 128]), torch.Size([1, 695, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2939028739929199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3326554298400879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 695, 128])
m.shape torch.Size([616, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33496761322021484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33496761322021484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3355550765991211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37483882904052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([6121, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4038419723510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4038419723510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 6121, 128]), torch.Size([1, 6121, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4096794128417969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8241376876831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 6121, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7815451622009277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7959628105163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8103804588317871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7958498001098633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([15118, 256])
first layer input nodes number: 36651
first layer output nodes number: 15118
edges number: 100430
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8106555938720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8250732421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8286776542663574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8286776542663574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([859, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8714685440063477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8714685440063477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 859, 256]), torch.Size([1, 859, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8731069564819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8862142562866211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 859, 256])
m.shape torch.Size([704, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8869147300720215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8869147300720215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8882575035095215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9089083671569824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([561, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9100866317749023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9100866317749023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9111566543579102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9353876113891602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([448, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9367599487304688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9367599487304688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9376144409179688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9654941558837891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([396, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9673800468444824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9673800468444824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9681353569030762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9962363243103027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([300, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.997589111328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.997589111328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9981613159179688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0237674713134766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([260, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0256295204162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0256295204162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.026125431060791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.053661823272705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([214, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0550594329833984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0550594329833984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0554676055908203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0787334442138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([205, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0803027153015137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0803027153015137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0806937217712402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1057181358337402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1069645881652832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1069645881652832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.107250690460205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1275639533996582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1287107467651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1287107467651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1289434432983398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1470937728881836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([126, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.14874267578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.14874267578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1489830017089844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1694107055664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([104, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1705904006958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1705904006958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1707887649536133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1890382766723633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1903386116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1903386116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1905369758605957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2101750373840332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2112007141113281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2112007141113281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2113494873046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2271194458007812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2282600402832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2282600402832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2284107208251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2454376220703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2463603019714355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2463603019714355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.246476650238037  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2604384422302246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2611937522888184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2611937522888184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2612833976745605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2726683616638184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.273573398590088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.273573398590088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2736725807189941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2869629859924316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.287874698638916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.287874698638916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2879700660705566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3014168739318848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3021564483642578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3021564483642578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3022308349609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3132400512695312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3139643669128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3139643669128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.314033031463623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3246760368347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.325261116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.325261116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3253145217895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3339662551879883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3349084854125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3349084854125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3349885940551758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.348526954650879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([472, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3599190711975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3599190711975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3608193397521973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5205483436584473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 472, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.483841896057129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4846673011779785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4854927062988281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4846258163452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5537, 40])
input nodes number: 15118
output nodes number: 5537
edges number: 43429
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4847831726074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.48478364944458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027042388916015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 5 input nodes size: 28372
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023897171020507812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023897171020507812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.037425994873046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03746747970581055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01994943618774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.020664691925048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.020664691925048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.020664691925048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([28372, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.020664691925048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1496, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05389690399169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05389690399169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05532360076904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0670328140258789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([1570, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06781673431396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06781673431396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1570, 128]), torch.Size([1, 1570, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06931400299072266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09191513061523438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1570, 128])
m.shape torch.Size([1299, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09302473068237305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09302473068237305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1299, 128]), torch.Size([1, 1299, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09426355361938477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12174034118652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1299, 128])
m.shape torch.Size([1072, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12330865859985352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12330865859985352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1072, 128]), torch.Size([1, 1072, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12433099746704102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15467500686645508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1072, 128])
m.shape torch.Size([909, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15633106231689453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15633106231689453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1571979522705078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18892240524291992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([732, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19068241119384766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19068241119384766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 732, 128]), torch.Size([1, 732, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19138050079345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22139835357666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 732, 128])
m.shape torch.Size([632, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2231588363647461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2231588363647461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22376155853271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2548704147338867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([541, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25663280487060547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25663280487060547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25714874267578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2884531021118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([442, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29009199142456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29009199142456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2905135154724121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3174910545349121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([3173, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3324103355407715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3324103355407715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3173, 128]), torch.Size([1, 3173, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3354363441467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5502829551696777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3173, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5226249694824219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5339412689208984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.545257568359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5338525772094727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11866, 256])
first layer input nodes number: 28372
first layer output nodes number: 11866
edges number: 66218
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.54547119140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5567874908447266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5596165657043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5596165657043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1126, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5896792411804199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5896792411804199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1126, 256]), torch.Size([1, 1126, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5924296379089355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6105318069458008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1126, 256])
m.shape torch.Size([958, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6117277145385742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6117277145385742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 958, 256]), torch.Size([1, 958, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6135549545288086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6412286758422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 958, 256])
m.shape torch.Size([696, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6425995826721191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6425995826721191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 696, 256]), torch.Size([1, 696, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6439270973205566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6737351417541504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 696, 256])
m.shape torch.Size([543, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6751589775085449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6751589775085449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6761946678161621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7071185111999512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([409, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7085661888122559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7085661888122559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7093462944030762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7378754615783691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([305, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7392444610595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7392444610595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7398262023925781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7675790786743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([240, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7689032554626465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7689032554626465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7693610191345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7922492027282715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([205, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7935967445373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7935967445373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7939877510070801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8162751197814941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([176, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8176021575927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8176021575927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8179378509521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8394222259521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([142, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8406195640563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8406195640563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8408904075622559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8601202964782715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([101, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8610596656799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8610596656799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8612523078918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8762784004211426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([87, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8771858215332031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8771858215332031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8773517608642578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8914566040039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8922233581542969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8922233581542969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8923530578613281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9042854309082031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9049205780029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9049205780029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9050197601318359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9148387908935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9154815673828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9154815673828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9155731201171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9252777099609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9259395599365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9259395599365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9260272979736328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9359416961669922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9366168975830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9366168975830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9367008209228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9467716217041016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9472832679748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9472832679748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9473443031311035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9550957679748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9555401802062988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9555401802062988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.955589771270752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9622349739074707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9626331329345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9626331329345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9626750946044922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9685916900634766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.96905517578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.96905517578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9691009521484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9758758544921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9760646820068359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9760646820068359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9760837554931641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9790401458740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9792299270629883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9792299270629883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9792470932006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9820280075073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9822735786437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9822735786437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9822945594787598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9858403205871582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([137, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9891219139099121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9891219139099121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9893832206726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0353732109069824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 137, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0118489265441895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0126714706420898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0134940147399902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0126299858093262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 11866
output nodes number: 5517
edges number: 29602
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0127573013305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0127577781677246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022138595581054688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 6 input nodes size: 57353
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019946575164794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019946575164794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04729461669921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04733610153198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03376579284667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035511016845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035511016845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035511016845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([57353, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035511016845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1371, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12694740295410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12694740295410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1371, 128]), torch.Size([1, 1371, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12825489044189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13871479034423828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1371, 128])
m.shape torch.Size([1535, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14000988006591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14000988006591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1535, 128]), torch.Size([1, 1535, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14147377014160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16343212127685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1535, 128])
m.shape torch.Size([1276, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16467761993408203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16467761993408203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1276, 128]), torch.Size([1, 1276, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1658945083618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19266605377197266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1276, 128])
m.shape torch.Size([1157, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1943349838256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1943349838256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1157, 128]), torch.Size([1, 1157, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19543838500976562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22743701934814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1157, 128])
m.shape torch.Size([1136, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22959375381469727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22959375381469727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23067712783813477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26970911026000977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([917, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2717909812927246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2717909812927246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27266550064086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31122255325317383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([922, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31386280059814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31386280059814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3147420883178711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35955810546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([886, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36249828338623047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36249828338623047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 886, 128]), torch.Size([1, 886, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3633432388305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.41304683685302734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 886, 128])
m.shape torch.Size([802, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4169464111328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4169464111328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4177112579345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4666614532470703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([14075, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5333938598632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5333938598632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 14075, 128]), torch.Size([1, 14075, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5468168258666992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.499847412109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 14075, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4171380996704102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4400997161865234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4630613327026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4399199485778809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([24077, 256])
first layer input nodes number: 57353
first layer output nodes number: 24077
edges number: 185589
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4634909629821777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.486452579498291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4921932220458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4921932220458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([857, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.539893627166748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.539893627166748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5415282249450684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5546050071716309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([772, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.555318832397461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.555318832397461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 772, 256]), torch.Size([1, 772, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5567913055419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.578878402709961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 772, 256])
m.shape torch.Size([565, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.579897403717041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.579897403717041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.58097505569458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6072735786437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([429, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.608384132385254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.608384132385254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6092023849487305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6347951889038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([372, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6366324424743652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6366324424743652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6373419761657715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6628851890563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([246, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6639494895935059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6639494895935059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6644186973571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6845946311950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([195, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6857457160949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6857457160949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6861176490783691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.704714298248291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([164, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.705789566040039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.705789566040039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7061023712158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7239322662353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([142, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7250332832336426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7250332832336426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.725304126739502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.742638111114502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([128, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.743760108947754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.743760108947754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.744004249572754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.761338233947754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7623600959777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7623600959777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.762566089630127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7786335945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([100, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.779714584350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.779714584350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7799053192138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7961177825927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([78, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7969970703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7969970703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7971458435058594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8108329772949219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.811727523803711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.811727523803711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8118648529052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.825460433959961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8262138366699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8262138366699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8263225555419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8378467559814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8385000228881836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8385000228881836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.838587760925293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8485021591186523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.849128246307373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.849128246307373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8492064476013184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8585906028747559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8594169616699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8594169616699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8595123291015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8716239929199219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8725261688232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8725261688232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8726253509521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.885915756225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8865966796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8865966796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8866691589355469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8968887329101562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8975186347961426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8975186347961426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8975815773010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9068970680236816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9075846672058105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9075846672058105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9076495170593262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.917701244354248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9182438850402832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9182438850402832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9182934761047363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9263272285461426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.926971435546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.926971435546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9270267486572266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9363746643066406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([883, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.957563877105713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.957563877105713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 883, 256]), torch.Size([1, 883, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9592480659484863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2556653022766113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 883, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.213674545288086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2144970893859863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2153196334838867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2144556045532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 24077
output nodes number: 5517
edges number: 48539
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.214676856994629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.214677333831787  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03864860534667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 7 input nodes size: 39756
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03376579284667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03376579284667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05329704284667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.053340911865234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025951385498046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027215003967285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027215003967285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027215003967285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([39756, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027215003967285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1481, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08988142013549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08988142013549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1481, 128]), torch.Size([1, 1481, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0912938117980957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10259294509887695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1481, 128])
m.shape torch.Size([1473, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10329151153564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10329151153564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1473, 128]), torch.Size([1, 1473, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10469627380371094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12576770782470703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1473, 128])
m.shape torch.Size([1241, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12684059143066406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12684059143066406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1241, 128]), torch.Size([1, 1241, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12802410125732422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15406131744384766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1241, 128])
m.shape torch.Size([1138, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15569591522216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15569591522216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15678119659423828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18825435638427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1028, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19016265869140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19016265869140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19114303588867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2276172637939453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([913, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22973918914794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22973918914794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23060989379882812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26842594146728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 913, 128])
m.shape torch.Size([802, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27066755294799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27066755294799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27143239974975586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3097500801086426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([765, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3122859001159668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3122859001159668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3130154609680176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3553023338317871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([663, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35778284072875977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35778284072875977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3584151268005371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.39978790283203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([8551, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4402461051940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4402461051940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 8551, 128]), torch.Size([1, 8551, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.44840097427368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0273966789245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 8551, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9712491035461426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9893989562988281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.006617546081543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9883327484130859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([18055, 256])
first layer input nodes number: 39756
first layer output nodes number: 18055
edges number: 126531
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0059847831726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.024134635925293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0278286933898926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0278286933898926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1007, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.070357322692871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.070357322692871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1007, 256]), torch.Size([1, 1007, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0722780227661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0876436233520508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1007, 256])
m.shape torch.Size([805, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0891852378845215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0891852378845215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 805, 256]), torch.Size([1, 805, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0907206535339355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1146559715270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 805, 256])
m.shape torch.Size([601, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.115621566772461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.115621566772461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1167678833007812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1503467559814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 601, 256])
m.shape torch.Size([461, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1515460014343262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1515460014343262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1524252891540527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.177924633026123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([416, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1794843673706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1794843673706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1802778244018555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2100963592529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([343, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2116780281066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2116780281066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2123322486877441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2428669929504395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([269, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2447352409362793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2447352409362793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2452483177185059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2723722457885742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([239, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2739534378051758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2739534378051758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.274409294128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3003931045532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([177, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3016963005065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3016963005065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3020339012145996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3236403465270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([163, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3250384330749512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3250384330749512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3253493309020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3474230766296387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([138, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.348726749420166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.348726749420166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3489899635314941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.369520664215088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.370680809020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.370680809020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.370894432067871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.389052391052246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([84, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3899955749511719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3899955749511719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3901557922363281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4048957824707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([70, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4057579040527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4057579040527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4058914184570312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4191093444824219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([71, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4200663566589355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4200663566589355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4202017784118652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.434556484222412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4355039596557617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4355039596557617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4356298446655273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.449854850769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.450788974761963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.450788974761963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4509053230285645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.464867115020752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.465864658355713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.465864658355713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4659810066223145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.480757236480713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4817585945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4817585945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4818692207336426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4966931343078613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4975223541259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4975223541259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.497610092163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5099811553955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.510805606842041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.510805606842041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.510887622833252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5230259895324707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5237040519714355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5237040519714355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5237689018249512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.533820629119873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5343852043151855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5343852043151855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5344367027282715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5427794456481934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5435380935668945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5435380935668945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5436029434204102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5545625686645508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([451, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5653672218322754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5653672218322754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5662274360656738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7184081077575684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 451, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6824140548706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6832842826843262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6841545104980469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6832404136657715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5837, 40])
input nodes number: 18055
output nodes number: 5837
edges number: 42995
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.683466911315918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6834673881530762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02961444854736328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 8 input nodes size: 21930
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025999069213867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025999069213867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03645610809326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.036499977111816406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01692485809326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017932891845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017932891845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017932891845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([21930, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017932891845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([949, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05950641632080078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05950641632080078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 949, 128]), torch.Size([1, 949, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06041145324707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06765174865722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 949, 128])
m.shape torch.Size([1089, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0682377815246582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0682377815246582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06927633285522461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08538293838500977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1087, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08641862869262695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08641862869262695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08745527267456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11067724227905273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([929, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11193084716796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11193084716796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11281681060791016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13851356506347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([873, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1401519775390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1401519775390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14098453521728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17095661163330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([776, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1727604866027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1727604866027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17350053787231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20563507080078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([676, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2075214385986328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2075214385986328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20816612243652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24059104919433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([605, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24257659912109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24257659912109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24315357208251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2765235900878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([514, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2784409523010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2784409523010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2789311408996582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3115706443786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([5060, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33545351028442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33545351028442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 5060, 128]), torch.Size([1, 5060, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3406224250793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6871304512023926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 5060, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6502165794372559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6621928215026855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6741690635681152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6620988845825195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12558, 256])
first layer input nodes number: 21930
first layer output nodes number: 12558
edges number: 83923
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6743345260620117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6863107681274414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6893048286437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6893048286437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([665, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7394509315490723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7394509315490723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 665, 256]), torch.Size([1, 665, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7407193183898926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7514286041259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 665, 256])
m.shape torch.Size([624, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7523708343505859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7523708343505859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7535610198974609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7720851898193359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([585, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7731771469116211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7731771469116211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7742929458618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.79962158203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([457, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8008208274841309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8008208274841309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8016924858093262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.827115535736084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([401, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8286070823669434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8286070823669434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8293719291687012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8577885627746582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([337, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8601260185241699  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8601260185241699  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8607687950134277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8886561393737793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([292, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8902993202209473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8902993202209473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8908562660217285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.919217586517334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([266, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9209847450256348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9209847450256348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9214920997619629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9508843421936035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([239, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9526982307434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9526982307434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9531540870666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9823288917541504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([196, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9839849472045898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9839849472045898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9843587875366211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0109014511108398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([162, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0124273300170898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0124273300170898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0127363204956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0368375778198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([149, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0384016036987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0384016036987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0386857986450195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0628423690795898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([125, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0642623901367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0642623901367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0645008087158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.086435317993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([135, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0881328582763672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0881328582763672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0883903503417969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.113882064819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([113, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1153826713562012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1153826713562012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.115598201751709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.138444423675537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1395912170410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1395912170410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1397457122802734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1572036743164062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([88, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.158564567565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.158564567565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1587324142456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1788740158081055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1799321174621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1799321174621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1800580024719238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1960453987121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1969504356384277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1969504356384277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1970515251159668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2105975151062012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2118544578552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2118544578552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2119841575622559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.230271816253662  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2314386367797852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2314386367797852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2315549850463867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.248774528503418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2494568824768066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2494568824768066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.249523639678955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.259871006011963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2607440948486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2607440948486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2608222961425781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2734909057617188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.274397850036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.274397850036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2744760513305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2876920700073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([574, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.301445484161377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.301445484161377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3025403022766113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4958233833312988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 574, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4522619247436523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.453134536743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4540071487426758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4530906677246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 12558
output nodes number: 5854
edges number: 51261
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.453230857849121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4532313346862793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019837379455566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 9 input nodes size: 23168
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016927242279052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016927242279052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027974605560302734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.028016090393066406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017515182495117188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018377304077148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018377304077148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018377304077148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([23168, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018377304077148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1330, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.055609703063964844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.055609703063964844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1330, 128]), torch.Size([1, 1330, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.056878089904785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06796646118164062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1330, 128])
m.shape torch.Size([1248, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06852245330810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06852245330810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1248, 128]), torch.Size([1, 1248, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06971263885498047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08756542205810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1248, 128])
m.shape torch.Size([1108, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08919048309326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08919048309326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09024715423583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1134939193725586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([944, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11476612091064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11476612091064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11566638946533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14177417755126953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([840, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1433267593383789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1433267593383789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14412784576416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17296695709228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([660, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1744546890258789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1744546890258789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17508411407470703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2029428482055664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([589, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20459413528442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20459413528442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2051558494567871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23373794555664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([524, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23545598983764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23545598983764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23595571517944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.265561580657959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([395, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26700687408447266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26700687408447266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2673835754394531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2914924621582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([4367, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31212759017944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31212759017944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4367, 128]), torch.Size([1, 4367, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31629228591918945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6235361099243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4367, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5913610458374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6028099060058594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6142587661743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6027202606201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12005, 256])
first layer input nodes number: 23168
first layer output nodes number: 12005
edges number: 74626
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6144332885742188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6258821487426758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6287446022033691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6287446022033691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([983, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6692852973937988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6692852973937988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 983, 256]), torch.Size([1, 983, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6711602210998535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6867423057556152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 983, 256])
m.shape torch.Size([755, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6881742477416992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6881742477416992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 755, 256]), torch.Size([1, 755, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6896142959594727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7116222381591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 755, 256])
m.shape torch.Size([599, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7132382392883301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7132382392883301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 599, 256]), torch.Size([1, 599, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7143807411193848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.740786075592041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 599, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7419414520263672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7419414520263672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7427978515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7683238983154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([386, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7697510719299316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7697510719299316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7704873085021973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7969918251037598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([284, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7982616424560547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7982616424560547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7988033294677734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8225002288818359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([222, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.823723316192627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.823723316192627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8241467475891113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8453183174133301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([197, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8466215133666992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8466215133666992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8469972610473633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8684148788452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([150, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8695249557495117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8695249557495117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8698110580444336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8881216049194336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([155, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8894686698913574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8894686698913574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8897643089294434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9107546806335449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9120025634765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9120025634765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9122543334960938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9318923950195312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([111, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9333386421203613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9333386421203613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9335503578186035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9515461921691895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9526276588439941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9526276588439941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9528088569641113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9694790840148926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9703707695007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9703707695007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9705100059509277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9842944145202637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9853205680847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9853205680847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9854655265808105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.000831127166748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0018200874328613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0018200874328613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0019516944885254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0168232917785645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([77, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0180158615112305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0180158615112305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.018162727355957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0357866287231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0365958213806152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0365958213806152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0366930961608887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0490469932556152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0499300956726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0499300956726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0500273704528809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0630621910095215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0639748573303223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0639748573303223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.064070224761963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.077517032623291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0783982276916504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0783982276916504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0784859657287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0914711952209473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0920405387878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0920405387878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0920958518981934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1006693840026855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.101283073425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.101283073425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1013383865356445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1102991104125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1109404563903809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1109404563903809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1109957695007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1203436851501465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([427, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1305761337280273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1305761337280273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1313905715942383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2747316360473633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 427, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2404069900512695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2412304878234863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2420539855957031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2411890029907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5525, 40])
input nodes number: 12005
output nodes number: 5525
edges number: 40873
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2412710189819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2412714958190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01999950408935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 10 input nodes size: 23598
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017466068267822266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017466068267822266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02871847152709961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02875995635986328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01767110824584961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01851034164428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01851034164428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01851034164428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([23598, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01851034164428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1051, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0537571907043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0537571907043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05475950241088867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1097, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06353473663330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06353473663330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06458091735839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08027362823486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1101, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08184003829956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08184003829956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08289003372192383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10665178298950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([832, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10771369934082031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10771369934082031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10850715637207031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13154029846191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 832, 128])
m.shape torch.Size([739, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1329054832458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1329054832458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13361024856567383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1589818000793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([616, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16039180755615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16039180755615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1609792709350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18641424179077148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([546, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1879429817199707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1879429817199707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18846368789672852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21550321578979492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([517, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21721506118774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21721506118774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21770811080932617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24649667739868164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([461, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2482285499572754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2482285499572754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24866819381713867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27680540084838867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([4150, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2963743209838867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2963743209838867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4150, 128]), torch.Size([1, 4150, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.30033206939697266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.582094669342041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4150, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5514035224914551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5619988441467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.572594165802002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5619158744812012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11110, 256])
first layer input nodes number: 23598
first layer output nodes number: 11110
edges number: 70874
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5727720260620117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5833673477172852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5860161781311035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5860161781311035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([808, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6270303726196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6270303726196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 808, 256]), torch.Size([1, 808, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6285715103149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6409006118774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 808, 256])
m.shape torch.Size([716, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6417336463928223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6417336463928223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 716, 256]), torch.Size([1, 716, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.643099308013916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6647171974182129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 716, 256])
m.shape torch.Size([612, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6662635803222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6662635803222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6674308776855469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6931114196777344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 612, 256])
m.shape torch.Size([483, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6944746971130371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6944746971130371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6953959465026855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7224507331848145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([380, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7238163948059082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7238163948059082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.724541187286377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7545247077941895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([294, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7558579444885254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7558579444885254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7564187049865723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7814278602600098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([250, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.782829761505127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.782829761505127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7833065986633301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8071484565734863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([226, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8086481094360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8086481094360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8090791702270508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8336496353149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([197, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8351383209228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8351383209228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8355140686035156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8595619201660156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([174, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8610467910766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8610467910766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8613786697387695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8849420547485352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([168, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8865523338317871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8865523338317871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8868727684020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9118666648864746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([126, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9133048057556152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9133048057556152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9135451316833496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9339728355407715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([117, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9353146553039551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9353146553039551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9355378150939941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9560685157775879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9572758674621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9572758674621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9574627876281738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9759678840637207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9771289825439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9771289825439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.977294921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9948844909667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9956626892089844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9956626892089844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9957695007324219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0078392028808594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0087337493896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0087337493896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0088443756103516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0221195220947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0230159759521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0230159759521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0231208801269531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0364437103271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.037158489227295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.037158489227295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.037238597869873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0479731559753418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0488367080688477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0488367080688477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0489263534545898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0615663528442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0622482299804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0622482299804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.06231689453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.072479248046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0733757019042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0733757019042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0734596252441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0864677429199219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0869784355163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0869784355163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0870261192321777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0947508811950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0953502655029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0953502655029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0954017639160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.104104995727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([391, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1134743690490723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1134743690490723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.114220142364502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2461819648742676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 391, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2112479209899902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2120704650878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.212893009185791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.212028980255127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 11110
output nodes number: 5517
edges number: 41633
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2121524810791016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2121529579162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.020146846771240234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 11 input nodes size: 20425
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017670154571533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017670154571533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02740955352783203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02745342254638672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016159534454345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017101764678955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017101764678955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017101764678955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([20425, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017101764678955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([738, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05391740798950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05391740798950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.054621219635009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.061007022857666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([923, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06153535842895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06153535842895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06241559982299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07561922073364258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([879, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07652139663696289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07652139663696289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07735967636108398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09672307968139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([861, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0979461669921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0979461669921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09876728057861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12257957458496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([729, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12390708923339844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12390708923339844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 729, 128]), torch.Size([1, 729, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1246023178100586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15031099319458008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 729, 128])
m.shape torch.Size([713, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15200328826904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15200328826904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15268325805664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18192195892333984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([622, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18365812301635742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18365812301635742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1842513084411621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21475648880004883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([550, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21655797958374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21655797958374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21708250045776367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24735498428344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([460, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24906682968139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24906682968139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24950551986694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27758169174194336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([4495, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2987961769104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2987961769104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4495, 128]), torch.Size([1, 4495, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3030829429626465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6110553741455078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4495, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.578737735748291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5891995429992676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5996613502502441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5891175270080566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([10970, 256])
first layer input nodes number: 20425
first layer output nodes number: 10970
edges number: 74432
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.599815845489502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6102776527404785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6128931045532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6128931045532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([539, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6635651588439941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6635651588439941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6645932197570801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6733770370483398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([601, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6743049621582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6743049621582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6754512786865234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6931672096252441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 601, 256])
m.shape torch.Size([523, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6942915916442871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6942915916442871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.695289134979248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7179207801818848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([486, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7192907333374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7192907333374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7202177047729492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7470998764038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([408, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7485971450805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7485971450805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7493753433227539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7775583267211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([381, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7793664932250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7793664932250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7800931930541992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.812190055847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([340, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8141145706176758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8141145706176758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.814763069152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8484563827514648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([269, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8502006530761719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8502006530761719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8507137298583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8804836273193359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([236, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8822689056396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8822689056396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8827190399169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9115276336669922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([228, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.914459228515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.914459228515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9148941040039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.945770263671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([200, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9476675987243652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9476675987243652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9480490684509277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9778037071228027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([167, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9795393943786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9795393943786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9798579216003418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0069327354431152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([146, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0085978507995605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0085978507995605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0088763236999512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0344958305358887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([131, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0361194610595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0361194610595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0363693237304688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.061105728149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0622930526733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0622930526733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0624666213989258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0808649063110352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([96, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.082254409790039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.082254409790039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.082437515258789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.103128433227539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([99, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1046547889709473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1046547889709473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1048436164855957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1275029182434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([87, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1289138793945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1289138793945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.129079818725586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1501541137695312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1512036323547363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1512036323547363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1513218879699707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.167168140411377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([76, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1685700416564941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1685700416564941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.168715000152588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1891541481018066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1904544830322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1904544830322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1905841827392578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2097797393798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2107934951782227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2107934951782227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.210890769958496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.225968360900879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2270212173461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2270212173461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2271127700805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2419443130493164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2429137229919434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2429137229919434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.242997646331787  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2571806907653809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([477, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2686004638671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2686004638671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 477, 256]), torch.Size([1, 477, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.269510269165039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.429636001586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 477, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3851070404052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3859796524047852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3868522644042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3859357833862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 10970
output nodes number: 5854
edges number: 51935
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3861117362976074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3861122131347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018945693969726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 12 input nodes size: 20936
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01620960235595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01620960235595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026192665100097656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026236534118652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016453266143798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([20936, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1246, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.050637245178222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.050637245178222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1246, 128]), torch.Size([1, 1246, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.051825523376464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06140470504760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1246, 128])
m.shape torch.Size([1287, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06203794479370117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06203794479370117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1287, 128]), torch.Size([1, 1287, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06326532363891602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08263254165649414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1287, 128])
m.shape torch.Size([1173, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08369684219360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08369684219360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1173, 128]), torch.Size([1, 1173, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08481550216674805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10942602157592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1173, 128])
m.shape torch.Size([1013, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11079883575439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11079883575439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11176490783691406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1403970718383789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([893, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14205598831176758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14205598831176758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14290761947631836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1743617057800293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([721, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17599868774414062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17599868774414062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17668628692626953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20641756057739258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([636, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20819664001464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20819664001464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2088031768798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23926925659179688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([555, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24108314514160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24108314514160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24161243438720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27194976806640625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([489, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27378368377685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27378368377685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2742500305175781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3040962219238281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([3334, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.319760799407959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.319760799407959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3334, 128]), torch.Size([1, 3334, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3233942985534668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5550775527954102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3334, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5263667106628418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5371880531311035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5480093955993652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5371031761169434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11347, 256])
first layer input nodes number: 20936
first layer output nodes number: 11347
edges number: 66815
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5481677055358887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5589890480041504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5622882843017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5622882843017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([871, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6027283668518066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6027283668518066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 871, 256]), torch.Size([1, 871, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6043896675109863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6176800727844238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 871, 256])
m.shape torch.Size([809, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6184048652648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6184048652648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 809, 256]), torch.Size([1, 809, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6199479103088379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6438517570495605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 809, 256])
m.shape torch.Size([654, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6456327438354492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6456327438354492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 654, 256]), torch.Size([1, 654, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6468801498413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.674616813659668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 654, 256])
m.shape torch.Size([519, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6759886741638184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6759886741638184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.676978588104248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.705686092376709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([418, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7072000503540039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7072000503540039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7079973220825195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7368173599243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([340, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7383794784545898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7383794784545898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7390279769897461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7674474716186523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([325, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7693099975585938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7693099975585938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7699298858642578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8024740219116211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([254, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8041172027587891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8041172027587891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8046016693115234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8322162628173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([227, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8339376449584961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8339376449584961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8343706130981445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8620805740356445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([184, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8636326789855957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8636326789855957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8639836311340332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8889012336730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([160, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8904175758361816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8904175758361816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8907227516174316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9145264625549316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9157810211181641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9157810211181641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9160137176513672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9357929229736328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([116, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9371261596679688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9371261596679688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.937347412109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.95770263671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([85, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.958808422088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.958808422088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9589705467224121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9750208854675293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9761943817138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9761943817138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9763603210449219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9939498901367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9950971603393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9950971603393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9952497482299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0124921798706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0132331848144531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0132331848144531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0133285522460938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0247726440429688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0256075859069824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0256075859069824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0257048606872559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0380587577819824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.038978099822998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.038978099822998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.039079189300537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0526251792907715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0536117553710938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0536117553710938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0537128448486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0679664611816406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0686631202697754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0686631202697754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0687336921691895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0791783332824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.079798698425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.079798698425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0798578262329102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0890226364135742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.089545726776123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.089545726776123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0895934104919434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.097318172454834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0977330207824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0977330207824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0977692604064941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.103893756866455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([283, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1106758117675781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1106758117675781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.111215591430664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.208371639251709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 283, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.174494743347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1753673553466797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1762399673461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.175323486328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5853, 40])
input nodes number: 11347
output nodes number: 5853
edges number: 40754
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1754522323608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.175452709197998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01883840560913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 13 input nodes size: 29775
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016453266143798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016453266143798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.030651092529296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.030694961547851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02066802978515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021581649780273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021581649780273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021581649780273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([29775, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021581649780273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1434, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06254196166992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06254196166992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1434, 128]), torch.Size([1, 1434, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06390953063964844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07485008239746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1434, 128])
m.shape torch.Size([1471, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07556915283203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07556915283203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1471, 128]), torch.Size([1, 1471, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07697200775146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09801483154296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1471, 128])
m.shape torch.Size([1399, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1000676155090332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1000676155090332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1399, 128]), torch.Size([1, 1399, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10140180587768555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1313319206237793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1399, 128])
m.shape torch.Size([1234, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13301849365234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13301849365234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1234, 128]), torch.Size([1, 1234, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13419532775878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16902542114257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1234, 128])
m.shape torch.Size([1041, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17091894149780273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17091894149780273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17191171646118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20808029174804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([926, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21023321151733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21023321151733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21111631393432617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24912023544311523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([724, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2510952949523926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2510952949523926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 724, 128]), torch.Size([1, 724, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2517857551574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28701066970825195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 724, 128])
m.shape torch.Size([681, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2892632484436035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2892632484436035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28991270065307617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3269791603088379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([540, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32897186279296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32897186279296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3294868469238281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36307668685913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([4245, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.38306093215942383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.38306093215942383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4245, 128]), torch.Size([1, 4245, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.38710927963256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.675605297088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4245, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6407022476196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6537628173828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6668233871459961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.653660774230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([13695, 256])
first layer input nodes number: 29775
first layer output nodes number: 13695
edges number: 82096
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6670475006103516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6801080703735352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.683445930480957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.683445930480957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([950, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7239594459533691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7239594459533691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 950, 256]), torch.Size([1, 950, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.725771427154541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.740267276763916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 950, 256])
m.shape torch.Size([800, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7418270111083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7418270111083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 800, 256]), torch.Size([1, 800, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7433528900146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7670350074768066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 800, 256])
m.shape torch.Size([645, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.768132209777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.768132209777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 645, 256]), torch.Size([1, 645, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7693624496459961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7972002029418945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 645, 256])
m.shape torch.Size([516, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7985692024230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7985692024230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.799553394317627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8289265632629395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([435, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8305249214172363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8305249214172363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8313546180725098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8618922233581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([367, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8635940551757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8635940551757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8642940521240234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8947658538818359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([278, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8962864875793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8962864875793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8968167304992676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9271559715270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([253, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9294791221618652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9294791221618652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9299616813659668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9574675559997559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([215, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9590864181518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9590864181518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9594964981079102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9857416152954102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([180, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.987267017364502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.987267017364502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9876103401184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.011986255645752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([149, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.013390064239502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.013390064239502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.013674259185791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.035841464996338  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([113, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0370030403137207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0370030403137207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0372185707092285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0555386543273926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([108, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0567803382873535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0567803382873535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0569863319396973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0759377479553223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0769920349121094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0769920349121094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0771560668945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0933952331542969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.094538688659668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.094538688659668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.094700813293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1118860244750977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.112666130065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.112666130065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1127729415893555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.124842643737793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1256389617919922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1256389617919922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1257381439208984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1376399993896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1384382247924805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1384382247924805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1385316848754883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1504011154174805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1512126922607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1512126922607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1513023376464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1633148193359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.164039134979248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.164039134979248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1641154289245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.174872875213623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1752386093139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1752386093139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.175276756286621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.180922508239746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1814956665039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1814956665039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.181549072265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1898269653320312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.190441608428955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.190441608428955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1904969215393066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1994576454162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2000761032104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2000761032104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.200129508972168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2091550827026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([325, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.21693754196167  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.21693754196167  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.217557430267334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.330817699432373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 325, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2969012260437012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.297773838043213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2986464500427246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2977299690246582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 13695
output nodes number: 5854
edges number: 40364
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2978758811950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2978763580322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023390769958496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 14 input nodes size: 16257
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02066802978515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02066802978515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.028419971466064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02846384048461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014222145080566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014809608459472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014809608459472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014809608459472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([16257, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014809608459472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1506, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0390324592590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0390324592590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1506, 128]), torch.Size([1, 1506, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.040468692779541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05273866653442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1506, 128])
m.shape torch.Size([1556, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05350446701049805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05350446701049805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1556, 128]), torch.Size([1, 1556, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05498838424682617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07724714279174805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1556, 128])
m.shape torch.Size([1285, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07834339141845703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07834339141845703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1285, 128]), torch.Size([1, 1285, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07956886291503906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10744905471801758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1285, 128])
m.shape torch.Size([1004, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10921096801757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10921096801757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1004, 128]), torch.Size([1, 1004, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11016845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13831710815429688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1004, 128])
m.shape torch.Size([878, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13993167877197266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13993167877197266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14076900482177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17112350463867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([670, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1726217269897461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1726217269897461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17326068878173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20172548294067383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([543, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2032184600830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2032184600830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2037363052368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23058748245239258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([428, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23196125030517578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23196125030517578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23236942291259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25563526153564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([358, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25696754455566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25696754455566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2573089599609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2791595458984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([1641, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28681373596191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28681373596191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2883787155151367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40270423889160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.383664608001709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3937840461730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4039034843444824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3937101364135742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([9869, 256])
first layer input nodes number: 16257
first layer output nodes number: 9869
edges number: 47756
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4033193588256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4134387969970703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4150843620300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4150843620300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1077, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4468111991882324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4468111991882324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1077, 256]), torch.Size([1, 1077, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.44911670684814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.46642589569091797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1077, 256])
m.shape torch.Size([964, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.467252254486084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.467252254486084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 964, 256]), torch.Size([1, 964, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.46909093856811523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.496671199798584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 964, 256])
m.shape torch.Size([761, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.49794626235961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.49794626235961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 761, 256]), torch.Size([1, 761, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.49939775466918945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5313305854797363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 761, 256])
m.shape torch.Size([595, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5328927040100098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5328927040100098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 595, 256]), torch.Size([1, 595, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5340275764465332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.567415714263916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 595, 256])
m.shape torch.Size([500, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.569251537322998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.569251537322998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5702052116394043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6057066917419434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([378, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6074099540710449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6074099540710449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.608130931854248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6405863761901855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([303, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6422648429870605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6422648429870605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6428427696228027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6723084449768066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([231, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6737957000732422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6737957000732422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6742362976074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6993503570556641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([182, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7007045745849609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7007045745849609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7010517120361328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7232685089111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([155, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7245850563049316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7245850563049316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7248806953430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7458710670471191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7468767166137695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7468767166137695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7470827102661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7631502151489258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([99, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7641892433166504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7641892433166504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7643780708312988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.780428409576416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7811713218688965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7811713218688965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7812991142272949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7930560111999512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7939743995666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7939743995666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7941136360168457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8078980445861816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8088088035583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8088088035583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8089385032653809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8226866722106934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.823267936706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.823267936706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8233480453491211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8324003219604492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8330302238464355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8330302238464355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8331084251403809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8424925804138184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8430767059326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8430767059326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8431453704833984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8518657684326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8521237373352051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8521237373352051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8521542549133301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8562436103820801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8564977645874023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8564977645874023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8565244674682617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8602895736694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8606600761413574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8606600761413574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8606963157653809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8660597801208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.866337776184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.866337776184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8663644790649414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8705034255981445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8708000183105469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8708000183105469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8708267211914062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.875152587890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8754854202270508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8754854202270508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.875514030456543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8803491592407227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([81, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8822813034057617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8822813034057617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8824357986450195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9096269607543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 81, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8855376243591309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8864102363586426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8872828483581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8863663673400879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5853, 40])
input nodes number: 9869
output nodes number: 5853
edges number: 30897
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8864841461181641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8864846229553223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016037464141845703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 15 input nodes size: 25971
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014222145080566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014222145080566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026606082916259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026649951934814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018854141235351562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019771575927734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019771575927734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019771575927734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([25971, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019771575927734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1161, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.058837890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.058837890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1161, 128]), torch.Size([1, 1161, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.059945106506347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06930685043334961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1161, 128])
m.shape torch.Size([1366, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07036924362182617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07036924362182617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1366, 128]), torch.Size([1, 1366, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07167196273803711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09121274948120117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1366, 128])
m.shape torch.Size([1223, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09231090545654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09231090545654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1223, 128]), torch.Size([1, 1223, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09347724914550781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12000656127929688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1223, 128])
m.shape torch.Size([1124, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12157249450683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12157249450683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12264442443847656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.153778076171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([919, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15543317794799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15543317794799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1563096046447754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18786144256591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([750, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18956899642944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18956899642944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 750, 128]), torch.Size([1, 750, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19028425216674805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2218317985534668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 750, 128])
m.shape torch.Size([677, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22373390197753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22373390197753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2243795394897461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25666141510009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([650, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2588181495666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2588181495666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25943803787231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29591989517211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([571, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29806041717529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29806041717529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29860496520996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3337826728820801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([4230, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3536806106567383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3536806106567383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4230, 128]), torch.Size([1, 4230, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3577146530151367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6450262069702148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4230, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6113600730895996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6234440803527832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6355280876159668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.623349666595459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12671, 256])
first layer input nodes number: 25971
first layer output nodes number: 12671
edges number: 78531
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6357235908508301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6478075981140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6508288383483887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6508288383483887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([784, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6945767402648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6945767402648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 784, 256]), torch.Size([1, 784, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6960721015930176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7080650329589844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 784, 256])
m.shape torch.Size([768, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7087936401367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7087936401367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 768, 256]), torch.Size([1, 768, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7102584838867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7323541641235352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 768, 256])
m.shape torch.Size([621, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7334127426147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7334127426147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 621, 256]), torch.Size([1, 621, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7345972061157227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7608346939086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 621, 256])
m.shape torch.Size([514, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7622189521789551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7622189521789551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 514, 256]), torch.Size([1, 514, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7631993293762207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.792290210723877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 514, 256])
m.shape torch.Size([453, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7939772605895996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7939772605895996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7948412895202637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8266587257385254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([312, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.828026294708252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.828026294708252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8286213874816895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8581085205078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([261, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8595671653747559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8595671653747559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8600649833679199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8857240676879883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([271, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8875589370727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8875589370727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8880758285522461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9176568984985352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([215, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9192585945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9192585945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9196686744689941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9459137916564941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([193, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9475641250610352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9475641250610352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.947932243347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9740686416625977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9753122329711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9753122329711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9755697250366211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9956541061401367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([142, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9971632957458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9971632957458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.997434139251709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0204558372497559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([125, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0218825340270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0218825340270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0221209526062012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.044055461883545  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([120, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0455513000488281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0455513000488281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0457801818847656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0684394836425781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0695505142211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0695505142211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0697126388549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.086897850036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([85, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0881242752075195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0881242752075195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0882863998413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1066064834594727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1076693534851074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1076693534851074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1078028678894043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1238245964050293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([67, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1249170303344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1249170303344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.125044822692871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1412744522094727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1422152519226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1422152519226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.142320156097412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1563773155212402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.157247543334961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.157247543334961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.157339096069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.170248031616211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1710500717163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1710500717163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1711301803588867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1829862594604492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1836867332458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1836867332458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.183753490447998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1941008567810059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1949076652526855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1949076652526855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1949801445007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2067217826843262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes
[05:40:05] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28960368 edges into 16 parts and get 6698847 edge cuts

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2074236869812012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2074236869812012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2074847221374512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2177996635437012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([377, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2268280982971191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2268280982971191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2275471687316895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3582520484924316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 377, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3209171295166016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3217887878417969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3226604461669922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3217449188232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5848, 40])
input nodes number: 12671
output nodes number: 5848
edges number: 44485
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3218822479248047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.321882724761963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021562576293945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027112960815429688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027112960815429688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011823534965515137 |0.0209873765707016 |0.1498069316148758 |9.772181510925293e-05 |0.0776737630367279 |0.005921840667724609 |
----------------------------------------------------------pseudo_mini_loss sum 5.340816974639893
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  857730
Number of first layer input nodes during this epoch:  583936
Number of first layer output nodes during this epoch:  273794
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027112483978271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01932668685913086
global_2_local spend time (sec) 0.04478025436401367
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004347801208496094
A = g.adjacency_matrix() spent  0.009055137634277344
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09546160697937012
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.391291856765747
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1909701824188232

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 1.299 seconds
Metis partitioning: 5.642 seconds
Split the graph: 1.163 seconds
Construct subgraphs: 0.121 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.243144750595093
5832
5517
5698
5828
5835
5854
5842
5851
5517
5549
5517
5853
5517
5517
5518
5696
total k batches seeds list generation spend  18.645251512527466
after graph partition
graph partition algorithm spend time 18.729750871658325
5832
5517
5698
5828
5835
5854
5842
5851
5517
5549
5517
5853
5517
5517
5518
5696
partition_len_list
[12354, 12846, 10711, 10942, 11786, 14122, 10492, 11999, 29414, 28144, 28013, 26386, 14794, 19449, 12377, 14397]
shared_neighbor_graph_partition_s0 selection method  spend 18.83008313179016
time for parepare:  0.017749309539794922
local_output_nid generation:  0.0015153884887695312
local_in_edges_tensor generation:  0.0016660690307617188
mini_batch_src_global generation:  0.0022606849670410156
r_  generation:  0.01970696449279785
local_output_nid generation:  0.0016968250274658203
local_in_edges_tensor generation:  0.0013508796691894531
mini_batch_src_global generation:  0.0018639564514160156
r_  generation:  0.015683412551879883
local_output_nid generation:  0.0018336772918701172
local_in_edges_tensor generation:  0.0012929439544677734
mini_batch_src_global generation:  0.0014035701751708984
r_  generation:  0.014293432235717773
local_output_nid generation:  0.00186920166015625
local_in_edges_tensor generation:  0.0013272762298583984
mini_batch_src_global generation:  0.0014383792877197266
r_  generation:  0.015804529190063477
local_output_nid generation:  0.0018832683563232422
local_in_edges_tensor generation:  0.0012710094451904297
mini_batch_src_global generation:  0.001255035400390625
r_  generation:  0.01416635513305664
local_output_nid generation:  0.001809835433959961
local_in_edges_tensor generation:  0.0013790130615234375
mini_batch_src_global generation:  0.001600503921508789
r_  generation:  0.01714634895324707
local_output_nid generation:  0.001947641372680664
local_in_edges_tensor generation:  0.001219034194946289
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.012921810150146484
local_output_nid generation:  0.0019240379333496094
local_in_edges_tensor generation:  0.0012898445129394531
mini_batch_src_global generation:  0.0011136531829833984
r_  generation:  0.014297962188720703
local_output_nid generation:  0.0018494129180908203
local_in_edges_tensor generation:  0.0011913776397705078
mini_batch_src_global generation:  0.004293680191040039
r_  generation:  0.03824353218078613
local_output_nid generation:  0.002207517623901367
local_in_edges_tensor generation:  0.0026323795318603516
mini_batch_src_global generation:  0.0033380985260009766
r_  generation:  0.023085832595825195
local_output_nid generation:  0.002048969268798828
local_in_edges_tensor generation:  0.0013358592987060547
mini_batch_src_global generation:  0.0018198490142822266
r_  generation:  0.02251267433166504
local_output_nid generation:  0.0035734176635742188
local_in_edges_tensor generation:  0.0014891624450683594
mini_batch_src_global generation:  0.0022034645080566406
r_  generation:  0.025313377380371094
local_output_nid generation:  0.002105712890625
local_in_edges_tensor generation:  0.0012555122375488281
mini_batch_src_global generation:  0.0015938282012939453
r_  generation:  0.011281251907348633
local_output_nid generation:  0.0020568370819091797
local_in_edges_tensor generation:  0.001222848892211914
mini_batch_src_global generation:  0.0011806488037109375
r_  generation:  0.014106035232543945
local_output_nid generation:  0.0019505023956298828
local_in_edges_tensor generation:  0.0012290477752685547
mini_batch_src_global generation:  0.0010499954223632812
r_  generation:  0.012788534164428711
local_output_nid generation:  0.0019218921661376953
local_in_edges_tensor generation:  0.0011491775512695312
mini_batch_src_global generation:  0.0011217594146728516
r_  generation:  0.013643264770507812
----------------------check_connections_block total spend ----------------------------- 0.45584893226623535
generate_one_block  0.02944183349609375
generate_one_block  0.019679546356201172
generate_one_block  0.01963353157043457
generate_one_block  0.031196117401123047
generate_one_block  0.020813703536987305
generate_one_block  0.027753114700317383
generate_one_block  0.024116992950439453
generate_one_block  0.020803451538085938
generate_one_block  0.02855086326599121
generate_one_block  0.03205513954162598
generate_one_block  0.029793739318847656
generate_one_block  0.03409290313720703
generate_one_block  0.01619100570678711
generate_one_block  0.018930673599243164
generate_one_block  0.016786813735961914
generate_one_block  0.01816415786743164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03589677810668945
gen group dst list time:  0.00788116455078125
time for parepare:  0.023380517959594727
local_output_nid generation:  0.0025568008422851562
local_in_edges_tensor generation:  0.0122833251953125
mini_batch_src_global generation:  0.002752065658569336
r_  generation:  0.028157711029052734
local_output_nid generation:  0.0037996768951416016
local_in_edges_tensor generation:  0.003086566925048828
mini_batch_src_global generation:  0.002901315689086914
r_  generation:  0.028096437454223633
local_output_nid generation:  0.0030395984649658203
local_in_edges_tensor generation:  0.002427339553833008
mini_batch_src_global generation:  0.0020058155059814453
r_  generation:  0.03705477714538574
local_output_nid generation:  0.0043451786041259766
local_in_edges_tensor generation:  0.0037233829498291016
mini_batch_src_global generation:  0.0059583187103271484
r_  generation:  0.026644229888916016
local_output_nid generation:  0.0032634735107421875
local_in_edges_tensor generation:  0.002595186233520508
mini_batch_src_global generation:  0.0020024776458740234
r_  generation:  0.05048370361328125
local_output_nid generation:  0.004364013671875
local_in_edges_tensor generation:  0.004110813140869141
mini_batch_src_global generation:  0.006312131881713867
r_  generation:  0.03403472900390625
local_output_nid generation:  0.0029113292694091797
local_in_edges_tensor generation:  0.0022792816162109375
mini_batch_src_global generation:  0.0020220279693603516
r_  generation:  0.021184682846069336
local_output_nid generation:  0.0032265186309814453
local_in_edges_tensor generation:  0.0024902820587158203
mini_batch_src_global generation:  0.001954317092895508
r_  generation:  0.02584052085876465
local_output_nid generation:  0.007481098175048828
local_in_edges_tensor generation:  0.00857400894165039
mini_batch_src_global generation:  0.010396718978881836
r_  generation:  0.08180713653564453
local_output_nid generation:  0.007108211517333984
local_in_edges_tensor generation:  0.0074007511138916016
mini_batch_src_global generation:  0.010553836822509766
r_  generation:  0.08181095123291016
local_output_nid generation:  0.007271528244018555
local_in_edges_tensor generation:  0.006191253662109375
mini_batch_src_global generation:  0.013120889663696289
r_  generation:  0.08391880989074707
local_output_nid generation:  0.007802248001098633
local_in_edges_tensor generation:  0.00594782829284668
mini_batch_src_global generation:  0.010788679122924805
r_  generation:  0.07952451705932617
local_output_nid generation:  0.0043756961822509766
local_in_edges_tensor generation:  0.0034079551696777344
mini_batch_src_global generation:  0.0044748783111572266
r_  generation:  0.034012556076049805
local_output_nid generation:  0.0055043697357177734
local_in_edges_tensor generation:  0.004151821136474609
mini_batch_src_global generation:  0.004814624786376953
r_  generation:  0.0509333610534668
local_output_nid generation:  0.003754138946533203
local_in_edges_tensor generation:  0.006616353988647461
mini_batch_src_global generation:  0.003700733184814453
r_  generation:  0.028454303741455078
local_output_nid generation:  0.004262447357177734
local_in_edges_tensor generation:  0.003459930419921875
mini_batch_src_global generation:  0.002796649932861328
r_  generation:  0.03248405456542969
----------------------check_connections_block total spend ----------------------------- 1.1605761051177979
generate_one_block  0.06203126907348633
generate_one_block  0.03998136520385742
generate_one_block  0.03030705451965332
generate_one_block  0.03425788879394531
generate_one_block  0.03212738037109375
generate_one_block  0.04642343521118164
generate_one_block  0.028502464294433594
generate_one_block  0.03219866752624512
generate_one_block  0.11577987670898438
generate_one_block  0.11273574829101562
generate_one_block  0.10434079170227051
generate_one_block  0.10085320472717285
generate_one_block  0.04407525062561035
generate_one_block  0.06440496444702148
generate_one_block  0.0345911979675293
generate_one_block  0.04238080978393555
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027112483978271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

connection checking time:  1.1605761051177979
block generation total time  0.9249913692474365
average batch blocks generation time:  0.05781196057796478
block dataloader generation time/epoch 21.982685089111328
pseudo mini batch 0 input nodes size: 21277
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024402618408203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024402618408203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.034548282623291016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0345921516418457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022164344787597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023187637329101562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023187637329101562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023187637329101562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([21277, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023187637329101562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([890, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06507587432861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06507587432861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06592464447021484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07271480560302734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([993, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07323741912841797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07323741912841797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 993, 128]), torch.Size([1, 993, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07418441772460938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08889436721801758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 993, 128])
m.shape torch.Size([977, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08981847763061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08981847763061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09075021743774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11124849319458008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([884, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11258411407470703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11258411407470703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 884, 128]), torch.Size([1, 884, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11342716217041016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13797283172607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 884, 128])
m.shape torch.Size([851, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13958024978637695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13958024978637695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14039182662963867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.170501708984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([713, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1721358299255371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1721358299255371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17281579971313477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20237112045288086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([657, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2042241096496582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2042241096496582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 657, 128]), torch.Size([1, 657, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2048506736755371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2366924285888672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 657, 128])
m.shape torch.Size([602, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23961973190307617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23961973190307617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24019384384155273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27295351028442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([510, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2748551368713379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2748551368713379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2753415107727051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3064694404602051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([5277, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3313889503479004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3313889503479004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 5277, 128]), torch.Size([1, 5277, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33642148971557617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.694119930267334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 5277, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.656893253326416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6686749458312988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6804566383361816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6685824394226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12354, 256])
first layer input nodes number: 21277
first layer output nodes number: 12354
edges number: 84651
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6806173324584961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6923990249633789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6959743499755859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6959743499755859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([645, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7472710609436035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7472710609436035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 645, 256]), torch.Size([1, 645, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7485013008117676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7583432197570801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 645, 256])
m.shape torch.Size([613, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7593555450439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7593555450439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 613, 256]), torch.Size([1, 613, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7605247497558594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7794094085693359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 613, 256])
m.shape torch.Size([550, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.780754566192627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.780754566192627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 550, 256]), torch.Size([1, 550, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7818036079406738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8050341606140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 550, 256])
m.shape torch.Size([432, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8064398765563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8064398765563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8072638511657715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8322925567626953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([380, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8337068557739258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8337068557739258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8344316482543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8613767623901367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([314, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8632469177246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8632469177246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8638458251953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8896446228027344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([309, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8914241790771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8914241790771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8920135498046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9218473434448242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([248, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.923459529876709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.923459529876709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9239325523376465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.950894832611084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([222, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9525790214538574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9525790214538574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9530024528503418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9801020622253418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([210, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9819087982177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9819087982177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9823093414306641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0107479095458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([200, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0130515098571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0130515098571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0134329795837402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0431876182556152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([148, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0447039604187012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0447039604187012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0449862480163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0689806938171387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([137, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0705513954162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0705513954162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.070812702178955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0948529243469238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([131, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0964851379394531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0964851379394531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0967350006103516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1214714050292969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([122, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.123105525970459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.123105525970459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.123338222503662  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1480040550231934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([104, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.149487018585205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.149487018585205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1496853828430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.17210054397583  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([103, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1736845970153809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1736845970153809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1738810539245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.197455883026123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1985859870910645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1985859870910645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1987214088439941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2159199714660645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.216942310333252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.216942310333252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.217054843902588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2321343421936035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([77, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2335586547851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2335586547851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2337055206298828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2544136047363281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([64, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.255631923675537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.255631923675537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.255753993988037  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.273820400238037  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2745208740234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2745208740234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2745895385742188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2852325439453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2861709594726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2861709594726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2862548828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2998504638671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3008980751037598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3008980751037598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3009839057922363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3154892921447754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([568, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.329094409942627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.329094409942627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3301777839660645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 1.5281662940979004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 568, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 1.4830117225646973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 1.4838809967041016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 1.4847502708435059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 1.4838371276855469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5832, 40])
input nodes number: 12354
output nodes number: 5832
edges number: 52481
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 1.483971118927002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 1.4839720726013184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02510356903076172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 1 input nodes size: 25873
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022162914276123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022162914276123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0345001220703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03454160690307617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024352073669433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025232315063476562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025232315063476562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025232315063476562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([25873, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025232315063476562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1360, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06464099884033203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06464099884033203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1360, 128]), torch.Size([1, 1360, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06593799591064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07631397247314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1360, 128])
m.shape torch.Size([1371, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07704401016235352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07704401016235352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1371, 128]), torch.Size([1, 1371, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07835149765014648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09796380996704102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1371, 128])
m.shape torch.Size([1257, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09931612014770508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09931612014770508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1257, 128]), torch.Size([1, 1257, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10051488876342773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12723875045776367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1257, 128])
m.shape torch.Size([1010, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12856578826904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12856578826904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12952899932861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15746212005615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([926, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15918827056884766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15918827056884766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16007137298583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19259262084960938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([775, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1943683624267578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1943683624267578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19510746002197266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22713279724121094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([669, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22899627685546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22899627685546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22963428497314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2626986503601074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([574, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2645692825317383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2645692825317383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26511669158935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2973909378051758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([479, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29917287826538086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29917287826538086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29962968826293945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.32886552810668945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([4425, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.34973716735839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.34973716735839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4425, 128]), torch.Size([1, 4425, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3539571762084961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6619729995727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4425, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6280574798583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6403083801269531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6525592803955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6402125358581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12846, 256])
first layer input nodes number: 25873
first layer output nodes number: 12846
edges number: 79029
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6527543067932129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6650052070617676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6680679321289062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6680679321289062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([963, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7071948051452637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7071948051452637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 963, 256]), torch.Size([1, 963, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7090315818786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7237257957458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 963, 256])
m.shape torch.Size([795, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7246861457824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7246861457824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 795, 256]), torch.Size([1, 795, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7262024879455566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7506999969482422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 795, 256])
m.shape torch.Size([645, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7518019676208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7518019676208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 645, 256]), torch.Size([1, 645, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7530322074890137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.780097484588623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 645, 256])
m.shape torch.Size([475, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.781308650970459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.781308650970459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7822146415710449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8084883689880371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([380, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8098616600036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8098616600036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8105864524841309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8376755714416504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([305, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8390722274780273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8390722274780273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8396539688110352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.864964485168457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([231, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8662281036376953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8662281036376953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.866668701171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8886985778808594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([207, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8900699615478516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8900699615478516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8904647827148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9129695892333984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([185, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9143729209899902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9143729209899902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9147257804870605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9373087882995605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([140, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9384779930114746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9384779930114746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9387450218200684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9577040672302246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9587345123291016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9587345123291016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9589366912841797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9747066497802734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([104, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9758052825927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9758052825927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9760036468505859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9928646087646484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([79, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9938273429870605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9938273429870605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9939780235290527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.007840633392334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0087614059448242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0087614059448242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0089025497436523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0228757858276367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([66, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.023756980895996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.023756980895996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0238828659057617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.037226676940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0377635955810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0377635955810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0378379821777344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.046243667602539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0472359657287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0472359657287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.047356128692627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0617756843566895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0624942779541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0624942779541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0625801086425781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0734806060791016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0742416381835938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0742416381835938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0743255615234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0855712890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0863947868347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0863947868347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0864806175231934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0985827445983887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0994081497192383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0994081497192383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0994901657104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.111628532409668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1121373176574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1121373176574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1121869087219238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1198735237121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.120445728302002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.120445728302002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.120497226715088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1288399696350098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1293678283691406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1293678283691406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1294136047363281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1371498107910156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([406, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1468825340270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1468825340270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1476569175720215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.289839267730713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 406, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2569074630737305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2577300071716309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2585525512695312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2576885223388672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 12846
output nodes number: 5517
edges number: 38986
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2577791213989258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.257779598236084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.026900291442871094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 2 input nodes size: 19958
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024305343627929688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024305343627929688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.033822059631347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03386497497558594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021486282348632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022276878356933594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022276878356933594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022276878356933594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([19958, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022276878356933594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1235, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05401802062988281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05401802062988281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1235, 128]), torch.Size([1, 1235, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05519580841064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06461811065673828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1235, 128])
m.shape torch.Size([1242, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06521368026733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06521368026733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1242, 128]), torch.Size([1, 1242, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06639814376831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08416509628295898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1242, 128])
m.shape torch.Size([1100, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08533620834350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08533620834350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08638525009155273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10946416854858398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([968, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11078596115112305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11078596115112305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1117091178894043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13848066329956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([722, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1397404670715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1397404670715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 722, 128]), torch.Size([1, 722, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14042901992797852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1660323143005371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 722, 128])
m.shape torch.Size([622, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16746759414672852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16746759414672852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1680607795715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19394731521606445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([518, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19537973403930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19537973403930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19587373733520508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2213587760925293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([485, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2229619026184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2229619026184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22342443466186523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24978876113891602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([444, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2514629364013672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2514629364013672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 444, 128]), torch.Size([1, 444, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.25188636779785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27898597717285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 444, 128])
m.shape torch.Size([3375, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29486751556396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29486751556396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3375, 128]), torch.Size([1, 3375, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2983055114746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5294618606567383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3375, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5022616386413574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5124764442443848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5226912498474121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5123963356018066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([10711, 256])
first layer input nodes number: 19958
first layer output nodes number: 10711
edges number: 63485
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5228419303894043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5330567359924316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5356106758117676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5356106758117676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([912, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5776386260986328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5776386260986328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 912, 256]), torch.Size([1, 912, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5793781280517578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5932941436767578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 912, 256])
m.shape torch.Size([780, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5940914154052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5940914154052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 780, 256]), torch.Size([1, 780, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5955791473388672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6182851791381836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 780, 256])
m.shape torch.Size([606, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6199135780334473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6199135780334473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6210694313049316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6470847129821777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 606, 256])
m.shape torch.Size([493, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6486520767211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6486520767211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.649592399597168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.677311897277832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([391, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6787209510803223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6787209510803223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.679466724395752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7064557075500488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([304, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7078361511230469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7078361511230469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7084159851074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7334136962890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([219, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7345972061157227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7345972061157227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7350149154663086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7559003829956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([223, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7574062347412109  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7574062347412109  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7578315734863281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7820758819580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([205, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7836365699768066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7836365699768066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7840275764465332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8090519905090332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([157, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8103656768798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8103656768798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8106651306152344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8319263458251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([148, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8333415985107422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8333415985107422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8336238861083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8556423187255859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([140, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8571162223815918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8571162223815918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8573832511901855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8800806999206543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([111, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8813343048095703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8813343048095703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8815460205078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9010238647460938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9020752906799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9020752906799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9022393226623535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9184784889221191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9195351600646973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9195351600646973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.919680118560791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9350457191467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9359574317932129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9359574317932129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9360795021057129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9498734474182129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9508881568908691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9508881568908691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9510102272033691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9656586647033691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9666876792907715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9666876792907715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9668078422546387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9820685386657715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9829583168029785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9829583168029785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9830574989318848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9963479042053223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9970483779907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9970483779907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9971227645874023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0076112747192383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.009294033050537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.009294033050537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.009387493133545  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0232195854187012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0240612030029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0240612030029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0241413116455078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0365581512451172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0374245643615723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0374245643615723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0375027656555176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0501713752746582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0508012771606445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0508012771606445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.050856590270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0602045059204102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([404, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0698843002319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0698843002319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0706548690795898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2069272994995117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 404, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1714768409729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1723260879516602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.17317533493042  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1722831726074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5698, 40])
input nodes number: 10711
output nodes number: 5698
edges number: 42574
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1724328994750977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1724333763122559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023865222930908203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 3 input nodes size: 21378
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021512985229492188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021512985229492188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.031706809997558594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03175067901611328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02219104766845703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02308368682861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02308368682861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02308368682861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([21378, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02308368682861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([808, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05889701843261719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05889701843261719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05966758728027344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06583213806152344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([952, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06635475158691406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06635475158691406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06726264953613281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08141422271728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 952, 128])
m.shape torch.Size([931, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08246612548828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08246612548828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08335399627685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10288715362548828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([900, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10415983200073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10415983200073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10501813888549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13049840927124023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([770, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13190507888793945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13190507888793945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 770, 128]), torch.Size([1, 770, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13263940811157227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1600966453552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 770, 128])
m.shape torch.Size([749, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16187238693237305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16187238693237305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 749, 128]), torch.Size([1, 749, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16258668899536133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19330644607543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 749, 128])
m.shape torch.Size([636, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19533729553222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19533729553222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19594383239746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2263927459716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([560, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2282257080078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2282257080078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.228759765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.25984954833984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([443, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26148366928100586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26148366928100586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26190614700317383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.28894472122192383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([4193, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3087272644042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3087272644042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4193, 128]), torch.Size([1, 4193, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3134031295776367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5973148345947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4193, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5658478736877441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5762829780578613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5867180824279785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5762014389038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([10942, 256])
first layer input nodes number: 21378
first layer output nodes number: 10942
edges number: 72298
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5868797302246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5973148345947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5999236106872559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5999236106872559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([625, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6463909149169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6463909149169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 625, 256]), torch.Size([1, 625, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6475830078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6578869819641113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 625, 256])
m.shape torch.Size([633, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6585702896118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6585702896118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 633, 256]), torch.Size([1, 633, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6597776412963867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6778879165649414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 633, 256])
m.shape torch.Size([558, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6791491508483887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6791491508483887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.680213451385498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7041821479797363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([495, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7055530548095703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7055530548095703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7064971923828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7342853546142578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([433, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7358942031860352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7358942031860352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.736720085144043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7664546966552734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([403, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7683658599853516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7683658599853516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.769134521484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.803009033203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([336, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8048853874206543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8048853874206543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8055262565612793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8414006233215332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([274, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8431873321533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8431873321533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8437099456787109  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8743114471435547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([219, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8759446144104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8759446144104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8763623237609863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9030957221984863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([241, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9052033424377441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9052033424377441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.905663013458252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9382996559143066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([209, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.940279483795166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.940279483795166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9406781196594238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9717717170715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([148, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9732794761657715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9732794761657715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9735617637634277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.997556209564209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([137, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9991269111633301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9991269111633301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9993882179260254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0234284400939941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([122, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0249395370483398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0249395370483398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.025172233581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0482091903686523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0492753982543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0492753982543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0494318008422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0660104751586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([94, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.067378044128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.067378044128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0675573348999023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0878171920776367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([93, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.089247226715088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.089247226715088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0894246101379395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.110710620880127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([70, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.111982822418213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.111982822418213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1121163368225098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.129072666168213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1300287246704102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1300287246704102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1301355361938477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1444482803344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([67, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1456828117370605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1456828117370605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.145810604095459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1638293266296387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1648554801940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1648554801940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1649584770202637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1802020072937012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1810178756713867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1810178756713867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.181096076965332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1932172775268555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1939077377319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1939077377319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1939706802368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.204167366027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.20503568649292  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.20503568649292  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2051100730895996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2176814079284668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([366, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2264385223388672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2264385223388672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2271366119384766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3503389358520508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 366, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3101449012756348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3110136985778809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.311882495880127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3109698295593262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5828, 40])
input nodes number: 10942
output nodes number: 5828
edges number: 47477
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.31111478805542  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3111152648925781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024820327758789062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 4 input nodes size: 23315
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02221059799194336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02221059799194336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03332805633544922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.033371925354003906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023134231567382812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02394390106201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02394390106201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02394390106201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([23315, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02394390106201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1310, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05842018127441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05842018127441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1310, 128]), torch.Size([1, 1310, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05966949462890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06966400146484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1310, 128])
m.shape torch.Size([1343, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07032012939453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07032012939453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1343, 128]), torch.Size([1, 1343, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07160091400146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09081268310546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1343, 128])
m.shape torch.Size([1222, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09224510192871094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09224510192871094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1222, 128]), torch.Size([1, 1222, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09341049194335938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.119049072265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1222, 128])
m.shape torch.Size([1069, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1205282211303711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1205282211303711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12154769897460938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15111255645751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([961, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1528940200805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1528940200805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1538105010986328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1871352195739746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([751, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1888256072998047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1888256072998047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 751, 128]), torch.Size([1, 751, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18954181671142578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22124862670898438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 751, 128])
m.shape torch.Size([650, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22306013107299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22306013107299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2236800193786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.25519514083862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([575, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2570786476135254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2570786476135254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.257627010345459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2904233932495117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([474, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29218339920043945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29218339920043945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.292635440826416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.321566104888916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([3431, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.337740421295166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.337740421295166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3431, 128]), torch.Size([1, 3431, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.34101247787475586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5733284950256348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3431, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5458416938781738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5570816993713379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.568321704864502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5569934844970703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11786, 256])
first layer input nodes number: 23315
first layer output nodes number: 11786
edges number: 68975
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5684976577758789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.579737663269043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.582547664642334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.582547664642334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([916, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.621708869934082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.621708869934082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 916, 256]), torch.Size([1, 916, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6234560012817383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6374330520629883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 916, 256])
m.shape torch.Size([813, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6385688781738281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6385688781738281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 813, 256]), torch.Size([1, 813, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6401195526123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6638603210449219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 813, 256])
m.shape torch.Size([683, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.665189266204834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.665189266204834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 683, 256]), torch.Size([1, 683, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6664919853210449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6971316337585449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 683, 256])
m.shape torch.Size([554, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6986103057861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6986103057861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6996669769287109  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7308216094970703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([461, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7325091361999512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7325091361999512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7333884239196777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.765129566192627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([330, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7666501998901367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7666501998901367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7672796249389648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7963337898254395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([278, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7978897094726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7978897094726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7984199523925781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8257770538330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([228, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8272652626037598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8272652626037598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.827700138092041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8524880409240723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([207, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8540616035461426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8540616035461426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8544564247131348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8797249794006348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([174, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8812003135681152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8812003135681152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8815321922302246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9050955772399902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([141, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9064445495605469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9064445495605469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9067134857177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9276905059814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9288020133972168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9288020133972168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9290080070495605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9465174674987793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([110, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.947789192199707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.947789192199707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9479990005493164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9673013687133789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9683537483215332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9683537483215332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9685177803039551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9847569465637207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9858574867248535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9858574867248535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9860138893127441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0025925636291504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0036063194274902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0036063194274902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.00374174118042  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0190443992614746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.019744873046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.019744873046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0198345184326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0305919647216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0313777923583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0313777923583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0314693450927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0430965423583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0440373420715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0440373420715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.044140338897705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0579419136047363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.058851718902588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.058851718902588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0589470863342285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0723938941955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.072972297668457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.072972297668457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0730314254760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.081782341003418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0822606086730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0822606086730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0823063850402832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0894017219543457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0899314880371094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0899314880371094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0899791717529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0977039337158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.098233699798584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.098233699798584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0982794761657715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.106015682220459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([290, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.113420009613037  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.113420009613037  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1139731407165527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2142233848571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 290, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1816363334655762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1825060844421387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1833758354187012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.182462215423584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5835, 40])
input nodes number: 11786
output nodes number: 5835
edges number: 39581
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1825952529907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1825957298278809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025555133819580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 5 input nodes size: 33620
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02313518524169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02313518524169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03916645050048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03921031951904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.028048992156982422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029174327850341797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029174327850341797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029174327850341797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([33620, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029174327850341797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([986, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07799530029296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07799530029296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 986, 128]), torch.Size([1, 986, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07893562316894531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08645820617675781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 986, 128])
m.shape torch.Size([1088, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08760738372802734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08760738372802734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1088, 128]), torch.Size([1, 1088, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08864498138427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10420894622802734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1088, 128])
m.shape torch.Size([1053, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10521650314331055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10521650314331055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10622072219848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12831354141235352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([940, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12960433959960938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12960433959960938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13050079345703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1574535369873047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([925, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1592106819152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1592106819152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 925, 128]), torch.Size([1, 925, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16009283065795898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19197416305541992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 925, 128])
m.shape torch.Size([793, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1938018798828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1938018798828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19455814361572266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22745037078857422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([720, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2294754981994629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2294754981994629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 720, 128]), torch.Size([1, 720, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2301621437072754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26570749282836914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 720, 128])
m.shape torch.Size([693, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.268007755279541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.268007755279541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26866865158081055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3071599006652832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([553, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3092026710510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3092026710510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.30973005294799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.34470605850219727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([6371, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.37569236755371094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.37569236755371094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 6371, 128]), torch.Size([1, 6371, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3825664520263672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8139524459838867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 6371, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7715888023376465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7850565910339355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7985243797302246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7849512100219727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([14122, 256])
first layer input nodes number: 33620
first layer output nodes number: 14122
edges number: 98735
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7987771034240723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8122448921203613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8156118392944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8156118392944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([685, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8666872978210449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8666872978210449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 685, 256]), torch.Size([1, 685, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8679938316345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8793668746948242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 685, 256])
m.shape torch.Size([648, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8800272941589355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8800272941589355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 648, 256]), torch.Size([1, 648, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.881263256072998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8998026847839355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 648, 256])
m.shape torch.Size([529, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9016323089599609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9016323089599609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9026412963867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9252567291259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([450, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9264826774597168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9264826774597168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9273409843444824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9537711143493652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([386, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9551973342895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9551973342895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9559335708618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9826269149780273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([334, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9841852188110352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9841852188110352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9848222732543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0127582550048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([303, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0147390365600586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0147390365600586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0153169631958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.045546531677246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([256, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0472259521484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0472259521484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0477142333984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0755462646484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([214, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0772757530212402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0772757530212402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.077683925628662  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.103806972503662  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([201, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1055350303649902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1055350303649902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1059184074401855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1331381797790527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([163, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1346702575683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1346702575683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1349811553955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.159231185913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([152, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1608290672302246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1608290672302246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.161118984222412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1857619285583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([129, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.187643051147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.187643051147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1878890991210938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2105255126953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([135, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.21221923828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.21221923828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2124767303466797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2379684448242188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([112, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.239454746246338  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.239454746246338  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.239668369293213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.262312412261963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([83, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2634820938110352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2634820938110352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2636404037475586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.281529426574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([84, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.282823085784912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.282823085784912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2829833030700684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3022093772888184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3032574653625488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3032574653625488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3033757209777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3183941841125488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3193693161010742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3193693161010742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.319474220275879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.333531379699707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([63, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3346900939941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3346900939941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3348102569580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3517532348632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.352823257446289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.352823257446289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3529224395751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3676013946533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3691306114196777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3691306114196777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3692450523376465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3869833946228027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.387589454650879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.387589454650879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3876466751098633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.396916389465332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3978338241577148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3978338241577148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3979120254516602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.411128044128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([627, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.426154613494873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.426154613494873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4273505210876465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.641202449798584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 627, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.596269130706787  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5971417427062988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5980143547058105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5970978736877441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 14122
output nodes number: 5854
edges number: 52209
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.597249984741211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5972504615783691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03132486343383789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 6 input nodes size: 19501
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02805185317993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02805185317993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03735065460205078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03739452362060547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02131938934326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021996498107910156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021996498107910156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021996498107910156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([19501, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021996498107910156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1351, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05019998550415039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05019998550415039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1351, 128]), torch.Size([1, 1351, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.051488399505615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.061795711517333984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1351, 128])
m.shape torch.Size([1433, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06251811981201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06251811981201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1433, 128]), torch.Size([1, 1433, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06388473510742188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08438396453857422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1433, 128])
m.shape torch.Size([1246, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08625555038452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08625555038452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1246, 128]), torch.Size([1, 1246, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08744382858276367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11486005783081055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1246, 128])
m.shape torch.Size([1062, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11629152297973633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11629152297973633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11730432510375977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14667558670043945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([831, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14815044403076172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14815044403076172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1489429473876953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1774730682373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([702, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17908525466918945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17908525466918945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17975473403930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20984554290771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([574, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2114267349243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2114267349243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2119741439819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2402958869934082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([515, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24198675155639648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24198675155639648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2424778938293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27066564559936523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([406, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27216243743896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27216243743896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2725496292114258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2973299026489258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([2372, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.30844688415527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.30844688415527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 2372, 128]), torch.Size([1, 2372, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31070899963378906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4742403030395508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 2372, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.45116710662841797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.46117305755615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4711790084838867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.46109485626220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([10492, 256])
first layer input nodes number: 19501
first layer output nodes number: 10492
edges number: 56082
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4713263511657715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.48133230209350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.48383378982543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.48383378982543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([977, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5182738304138184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5182738304138184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 977, 256]), torch.Size([1, 977, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5201373100280762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5350451469421387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 977, 256])
m.shape torch.Size([886, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5361475944519043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5361475944519043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 886, 256]), torch.Size([1, 886, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5378375053405762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5631861686706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 886, 256])
m.shape torch.Size([718, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5645890235900879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5645890235900879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 718, 256]), torch.Size([1, 718, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5659584999084473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5961670875549316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 718, 256])
m.shape torch.Size([573, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5978302955627441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5978302955627441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5989232063293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6315293312072754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([440, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6330976486206055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6330976486206055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.633936882019043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6653203964233398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([377, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6670751571655273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6670751571655273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6677942276000977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.699549674987793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([318, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7013297080993652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7013297080993652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7019362449645996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7332892417907715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([264, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.735015869140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.735015869140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7355194091796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7646350860595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([205, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7661566734313965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7661566734313965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.766547679901123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.791572093963623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([180, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7931070327758789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7931070327758789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7934503555297852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8178262710571289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([129, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8190693855285645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8190693855285645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8193154335021973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8385071754455566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([104, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8395838737487793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8395838737487793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8397822380065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8566431999206543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([98, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8577685356140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8577685356140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8579554557800293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8751521110534668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8760409355163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8760409355163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8761801719665527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8899645805358887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([77, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8910055160522461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8910055160522461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8911523818969727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9067201614379883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9074621200561523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9074621200561523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9075632095336914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9189863204956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9196548461914062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9196548461914062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.91973876953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9298095703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9306330680847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9306330680847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9307284355163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9428400993347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9433951377868652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9433951377868652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.943458080291748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9518923759460449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9523992538452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9523992538452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9524526596069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9599828720092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9604406356811523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9604406356811523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9604864120483398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9672613143920898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9676828384399414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9676828384399414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9677228927612305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9739313125610352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9742650985717773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9742650985717773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9742956161499023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9792394638061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.979616641998291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.979616641998291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9796490669250488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9851288795471191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([137, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9884047508239746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9884047508239746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9886660575866699  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.034656047821045  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 137, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0069642066955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0078349113464355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0087056159973145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0077910423278809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5842, 40])
input nodes number: 10492
output nodes number: 5842
edges number: 34608
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.007911205291748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0079116821289062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023375988006591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 7 input nodes size: 23465
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021317481994628906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021317481994628906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.032506465911865234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03255033493041992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023207664489746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024030685424804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024030685424804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024030685424804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([23465, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024030685424804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1362, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.059049129486083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.059049129486083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1362, 128]), torch.Size([1, 1362, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0603480339050293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07121658325195312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1362, 128])
m.shape torch.Size([1441, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07194137573242188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07194137573242188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1441, 128]), torch.Size([1, 1441, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07331562042236328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09392929077148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1441, 128])
m.shape torch.Size([1244, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09502172470092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09502172470092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1244, 128]), torch.Size([1, 1244, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09620809555053711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12285757064819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1244, 128])
m.shape torch.Size([1042, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1242518424987793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1242518424987793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1252455711364746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15406370162963867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([904, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15572214126586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15572214126586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1565842628479004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18842554092407227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([770, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19028329849243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19028329849243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 770, 128]), torch.Size([1, 770, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19101762771606445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22352886199951172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 770, 128])
m.shape torch.Size([643, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22530794143676758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22530794143676758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2259211540222168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2575387954711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([594, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.25949811935424805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.25949811935424805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26006460189819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2930941581726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([504, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29497385025024414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29497385025024414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2954545021057129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3262162208557129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([3495, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.34264135360717773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.34264135360717773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3495, 128]), torch.Size([1, 3495, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3459744453430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5832610130310059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3495, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5546483993530273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5660915374755859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5775346755981445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5660018920898438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11999, 256])
first layer input nodes number: 23465
first layer output nodes number: 11999
edges number: 70023
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5777115821838379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5891547203063965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5920205116271973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5920205116271973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([936, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6325211524963379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6325211524963379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 936, 256]), torch.Size([1, 936, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6343064308166504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6485886573791504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 936, 256])
m.shape torch.Size([832, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6492953300476074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6492953300476074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 832, 256]), torch.Size([1, 832, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6508822441101074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6746859550476074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 832, 256])
m.shape torch.Size([658, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6765356063842773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6765356063842773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 658, 256]), torch.Size([1, 658, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.677790641784668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7070646286010742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 658, 256])
m.shape torch.Size([493, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7088561058044434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7088561058044434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7097964286804199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7371535301208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([445, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7388219833374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7388219833374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7396707534790039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.771977424621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([350, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7735714912414551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7735714912414551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7742390632629395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8030314445495605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([278, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8045682907104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8045682907104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8050985336303711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8326473236083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([263, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.834404468536377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.834404468536377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8349061012268066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8637204170227051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([196, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8651652336120605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8651652336120605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8655390739440918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8894648551940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([171, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8909215927124023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8909215927124023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8912477493286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9144048690795898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([133, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9156479835510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9156479835510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9159016609191895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9356884956359863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([131, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.93707275390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.93707275390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9373226165771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9585609436035156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([96, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9596357345581055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9596357345581055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9598188400268555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9766645431518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9777975082397461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9777975082397461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.977971076965332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9951543807983398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9963507652282715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9963507652282715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9965205192565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.014514446258545  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0155353546142578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0155353546142578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0156612396240234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.029886245727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.030771255493164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.030771255493164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0308818817138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0441570281982422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.04500150680542  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.04500150680542  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0451006889343262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.05769681930542  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0584325790405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0584325790405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0585145950317383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.069504737854004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0701751708984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0701751708984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0702457427978516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0801963806152344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0809082984924316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0809082984924316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0809788703918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.091423511505127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0921497344970703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0921497344970703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0922183990478516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1028614044189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1035566329956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1035566329956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1036195755004883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.113816261291504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.114384651184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.114384651184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1144342422485352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1228151321411133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([301, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1300230026245117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1300230026245117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1305971145629883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.232356071472168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 301, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.198458194732666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1993303298950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.200202465057373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1992864608764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5851, 40])
input nodes number: 11999
output nodes number: 5851
edges number: 40299
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1994214057922363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1994218826293945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025665283203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 8 input nodes size: 67376
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023209095001220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023209095001220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05533647537231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.055377960205078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04414510726928711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0462946891784668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0462946891784668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0462946891784668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([67376, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0462946891784668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1461, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16256952285766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16256952285766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1461, 128]), torch.Size([1, 1461, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16396284103393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1751093864440918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1461, 128])
m.shape torch.Size([1461, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1760997772216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1760997772216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1461, 128]), torch.Size([1, 1461, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17749309539794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1983928680419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1461, 128])
m.shape torch.Size([1354, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20050764083862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20050764083862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1354, 128]), torch.Size([1, 1354, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2017989158630371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23020696640014648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1354, 128])
m.shape torch.Size([1243, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2319321632385254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2319321632385254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1243, 128]), torch.Size([1, 1243, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23311758041381836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2676358222961426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1243, 128])
m.shape torch.Size([1173, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26997852325439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26997852325439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1173, 128]), torch.Size([1, 1173, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27109718322753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3113689422607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1173, 128])
m.shape torch.Size([1065, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3146796226501465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3146796226501465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31569528579711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.35936880111694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([973, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3621087074279785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3621087074279785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 973, 128]), torch.Size([1, 973, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3630366325378418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.41040563583374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 973, 128])
m.shape torch.Size([1007, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.41378307342529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.41378307342529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1007, 128]), torch.Size([1, 1007, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.41474342346191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.47032642364501953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1007, 128])
m.shape torch.Size([931, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.47384166717529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.47384166717529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4747295379638672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5320224761962891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([18746, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6209664344787598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6209664344787598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18746, 128]), torch.Size([1, 18746, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6388440132141113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9081521034240723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18746, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7999706268310547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8280220031738281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8560733795166016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8278026580810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([29414, 256])
first layer input nodes number: 67376
first layer output nodes number: 29414
edges number: 236378
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8565773963928223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8846287727355957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.891641616821289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.891641616821289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([867, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9426651000976562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9426651000976562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 867, 256]), torch.Size([1, 867, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9443187713623047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9575481414794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 867, 256])
m.shape torch.Size([684, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.958061695098877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.958061695098877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 684, 256]), torch.Size([1, 684, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9593663215637207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.983015537261963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 684, 256])
m.shape torch.Size([502, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.983811378479004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.983811378479004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9847688674926758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.005833625793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([401, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.006999969482422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.006999969482422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0077648162841797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.031553268432617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([302, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0326356887817383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0326356887817383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0332117080688477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0566091537475586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([245, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0577340126037598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0577340126037598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.058201313018799  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0782952308654785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([206, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0799779891967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0799779891967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0803709030151367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1000165939331055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([188, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1012659072875977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1012659072875977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1016244888305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.122063636779785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([149, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.123767375946045  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.123767375946045  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.124051570892334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.142240047454834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([124, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1432900428771973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1432900428771973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.143526554107666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1603188514709473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([120, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1623353958129883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1623353958129883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.162564277648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.180417060852051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([102, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1814794540405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1814794540405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.181674003601074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1982107162475586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.200263023376465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.200263023376465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.200444221496582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2171144485473633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([82, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2181272506713867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2181272506713867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2182836532592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.233767509460449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2347006797790527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2347006797790527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2348341941833496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2489867210388184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.250011920928955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.250011920928955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2501473426818848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2654500007629395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.266134262084961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.266134262084961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2662220001220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2767505645751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2775721549987793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2775721549987793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.27766752243042  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2897791862487793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.29086971282959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.29086971282959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.290987968444824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3068342208862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3076977729797363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3076977729797363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3077893257141113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3206982612609863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3214802742004395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3214802742004395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3215584754943848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.333132266998291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3338122367858887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3338122367858887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3338770866394043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.343928813934326  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3446922302246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3446922302246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3447608947753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.355884552001953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3566346168518066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3566346168518066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3566994667053223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.367659091949463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([958, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.390645980834961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.390645980834961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 958, 256]), torch.Size([1, 958, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3924732208251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.7144603729248047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 958, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.6691102981567383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.6699328422546387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.670755386352539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.669891357421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 29414
output nodes number: 5517
edges number: 51988
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.670102596282959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.670103073120117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.050005435943603516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 9 input nodes size: 58322
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.044095516204833984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.044095516204833984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07190561294555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07194709777832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03977823257446289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.042047977447509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.042047977447509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.042047977447509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([58322, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.042047977447509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([894, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1583695411682129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1583695411682129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15922212600708008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1667466163635254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([1110, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16780710220336914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16780710220336914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16886568069458008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18474435806274414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1006, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1856541633605957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1856541633605957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1006, 128]), torch.Size([1, 1006, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1866135597229004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20772027969360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1006, 128])
m.shape torch.Size([974, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20909833908081055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20909833908081055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21002721786499023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23838376998901367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([1006, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24031782150268555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24031782150268555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1006, 128]), torch.Size([1, 1006, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24127721786499023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.275815486907959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1006, 128])
m.shape torch.Size([932, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2780022621154785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2780022621154785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27889108657836914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31717634201049805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([971, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3199729919433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3199729919433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.32089900970458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.367342472076416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([933, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3704385757446289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3704385757446289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 933, 128]), torch.Size([1, 933, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.37132835388183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4220457077026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 933, 128])
m.shape torch.Size([959, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4257164001464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4257164001464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.42663097381591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.48516368865966797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([19359, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5770173072814941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5770173072814941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19359, 128]), torch.Size([1, 19359, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5954794883728027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.906294345855713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19359, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.796879768371582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8237199783325195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.850560188293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8235101699829102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([28144, 256])
first layer input nodes number: 58322
first layer output nodes number: 28144
edges number: 237132
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.850996971130371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8778371810913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.884547233581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.884547233581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([532, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9500761032104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9500761032104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9510908126831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9595346450805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([518, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9600462913513184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9600462913513184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 518, 256]), torch.Size([1, 518, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9610342979431152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9768271446228027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 518, 256])
m.shape torch.Size([387, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9775819778442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9775819778442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9783201217651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.998331069946289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([289, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9992108345031738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9992108345031738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9997620582580566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.015747547149658  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([310, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0176219940185547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0176219940185547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0182132720947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.04416561126709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([219, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.045133113861084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.045133113861084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.04555082321167  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0635123252868652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([195, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0646157264709473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0646157264709473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0649876594543457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0835843086242676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([157, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0846056938171387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0846056938171387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0849051475524902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1019740104675293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([176, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1041946411132812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1041946411132812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1045303344726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1260147094726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.127288818359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.127288818359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.127574920654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.14788818359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([141, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1492362022399902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1492362022399902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.149505138397217  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1704821586608887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([131, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.171858787536621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.171858787536621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1721086502075195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1933469772338867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.194934368133545  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.194934368133545  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.195125102996826  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.212672710418701  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([99, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.21390962600708  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.21390962600708  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2140984535217285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.232792377471924  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([101, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.234154224395752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.234154224395752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.234346866607666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2547669410705566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([83, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2559471130371094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2559471130371094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.256105422973633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2739944458007812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([86, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.275320529937744  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.275320529937744  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.275484561920166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.295168399810791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([97, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.296764850616455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.296764850616455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.296949863433838  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.320446491241455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([77, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3217601776123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3217601776123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3219070434570312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3415870666503906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([64, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3427438735961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3427438735961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3428659439086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3600778579711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([71, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3614501953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3614501953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3615856170654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3816280364990234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([53, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.382681369781494  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.382681369781494  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.382782459259033  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.398451328277588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.399263381958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.399263381958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3993377685546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.411388397216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([52, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.412550926208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.412550926208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.4126501083374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.4294118881225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([1422, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.4635305404663086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.4635305404663086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1422, 256]), torch.Size([1, 1422, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.466242790222168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.9552202224731445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1422, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.894745349884033  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.8955726623535156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.896399974822998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.895531177520752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5549, 40])
input nodes number: 28144
output nodes number: 5549
edges number: 67409
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.895787239074707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.8957877159118652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04595184326171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 10 input nodes size: 56165
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03978300094604492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03978300094604492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06656455993652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06660604476928711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03875446319580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04094886779785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04094886779785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04094886779785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([56165, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04094886779785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1139, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1555171012878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1555171012878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1139, 128]), torch.Size([1, 1139, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15660333633422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16541671752929688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1139, 128])
m.shape torch.Size([1178, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16599702835083008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16599702835083008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1178, 128]), torch.Size([1, 1178, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16712045669555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18438148498535156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1178, 128])
m.shape torch.Size([1075, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18535757064819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18535757064819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18638277053833008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20954513549804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1015, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2109684944152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2109684944152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1015, 128]), torch.Size([1, 1015, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21193647384643555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24017953872680664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1015, 128])
m.shape torch.Size([970, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24200820922851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24200820922851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2429332733154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27680301666259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([874, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2788410186767578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2788410186767578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2796745300292969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31644439697265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([912, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31907176971435547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31907176971435547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31994152069091797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.36382579803466797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 912, 128])
m.shape torch.Size([835, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3665761947631836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3665761947631836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 835, 128]), torch.Size([1, 835, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3673725128173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.41318225860595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 835, 128])
m.shape torch.Size([811, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.41626453399658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.41626453399658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4170379638671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.468691349029541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([19204, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5598764419555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5598764419555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19204, 128]), torch.Size([1, 19204, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.578190803527832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8785104751586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19204, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7709465026855469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7976617813110352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8243770599365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7974529266357422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([28013, 256])
first layer input nodes number: 56165
first layer output nodes number: 28013
edges number: 233277
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8247976303100586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8515129089355469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.858191967010498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.858191967010498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([699, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.918138027191162  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.918138027191162  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 699, 256]), torch.Size([1, 699, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.919471263885498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9301371574401855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 699, 256])
m.shape torch.Size([611, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9306740760803223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9306740760803223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9318394660949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9499382972717285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 611, 256])
m.shape torch.Size([443, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.950643539428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.950643539428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9514884948730469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9764866828918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([354, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9774961471557617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9774961471557617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9781713485717773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9978666305541992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([293, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9989371299743652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9989371299743652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9994959831237793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0210070610046387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([203, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0218987464904785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0218987464904785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0222859382629395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0389351844787598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([199, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0400805473327637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0400805473327637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0404601097106934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0594382286071777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([160, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.060530185699463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.060530185699463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.060835361480713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.078230381011963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([148, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0793581008911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0793581008911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0796403884887695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0977067947387695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([138, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0988922119140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0988922119140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0991554260253906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1178436279296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([114, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.118947982788086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.118947982788086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1191654205322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1361255645751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([115, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.138218402862549  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.138218402862549  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1384377479553223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1570820808410645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([81, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.158017158508301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.158017158508301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1581716537475586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1723852157592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1732096672058105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1732096672058105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.173337459564209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1859889030456543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([77, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.187039375305176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.187039375305176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1871862411499023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.202754020690918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([67, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2037720680236816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2037720680236816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.20389986038208  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2183403968811035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.21925687789917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.21925687789917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2193713188171387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2331042289733887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([78, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.234396457672119  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.234396457672119  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2345452308654785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.253439426422119  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2544569969177246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2544569969177246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2545676231384277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2693915367126465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.27042818069458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.27042818069458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2705330848693848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2853245735168457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.286543846130371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.286543846130371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2866640090942383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.304448127746582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.305360794067383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.305360794067383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.305448532104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3190479278564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([53, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.320176124572754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.320176124572754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.320277214050293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.336653709411621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3376946449279785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3376946449279785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.337780475616455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.352285861968994  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([1290, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.383239269256592  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.383239269256592  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1290, 256]), torch.Size([1, 1290, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.38569974899292  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.8192763328552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1290, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.7645931243896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.765415668487549  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.766238212585449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.765374183654785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 28013
output nodes number: 5517
edges number: 61096
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.7656197547912598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.765620231628418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04470205307006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 11 input nodes size: 51993
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03874969482421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03874969482421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06354188919067383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06358575820922852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03676271438598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03899049758911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03899049758911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03899049758911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([51993, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03899049758911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([836, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1493377685546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1493377685546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15013504028320312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15651321411132812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([904, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15697669982910156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15697669982910156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1578388214111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17077064514160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([891, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17165517807006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17165517807006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17250490188598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1919865608215332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([903, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1932840347290039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1932840347290039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 903, 128]), torch.Size([1, 903, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19414520263671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21970462799072266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 903, 128])
m.shape torch.Size([875, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2213602066040039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2213602066040039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 875, 128]), torch.Size([1, 875, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22219467163085938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2528843879699707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 875, 128])
m.shape torch.Size([814, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.25479602813720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.25479602813720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2555723190307617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29071521759033203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([830, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29309749603271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29309749603271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29388904571533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3340005874633789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([777, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.33656883239746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.33656883239746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 777, 128]), torch.Size([1, 777, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3373098373413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.37987518310546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 777, 128])
m.shape torch.Size([793, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3829078674316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3829078674316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3836641311645508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4320650100708008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([18763, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.521155834197998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.521155834197998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18763, 128]), torch.Size([1, 18763, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5390496253967285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8095088005065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18763, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7053642272949219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7305278778076172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7556915283203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7303309440612793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([26386, 256])
first layer input nodes number: 51993
first layer output nodes number: 26386
edges number: 224981
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7560811042785645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7812447547912598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.788194179534912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.788194179534912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([536, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8599562644958496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8599562644958496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 536, 256]), torch.Size([1, 536, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.860978603363037  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.869157314300537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 536, 256])
m.shape torch.Size([436, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8694844245910645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8694844245910645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8703160285949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8827900886535645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([382, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.883613109588623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.883613109588623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8843417167663574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.901838779449463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([329, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9028654098510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9028654098510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9034929275512695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9256768226623535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([294, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.927393913269043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.927393913269043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9279546737670898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.948359489440918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([230, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9502429962158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9502429962158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9506816864013672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9695453643798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([200, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9706716537475586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9706716537475586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.971053123474121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.990126609802246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([164, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9918856620788574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9918856620788574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9921984672546387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.01002836227417  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([185, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.011472702026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.011472702026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0118255615234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0344085693359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.03593111038208  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.03593111038208  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0362343788146973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0577664375305176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.059147834777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.059147834777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.05942440032959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.080996513366699  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([154, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.082634449005127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.082634449005127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.08292818069458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1078953742980957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([141, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.109516143798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.109516143798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1097850799560547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1345272064208984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([115, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1359405517578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1359405517578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.136159896850586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1578750610351562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([113, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.159517765045166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.159517765045166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.159733295440674  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.182579517364502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([110, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1841635704040527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.1841635704040527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.184373378753662  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2080817222595215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([100, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.209610939025879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.209610939025879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.20980167388916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.23268985748291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([91, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.234203338623047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.234203338623047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.234376907348633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.256420135498047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([92, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2580137252807617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2580137252807617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2581892013549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.281702995300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([96, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2834606170654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2834606170654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2836437225341797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3094615936279297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([80, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.310990810394287  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.310990810394287  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.311143398284912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.333726406097412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3351035118103027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3351035118103027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.335212230682373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3520636558532715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([61, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.353532314300537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.353532314300537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3536486625671387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.372497081756592  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3741040229797363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3741040229797363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3742222785949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.39420747756958  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([1521, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.4306955337524414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.4306955337524414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1521, 256]), torch.Size([1, 1521, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.4339704513549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.961968421936035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1521, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.8955140113830566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.8963866233825684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.89725923538208  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.8963427543640137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5853, 40])
input nodes number: 26386
output nodes number: 5853
edges number: 73884
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.8966336250305176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.896634101867676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.042864322662353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 12 input nodes size: 35621
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.036812782287597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.036812782287597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05379819869995117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.053839683532714844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029003620147705078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029884815216064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029884815216064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029884815216064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([35621, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029884815216064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1721, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07366323471069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07366323471069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1721, 128]), torch.Size([1, 1721, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07530450820922852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08843469619750977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1721, 128])
m.shape torch.Size([1754, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09015989303588867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09015989303588867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1754, 128]), torch.Size([1, 1754, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09183263778686523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11723136901855469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1754, 128])
m.shape torch.Size([1468, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11849498748779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11849498748779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1468, 128]), torch.Size([1, 1468, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11989498138427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1506948471069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1468, 128])
m.shape torch.Size([1229, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1527261734008789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1527261734008789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1229, 128]), torch.Size([1, 1229, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1538982391357422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18788814544677734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1229, 128])
m.shape torch.Size([1132, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19042444229125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19042444229125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19150400161743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23051881790161133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([866, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23245668411254883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23245668411254883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23328256607055664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2687954902648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([724, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2707991600036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2707991600036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 724, 128]), torch.Size([1, 724, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27148962020874023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3070521354675293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 724, 128])
m.shape torch.Size([692, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.30934667587280273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.30934667587280273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31000661849975586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.34766530990600586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 692, 128])
m.shape torch.Size([538, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.34964418411254883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.34964418411254883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3501572608947754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.38420629501342773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([4670, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4062180519104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4062180519104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4670, 128]), torch.Size([1, 4670, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4106717109680176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7280945777893066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4670, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6908931732177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7050018310546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7191104888916016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7048912048339844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([14794, 256])
first layer input nodes number: 35621
first layer output nodes number: 14794
edges number: 87551
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7193779945373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7334866523742676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7370562553405762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7370562553405762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1166, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7684168815612793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7684168815612793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1166, 256]), torch.Size([1, 1166, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7718501091003418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7949843406677246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1166, 256])
m.shape torch.Size([933, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.795351505279541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.795351505279541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 933, 256]), torch.Size([1, 933, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7971310615539551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.823824405670166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 933, 256])
m.shape torch.Size([694, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8249359130859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8249359130859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 694, 256]), torch.Size([1, 694, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8262596130371094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8553810119628906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 694, 256])
m.shape torch.Size([507, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8566684722900391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8566684722900391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.857635498046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8858699798583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([432, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8874626159667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8874626159667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8882865905761719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9188518524169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([294, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.920135498046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.920135498046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9206962585449219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9452276229858398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([246, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9466023445129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9466023445129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9470715522766113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9705319404602051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([188, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.972496509552002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.972496509552002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9728550910949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9932942390441895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([157, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9944734573364258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9944734573364258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9947729110717773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0139379501342773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([126, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0149993896484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0149993896484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0152397155761719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0323028564453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([98, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0332188606262207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0332188606262207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0334057807922363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.047985553741455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0490226745605469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0490226745605469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0492095947265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0650978088378906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0658793449401855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0658793449401855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0660128593444824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.078296184539795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0788216590881348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0788216590881348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0789055824279785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0872139930725098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0878643989562988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0878643989562988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0879559516906738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0976605415344238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0981531143188477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0981531143188477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.098219871520996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1057634353637695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1061716079711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1061716079711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1062231063842773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1124029159545898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1129827499389648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1129827499389648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1130495071411133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1215276718139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1220240592956543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1220240592956543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1220793724060059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1294913291931152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1300020217895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1300020217895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1300554275512695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1375856399536133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1379828453063965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1379828453063965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1380228996276855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1439509391784668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1442484855651855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1442484855651855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1442770957946777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1487116813659668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.14902925491333  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.14902925491333  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1490578651428223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1536927223205566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1540937423706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1540937423706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.154128074645996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1599302291870117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([193, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.16455078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.16455078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1649188995361328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2297077178955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 193, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.204878330230713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2057008743286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2065234184265137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2056593894958496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 14794
output nodes number: 5517
edges number: 30598
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.205761432647705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2057619094848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.031604766845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 13 input nodes size: 45136
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02895355224609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02895355224609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05047607421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05051755905151367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.033490657806396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.034830570220947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.034830570220947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.034830570220947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([45136, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.034830570220947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1506, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10408830642700195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10408830642700195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1506, 128]), torch.Size([1, 1506, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10552453994750977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11701440811157227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1506, 128])
m.shape torch.Size([1502, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11832571029663086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11832571029663086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1502, 128]), torch.Size([1, 1502, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11975812911987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14124441146850586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1502, 128])
m.shape torch.Size([1245, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14286279678344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14286279678344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1245, 128]), torch.Size([1, 1245, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14405012130737305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17021512985229492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1245, 128])
m.shape torch.Size([1154, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17182254791259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17182254791259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1154, 128]), torch.Size([1, 1154, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17292308807373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20483875274658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1154, 128])
m.shape torch.Size([987, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20664167404174805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20664167404174805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20758295059204102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24217462539672852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([887, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24424171447753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24424171447753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2450876235961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.28327512741088867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([820, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.28558921813964844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.28558921813964844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.28637123107910156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3271446228027344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([810, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.32984352111816406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.32984352111816406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3306159973144531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3746471405029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([700, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.37726497650146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.37726497650146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 700, 128]), torch.Size([1, 700, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3779325485229492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4215822219848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 700, 128])
m.shape torch.Size([9838, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.46815967559814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.46815967559814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 9838, 128]), torch.Size([1, 9838, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4775419235229492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1697750091552734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 9838, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.106433391571045  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.12498140335083  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1435294151306152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1248364448547363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([19449, 256])
first layer input nodes number: 45136
first layer output nodes number: 19449
edges number: 140018
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1438679695129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1624159812927246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1678977012634277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1678977012634277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([998, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.207231044769287  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.207231044769287  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 998, 256]), torch.Size([1, 998, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.209134578704834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.224362850189209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 998, 256])
m.shape torch.Size([826, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.225083351135254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.225083351135254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 826, 256]), torch.Size([1, 826, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.226658821105957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.25056791305542  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 826, 256])
m.shape torch.Size([585, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2517600059509277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2517600059509277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.252875804901123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2774920463562012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([452, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.278914451599121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.278914451599121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2797765731811523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3060073852539062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([369, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.307349681854248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.307349681854248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3080534934997559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3334355354309082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([319, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.334923267364502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.334923267364502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3355317115783691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3623557090759277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([226, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.363572120666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.363572120666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3640031814575195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3855562210083008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([219, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3870248794555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3870248794555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3874425888061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4112520217895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([149, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4123320579528809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4123320579528809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.41261625289917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.43080472946167  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([143, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.432037353515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.432037353515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4323101043701172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4516754150390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4529666900634766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4529666900634766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4532241821289062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4733085632324219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([91, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4743986129760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4743986129760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4745721817016602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4893255233764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4900760650634766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4900760650634766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.490203857421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5019607543945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5027446746826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5027446746826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5028648376464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.514760971069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.515479564666748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.515479564666748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.51558256149292  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5265002250671387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5273561477661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5273561477661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5274686813354492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5401849746704102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.541043758392334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.541043758392334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5411505699157715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5539679527282715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5547103881835938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5547103881835938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5547981262207031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5659408569335938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5666460990905762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5666460990905762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5667243003845215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5772032737731934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.577894687652588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.577894687652588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5779671669006348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5881867408752441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5889177322387695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5889177322387695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5889902114868164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.599717140197754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6002521514892578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6002521514892578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6003036499023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.608285903930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6087908744812012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6087908744812012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6088366508483887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6162524223327637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6169910430908203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6169910430908203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6170539855957031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6276912689208984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([459, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6386890411376953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6386890411376953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6395645141601562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7953786849975586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 459, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7622289657592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7630515098571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7638740539550781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.763010025024414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 19449
output nodes number: 5517
edges number: 39691
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7631964683532715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7631969451904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.037301063537597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 14 input nodes size: 27745
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.033490657806396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.033490657806396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04672050476074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04676198959350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025197982788085938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02599334716796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02599334716796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02599334716796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([27745, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02599334716796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1443, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06206083297729492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06206083297729492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1443, 128]), torch.Size([1, 1443, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06343698501586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07524299621582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1443, 128])
m.shape torch.Size([1453, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0764927864074707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0764927864074707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1453, 128]), torch.Size([1, 1453, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07787847518920898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0986638069152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1453, 128])
m.shape torch.Size([1312, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09984779357910156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09984779357910156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1312, 128]), torch.Size([1, 1312, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10109901428222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12862586975097656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1312, 128])
m.shape torch.Size([1037, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13001441955566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13001441955566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1037, 128]), torch.Size([1, 1037, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13100337982177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16036415100097656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1037, 128])
m.shape torch.Size([988, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16222524642944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16222524642944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16316747665405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19777441024780273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([793, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19957208633422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19957208633422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20032835006713867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23296785354614258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([662, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23479938507080078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23479938507080078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23543071746826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2677192687988281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 662, 128])
m.shape torch.Size([562, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2695474624633789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2695474624633789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2700834274291992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3014812469482422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([447, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3031315803527832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3031315803527832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3035578727722168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3308405876159668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([3680, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.348175048828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.348175048828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3680, 128]), torch.Size([1, 3680, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3519134521484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6032490730285645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3680, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5725569725036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5843605995178223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5961642265319824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5842680931091309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12377, 256])
first layer input nodes number: 27745
first layer output nodes number: 12377
edges number: 72084
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5963730812072754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6081767082214355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6111278533935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6111278533935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1004, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6454901695251465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6454901695251465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1004, 256]), torch.Size([1, 1004, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6474051475524902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6627249717712402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1004, 256])
m.shape torch.Size([820, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6634430885314941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6634430885314941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 820, 256]), torch.Size([1, 820, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6650071144104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6884675025939941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 820, 256])
m.shape torch.Size([658, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6900653839111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6900653839111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 658, 256]), torch.Size([1, 658, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6913204193115234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7196216583251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 658, 256])
m.shape torch.Size([506, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.72137451171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.72137451171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7223396301269531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7516326904296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([447, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.753298282623291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.753298282623291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7541508674621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7862167358398438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([327, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7876763343811035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7876763343811035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7883000373840332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8162693977355957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([255, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8176732063293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8176732063293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8181595802307129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8424782752990723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([215, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8438882827758789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8438882827758789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8442983627319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8676729202270508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([169, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8689298629760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8689298629760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8692522048950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8898820877075195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([137, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8910379409790039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8910379409790039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8912992477416992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9098520278930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([99, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9107685089111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9107685089111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9109573364257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9256858825683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([103, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9267797470092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9267797470092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.926976203918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9436750411987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9448513984680176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9448513984680176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9450459480285645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.962944507598877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9640045166015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9640045166015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9641685485839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.98040771484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9811477661132812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9811477661132812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9812564849853516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9927806854248047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9935107231140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9935107231140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9936079978942871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0046000480651855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.00535249710083  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.00535249710083  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.005445957183838  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0166611671447754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0172719955444336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0172719955444336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0173444747924805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0265493392944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0273170471191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0273170471191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0274009704589844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0386466979980469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.039297103881836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.039297103881836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0393657684326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0490474700927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0493764877319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0493764877319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0494108200073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0544919967651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0548768043518066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0548768043518066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.05491304397583  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.060530185699463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0610427856445312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0610427856445312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0610885620117188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0685043334960938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0688738822937012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0688738822937012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.068906307220459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0743861198425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([237, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0807209014892578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0807209014892578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0811729431152344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1607322692871094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 237, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.13273286819458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1335554122924805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1343779563903809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1335139274597168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5518, 40])
input nodes number: 12377
output nodes number: 5518
edges number: 34515
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1336479187011719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.13364839553833  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.027593135833740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 15 input nodes size: 34179
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025197982788085938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025197982788085938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04149580001831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.041538238525390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02826690673828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029205322265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029205322265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029205322265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([34179, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029205322265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1376, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07352018356323242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07352018356323242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1376, 128]), torch.Size([1, 1376, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07483243942260742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08593940734863281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1376, 128])
m.shape torch.Size([1621, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08682918548583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08682918548583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1621, 128]), torch.Size([1, 1621, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08837509155273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11163711547851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1621, 128])
m.shape torch.Size([1383, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11284255981445312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11284255981445312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1383, 128]), torch.Size([1, 1383, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11416149139404297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14354181289672852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1383, 128])
m.shape torch.Size([1181, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14513492584228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14513492584228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1181, 128]), torch.Size([1, 1181, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14626121520996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1789236068725586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1181, 128])
m.shape torch.Size([1070, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18091154098510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18091154098510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1819319725036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21866750717163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([842, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2205662727355957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2205662727355957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22136926651000977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.25613927841186523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([732, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.258181095123291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.258181095123291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 732, 128]), torch.Size([1, 732, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2588791847229004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2947564125061035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 732, 128])
m.shape torch.Size([668, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29695558547973633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29695558547973633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2975926399230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3353753089904785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([577, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.33753299713134766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.33753299713134766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.33808326721191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.373563289642334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([4947, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3968772888183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3968772888183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4947, 128]), torch.Size([1, 4947, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4021015167236328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.748286247253418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4947, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7100658416748047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7237958908081055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7375259399414062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7236886024475098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([14397, 256])
first layer input nodes number: 34179
first layer output nodes number: 14397
edges number: 89024
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7377829551696777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7515130043029785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7549457550048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7549457550048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([967, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7915267944335938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7915267944335938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 967, 256]), torch.Size([1, 967, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7933712005615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8083534240722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 967, 256])
m.shape torch.Size([878, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8095569610595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8095569610595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 878, 256]), torch.Size([1, 878, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8112316131591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8363513946533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 878, 256])
m.shape torch.Size([679, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.837641716003418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.837641716003418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 679, 256]), torch.Size([1, 679, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8389368057250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8680977821350098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 679, 256])
m.shape torch.Size([517, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8698344230651855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8698344230651855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8708205223083496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8999629020690918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 517, 256])
m.shape torch.Size([459, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9016757011413574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9016757011413574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9025511741638184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.934816837310791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([314, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.936190128326416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.936190128326416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9367890357971191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9635591506958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([246, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9649147987365723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9649147987365723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9653840065002441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9888443946838379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([218, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9902863502502441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9902863502502441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9907021522521973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0144028663635254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([190, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.015838623046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.015838623046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0162010192871094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0393943786621094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([148, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0406360626220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0406360626220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0409183502197266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0609607696533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0621094703674316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0621094703674316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0623421669006348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0804924964904785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0816221237182617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0816221237182617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0818281173706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0993375778198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1005215644836426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1005215644836426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1007180213928223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1187920570373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1197705268859863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1197705268859863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1199231147766113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1350293159484863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1358613967895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1358613967895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.135981559753418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1487188339233398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.14959716796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.14959716796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1497135162353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1628608703613281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1636199951171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1636199951171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1637153625488281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1751594543457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.176011562347412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.176011562347412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1761107444763184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.188706874847412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1893329620361328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1893329620361328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1894035339355469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1988601684570312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1995172500610352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1995172500610352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1995859146118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2092676162719727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2098593711853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2098593711853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.20991849899292  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2186694145202637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2190418243408203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2190418243408203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2190780639648438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2246952056884766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2250752449035645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2250752449035645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.225109577178955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2306714057922363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.231092929840088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.231092929840088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2311291694641113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2372536659240723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([281, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2439875602722168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2439875602722168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.244523525238037  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3400044441223145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3098983764648438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3107471466064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3115959167480469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3107047080993652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5696, 40])
input nodes number: 14397
output nodes number: 5696
edges number: 36854
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3108806610107422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3108811378479004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.031085968017578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.031085968017578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.031085968017578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009315773844718933 |0.002558097243309021 |0.11818370223045349 |8.74251127243042e-05 |0.07667742669582367 |0.004643917083740234 |
----------------------------------------------------------pseudo_mini_loss sum 4.793069362640381[05:40:30] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28962740 edges into 16 parts and get 7458975 edge cuts

Total (block generation + training)time/epoch 25.37806272506714
Training time/epoch 3.3950488567352295
Training time without block to device /epoch 3.354119300842285
Training time without total dataloading part /epoch 3.1238207817077637
load block tensor time/epoch 0.14905238151550293
block to device time/epoch 0.040929555892944336
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  833150
Number of first layer input nodes during this epoch:  564924
Number of first layer output nodes during this epoch:  268226
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.031085491180419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018288135528564453
global_2_local spend time (sec) 0.04845309257507324
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004474163055419922
A = g.adjacency_matrix() spent  0.011723756790161133
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08435773849487305
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3841609954833984
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1764576435089111

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 1.229 seconds
Metis partitioning: 5.604 seconds
Split the graph: 1.023 seconds
Construct subgraphs: 0.030 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.90088677406311
5801
5793
5549
5853
5814
5838
5831
5818
5517
5774
5518
5517
5518
5593
5517
5690
total k batches seeds list generation spend  18.041022539138794
after graph partition
graph partition algorithm spend time 18.153159856796265
5801
5793
5549
5853
5814
5838
5831
5818
5517
5774
5518
5517
5518
5593
5517
5690
partition_len_list
[11154, 11852, 12249, 13016, 10378, 11766, 14337, 13522, 18506, 13349, 24435, 14749, 30350, 24973, 26368, 30084]
shared_neighbor_graph_partition_s0 selection method  spend 18.25615692138672
time for parepare:  0.017252206802368164
local_output_nid generation:  0.0013926029205322266
local_in_edges_tensor generation:  0.0015206336975097656
mini_batch_src_global generation:  0.0068988800048828125
r_  generation:  0.01625370979309082
local_output_nid generation:  0.0016326904296875
local_in_edges_tensor generation:  0.0013871192932128906
mini_batch_src_global generation:  0.0018000602722167969
r_  generation:  0.015536069869995117
local_output_nid generation:  0.001676797866821289
local_in_edges_tensor generation:  0.0012688636779785156
mini_batch_src_global generation:  0.0013172626495361328
r_  generation:  0.012564420700073242
local_output_nid generation:  0.0017881393432617188
local_in_edges_tensor generation:  0.001401662826538086
mini_batch_src_global generation:  0.0015025138854980469
r_  generation:  0.016755342483520508
local_output_nid generation:  0.0018160343170166016
local_in_edges_tensor generation:  0.0012521743774414062
mini_batch_src_global generation:  0.0012845993041992188
r_  generation:  0.010940313339233398
local_output_nid generation:  0.001775503158569336
local_in_edges_tensor generation:  0.0012316703796386719
mini_batch_src_global generation:  0.0013196468353271484
r_  generation:  0.013810396194458008
local_output_nid generation:  0.0017781257629394531
local_in_edges_tensor generation:  0.001361846923828125
mini_batch_src_global generation:  0.001352548599243164
r_  generation:  0.01632976531982422
local_output_nid generation:  0.0018413066864013672
local_in_edges_tensor generation:  0.0012788772583007812
mini_batch_src_global generation:  0.0013737678527832031
r_  generation:  0.015351533889770508
local_output_nid generation:  0.0018248558044433594
local_in_edges_tensor generation:  0.0013568401336669922
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.01405024528503418
local_output_nid generation:  0.0018143653869628906
local_in_edges_tensor generation:  0.0012629032135009766
mini_batch_src_global generation:  0.0012116432189941406
r_  generation:  0.013775825500488281
local_output_nid generation:  0.0017437934875488281
local_in_edges_tensor generation:  0.0012671947479248047
mini_batch_src_global generation:  0.0013878345489501953
r_  generation:  0.01763772964477539
local_output_nid generation:  0.0018181800842285156
local_in_edges_tensor generation:  0.0011928081512451172
mini_batch_src_global generation:  0.0015184879302978516
r_  generation:  0.010829448699951172
local_output_nid generation:  0.0017726421356201172
local_in_edges_tensor generation:  0.0012738704681396484
mini_batch_src_global generation:  0.0014581680297851562
r_  generation:  0.0193483829498291
local_output_nid generation:  0.0019381046295166016
local_in_edges_tensor generation:  0.0012943744659423828
mini_batch_src_global generation:  0.0017714500427246094
r_  generation:  0.017002105712890625
local_output_nid generation:  0.0018923282623291016
local_in_edges_tensor generation:  0.0013549327850341797
mini_batch_src_global generation:  0.0016980171203613281
r_  generation:  0.02155590057373047
local_output_nid generation:  0.0019981861114501953
local_in_edges_tensor generation:  0.002147197723388672
mini_batch_src_global generation:  0.002572774887084961
r_  generation:  0.02396988868713379
----------------------check_connections_block total spend ----------------------------- 0.42426013946533203
generate_one_block  0.027995824813842773
generate_one_block  0.02232813835144043
generate_one_block  0.017181396484375
generate_one_block  0.02268362045288086
generate_one_block  0.015843868255615234
generate_one_block  0.01687908172607422
generate_one_block  0.023293018341064453
generate_one_block  0.020629405975341797
generate_one_block  0.02405714988708496
generate_one_block  0.018230438232421875
generate_one_block  0.025233983993530273
generate_one_block  0.016127586364746094
generate_one_block  0.027298450469970703
generate_one_block  0.02308201789855957
generate_one_block  0.030023813247680664
generate_one_block  0.03457236289978027
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04251503944396973
gen group dst list time:  0.008391141891479492
time for parepare:  0.01938915252685547
local_output_nid generation:  0.0024335384368896484
local_in_edges_tensor generation:  0.011317968368530273
mini_batch_src_global generation:  0.0025539398193359375
r_  generation:  0.025473594665527344
local_output_nid generation:  0.003438711166381836
local_in_edges_tensor generation:  0.003255605697631836
mini_batch_src_global generation:  0.002981901168823242
r_  generation:  0.02714085578918457
local_output_nid generation:  0.0036995410919189453
local_in_edges_tensor generation:  0.002893686294555664
mini_batch_src_global generation:  0.0021436214447021484
r_  generation:  0.027052640914916992
local_output_nid generation:  0.00362396240234375
local_in_edges_tensor generation:  0.0035774707794189453
mini_batch_src_global generation:  0.0027103424072265625
r_  generation:  0.029936552047729492
local_output_nid generation:  0.002986907958984375
local_in_edges_tensor generation:  0.0025298595428466797
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.02036428451538086
local_output_nid generation:  0.0032503604888916016
local_in_edges_tensor generation:  0.00249481201171875
mini_batch_src_global generation:  0.0018901824951171875
r_  generation:  0.02395796775817871
local_output_nid generation:  0.0037419795989990234
local_in_edges_tensor generation:  0.0033636093139648438
mini_batch_src_global generation:  0.0031762123107910156
r_  generation:  0.035245418548583984
local_output_nid generation:  0.0036830902099609375
local_in_edges_tensor generation:  0.003225088119506836
mini_batch_src_global generation:  0.00296783447265625
r_  generation:  0.030510663986206055
local_output_nid generation:  0.004997730255126953
local_in_edges_tensor generation:  0.004716396331787109
mini_batch_src_global generation:  0.004140138626098633
r_  generation:  0.04605865478515625
local_output_nid generation:  0.0037376880645751953
local_in_edges_tensor generation:  0.0030677318572998047
mini_batch_src_global generation:  0.003218412399291992
r_  generation:  0.03013920783996582
local_output_nid generation:  0.006488800048828125
local_in_edges_tensor generation:  0.006288290023803711
mini_batch_src_global generation:  0.006953716278076172
r_  generation:  0.0680689811706543
local_output_nid generation:  0.00441431999206543
local_in_edges_tensor generation:  0.0036880970001220703
mini_batch_src_global generation:  0.004303932189941406
r_  generation:  0.03474760055541992
local_output_nid generation:  0.007764577865600586
local_in_edges_tensor generation:  0.00812077522277832
mini_batch_src_global generation:  0.008246660232543945
r_  generation:  0.08859872817993164
local_output_nid generation:  0.007183551788330078
local_in_edges_tensor generation:  0.006788969039916992
mini_batch_src_global generation:  0.00818634033203125
r_  generation:  0.07120609283447266
local_output_nid generation:  0.0072133541107177734
local_in_edges_tensor generation:  0.006360769271850586
mini_batch_src_global generation:  0.008569002151489258
r_  generation:  0.0783090591430664
local_output_nid generation:  0.007837295532226562
local_in_edges_tensor generation:  0.007949352264404297
mini_batch_src_global generation:  0.011122465133666992
r_  generation:  0.08951687812805176
----------------------check_connections_block total spend ----------------------------- 1.1642320156097412
generate_one_block  0.04860997200012207
generate_one_block  0.03515791893005371
generate_one_block  0.034122467041015625
generate_one_block  0.038536787033081055
generate_one_block  0.025643348693847656
generate_one_block  0.030819416046142578
generate_one_block  0.04703640937805176
generate_one_block  0.039504051208496094
generate_one_block  0.06242108345031738
generate_one_block  0.038887977600097656
generate_one_block  0.08816385269165039
generate_one_block  0.045124053955078125
generate_one_block  0.11968111991882324
generate_one_block  0.09452700614929199
generate_one_block  0.10416936874389648
generate_one_block  0.11914205551147461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.031085491180419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

connection checking time:  1.1642320156097412
block generation total time  0.9715468883514404
average batch blocks generation time:  0.06072168052196503
block dataloader generation time/epoch 21.678496718406677
pseudo mini batch 0 input nodes size: 21027
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.028292179107666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.028292179107666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.038318634033203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03836202621459961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022021770477294922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022962093353271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022962093353271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022962093353271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([21027, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022962093353271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([744, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06042146682739258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06042146682739258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06113100051879883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06691646575927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([914, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06743335723876953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06743335723876953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06830501556396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08137989044189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([903, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08223581314086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08223581314086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 903, 128]), torch.Size([1, 903, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08309698104858398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10301685333251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 903, 128])
m.shape torch.Size([872, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10424947738647461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10424947738647461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10508108139038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1291975975036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 872, 128])
m.shape torch.Size([770, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13061761856079102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13061761856079102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 770, 128]), torch.Size([1, 770, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13135194778442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15874433517456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 770, 128])
m.shape torch.Size([708, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16040277481079102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16040277481079102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 708, 128]), torch.Size([1, 708, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16107797622680664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19058465957641602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 708, 128])
m.shape torch.Size([623, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19232654571533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19232654571533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19292068481445312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22423124313354492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([605, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2262420654296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2262420654296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22681903839111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2605915069580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([479, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2625250816345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2625250816345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2629818916320801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2922177314758301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([4536, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31361865997314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31361865997314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4536, 128]), torch.Size([1, 4536, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3179445266723633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6260538101196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4536, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5928783416748047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6141529083251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6034321784973145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11154, 256])
first layer input nodes number: 21027
first layer output nodes number: 11154
edges number: 75739
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.614311695098877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6249489784240723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6285243034362793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6285243034362793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([548, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6777286529541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6777286529541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6787738800048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6871356964111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([584, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6878008842468262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6878008842468262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 584, 256]), torch.Size([1, 584, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6889147758483887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7057433128356934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 584, 256])
m.shape torch.Size([526, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7074089050292969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7074089050292969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 526, 256]), torch.Size([1, 526, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7084121704101562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7309789657592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 526, 256])
m.shape torch.Size([466, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.732269287109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.732269287109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7331581115722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7597732543945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([438, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7614340782165527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7614340782165527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7622694969177246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7923445701599121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([394, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7941989898681641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7941989898681641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7949504852294922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8278274536132812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([319, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8295979499816895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8295979499816895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8302063941955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8613629341125488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([276, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8631811141967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8631811141967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8637075424194336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8944525718688965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([230, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.89617919921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.89617919921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8966178894042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9246940612792969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([211, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9265027046203613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9265027046203613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9269051551818848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9554791450500488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([226, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.957667350769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.957667350769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9580984115600586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9917211532592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([146, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.993189811706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.993189811706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9934682846069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0171384811401367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([163, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0190362930297852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0190362930297852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0193471908569336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0479497909545898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([139, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0496649742126465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0496649742126465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0499300956726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0761771202087402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([107, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.077587604522705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.077587604522705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.077791690826416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0994248390197754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([108, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1009836196899414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1009836196899414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1011896133422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.124466896057129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([99, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1259818077087402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1259818077087402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1261706352233887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1488299369812012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([79, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1501026153564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1501026153564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1502532958984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1693897247314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1702642440795898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1702642440795898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.170363426208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1836538314819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([84, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1852192878723145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1852192878723145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1853795051574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.207970142364502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2092089653015137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2092089653015137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2093195915222168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2256922721862793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2267155647277832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2267155647277832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2268128395080566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2418904304504395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2425494194030762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2425494194030762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2426104545593262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2524981498718262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.25343656539917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.25343656539917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.253516674041748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2670550346374512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([423, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.27781343460083  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.27781343460083  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2786202430725098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4216256141662598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 423, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3785614967346191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3794260025024414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3802905082702637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.379382610321045  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5801, 40])
input nodes number: 11154
output nodes number: 5801
edges number: 50401
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3795251846313477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.379526138305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02476787567138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 1 input nodes size: 23659
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02203845977783203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02203845977783203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.033319950103759766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03336334228515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023293495178222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024187088012695312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024187088012695312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024187088012695312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([23659, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024187088012695312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1091, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.061023712158203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.061023712158203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.062064170837402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0703878402709961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1270, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0715341567993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0715341567993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1270, 128]), torch.Size([1, 1270, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07274532318115234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0909128189086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1270, 128])
m.shape torch.Size([1155, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09197282791137695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09197282791137695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1155, 128]), torch.Size([1, 1155, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09307432174682617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1181178092956543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1155, 128])
m.shape torch.Size([1030, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11953163146972656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11953163146972656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1030, 128]), torch.Size([1, 1030, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.120513916015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14941978454589844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1030, 128])
m.shape torch.Size([764, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15077877044677734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15077877044677734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15150737762451172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17781734466552734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([737, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17956161499023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17956161499023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 737, 128]), torch.Size([1, 737, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18026447296142578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21088695526123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 737, 128])
m.shape torch.Size([621, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21260833740234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21260833740234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21320056915283203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24346113204956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([545, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24524402618408203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24524402618408203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24576377868652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2760648727416992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([494, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2779250144958496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2779250144958496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2783961296081543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3085474967956543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([4145, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3280768394470215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3280768394470215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4145, 128]), torch.Size([1, 4145, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3320298194885254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6128411293029785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4145, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5809736251831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5922765731811523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6035795211791992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5921878814697266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11852, 256])
first layer input nodes number: 23659
first layer output nodes number: 11852
edges number: 74061
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6037578582763672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6150608062744141  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6187801361083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6187801361083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([763, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.663783073425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.663783073425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6652383804321289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6778273582458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([756, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6787371635437012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6787371635437012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 756, 256]), torch.Size([1, 756, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6801791191101074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7018084526062012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 756, 256])
m.shape torch.Size([646, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7035360336303711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7035360336303711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 646, 256]), torch.Size([1, 646, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.704768180847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7326822280883789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 646, 256])
m.shape torch.Size([519, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7345423698425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7345423698425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.735532283782959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7647204399108887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([361, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7659821510314941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7659821510314941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7666707038879395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7965488433837891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([320, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7980499267578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7980499267578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7986602783203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8250617980957031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([256, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8264789581298828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8264789581298828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8269672393798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8513813018798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([232, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8529210090637207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8529210090637207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8533635139465332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8785862922668457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([236, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8804068565368652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8804068565368652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.880856990814209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.909665584564209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([180, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9111709594726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9111709594726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9115142822265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9358901977539062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([155, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9382758140563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9382758140563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9385714530944824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9616312980651855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([155, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9632716178894043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9632716178894043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9635672569274902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9886965751647949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9898357391357422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9898357391357422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9900321960449219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0081062316894531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0092597007751465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0092597007751465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.009437084197998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0269980430603027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0279622077941895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0279622077941895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0281014442443848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.042860507965088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0438365936279297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0438365936279297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.043966293334961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0586223602294922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0597343444824219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0597343444824219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0598716735839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0763511657714844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.077441692352295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.077441692352295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0775694847106934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.093799114227295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([68, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0949773788452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0949773788452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.095107078552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1124868392944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1131911277770996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1131911277770996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.113267421722412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1240248680114746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1250367164611816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1250367164611816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.125135898590088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.139814853668213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.14044189453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.14044189453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1405029296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.14996337890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([48, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1509943008422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1509943008422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1510858535766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1659173965454102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1665868759155273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1665868759155273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1666460037231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1766386032104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([467, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1878304481506348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1878304481506348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1887211799621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3458771705627441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 467, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3071370124816895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3080005645751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3088641166687012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3079571723937988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5793, 40])
input nodes number: 11852
output nodes number: 5793
edges number: 45816
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3080883026123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.308088779449463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025928974151611328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 2 input nodes size: 26585
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02329254150390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02329254150390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03596925735473633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0360107421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02468585968017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025488853454589844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025488853454589844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025488853454589844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([26585, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025488853454589844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1366, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06193971633911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06193971633911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1366, 128]), torch.Size([1, 1366, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06324243545532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07366418838500977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1366, 128])
m.shape torch.Size([1422, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07465648651123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07465648651123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1422, 128]), torch.Size([1, 1422, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07601261138916016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09635448455810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1422, 128])
m.shape torch.Size([1280, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09750747680664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09750747680664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1280, 128]), torch.Size([1, 1280, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09872817993164062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12558364868164062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1280, 128])
m.shape torch.Size([1046, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1269683837890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1269683837890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12796592712402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15689468383789062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([866, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1584606170654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1584606170654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1592864990234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18991613388061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([729, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19251680374145508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19251680374145508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 729, 128]), torch.Size([1, 729, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19321203231811523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22320795059204102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 729, 128])
m.shape torch.Size([613, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22490644454956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22490644454956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22549104690551758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2551736831665039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([544, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2569565773010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2569565773010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2574753761291504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.28856897354125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([448, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29023218154907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29023218154907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29065942764282227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31800317764282227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([3935, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.33732080459594727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.33732080459594727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3935, 128]), torch.Size([1, 3935, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.34107351303100586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6159605979919434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3935, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5849852561950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5966668128967285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6083483695983887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5965752601623535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12249, 256])
first layer input nodes number: 26585
first layer output nodes number: 12249
edges number: 72963
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.608548641204834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6202301979064941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6231508255004883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6231508255004883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1001, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6576461791992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6576461791992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1001, 256]), torch.Size([1, 1001, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6595554351806641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6769351959228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1001, 256])
m.shape torch.Size([856, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6777362823486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6777362823486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 856, 256]), torch.Size([1, 856, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6793689727783203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7038593292236328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 856, 256])
m.shape torch.Size([726, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7056350708007812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7056350708007812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 726, 256]), torch.Size([1, 726, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7070198059082031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7376289367675781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 726, 256])
m.shape torch.Size([510, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7388973236083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7388973236083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 510, 256]), torch.Size([1, 510, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7398700714111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7680797576904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 510, 256])
m.shape torch.Size([424, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7696313858032227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7696313858032227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7704401016235352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7997512817382812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([323, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8012099266052246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8012099266052246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.801826000213623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8292150497436523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([238, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8305087089538574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8305087089538574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8309626579284668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8536601066589355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([179, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8553686141967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8553686141967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8557100296020508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8751707077026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([158, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8763670921325684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8763670921325684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8766684532165527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8959555625915527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([140, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8971505165100098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8971505165100098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8974175453186035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9163765907287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9174504280090332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9174504280090332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.917665958404541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9344773292541504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([99, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.935511589050293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.935511589050293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9357004165649414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9517507553100586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([85, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9527187347412109  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9527187347412109  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.952880859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9677963256835938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9685497283935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9685497283935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9686679840087891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9803752899169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9814410209655762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9814410209655762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9815897941589355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9973597526550293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9980392456054688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9980392456054688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9981327056884766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0086936950683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0094966888427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0094966888427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0095958709716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0214977264404297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.022122859954834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.022122859954834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0221972465515137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.031644344329834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0323376655578613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0323376655578613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0324139595031738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0426373481750488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0431571006774902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0431571006774902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0432124137878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.051011562347412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0516300201416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0516300201416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0516910552978516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0607242584228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0610747337341309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0610747337341309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0611090660095215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0664305686950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0667896270751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0667896270751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0668220520019531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0720748901367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.07258939743042  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.07258939743042  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0726332664489746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0800471305847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([258, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0862245559692383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0862245559692383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.086716651916504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1763172149658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 258, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1481924057006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.149019718170166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1498470306396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1489782333374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5549, 40])
input nodes number: 12249
output nodes number: 5549
edges number: 34654
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1490750312805176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1490755081176758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.027049541473388672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 3 input nodes size: 22443
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024649620056152344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.024649620056152344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03535127639770508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.035395145416259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022676944732666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023707866668701172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023707866668701172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023707866668701172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([22443, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023707866668701172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1022, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06678104400634766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06678104400634766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06775569915771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07555294036865234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([1129, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0761423110961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0761423110961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1129, 128]), torch.Size([1, 1129, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07721900939941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0933694839477539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1129, 128])
m.shape torch.Size([1109, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09473609924316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09473609924316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0957937240600586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11906147003173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([947, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12064552307128906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12064552307128906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12154865264892578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1485424041748047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([920, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1502842903137207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1502842903137207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15116167068481445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18274736404418945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([768, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18450593948364258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18450593948364258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18523836135864258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2179093360900879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([710, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21991300582885742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21991300582885742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 710, 128]), torch.Size([1, 710, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22059011459350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2553563117980957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 710, 128])
m.shape torch.Size([619, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.25737905502319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.25737905502319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.25796937942504883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29251813888549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([528, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29448890686035156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29448890686035156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29499244689941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.32767677307128906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([5264, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3525257110595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3525257110595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 5264, 128]), torch.Size([1, 5264, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3575458526611328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7139759063720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 5264, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6759781837463379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6883912086486816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7008042335510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6882939338684082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([13016, 256])
first layer input nodes number: 22443
first layer output nodes number: 13016
edges number: 86917
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7009735107421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7133865356445312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7166709899902344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7166709899902344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([730, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7668418884277344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7668418884277344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 730, 256]), torch.Size([1, 730, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7682342529296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7798728942871094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 730, 256])
m.shape torch.Size([640, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7808723449707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7808723449707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 640, 256]), torch.Size([1, 640, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7820930480957031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8004035949707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 640, 256])
m.shape torch.Size([531, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8014912605285645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8014912605285645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 531, 256]), torch.Size([1, 531, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8025040626525879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8261780738830566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 531, 256])
m.shape torch.Size([458, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8275775909423828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8275775909423828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8284511566162109  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8559894561767578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([374, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8573503494262695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8573503494262695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8580636978149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.885249137878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([322, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8867497444152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8867497444152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8873639106750488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9164319038391113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([302, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9181571006774902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9181571006774902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9187331199645996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.948493480682373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([263, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9502277374267578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9502277374267578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9507293701171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9805583953857422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([231, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9823060035705566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9823060035705566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9827466011047363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0109448432922363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([210, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0127429962158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0127429962158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.013143539428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0415821075439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([171, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0431900024414062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0431900024414062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0435161590576172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0689563751220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([145, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0704660415649414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0704660415649414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0707426071166992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0942506790161133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([119, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0961766242980957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0961766242980957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0964035987854004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1172852516174316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([129, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1189079284667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1189079284667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1191539764404297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1435127258300781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([103, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1448750495910645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1448750495910645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1450715065002441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.165895938873291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.166966438293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.166966438293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1671113967895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1834917068481445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([91, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1849064826965332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1849064826965332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1850800514221191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2059082984924316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.206911563873291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.206911563873291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2070317268371582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.222292423248291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2232003211975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2232003211975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2233014106750488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2368474006652832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([77, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2382774353027344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2382774353027344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.238424301147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2591323852539062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([65, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.260371208190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.260371208190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2604951858520508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.278843879699707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.279606819152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.279606819152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2796812057495117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2912111282348633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2921028137207031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2921028137207031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2921829223632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3051605224609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3060202598571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3060202598571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3060946464538574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3186659812927246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([580, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3325653076171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3325653076171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3336715698242188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5321063995361328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 580, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4881582260131836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4890308380126953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.489903450012207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4889869689941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5853, 40])
input nodes number: 13016
output nodes number: 5853
edges number: 51222
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.489173412322998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4891738891601562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025691509246826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 4 input nodes size: 18298
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022722244262695312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022722244262695312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03155183792114258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03159523010253906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02084970474243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021491527557373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021491527557373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021491527557373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([18298, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.021491527557373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1409, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.048370361328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.048370361328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1409, 128]), torch.Size([1, 1409, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.049714088439941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.060463905334472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1409, 128])
m.shape torch.Size([1532, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06125307083129883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06125307083129883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1532, 128]), torch.Size([1, 1532, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0627140998840332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08557319641113281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1532, 128])
m.shape torch.Size([1280, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08667373657226562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08667373657226562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1280, 128]), torch.Size([1, 1280, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08789443969726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11539840698242188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1280, 128])
m.shape torch.Size([1049, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11678886413574219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11678886413574219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1049, 128]), torch.Size([1, 1049, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11778926849365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14680099487304688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1049, 128])
m.shape torch.Size([907, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14846324920654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14846324920654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14932823181152344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1811833381652832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([688, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1829824447631836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1829824447631836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 688, 128]), torch.Size([1, 688, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1836385726928711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21206378936767578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 688, 128])
m.shape torch.Size([556, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2135915756225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2135915756225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21412181854248047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24086856842041016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([474, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24241161346435547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24241161346435547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24286365509033203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2686300277709961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([390, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2700777053833008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2700777053833008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2704496383666992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2942533493041992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([2093, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3040475845336914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3040475845336914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 2093, 128]), torch.Size([1, 2093, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.306058406829834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.45240116119384766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 2093, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.43016815185546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4400653839111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4499626159667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4399876594543457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([10378, 256])
first layer input nodes number: 18298
first layer output nodes number: 10378
edges number: 53296
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4501008987426758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.45999813079833984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.46256303787231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.46256303787231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1022, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4952735900878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4952735900878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1022, 256]), torch.Size([1, 1022, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.497222900390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5128173828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1022, 256])
m.shape torch.Size([938, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5136938095092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5136938095092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 938, 256]), torch.Size([1, 938, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5154829025268555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5423192977905273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 938, 256])
m.shape torch.Size([737, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5439190864562988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5439190864562988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5453248023986816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5762505531311035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 737, 256])
m.shape torch.Size([545, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5780420303344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5780420303344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 545, 256]), torch.Size([1, 545, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5790815353393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6114387512207031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 545, 256])
m.shape torch.Size([501, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6133270263671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6133270263671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6142826080322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6491031646728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([356, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6506786346435547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6506786346435547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6513576507568359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6812000274658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([294, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6828389167785645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6828389167785645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6833996772766113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7117094993591309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([229, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7131900787353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7131900787353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7136268615722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7385234832763672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([177, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7398362159729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7398362159729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7401738166809082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7617802619934082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([173, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7633099555969238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7633099555969238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7636399269104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7870678901672363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([124, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7882142066955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7882142066955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7884507179260254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8068985939025879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8080263137817383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8080263137817383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.808232307434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8257417678833008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([83, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8266968727111816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8266968727111816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8268551826477051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8414196968078613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([82, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8424439430236816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8424439430236816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8426003456115723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8580842018127441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8591017723083496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8591017723083496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8592467308044434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8746123313903809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8753552436828613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8753552436828613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8754563331604004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8868794441223145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8875479698181152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8875479698181152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.887631893157959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.897702693939209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8984565734863281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8984565734863281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8985443115234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9096870422363281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9100818634033203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9100818634033203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9101276397705078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9162616729736328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9167771339416504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9167771339416504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9168305397033691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9243607521057129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9248790740966797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9248790740966797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9249305725097656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9325523376464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9328017234802246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9328017234802246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9328265190124512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9366698265075684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9370336532592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9370336532592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9370660781860352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9423189163208008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9426259994506836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9426259994506836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.942652702331543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9471654891967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([103, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9496273994445801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9496273994445801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9498238563537598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9844002723693848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 103, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9584712982177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9593377113342285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9602041244506836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.959294319152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5814, 40])
input nodes number: 10378
output nodes number: 5814
edges number: 32765
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.959409236907959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9594097137451172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022806644439697266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 5 input nodes size: 21664
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.020843505859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.020843505859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.031545162200927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03158903121948242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022716045379638672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023513317108154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023513317108154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023513317108154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([21664, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.023513317108154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1355, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05742692947387695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05742692947387695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1355, 128]), torch.Size([1, 1355, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05871915817260742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06905698776245117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1355, 128])
m.shape torch.Size([1384, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06998682022094727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06998682022094727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1384, 128]), torch.Size([1, 1384, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07130670547485352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0920705795288086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1384, 128])
m.shape torch.Size([1273, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0932316780090332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0932316780090332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1273, 128]), torch.Size([1, 1273, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09444570541381836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1211543083190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1273, 128])
m.shape torch.Size([1080, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12284231185913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12284231185913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12387228012084961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15421628952026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([930, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15591859817504883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15591859817504883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15680551528930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18951177597045898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([749, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19121122360229492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19121122360229492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 749, 128]), torch.Size([1, 749, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1919255256652832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22394037246704102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 749, 128])
m.shape torch.Size([651, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22575616836547852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22575616836547852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22637701034545898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2580747604370117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([565, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2599196434020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2599196434020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26045846939086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29178953170776367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([498, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2936573028564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2936573028564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2941322326660156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3245277404785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([3281, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.339935302734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.339935302734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3281, 128]), torch.Size([1, 3281, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.34382152557373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5743908882141113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3281, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5451369285583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5563578605651855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5675787925720215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5562701225280762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11766, 256])
first layer input nodes number: 21664
first layer output nodes number: 11766
edges number: 67775
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5677423477172852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5789632797241211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5817685127258301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5817685127258301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([911, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6204071044921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6204071044921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 911, 256]), torch.Size([1, 911, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6221446990966797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6360454559326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 911, 256])
m.shape torch.Size([826, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6370182037353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6370182037353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 826, 256]), torch.Size([1, 826, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6385936737060547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6622257232666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 826, 256])
m.shape torch.Size([669, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6634831428527832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6634831428527832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 669, 256]), torch.Size([1, 669, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6647591590881348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.693448543548584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 669, 256])
m.shape torch.Size([533, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6951484680175781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6951484680175781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6961650848388672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.72564697265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([439, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7272486686706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7272486686706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.728085994720459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7582640647888184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([345, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7598352432250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7598352432250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.760493278503418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7890481948852539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([325, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7909059524536133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7909059524536133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7915258407592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8233833312988281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([255, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8250341415405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8250341415405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8255205154418945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8532438278198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([206, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8547825813293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8547825813293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8551754951477051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8803219795227051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([173, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8817887306213379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8817887306213379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8821187019348145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9055466651916504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([147, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9069361686706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9069361686706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9072165489196777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9290862083435059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([113, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9304251670837402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9304251670837402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.930640697479248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9489607810974121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([115, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9502902030944824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9502902030944824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9505095481872559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9706892967224121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9718313217163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9718313217163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9720087051391602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9895696640014648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9906344413757324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9906344413757324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9907870292663574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0069613456726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0079402923583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0079402923583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.008066177368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0222911834716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0229310989379883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0229310989379883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0230131149291992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0328550338745117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0335063934326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0335063934326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0335826873779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0432720184326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.04414701461792  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.04414701461792  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0442423820495605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0570216178894043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0577430725097656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0577430725097656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0578193664550781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0685768127441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0690836906433105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0690836906433105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0691351890563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0767569541931152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0774502754211426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0774502754211426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0775151252746582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.08756685256958  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.087998867034912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.087998867034912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0880389213562012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0945277214050293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0950613021850586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0950613021850586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.095107078552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1028432846069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([263, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1091399192810059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1091399192810059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1096415519714355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1999192237854004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 263, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1687960624694824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1696662902832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1705365180969238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1696224212646484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5838, 40])
input nodes number: 11766
output nodes number: 5838
edges number: 39042
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1697578430175781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1697583198547363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025096893310546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 6 input nodes size: 33588
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022719860076904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.022719860076904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03873586654663086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03877973556518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.028034210205078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029137611389160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029137611389160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029137611389160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([33588, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.029137611389160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1066, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07807064056396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07807064056396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0790872573852539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0872201919555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([1165, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08819389343261719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08819389343261719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1165, 128]), torch.Size([1, 1165, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08930492401123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1066884994506836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1165, 128])
m.shape torch.Size([1081, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10767936706542969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10767936706542969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10871028900146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13139057159423828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([989, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13276147842407227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13276147842407227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 989, 128]), torch.Size([1, 989, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13370466232299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1610569953918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 989, 128])
m.shape torch.Size([957, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16286706924438477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16286706924438477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16377973556518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19699573516845703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([787, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1987910270690918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1987910270690918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 787, 128]), torch.Size([1, 787, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19954156875610352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23181486129760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 787, 128])
m.shape torch.Size([723, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23445892333984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23445892333984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23514842987060547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2698488235473633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([705, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27219343185424805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27219343185424805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 705, 128]), torch.Size([1, 705, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27286577224731445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3123602867126465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 705, 128])
m.shape torch.Size([577, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3145003318786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3145003318786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3150506019592285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.35106754302978516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([6287, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3807711601257324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3807711601257324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 6287, 128]), torch.Size([1, 6287, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3867669105529785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8124651908874512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 6287, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7702913284301758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7839641571044922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7976369857788086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7838568687438965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([14337, 256])
first layer input nodes number: 33588
first layer output nodes number: 14337
edges number: 98866
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.797889232635498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8115620613098145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8149805068969727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8149805068969727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([738, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8634343147277832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8634343147277832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 738, 256]), torch.Size([1, 738, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8648419380187988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8763308525085449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 738, 256])
m.shape torch.Size([678, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8771815299987793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8771815299987793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 678, 256]), torch.Size([1, 678, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8784747123718262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8983292579650879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 678, 256])
m.shape torch.Size([570, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8996181488037109  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8996181488037109  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9007053375244141  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9258790016174316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([484, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9271965026855469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9271965026855469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 484, 256]), torch.Size([1, 484, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9281196594238281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9552001953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 484, 256])
m.shape torch.Size([405, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9567546844482422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9567546844482422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9575271606445312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9854640960693359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([316, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9869003295898438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9869003295898438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9875030517578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0175657272338867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([288, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0192022323608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0192022323608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0197515487670898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0500612258911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([253, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.051732063293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.051732063293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0522146224975586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0797204971313477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([217, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0813565254211426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0813565254211426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.081770420074463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.108259677886963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([199, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1107163429260254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1107163429260254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.111095905303955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.138044834136963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([143, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1393671035766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1393671035766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1396398544311523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.160914421081543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([152, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1625313758850098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1625313758850098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1628212928771973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1874642372131348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([129, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1889314651489258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1889314651489258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1891775131225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2118139266967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([124, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2133598327636719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2133598327636719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2135963439941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2370109558105469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([106, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2384209632873535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2384209632873535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2386231422424316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.260054111480713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2610759735107422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2610759735107422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2612152099609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2769489288330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([84, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.278252124786377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.278252124786377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2784123420715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2976384162902832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2985100746154785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2985100746154785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2986149787902832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3119378089904785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.312817096710205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.312817096710205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3129143714904785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3259491920471191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3269176483154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3269176483154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.327016830444336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3410015106201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3417596817016602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3417596817016602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3418359756469727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3531274795532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3541679382324219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3541679382324219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3542652130126953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3693428039550781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3699355125427246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3699355125427246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3699908256530762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3789515495300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.379941463470459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.379941463470459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.38002347946167  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3938841819763184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([551, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4070830345153809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4070830345153809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 551, 256]), torch.Size([1, 551, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4081339836120605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5931897163391113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 551, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5509567260742188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.551826000213623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5526952743530273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5517821311950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5831, 40])
input nodes number: 14337
output nodes number: 5831
edges number: 49075
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5519323348999023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5519328117370605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.031244754791259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 7 input nodes size: 28282
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02803325653076172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02803325653076172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0415191650390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.041562557220458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025502681732177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.026470661163330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.026470661163330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.026470661163330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([28282, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.026470661163330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1303, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0689096450805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0689096450805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1303, 128]), torch.Size([1, 1303, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07015228271484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0800933837890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1303, 128])
m.shape torch.Size([1342, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08075189590454102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08075189590454102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1342, 128]), torch.Size([1, 1342, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0820317268371582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10122919082641602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1342, 128])
m.shape torch.Size([1237, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10235881805419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10235881805419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1237, 128]), torch.Size([1, 1237, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10353851318359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.12949180603027344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1237, 128])
m.shape torch.Size([1107, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1310133934020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1310133934020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13206911087036133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16268491744995117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([955, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1647968292236328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1647968292236328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16570758819580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19856929779052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 955, 128])
m.shape torch.Size([811, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20043420791625977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20043420791625977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20120763778686523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23607778549194336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([731, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23813104629516602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23813104629516602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 731, 128]), torch.Size([1, 731, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23882818222045898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2740449905395508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 731, 128])
m.shape torch.Size([689, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2763247489929199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2763247489929199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27698183059692383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3148946762084961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([573, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31702518463134766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31702518463134766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31757164001464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3542017936706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([4774, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3766927719116211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3766927719116211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4774, 128]), torch.Size([1, 4774, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.38124561309814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7044973373413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4774, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6677398681640625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6806354522705078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6935310363769531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6805343627929688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([13522, 256])
first layer input nodes number: 28282
first layer output nodes number: 13522
edges number: 85293
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6937437057495117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.706639289855957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7106170654296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7106170654296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([872, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7544207572937012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7544207572937012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 872, 256]), torch.Size([1, 872, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7560839653015137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7693896293640137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 872, 256])
m.shape torch.Size([740, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7705492973327637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7705492973327637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 740, 256]), torch.Size([1, 740, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7719607353210449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7944035530090332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 740, 256])
m.shape torch.Size([605, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7954425811767578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7954425811767578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 605, 256]), torch.Size([1, 605, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7965965270996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8220272064208984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 605, 256])
m.shape torch.Size([516, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8235478401184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8235478401184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8245320320129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8530735969543457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([408, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8545422554016113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8545422554016113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8553204536437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8833355903625488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([323, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8853721618652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8853721618652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8859882354736328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9142570495605469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([264, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9157252311706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9157252311706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9162287712097168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9422903060913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([257, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9440150260925293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9440150260925293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9445052146911621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9733328819274902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9747748374938965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9747748374938965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9751467704772949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9989504814147949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([171, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0004081726074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0004081726074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0007343292236328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0238914489746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([143, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.025240421295166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.025240421295166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0255131721496582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0467877388000488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([140, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0482664108276367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0482664108276367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0485334396362305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0712308883666992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0723843574523926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0723843574523926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0725808143615723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0906548500061035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0917410850524902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0917410850524902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0919089317321777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1085257530212402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([97, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1098403930664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1098403930664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.110025405883789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1296367645263672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1307287216186523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1307287216186523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.130875587463379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1474714279174805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1486549377441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1486549377441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1487922668457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1652717590332031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([68, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1663799285888672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1663799285888672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1665096282958984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1829814910888672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.184049129486084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.184049129486084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1841673851013184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2000136375427246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2009544372558594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2009544372558594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2010536193847656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2150382995605469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2159576416015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2159576416015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2160491943359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2295989990234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2303781509399414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2303781509399414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.230452537536621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2419824600219727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2429404258728027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2429404258728027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2430262565612793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2569308280944824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2575111389160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2575111389160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2575626373291016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.266265869140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([406, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2759957313537598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2759957313537598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2767701148986816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4196734428405762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 406, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.382309913635254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3831772804260254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3840446472167969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.383133888244629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5818, 40])
input nodes number: 13522
output nodes number: 5818
edges number: 44454
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3832764625549316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3832769393920898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02834796905517578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 8 input nodes size: 42295
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025500774383544922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.025500774383544922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.045668601989746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.045710086822509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0321807861328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.033469200134277344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.033469200134277344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.033469200134277344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([42295, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.033469200134277344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1432, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09916400909423828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09916400909423828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1432, 128]), torch.Size([1, 1432, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10052967071533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11239004135131836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1432, 128])
m.shape torch.Size([1437, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11307764053344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11307764053344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1437, 128]), torch.Size([1, 1437, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11444807052612305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13500452041625977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1437, 128])
m.shape torch.Size([1200, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13603591918945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13603591918945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1200, 128]), torch.Size([1, 1200, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13718032836914062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16235733032226562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1200, 128])
m.shape torch.Size([1079, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16384315490722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16384315490722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1648721694946289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19526100158691406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([1024, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1971879005432129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1971879005432129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1024, 128]), torch.Size([1, 1024, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1981644630432129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23415613174438477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1024, 128])
m.shape torch.Size([854, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23611116409301758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23611116409301758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23692560195922852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27219724655151367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([768, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27503252029418945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27503252029418945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27576494216918945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31287431716918945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([747, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31535768508911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31535768508911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3160700798034668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.35739564895629883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([664, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.35988903045654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.35988903045654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3605222702026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4019594192504883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([9301, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.44599342346191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.44599342346191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 9301, 128]), torch.Size([1, 9301, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4548635482788086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0855803489685059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 9301, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0266351699829102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0442838668823242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0619325637817383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0441455841064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([18506, 256])
first layer input nodes number: 42295
first layer output nodes number: 18506
edges number: 132804
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0622496604919434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0798983573913574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.084310531616211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.084310531616211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([990, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1248483657836914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1248483657836914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 990, 256]), torch.Size([1, 990, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1267366409301758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1424784660339355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 990, 256])
m.shape torch.Size([814, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1433377265930176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1433377265930176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 814, 256]), torch.Size([1, 814, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.144890308380127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1702790260314941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 814, 256])
m.shape torch.Size([580, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.17130708694458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.17130708694458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1724133491516113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1967511177062988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([429, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1980018615722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1980018615722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1988201141357422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2244033813476562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([375, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.225799560546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.225799560546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2265148162841797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2576713562011719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([302, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2591185569763184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2591185569763184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2596945762634277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2863850593566895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([247, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2877593040466309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2877593040466309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2882304191589355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.31178617477417  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([224, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3132729530334473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3132729530334473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3137001991271973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3380532264709473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([162, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3392410278320312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3392410278320312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3395500183105469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3593254089355469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([147, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.360583782196045  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.360583782196045  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3608641624450684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3807711601257324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3820266723632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3820266723632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.3822784423828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.40191650390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.402921199798584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.402921199798584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4031081199645996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4189963340759277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4198026657104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4198026657104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4199399948120117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4325742721557617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4334073066711426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4334073066711426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.433535099029541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4461865425109863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([59, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4469733238220215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4469733238220215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4470858573913574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4590144157409668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4597272872924805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4597272872924805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.459822654724121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4705991744995117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4714832305908203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4714832305908203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4715919494628906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4846382141113281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4853973388671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4853973388671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4854869842529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4968719482421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4976310729980469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4976310729980469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4977149963378906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5089607238769531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5097455978393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5097455978393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5098276138305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5213918685913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5221381187438965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5221381187438965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5222125053405762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.53322172164917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5338401794433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5338401794433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5338993072509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5430641174316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.543454647064209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.543454647064209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5434908866882324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5493617057800293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5501279830932617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5501279830932617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5501928329467773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.561152458190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([455, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5720529556274414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5720529556274414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.572920799255371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7282934188842773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 455, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6939373016357422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6947598457336426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.695582389831543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.694718360900879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 18506
output nodes number: 5517
edges number: 40037
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6948533058166504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6948537826538086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.035803794860839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 9 input nodes size: 29022
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.032135963439941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.032135963439941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0459747314453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.046018123626708984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02580881118774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.026687145233154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.026687145233154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.026687145233154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([29022, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.026687145233154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1432, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0665287971496582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0665287971496582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1432, 128]), torch.Size([1, 1432, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.06789445877075195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07904958724975586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1432, 128])
m.shape torch.Size([1487, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07978487014770508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07978487014770508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1487, 128]), torch.Size([1, 1487, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.08120298385620117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10247468948364258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1487, 128])
m.shape torch.Size([1323, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10365819931030273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.10365819931030273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1323, 128]), torch.Size([1, 1323, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1049199104309082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13267755508422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1323, 128])
m.shape torch.Size([1136, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1342320442199707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1342320442199707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.1353154182434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16750383377075195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([1080, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16953706741333008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16953706741333008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17056703567504883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20826005935668945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([860, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2102055549621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2102055549621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.21102571487426758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2462925910949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([722, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2482924461364746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2482924461364746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 722, 128]), torch.Size([1, 722, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.24898099899291992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.28422975540161133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 722, 128])
m.shape torch.Size([653, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2863764762878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2863764762878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2869992256164551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.323728084564209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([502, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.32557106018066406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.32557106018066406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3260498046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.356689453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([4154, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.37625789642333984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.37625789642333984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4154, 128]), torch.Size([1, 4154, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3811798095703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6624507904052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4154, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6285209655761719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6412515640258789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6539821624755859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6411519050598145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([13349, 256])
first layer input nodes number: 29022
first layer output nodes number: 13349
edges number: 79815
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.654200553894043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.66693115234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6701140403747559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.6701140403747559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([972, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7078099250793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7078099250793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 972, 256]), torch.Size([1, 972, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7096638679504395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7244954109191895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 972, 256])
m.shape torch.Size([845, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7252182960510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7252182960510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 845, 256]), torch.Size([1, 845, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.726830005645752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7513594627380371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 845, 256])
m.shape torch.Size([642, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7532258033752441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7532258033752441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 642, 256]), torch.Size([1, 642, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7544503211975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.783048152923584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 642, 256])
m.shape torch.Size([528, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7844657897949219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7844657897949219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7854728698730469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8146781921386719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([480, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8164815902709961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8164815902709961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8173971176147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8511190414428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([346, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8526568412780762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8526568412780762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8533167839050293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8881478309631348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([270, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8896346092224121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8896346092224121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8901495933532715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9175071716308594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([232, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9190335273742676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9190335273742676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9194760322570801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9446988105773926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([191, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9461297988891602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9461297988891602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9464941024780273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9698095321655273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([148, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9713411331176758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9713411331176758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.971623420715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9916658401489258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9927196502685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9927196502685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9929351806640625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0097465515136719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0110459327697754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0110459327697754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0112786293029785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0310578346252441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.032303810119629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.032303810119629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0325117111206055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0516386032104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0527057647705078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0527057647705078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0528717041015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0692996978759766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([69, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0702118873596191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0702118873596191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0703434944152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0842938423156738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0850892066955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0850892066955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0851960182189941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0972657203674316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.097996711730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.097996711730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.098088264465332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.109074592590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1099634170532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1099634170532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1100664138793945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1231470108032227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.123990535736084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.123990535736084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1240839958190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1366076469421387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1373300552368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1373300552368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.137406349182129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1481637954711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1485700607299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1485700607299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1486120223999023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1548223495483398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1553092002868652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1553092002868652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1553549766540527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1624503135681152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1629581451416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1629581451416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.163003921508789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.170419692993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1710200309753418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1710200309753418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1710715293884277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1797747611999512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([276, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1863808631896973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1863808631896973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1869072914123535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2818503379821777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 276, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2507243156433105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2515850067138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2524456977844238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2515416145324707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5774, 40])
input nodes number: 13349
output nodes number: 5774
edges number: 38003
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.251722812652588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.251723289489746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02846813201904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 10 input nodes size: 56389
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02584695816040039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.02584695816040039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.052735328674316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05277681350708008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0388946533203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0406951904296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0406951904296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0406951904296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([56389, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0406951904296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1346, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13443756103515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13443756103515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1346, 128]), torch.Size([1, 1346, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.13572120666503906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14599037170410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1346, 128])
m.shape torch.Size([1437, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14671897888183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14671897888183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1437, 128]), torch.Size([1, 1437, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14808940887451172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.16933822631835938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1437, 128])
m.shape torch.Size([1307, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17106151580810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17106151580810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1307, 128]), torch.Size([1, 1307, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.17230796813964844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.19972991943359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1307, 128])
m.shape torch.Size([1121, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20124483108520508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20124483108520508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.20231389999389648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23331689834594727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1098, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23540019989013672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23540019989013672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.23644733428955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.27463531494140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([947, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2768211364746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2768211364746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.2777242660522461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3172292709350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([883, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31972503662109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.31972503662109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.32056713104248047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.36348772048950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([873, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3663969039916992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3663969039916992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3672294616699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.4146852493286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([846, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.41789960861206055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.41789960861206055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.41870641708374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.47051000595092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([14577, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5396151542663574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5396151542663574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 14577, 128]), torch.Size([1, 14577, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.5535168647766113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5405383110046387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 14577, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.454941749572754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.4782447814941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5015478134155273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.478062629699707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([24435, 256])
first layer input nodes number: 56389
first layer output nodes number: 24435
edges number: 190346
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5019702911376953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.525273323059082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5310993194580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5310993194580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([840, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.58125638961792  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.58125638961792  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 840, 256]), torch.Size([1, 840, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5828585624694824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5959181785583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 840, 256])
m.shape torch.Size([703, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.596489429473877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.596489429473877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 703, 256]), torch.Size([1, 703, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.5978302955627441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6181530952453613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 703, 256])
m.shape torch.Size([495, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6189627647399902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6189627647399902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6199069023132324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.642970085144043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([405, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.644136905670166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.644136905670166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.644909381866455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6676373481750488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([347, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6689190864562988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6689190864562988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6695809364318848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6948165893554688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([250, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.695927619934082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.695927619934082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.6964044570922852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7169084548950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([209, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.718076229095459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.718076229095459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7184748649597168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7384066581726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([188, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7399053573608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7399053573608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7402639389038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7607030868530273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([165, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7619514465332031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7619514465332031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7622661590576172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7824077606201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([133, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7835288047790527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7835288047790527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.7837824821472168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8017935752868652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([121, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8029460906982422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8029460906982422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8031768798828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8211784362792969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([92, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8221721649169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8221721649169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.822347640991211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8372631072998047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([84, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8382878303527832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8382878303527832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8384480476379395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8531880378723145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8542203903198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8542203903198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.854374885559082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8696699142456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8705730438232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8705730438232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8707027435302734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.884450912475586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([63, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.885354995727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.885354995727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8854751586914062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8990535736083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8998761177062988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8998761177062988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.8999791145324707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9123387336730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.913510799407959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.913510799407959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.913632869720459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.929135799407959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9303011894226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9303011894226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9304099082946777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9449782371520996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9458661079406738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9458661079406738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9459595680236816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9591374397277832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9598174095153809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9598174095153809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.959886074066162  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.970048427581787  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9707331657409668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9707331657409668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9707980155944824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9808497428894043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9814367294311523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9814367294311523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.981490135192871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9901418685913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9907150268554688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9907150268554688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9907646179199219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.9991455078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([926, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0213708877563477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.0213708877563477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 926, 256]), torch.Size([1, 926, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.023137092590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.3399457931518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 926, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2954611778259277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.296283721923828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2971062660217285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2962422370910645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5518, 40])
input nodes number: 24435
output nodes number: 5518
edges number: 51112
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2964277267456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 2.2964282035827637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0438685417175293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 11 input nodes size: 38306
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03885650634765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03885650634765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.057122230529785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.05716371536254883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03023386001586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03113698959350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03113698959350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03113698959350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([38306, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03113698959350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1609, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07622528076171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.07622528076171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1609, 128]), torch.Size([1, 1609, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0777597427368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09003543853759766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1609, 128])
m.shape torch.Size([1654, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09084558486938477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.09084558486938477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1654, 128]), torch.Size([1, 1654, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0924229621887207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11608362197875977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1654, 128])
m.shape torch.Size([1433, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11734485626220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11734485626220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1433, 128]), torch.Size([1, 1433, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.11871147155761719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.14917564392089844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1433, 128])
m.shape torch.Size([1153, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15069150924682617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15069150924682617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1153, 128]), torch.Size([1, 1153, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.15179109573364258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18454885482788086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1153, 128])
m.shape torch.Size([1041, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18648099899291992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18648099899291992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.18747377395629883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22321367263793945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([809, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22503185272216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22503185272216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.22580337524414062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26007080078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([709, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26224279403686523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26224279403686523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.26291894912719727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29732561111450195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([669, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29953956604003906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.29953956604003906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.30017757415771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.33693504333496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([558, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.33901071548461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.33901071548461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.33954286575317383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.37419557571411133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([5114, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3983149528503418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.3983149528503418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 5114, 128]), torch.Size([1, 5114, 128])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.40319204330444336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7498888969421387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 5114, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7110881805419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.725153923034668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7392196655273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.725043773651123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([14749, 256])
first layer input nodes number: 38306
first layer output nodes number: 14749
edges number: 90364
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7395071983337402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.753572940826416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7570896148681641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7570896148681641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1135, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7888035774230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.7888035774230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1135, 256]), torch.Size([1, 1135, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.791834831237793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8092880249023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1135, 256])
m.shape torch.Size([950, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.810910701751709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.810910701751709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 950, 256]), torch.Size([1, 950, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8127226829528809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.839902400970459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 950, 256])
m.shape torch.Size([697, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8410062789916992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8410062789916992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 697, 256]), torch.Size([1, 697, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8423357009887695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.872502326965332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 697, 256])
m.shape torch.Size([504, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8737754821777344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8737754821777344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.8747367858886719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9033699035644531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([414, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.904879093170166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.904879093170166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9056687355041504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9346756935119629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([286, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9359302520751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9359302520751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9364757537841797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9611468315124512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([236, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9624619483947754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9624619483947754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9629120826721191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9854187965393066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([203, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9867548942565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9867548942565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.9871420860290527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0092120170593262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([176, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0107088088989258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0107088088989258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0110445022583008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0325288772583008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([133, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0336394309997559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0336394309997559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.03389310836792  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0519042015075684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([101, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0528454780578613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0528454780578613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0530381202697754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0680642127990723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([81, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0689024925231934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0689024925231934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0690569877624512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0821890830993652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([77, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0830740928649902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0830740928649902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0832209587097168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0967326164245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0974531173706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0974531173706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.0975656509399414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1087064743041992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1094002723693848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1094002723693848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.109499454498291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1200127601623535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1206555366516113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1206555366516113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.120741367340088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1304402351379395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1309857368469238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1309857368469238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.131054401397705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.139294147491455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1397442817687988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1397442817687988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1397976875305176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1465802192687988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1470832824707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1470832824707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1471385955810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.154550552368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1549654006958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1549654006958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1550092697143555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1611948013305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1615967750549316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1615967750549316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1616368293762207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.167564868927002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1677989959716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1677989959716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1678218841552734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1713695526123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1716899871826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1716899871826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1717185974121094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1763534545898438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1766853332519531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1766853332519531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1767139434814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.181549072265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([189, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1860761642456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.1860761642456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.186436653137207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.249882698059082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 189, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2254786491394043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2263011932373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.227123737335205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.226259708404541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 14749
output nodes number: 5517
edges number: 30790
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2264113426208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 1.2264118194580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.032948970794677734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 12 input nodes size: 66427
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03023386001586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.03023386001586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.061908721923828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.0619502067565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04364299774169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04591560363769531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04591560363769531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04591560363769531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([66427, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5369873046875 GB
    Memory Allocated: 0.04591560363769531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1261, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.16864585876464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.16864585876464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1261, 128]), torch.Size([1, 1261, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.16984844207763672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.1796412467956543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1261, 128])
m.shape torch.Size([1324, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.18030261993408203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.18030261993408203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1324, 128]), torch.Size([1, 1324, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.1815652847290039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.20050525665283203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1324, 128])
m.shape torch.Size([1330, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.20177650451660156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.20177650451660156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1330, 128]), torch.Size([1, 1330, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.20304489135742188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.23094940185546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1330, 128])
m.shape torch.Size([1233, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.2326669692993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.2326669692993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1233, 128]), torch.Size([1, 1233, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.2338428497314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.26829051971435547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1233, 128])
m.shape torch.Size([1201, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.27077150344848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.27077150344848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1201, 128]), torch.Size([1, 1201, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.27191686630249023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.31314992904663086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1201, 128])
m.shape torch.Size([1114, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3160734176635742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3160734176635742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3171358108520508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3636350631713867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([1056, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.36662864685058594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.36662864685058594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1056, 128]), torch.Size([1, 1056, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.36763572692871094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.41798973083496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1056, 128])
m.shape torch.Size([1025, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.42139625549316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.42139625549316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1025, 128]), torch.Size([1, 1025, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.42237377166748047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.4780921936035156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1025, 128])
m.shape torch.Size([1009, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.48193359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.48193359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1009, 128]), torch.Size([1, 1009, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.4828958511352539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.5450754165649414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1009, 128])
m.shape torch.Size([19797, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.6389937400817871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.6389937400817871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19797, 128]), torch.Size([1, 19797, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.6578736305236816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0055108070373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19797, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8901782035827637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9194750785827637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9484190940856934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9188957214355469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([30350, 256])
first layer input nodes number: 66427
first layer output nodes number: 30350
edges number: 248163
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.948915958404541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9785656929016113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9850959777832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9850959777832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([708, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0405898094177246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0405898094177246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 708, 256]), torch.Size([1, 708, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.041940212249756  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0528979301452637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 708, 256])
m.shape torch.Size([613, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0534377098083496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0534377098083496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 613, 256]), torch.Size([1, 613, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0546069145202637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.072547435760498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 613, 256])
m.shape torch.Size([480, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0733776092529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0733776092529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0742931365966797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0949859619140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([381, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0961050987243652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0961050987243652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.096831798553467  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1188573837280273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([340, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1201281547546387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1201281547546387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.120776653289795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1442084312438965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([253, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.14534330368042  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.14534330368042  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1458258628845215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1665759086608887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([196, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1676535606384277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1676535606384277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.168027400970459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1867194175720215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([173, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1878628730773926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1878628730773926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.188192844390869  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.207001209259033  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([137, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.208059787750244  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.208059787750244  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2083210945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2250447273254395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([138, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.226240634918213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.226240634918213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.226503849029541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.245192050933838  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.246373176574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.246373176574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.24660587310791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.264756202697754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([103, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2659521102905273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2659521102905273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.266148567199707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2828474044799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.284061908721924  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.284061908721924  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.284252643585205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.30180025100708  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([85, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3030166625976562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3030166625976562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3031787872314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3192291259765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([92, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.320474624633789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.320474624633789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.320650100708008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3392505645751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([90, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3405470848083496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3405470848083496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3407187461853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.360116481781006  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.361342430114746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.361342430114746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.361477851867676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3777284622192383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([78, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3790102005004883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3790102005004883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3791589736938477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.3980531692504883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.399209976196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.399209976196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.399324417114258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4146595001220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4155826568603516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4155826568603516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.415679931640625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4293956756591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([67, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.430699348449707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.430699348449707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4308271408081055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.449740409851074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4509873390197754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4509873390197754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4510769844055176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4649720191955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.465745449066162  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.465745449066162  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.465816020965576  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4772486686706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4781360626220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4781360626220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.478212356567383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.4911060333251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([1056, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.516441822052002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.516441822052002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1056, 256]), torch.Size([1, 1056, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.519047260284424  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.8823628425598145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1056, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.8319358825683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.8327584266662598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.83358097076416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.832716941833496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5518, 40])
input nodes number: 30350
output nodes number: 5518
edges number: 56796
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.8329849243164062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.8329854011535645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04984903335571289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 13 input nodes size: 64975
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04364299774169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04364299774169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.07489299774169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.0749349594116211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04321861267089844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04496955871582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04496955871582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04496955871582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([64975, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04496955871582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1489, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.13902950286865234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.13902950286865234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1489, 128]), torch.Size([1, 1489, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.14044952392578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.1518096923828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1489, 128])
m.shape torch.Size([1544, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.15297365188598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.15297365188598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1544, 128]), torch.Size([1, 1544, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.15444612503051758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.17653322219848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1544, 128])
m.shape torch.Size([1400, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.17786836624145508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.17786836624145508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1400, 128]), torch.Size([1, 1400, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.17920351028442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.20886659622192383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1400, 128])
m.shape torch.Size([1248, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.21057939529418945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.21057939529418945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1248, 128]), torch.Size([1, 1248, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.21176958084106445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.24677324295043945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1248, 128])
m.shape torch.Size([1229, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.24910831451416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.24910831451416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1229, 128]), torch.Size([1, 1229, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.25028038024902344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.29337263107299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1229, 128])
m.shape torch.Size([1067, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.2958393096923828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.2958393096923828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.2968568801879883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.34061241149902344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([932, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3432145118713379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3432145118713379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3441033363342285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.38854455947875977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([923, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.39162111282348633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.39162111282348633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3925013542175293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.4430527687072754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([816, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.44611454010009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.44611454010009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.44689273834228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.4984264373779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([14325, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.5663442611694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.5663442611694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 14325, 128]), torch.Size([1, 14325, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.5800056457519531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.5500373840332031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 14325, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.4644455909729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.4882616996765137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.512077808380127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.4880752563476562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([24973, 256])
first layer input nodes number: 64975
first layer output nodes number: 24973
edges number: 190818
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.5125641822814941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.5363802909851074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.5423345565795898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.5423345565795898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([931, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.5858573913574219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.5858573913574219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 931, 256]), torch.Size([1, 931, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.5876331329345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.6018390655517578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 931, 256])
m.shape torch.Size([746, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.6026315689086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.6026315689086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 746, 256]), torch.Size([1, 746, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.6040544509887695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.6253976821899414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 746, 256])
m.shape torch.Size([587, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.626673698425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.626673698425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.627793312072754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.6546649932861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 587, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.6561822891235352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.6561822891235352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.657038688659668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.683626651763916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([390, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.685072898864746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.685072898864746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.685816764831543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7140350341796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([287, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.715318202972412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.715318202972412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7158656120300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7423477172851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([228, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.743607997894287  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.743607997894287  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7440428733825684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7657866477966309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([201, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7671151161193848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7671151161193848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.76749849319458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.789350986480713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([166, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.790595531463623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.790595531463623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.79091215133667  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.81117582321167  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8125457763671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8125457763671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8128490447998047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.834381103515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8355193138122559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8355193138122559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.835752010345459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8539023399353027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.855262279510498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.855262279510498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.855506420135498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.876258373260498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8773245811462402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8773245811462402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8775038719177246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.893998622894287  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.894716739654541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.894716739654541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8948311805725098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.906160831451416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([69, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9070987701416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9070987701416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9072303771972656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9211807250976562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([62, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9220685958862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9220685958862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9221868515014648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9355497360229492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9363079071044922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9363079071044922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9364032745361328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9478473663330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9487686157226562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9487686157226562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9488754272460938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9624404907226562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9632453918457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9632453918457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9633350372314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9753475189208984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.976168155670166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.976168155670166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9762539863586426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.988356113433838  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.989060401916504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.989060401916504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.989130973815918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9995756149291992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0001749992370605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0001749992370605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.000232219696045  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.009101390838623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.009824752807617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.009824752807617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.009889602661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.020395278930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.021193504333496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.021193504333496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0212621688842773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0328664779663086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([579, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0467448234558105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0467448234558105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 579, 256]), torch.Size([1, 579, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.047849178314209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2468457221984863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 579, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2094335556030273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2102670669555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2111005783081055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2102251052856445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5593, 40])
input nodes number: 24973
output nodes number: 5593
edges number: 44116
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2104644775390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2104649543762207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04816770553588867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 14 input nodes size: 53600
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04322957992553711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04322957992553711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.06878805160522461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.06882953643798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.037537574768066406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.03964996337890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.03964996337890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.03964996337890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([53600, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.03964996337890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1008, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.14762306213378906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.14762306213378906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1008, 128]), torch.Size([1, 1008, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.14858436584472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.15627479553222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1008, 128])
m.shape torch.Size([1050, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.1576099395751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.1576099395751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1050, 128]), torch.Size([1, 1050, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.15861129760742188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.17409992218017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1050, 128])
m.shape torch.Size([1062, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.17511844635009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.17511844635009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.1761312484741211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.19841289520263672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([970, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.19975948333740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.19975948333740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.2006845474243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.22801494598388672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([908, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.22971725463867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.22971725463867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.23058319091796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.262237548828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([877, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.2643136978149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.2643136978149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.2651500701904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3014087677001953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([866, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3038811683654785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3038811683654785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.30470705032348633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.34600114822387695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([793, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.34861326217651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.34861326217651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.34936952590942383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3926987648010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([808, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3967266082763672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.3967266082763672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.39749717712402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.44681358337402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([18026, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.5323829650878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.5323829650878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18026, 128]), torch.Size([1, 18026, 128])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.5495738983154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7701301574707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18026, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.6687464714050293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.6938929557800293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7190394401550293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.6936964988708496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([26368, 256])
first layer input nodes number: 53600
first layer output nodes number: 26368
edges number: 219914
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7194409370422363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7445874214172363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7508997917175293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.7508997917175293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([643, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.812697410583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.812697410583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8139238357543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.823735237121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([523, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8241677284240723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8241677284240723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8251652717590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8418622016906738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([433, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8427352905273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8427352905273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8435611724853516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8665504455566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([332, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8675246238708496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8675246238708496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8681578636169434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.889279842376709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([278, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8911213874816895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8911213874816895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.8916516304016113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9122767448425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([224, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9133033752441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9133033752441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9137306213378906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9321022033691406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([210, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9342379570007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9342379570007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.934638500213623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9546656608581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([154, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9556498527526855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9556498527526855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9559435844421387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9726862907409668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([171, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9740190505981445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9740190505981445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9743452072143555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9952192306518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([140, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9971046447753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9971046447753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 1.9973716735839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0163307189941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([131, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.017582416534424  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.017582416534424  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0178322792053223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0373215675354004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0386037826538086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0386037826538086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0388364791870117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0586156845092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0604195594787598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0604195594787598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0606160163879395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0786900520324707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.079843521118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.079843521118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0800209045410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0975818634033203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([77, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0986037254333496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.0986037254333496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.098750591278076  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.114318370819092  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.115429401397705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.115429401397705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1155762672424316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.132172107696533  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([84, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1334714889526367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1334714889526367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.133631706237793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.152857780456543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1539487838745117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1539487838745117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1540708541870117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1695737838745117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([67, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.170736312866211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.170736312866211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1708641052246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.18798828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([65, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1900391578674316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1900391578674316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.1901631355285645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.207643985748291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([60, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2087931632995605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2087931632995605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2089076042175293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2258448600769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2267184257507324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2267184257507324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.226802349090576  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2398104667663574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([48, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2408299446105957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2408299446105957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2409214973449707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.2557530403137207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.256676197052002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.256676197052002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.25675630569458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.270294666290283  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([1332, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.302260398864746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.302260398864746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1332, 256]), torch.Size([1, 1332, 256])
----------------------------------------3
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.305220603942871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.762648582458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1332, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.7055606842041016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.706383228302002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.7072057723999023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.7063417434692383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 26368
output nodes number: 5517
edges number: 63417
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.706568717956543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 2.706569194793701  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.04327678680419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 15 input nodes size: 57896
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.037526607513427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.037526607513427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.06513357162475586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.06517601013183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.039576053619384766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.0420374870300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.0420374870300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.0420374870300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([57896, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.6561279296875 GB
    Memory Allocated: 0.0420374870300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([992, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.1686077117919922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.1686077117919922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.1695537567138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.1771221160888672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([1030, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.17840003967285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.17840003967285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1030, 128]), torch.Size([1, 1030, 128])
----------------------------------------3
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.17938232421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.19411659240722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1030, 128])
m.shape torch.Size([909, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.19492578506469727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.19492578506469727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.19579267501831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.215789794921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([961, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.21718931198120117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.21718931198120117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.21810579299926758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.24484586715698242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([921, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.2465834617614746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.2465834617614746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.24746179580688477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.2790818214416504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([958, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.2813835144042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.2813835144042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 958, 128]), torch.Size([1, 958, 128])
----------------------------------------3
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.28229713439941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.32235145568847656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 958, 128])
m.shape torch.Size([909, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.32492876052856445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.32492876052856445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.32579565048217773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.370025634765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([889, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.372983455657959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.372983455657959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 889, 128]), torch.Size([1, 889, 128])
----------------------------------------3
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.37383127212524414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.42368650436401367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 889, 128])
m.shape torch.Size([896, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.4271078109741211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.4271078109741211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.4279623031616211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.48455333709716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([21619, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.5872135162353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.5872135162353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 21619, 128]), torch.Size([1, 21619, 128])
----------------------------------------3
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 0.6078310012817383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.0716724395751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 21619, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 1.9520940780639648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 1.9813909530639648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.0100812911987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 1.9805598258972168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([30084, 256])
first layer input nodes number: 57896
first layer output nodes number: 30084
edges number: 257705
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.010514736175537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.0392050743103027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.0471854209899902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.0471854209899902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([624, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.1177449226379395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.1177449226379395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.1189351081848145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.129544734954834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([494, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.129899501800537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.129899501800537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 494, 256]), torch.Size([1, 494, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.1308417320251465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.144975185394287  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 494, 256])
m.shape torch.Size([353, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.145620822906494  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.145620822906494  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.146294116973877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.163743495941162  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([261, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.1645236015319824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.1645236015319824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.1650214195251465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.1873087882995605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([248, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.188803195953369  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.188803195953369  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.1892762184143066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2063050270080566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([221, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.207343101501465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.207343101501465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2077646255493164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2258901596069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([163, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.226776123046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.226776123046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2270870208740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2426319122314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([153, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2436532974243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2436532974243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2439451217651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2605791091918945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([158, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2621102333068848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2621102333068848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.262411594390869  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.281698703765869  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([144, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2829322814941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2829322814941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.2832069396972656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.3027076721191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.30403995513916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.30403995513916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.304305076599121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.324984550476074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([133, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.326385974884033  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.326385974884033  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.3266396522521973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.3482022285461426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([117, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.3495373725891113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.3495373725891113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.3497605323791504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.370291233062744  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.3714356422424316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.3714356422424316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.3716111183166504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.3889832496643066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([83, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.390092372894287  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.390092372894287  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.3902506828308105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.407031536102295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([98, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4084596633911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4084596633911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.408646583557129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4297685623168945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.430868148803711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.430868148803711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4310073852539062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4477157592773438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([100, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4493765830993652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4493765830993652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4495673179626465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4737906455993652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([83, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4752111434936523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4752111434936523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.475369453430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4965829849243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([89, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4982147216796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.4982147216796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.498384475708008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.522319793701172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([86, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.5239710807800293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.5239710807800293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.524135112762451  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.5484118461608887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.549806594848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.549806594848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.549915313720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.5667667388916016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([63, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.568849563598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.568849563598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.5689697265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.5884361267089844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.58980655670166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.58980655670166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.5899248123168945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.609910011291504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([1596, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.648200035095215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.648200035095215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1596, 256]), torch.Size([1, 1596, 256])
----------------------------------------3
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 2.6512441635131836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 3.189361572265625  GigaBytes
Max Memory Allocated: 3.2274131774902344  GigaBytes

rst.shape  torch.Size([1, 1596, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 3.123112201690674  GigaBytes
Max Memory Allocated: 3.2274131774902344  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 3.123960494995117  GigaBytes
Max Memory Allocated: 3.2274131774902344  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 3.1248087882995605  GigaBytes
Max Memory Allocated: 3.2274131774902344  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 3.123918056488037  GigaBytes
Max Memory Allocated: 3.2274131774902344  GigaBytes

torch.Size([5690, 40])
input nodes number: 30084
output nodes number: 5690
edges number: 72550
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 3.124210834503174  GigaBytes
Max Memory Allocated: 3.2274131774902344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 3.124211311340332  GigaBytes
Max Memory Allocated: 3.2274131774902344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6834716796875 GB
    Memory Allocated: 0.046235084533691406  GigaBytes
Max Memory Allocated: 3.2274131774902344  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.6834716796875 GB
    Memory Allocated: 0.046235084533691406  GigaBytes
Max Memory Allocated: 3.2274131774902344  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.6834716796875 GB
    Memory Allocated: 0.046235084533691406  GigaBytes
Max Memory Allocated: 3.2274131774902344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010769441723823547 |0.002953141927719116 |0.11819928884506226 |8.733570575714111e-05 |0.07752501964569092 |0.0047054290771484375 |
----------------------------------------------------------pseudo_mini_loss sum 3.822347402572632
Total (block generation + training)time/epoch 25.097395539283752
Training time/epoch 3.4421355724334717
Training time without block to device /epoch 3.394885301589966
Training time without total dataloading part /epoch 3.1376917362213135
load block tensor time/epoch 0.17231106758117676
block to device time/epoch 0.04725027084350586
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  885544
Number of first layer input nodes during this epoch:  604456
Number of first layer output nodes during this epoch:  281088
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
